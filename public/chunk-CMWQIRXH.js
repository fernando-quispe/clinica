import{$ as Vn,$a as Ct,$b as py,A as ii,Aa as Kl,B as xn,Ba as li,C as Ul,Ca as hi,D as si,Da as Qm,E as Um,Ea as Xm,F as jm,Fa as Jm,Fb as fn,G as pr,Ga as Ym,Gb as di,H as $t,Ha as Zm,Hb as cy,I as jl,Ia as ey,J as Bm,Ja as ty,K as Oa,Ka as yr,Kb as $s,L as oi,Lb as Ua,M as Bl,Mb as ja,N as ai,Na as ny,Nb as Ba,O as Me,Oa as Bs,Ob as Jl,P as ql,Pa as Je,Pb as qa,Q as qm,Qa as re,Qb as $a,R as je,Ra as ry,Rb as za,S as de,Sb as Yl,T as hn,Tb as zs,U as ee,Ua as iy,Ub as ly,V as ut,Va as vr,Vb as _r,W as $m,Wb as hy,X as Q,Xa as Se,Xb as fi,Y as $l,Ya as Wl,Yb as dy,Z as j,Za as sy,Zb as fy,_ as H,_b as pt,a as xm,aa as zm,ab as oy,ac as pi,b as Vm,ba as js,bb as ay,bc as gy,c as qt,ca as bt,cb as Hl,cc as Zl,d as kl,da as ui,db as qs,dc as Gs,e as Ol,ea as ct,eb as uy,ec as Ga,f as Tt,fa as Ne,fb as Fa,g as At,gb as dt,gc as my,h as Na,ha as gr,i as Mm,ib as Ql,j as Dn,ja as Gm,jc as yy,k as Pn,ka as Mn,kb as _e,l as fr,la as zt,lb as we,lc as Nn,m as ve,ma as Gt,mb as La,mc as vy,n as K,na as lt,nc as Ka,o as Us,oa as ht,p as Nm,pa as dn,pb as St,q as km,qa as Km,r as J,ra as ci,rb as Ie,s as ka,sa as zl,sb as ft,t as vt,ta as mr,u as Fl,ua as kt,v as Om,va as Wm,w as Ll,wa as Gl,x as Fm,xa as Hm,xb as pe,y as Lm,ya as nt,z as at,zb as Xl}from"./chunk-2R5RJSOK.js";import{a as _y,b as wy,c as eh,d as Ey,e as Ks,f as th,g as Wa,h as Iy,i as Ty,j as nh,k as Ae,l as wr,m as Kt,n as Ha,o as Ws,p as rh,q as Ay,r as by,s as Hs,t as Qa,u as Rt,v as gt}from"./chunk-WH4R2YDQ.js";import{a as B,b as ye,g as Nl,h as P}from"./chunk-SIAVTO45.js";var Xs=class{},Ja=class{},Er=class r{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let n=t.indexOf(":");if(n>0){let i=t.slice(0,n),s=i.toLowerCase(),o=t.slice(n+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,n)=>{this.setHeaderEntries(n,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,n])=>{this.setHeaderEntries(t,n)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof r?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new r;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof r?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if(typeof n=="string"&&(n=[n]),n.length===0)return;this.maybeSetNormalizedName(e.name,t);let i=(e.op==="a"?this.headers.get(t):void 0)||[];i.push(...n),this.headers.set(t,i);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let o=this.headers.get(t);if(!o)return;o=o.filter(u=>s.indexOf(u)===-1),o.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}break}}setHeaderEntries(e,t){let n=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,n),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var sh=class{encodeKey(e){return Cy(e)}encodeValue(e){return Cy(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function ZT(r,e){let t=new Map;return r.length>0&&r.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[o,u]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],c=t.get(o)||[];c.push(u),t.set(o,c)}),t}var e0=/%(\d[a-f0-9])/gi,t0={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Cy(r){return encodeURIComponent(r).replace(e0,(e,t)=>t0[t]??e)}function Xa(r){return`${r}`}var kn=class r{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new sh,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=ZT(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let n=e.fromObject[t],i=Array.isArray(n)?n.map(Xa):[Xa(n)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(n=>{let i=e[n];Array.isArray(i)?i.forEach(s=>{t.push({param:n,value:s,op:"a"})}):t.push({param:n,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new r({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(Xa(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let n=this.map.get(e.param)||[],i=n.indexOf(Xa(e.value));i!==-1&&n.splice(i,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var oh=class{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function n0(r){switch(r){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function Sy(r){return typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer}function Ry(r){return typeof Blob<"u"&&r instanceof Blob}function Dy(r){return typeof FormData<"u"&&r instanceof FormData}function r0(r){return typeof URLSearchParams<"u"&&r instanceof URLSearchParams}var Qs=class r{constructor(e,t,n,i){this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(n0(this.method)||i?(this.body=n!==void 0?n:null,s=i):s=n,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new Er,this.context??=new oh,!this.params)this.params=new kn,this.urlWithParams=t;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=t;else{let u=t.indexOf("?"),c=u===-1?"?":u<t.length-1?"&":"";this.urlWithParams=t+c+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||Sy(this.body)||Ry(this.body)||Dy(this.body)||r0(this.body)?this.body:this.body instanceof kn?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Dy(this.body)?null:Ry(this.body)?this.body.type||null:Sy(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof kn?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let t=e.method||this.method,n=e.url||this.url,i=e.responseType||this.responseType,s=e.transferCache??this.transferCache,o=e.body!==void 0?e.body:this.body,u=e.withCredentials??this.withCredentials,c=e.reportProgress??this.reportProgress,l=e.headers||this.headers,f=e.params||this.params,p=e.context??this.context;return e.setHeaders!==void 0&&(l=Object.keys(e.setHeaders).reduce((m,w)=>m.set(w,e.setHeaders[w]),l)),e.setParams&&(f=Object.keys(e.setParams).reduce((m,w)=>m.set(w,e.setParams[w]),f)),new r(t,n,o,{params:f,headers:l,context:p,reportProgress:c,responseType:i,withCredentials:u,transferCache:s})}},gi=function(r){return r[r.Sent=0]="Sent",r[r.UploadProgress=1]="UploadProgress",r[r.ResponseHeader=2]="ResponseHeader",r[r.DownloadProgress=3]="DownloadProgress",r[r.Response=4]="Response",r[r.User=5]="User",r}(gi||{}),Js=class{constructor(e,t=eu.Ok,n="OK"){this.headers=e.headers||new Er,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},ah=class r extends Js{constructor(e={}){super(e),this.type=gi.ResponseHeader}clone(e={}){return new r({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Ya=class r extends Js{constructor(e={}){super(e),this.type=gi.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new r({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Za=class extends Js{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},eu=function(r){return r[r.Continue=100]="Continue",r[r.SwitchingProtocols=101]="SwitchingProtocols",r[r.Processing=102]="Processing",r[r.EarlyHints=103]="EarlyHints",r[r.Ok=200]="Ok",r[r.Created=201]="Created",r[r.Accepted=202]="Accepted",r[r.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",r[r.NoContent=204]="NoContent",r[r.ResetContent=205]="ResetContent",r[r.PartialContent=206]="PartialContent",r[r.MultiStatus=207]="MultiStatus",r[r.AlreadyReported=208]="AlreadyReported",r[r.ImUsed=226]="ImUsed",r[r.MultipleChoices=300]="MultipleChoices",r[r.MovedPermanently=301]="MovedPermanently",r[r.Found=302]="Found",r[r.SeeOther=303]="SeeOther",r[r.NotModified=304]="NotModified",r[r.UseProxy=305]="UseProxy",r[r.Unused=306]="Unused",r[r.TemporaryRedirect=307]="TemporaryRedirect",r[r.PermanentRedirect=308]="PermanentRedirect",r[r.BadRequest=400]="BadRequest",r[r.Unauthorized=401]="Unauthorized",r[r.PaymentRequired=402]="PaymentRequired",r[r.Forbidden=403]="Forbidden",r[r.NotFound=404]="NotFound",r[r.MethodNotAllowed=405]="MethodNotAllowed",r[r.NotAcceptable=406]="NotAcceptable",r[r.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",r[r.RequestTimeout=408]="RequestTimeout",r[r.Conflict=409]="Conflict",r[r.Gone=410]="Gone",r[r.LengthRequired=411]="LengthRequired",r[r.PreconditionFailed=412]="PreconditionFailed",r[r.PayloadTooLarge=413]="PayloadTooLarge",r[r.UriTooLong=414]="UriTooLong",r[r.UnsupportedMediaType=415]="UnsupportedMediaType",r[r.RangeNotSatisfiable=416]="RangeNotSatisfiable",r[r.ExpectationFailed=417]="ExpectationFailed",r[r.ImATeapot=418]="ImATeapot",r[r.MisdirectedRequest=421]="MisdirectedRequest",r[r.UnprocessableEntity=422]="UnprocessableEntity",r[r.Locked=423]="Locked",r[r.FailedDependency=424]="FailedDependency",r[r.TooEarly=425]="TooEarly",r[r.UpgradeRequired=426]="UpgradeRequired",r[r.PreconditionRequired=428]="PreconditionRequired",r[r.TooManyRequests=429]="TooManyRequests",r[r.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",r[r.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",r[r.InternalServerError=500]="InternalServerError",r[r.NotImplemented=501]="NotImplemented",r[r.BadGateway=502]="BadGateway",r[r.ServiceUnavailable=503]="ServiceUnavailable",r[r.GatewayTimeout=504]="GatewayTimeout",r[r.HttpVersionNotSupported=505]="HttpVersionNotSupported",r[r.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",r[r.InsufficientStorage=507]="InsufficientStorage",r[r.LoopDetected=508]="LoopDetected",r[r.NotExtended=510]="NotExtended",r[r.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",r}(eu||{});function ih(r,e){return{body:e,headers:r.headers,context:r.context,observe:r.observe,params:r.params,reportProgress:r.reportProgress,responseType:r.responseType,withCredentials:r.withCredentials,transferCache:r.transferCache}}var i0=(()=>{let e=class e{constructor(n){this.handler=n}request(n,i,s={}){let o;if(n instanceof Qs)o=n;else{let l;s.headers instanceof Er?l=s.headers:l=new Er(s.headers);let f;s.params&&(s.params instanceof kn?f=s.params:f=new kn({fromObject:s.params})),o=new Qs(n,i,s.body!==void 0?s.body:null,{headers:l,context:s.context,params:f,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials,transferCache:s.transferCache})}let u=K(o).pipe(xn(l=>this.handler.handle(l)));if(n instanceof Qs||s.observe==="events")return u;let c=u.pipe(at(l=>l instanceof Ya));switch(s.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return c.pipe(J(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return c.pipe(J(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return c.pipe(J(l=>{if(l.body!==null&&typeof l.body!="string")throw new Error("Response is not a string.");return l.body}));case"json":default:return c.pipe(J(l=>l.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(n,i={}){return this.request("DELETE",n,i)}get(n,i={}){return this.request("GET",n,i)}head(n,i={}){return this.request("HEAD",n,i)}jsonp(n,i){return this.request("JSONP",n,{params:new kn().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,i={}){return this.request("OPTIONS",n,i)}patch(n,i,s={}){return this.request("PATCH",n,ih(s,i))}post(n,i,s={}){return this.request("POST",n,ih(s,i))}put(n,i,s={}){return this.request("PUT",n,ih(s,i))}};e.\u0275fac=function(i){return new(i||e)(j(Xs))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})();function My(r,e){return e(r)}function s0(r,e){return(t,n)=>e.intercept(t,{handle:i=>r(i,n)})}function o0(r,e,t){return(n,i)=>zt(t,()=>e(n,s=>r(s,i)))}var a0=new Q(""),uh=new Q(""),u0=new Q(""),c0=new Q("");function l0(){let r=null;return(e,t)=>{r===null&&(r=(H(a0,{optional:!0})??[]).reduceRight(s0,My));let n=H(qs),i=n.add();return r(e,t).pipe(pr(()=>n.remove(i)))}}var Py=(()=>{let e=class e extends Xs{constructor(n,i){super(),this.backend=n,this.injector=i,this.chain=null,this.pendingTasks=H(qs);let s=H(c0,{optional:!0});this.backend=s??n}handle(n){if(this.chain===null){let s=Array.from(new Set([...this.injector.get(uh),...this.injector.get(u0,[])]));this.chain=s.reduceRight((o,u)=>o0(o,u,this.injector),My)}let i=this.pendingTasks.add();return this.chain(n,s=>this.backend.handle(s)).pipe(pr(()=>this.pendingTasks.remove(i)))}};e.\u0275fac=function(i){return new(i||e)(j(Ja),j(Mn))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})();var h0=/^\)\]\}',?\n/;function d0(r){return"responseURL"in r&&r.responseURL?r.responseURL:/^X-Request-URL:/m.test(r.getAllResponseHeaders())?r.getResponseHeader("X-Request-URL"):null}var xy=(()=>{let e=class e{constructor(n){this.xhrFactory=n}handle(n){if(n.method==="JSONP")throw new de(-2800,!1);let i=this.xhrFactory;return(i.\u0275loadImpl?ve(i.\u0275loadImpl()):K(null)).pipe(Me(()=>new qt(o=>{let u=i.build();if(u.open(n.method,n.urlWithParams),n.withCredentials&&(u.withCredentials=!0),n.headers.forEach((D,k)=>u.setRequestHeader(D,k.join(","))),n.headers.has("Accept")||u.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){let D=n.detectContentTypeHeader();D!==null&&u.setRequestHeader("Content-Type",D)}if(n.responseType){let D=n.responseType.toLowerCase();u.responseType=D!=="json"?D:"text"}let c=n.serializeBody(),l=null,f=()=>{if(l!==null)return l;let D=u.statusText||"OK",k=new Er(u.getAllResponseHeaders()),z=d0(u)||n.url;return l=new ah({headers:k,status:u.status,statusText:D,url:z}),l},p=()=>{let{headers:D,status:k,statusText:z,url:F}=f(),$=null;k!==eu.NoContent&&($=typeof u.response>"u"?u.responseText:u.response),k===0&&(k=$?eu.Ok:0);let X=k>=200&&k<300;if(n.responseType==="json"&&typeof $=="string"){let Y=$;$=$.replace(h0,"");try{$=$!==""?JSON.parse($):null}catch(E){$=Y,X&&(X=!1,$={error:E,text:$})}}X?(o.next(new Ya({body:$,headers:D,status:k,statusText:z,url:F||void 0})),o.complete()):o.error(new Za({error:$,headers:D,status:k,statusText:z,url:F||void 0}))},m=D=>{let{url:k}=f(),z=new Za({error:D,status:u.status||0,statusText:u.statusText||"Unknown Error",url:k||void 0});o.error(z)},w=!1,x=D=>{w||(o.next(f()),w=!0);let k={type:gi.DownloadProgress,loaded:D.loaded};D.lengthComputable&&(k.total=D.total),n.responseType==="text"&&u.responseText&&(k.partialText=u.responseText),o.next(k)},V=D=>{let k={type:gi.UploadProgress,loaded:D.loaded};D.lengthComputable&&(k.total=D.total),o.next(k)};return u.addEventListener("load",p),u.addEventListener("error",m),u.addEventListener("timeout",m),u.addEventListener("abort",m),n.reportProgress&&(u.addEventListener("progress",x),c!==null&&u.upload&&u.upload.addEventListener("progress",V)),u.send(c),o.next({type:gi.Sent}),()=>{u.removeEventListener("error",m),u.removeEventListener("abort",m),u.removeEventListener("load",p),u.removeEventListener("timeout",m),n.reportProgress&&(u.removeEventListener("progress",x),c!==null&&u.upload&&u.upload.removeEventListener("progress",V)),u.readyState!==u.DONE&&u.abort()}})))}};e.\u0275fac=function(i){return new(i||e)(j(Ka))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})(),Ny=new Q(""),f0="XSRF-TOKEN",p0=new Q("",{providedIn:"root",factory:()=>f0}),g0="X-XSRF-TOKEN",m0=new Q("",{providedIn:"root",factory:()=>g0}),tu=class{},y0=(()=>{let e=class e{constructor(n,i,s){this.doc=n,this.platform=i,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=Ga(n,this.cookieName),this.lastCookieString=n),this.lastToken}};e.\u0275fac=function(i){return new(i||e)(j(pt),j(nt),j(p0))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})();function v0(r,e){let t=r.url.toLowerCase();if(!H(Ny)||r.method==="GET"||r.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(r);let n=H(tu).getToken(),i=H(m0);return n!=null&&!r.headers.has(i)&&(r=r.clone({headers:r.headers.set(i,n)})),e(r)}var ky=function(r){return r[r.Interceptors=0]="Interceptors",r[r.LegacyInterceptors=1]="LegacyInterceptors",r[r.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",r[r.NoXsrfProtection=3]="NoXsrfProtection",r[r.JsonpSupport=4]="JsonpSupport",r[r.RequestsMadeViaParent=5]="RequestsMadeViaParent",r[r.Fetch=6]="Fetch",r}(ky||{});function _0(r,e){return{\u0275kind:r,\u0275providers:e}}function w0(...r){let e=[i0,xy,Py,{provide:Xs,useExisting:Py},{provide:Ja,useExisting:xy},{provide:uh,useValue:v0,multi:!0},{provide:Ny,useValue:!0},{provide:tu,useClass:y0}];for(let t of r)e.push(...t.\u0275providers);return gr(e)}var Vy=new Q("");function E0(){return _0(ky.LegacyInterceptors,[{provide:Vy,useFactory:l0},{provide:uh,useExisting:Vy,multi:!0}])}var eP=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=ct({type:e}),e.\u0275inj=ut({providers:[w0(E0())]});let r=e;return r})();var hh=class extends fy{constructor(){super(...arguments),this.supportsDOMEvents=!0}},dh=class r extends hh{static makeCurrent(){dy(new r)}onAndCancel(e,t,n){return e.addEventListener(t,n),()=>{e.removeEventListener(t,n)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=T0();return t==null?null:A0(t)}resetBaseElement(){Ys=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Ga(document.cookie,e)}},Ys=null;function T0(){return Ys=Ys||document.querySelector("base"),Ys?Ys.getAttribute("href"):null}function A0(r){return new URL(r,document.baseURI).pathname}var b0=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})(),fh=new Q(""),Uy=(()=>{let e=class e{constructor(n,i){this._zone=i,this._eventNameToPlugin=new Map,n.forEach(s=>{s.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,i,s){return this._findPluginFor(i).addEventListener(n,i,s)}getZone(){return this._zone}_findPluginFor(n){let i=this._eventNameToPlugin.get(n);if(i)return i;if(i=this._plugins.find(o=>o.supports(n)),!i)throw new de(5101,!1);return this._eventNameToPlugin.set(n,i),i}};e.\u0275fac=function(i){return new(i||e)(j(fh),j(Se))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})(),nu=class{constructor(e){this._doc=e}},ch="ng-app-id",jy=(()=>{let e=class e{constructor(n,i,s,o={}){this.doc=n,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Nn(o),this.resetHostNodes()}addStyles(n){for(let i of n)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(n){for(let i of n)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let n=this.styleNodesInDOM;n&&(n.forEach(i=>i.remove()),n.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(let i of this.getAllStyles())this.addStyleToHost(n,i)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(let i of this.hostNodes)this.addStyleToHost(i,n)}onStyleRemoved(n){let i=this.styleRef;i.get(n)?.elements?.forEach(s=>s.remove()),i.delete(n)}collectServerRenderedStyles(){let n=this.doc.head?.querySelectorAll(`style[${ch}="${this.appId}"]`);if(n?.length){let i=new Map;return n.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(n,i){let s=this.styleRef;if(s.has(n)){let o=s.get(n);return o.usage+=i,o.usage}return s.set(n,{usage:i,elements:[]}),i}getStyleElement(n,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===n)return s.delete(i),o.removeAttribute(ch),o;{let u=this.doc.createElement("style");return this.nonce&&u.setAttribute("nonce",this.nonce),u.textContent=i,this.platformIsServer&&u.setAttribute(ch,this.appId),n.appendChild(u),u}}addStyleToHost(n,i){let s=this.getStyleElement(n,i),o=this.styleRef,u=o.get(i)?.elements;u?u.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let n=this.hostNodes;n.clear(),n.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(j(pt),j(Gl),j(Kl,8),j(nt))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})(),lh={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},gh=/%COMP%/g,By="%COMP%",C0=`_nghost-${By}`,S0=`_ngcontent-${By}`,R0=!0,D0=new Q("",{providedIn:"root",factory:()=>R0});function P0(r){return S0.replace(gh,r)}function x0(r){return C0.replace(gh,r)}function qy(r,e){return e.map(t=>t.replace(gh,r))}var Oy=(()=>{let e=class e{constructor(n,i,s,o,u,c,l,f=null){this.eventManager=n,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=u,this.platformId=c,this.ngZone=l,this.nonce=f,this.rendererByCompId=new Map,this.platformIsServer=Nn(c),this.defaultRenderer=new Zs(n,u,l,this.platformIsServer)}createRenderer(n,i){if(!n||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===js.ShadowDom&&(i=ye(B({},i),{encapsulation:js.Emulated}));let s=this.getOrCreateRenderer(n,i);return s instanceof ru?s.applyToHost(n):s instanceof eo&&s.applyStyles(),s}getOrCreateRenderer(n,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let u=this.doc,c=this.ngZone,l=this.eventManager,f=this.sharedStylesHost,p=this.removeStylesOnCompDestroy,m=this.platformIsServer;switch(i.encapsulation){case js.Emulated:o=new ru(l,f,i,this.appId,p,u,c,m);break;case js.ShadowDom:return new ph(l,f,n,i,u,c,this.nonce,m);default:o=new eo(l,f,i,p,u,c,m);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(j(Uy),j(jy),j(Gl),j(D0),j(pt),j(nt),j(Se),j(Kl))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})(),Zs=class{constructor(e,t,n,i){this.eventManager=e,this.doc=t,this.ngZone=n,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(lh[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(Fy(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(Fy(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n=typeof e=="string"?this.doc.querySelector(e):e;if(!n)throw new de(-5104,!1);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,i){if(i){t=i+":"+t;let s=lh[i];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){let i=lh[n];i?e.removeAttributeNS(i,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,i){i&(Bs.DashCase|Bs.Important)?e.style.setProperty(t,n,i&Bs.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&Bs.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e!=null&&(e[t]=n)}setValue(e,t){e.nodeValue=t}listen(e,t,n){if(typeof e=="string"&&(e=fi().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(n))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function Fy(r){return r.tagName==="TEMPLATE"&&r.content!==void 0}var ph=class extends Zs{constructor(e,t,n,i,s,o,u,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=qy(i.id,i.styles);for(let f of l){let p=document.createElement("style");u&&p.setAttribute("nonce",u),p.textContent=f,this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},eo=class extends Zs{constructor(e,t,n,i,s,o,u,c){super(e,s,o,u),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?qy(c,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},ru=class extends eo{constructor(e,t,n,i,s,o,u,c){let l=i+"-"+n.id;super(e,t,n,s,o,u,c,l),this.contentAttr=P0(l),this.hostAttr=x0(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}},V0=(()=>{let e=class e extends nu{constructor(n){super(n)}supports(n){return!0}addEventListener(n,i,s){return n.addEventListener(i,s,!1),()=>this.removeEventListener(n,i,s)}removeEventListener(n,i,s){return n.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(j(pt))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})(),Ly=["alt","control","meta","shift"],M0={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},N0={alt:r=>r.altKey,control:r=>r.ctrlKey,meta:r=>r.metaKey,shift:r=>r.shiftKey},k0=(()=>{let e=class e extends nu{constructor(n){super(n)}supports(n){return e.parseEventName(n)!=null}addEventListener(n,i,s){let o=e.parseEventName(i),u=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>fi().onAndCancel(n,o.domEventName,u))}static parseEventName(n){let i=n.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),u="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),u="code."),Ly.forEach(f=>{let p=i.indexOf(f);p>-1&&(i.splice(p,1),u+=f+".")}),u+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=s,l.fullKey=u,l}static matchEventFullKeyCode(n,i){let s=M0[n.key]||n.key,o="";return i.indexOf("code.")>-1&&(s=n.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),Ly.forEach(u=>{if(u!==s){let c=N0[u];c(n)&&(o+=u+".")}}),o+=s,o===i)}static eventCallback(n,i,s){return o=>{e.matchEventFullKeyCode(o,n)&&s.runGuarded(()=>i(o))}}static _normalizeKey(n){return n==="esc"?"escape":n}};e.\u0275fac=function(i){return new(i||e)(j(pt))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})();function EP(r,e){return ly(B({rootComponent:r},O0(e)))}function O0(r){return{appProviders:[...B0,...r?.providers??[]],platformProviders:j0}}function F0(){dh.makeCurrent()}function L0(){return new zl}function U0(){return Wm(document),document}var j0=[{provide:nt,useValue:yy},{provide:Hm,useValue:F0,multi:!0},{provide:pt,useFactory:U0,deps:[]}];var B0=[{provide:Gm,useValue:"root"},{provide:zl,useFactory:L0,deps:[]},{provide:fh,useClass:V0,multi:!0,deps:[pt,Se,nt]},{provide:fh,useClass:k0,multi:!0,deps:[pt]},Oy,jy,Uy,{provide:iy,useExisting:Oy},{provide:Ka,useClass:b0,deps:[]},[]];var $y=(()=>{let e=class e{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}};e.\u0275fac=function(i){return new(i||e)(j(pt))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();var q0=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:function(i){let s=null;return i?s=new(i||e):s=j($0),s},providedIn:"root"});let r=e;return r})(),$0=(()=>{let e=class e extends q0{constructor(n){super(),this._doc=n}sanitize(n,i){if(i==null)return null;switch(n){case yr.NONE:return i;case yr.HTML:return hi(i,"HTML")?li(i):ty(this._doc,String(i)).toString();case yr.STYLE:return hi(i,"Style")?li(i):i;case yr.SCRIPT:if(hi(i,"Script"))return li(i);throw new de(5200,!1);case yr.URL:return hi(i,"URL")?li(i):ey(String(i));case yr.RESOURCE_URL:if(hi(i,"ResourceURL"))return li(i);throw new de(5201,!1);default:throw new de(5202,!1)}}bypassSecurityTrustHtml(n){return Qm(n)}bypassSecurityTrustStyle(n){return Xm(n)}bypassSecurityTrustScript(n){return Jm(n)}bypassSecurityTrustUrl(n){return Ym(n)}bypassSecurityTrustResourceUrl(n){return Zm(n)}};e.\u0275fac=function(i){return new(i||e)(j(pt))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();var ev=(()=>{let e=class e{constructor(n,i){this._renderer=n,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(n,i){this._renderer.setProperty(this._elementRef.nativeElement,n,i)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}};e.\u0275fac=function(i){return new(i||e)(re(vr),re(mr))},e.\u0275dir=Ne({type:e});let r=e;return r})(),du=(()=>{let e=class e extends ev{};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=dn(e)))(s||e)}})(),e.\u0275dir=Ne({type:e,features:[Ct]});let r=e;return r})(),vi=new Q("");var G0={provide:vi,useExisting:hn(()=>tv),multi:!0};function K0(){let r=fi()?fi().getUserAgent():"";return/android (\d+)/.test(r.toLowerCase())}var W0=new Q(""),tv=(()=>{let e=class e extends ev{constructor(n,i,s){super(n,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!K0())}writeValue(n){let i=n??"";this.setProperty("value",i)}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}};e.\u0275fac=function(i){return new(i||e)(re(vr),re(mr),re(W0,8))},e.\u0275dir=Ne({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&Ie("input",function(u){return s._handleInput(u.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(u){return s._compositionEnd(u.target.value)})},features:[fn([G0]),Ct]});let r=e;return r})();function On(r){return r==null||(typeof r=="string"||Array.isArray(r))&&r.length===0}function nv(r){return r!=null&&typeof r.length=="number"}var fu=new Q(""),wh=new Q(""),H0=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,zy=class{static min(e){return Q0(e)}static max(e){return X0(e)}static required(e){return rv(e)}static requiredTrue(e){return J0(e)}static email(e){return Y0(e)}static minLength(e){return Z0(e)}static maxLength(e){return eA(e)}static pattern(e){return tA(e)}static nullValidator(e){return su(e)}static compose(e){return cv(e)}static composeAsync(e){return hv(e)}};function Q0(r){return e=>{if(On(e.value)||On(r))return null;let t=parseFloat(e.value);return!isNaN(t)&&t<r?{min:{min:r,actual:e.value}}:null}}function X0(r){return e=>{if(On(e.value)||On(r))return null;let t=parseFloat(e.value);return!isNaN(t)&&t>r?{max:{max:r,actual:e.value}}:null}}function rv(r){return On(r.value)?{required:!0}:null}function J0(r){return r.value===!0?null:{required:!0}}function Y0(r){return On(r.value)||H0.test(r.value)?null:{email:!0}}function Z0(r){return e=>On(e.value)||!nv(e.value)?null:e.value.length<r?{minlength:{requiredLength:r,actualLength:e.value.length}}:null}function eA(r){return e=>nv(e.value)&&e.value.length>r?{maxlength:{requiredLength:r,actualLength:e.value.length}}:null}function tA(r){if(!r)return su;let e,t;return typeof r=="string"?(t="",r.charAt(0)!=="^"&&(t+="^"),t+=r,r.charAt(r.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=r.toString(),e=r),n=>{if(On(n.value))return null;let i=n.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}function su(r){return null}function iv(r){return r!=null}function sv(r){return Ba(r)?ve(r):r}function ov(r){let e={};return r.forEach(t=>{e=t!=null?B(B({},e),t):e}),Object.keys(e).length===0?null:e}function av(r,e){return e.map(t=>t(r))}function nA(r){return!r.validate}function uv(r){return r.map(e=>nA(e)?e:t=>e.validate(t))}function cv(r){if(!r)return null;let e=r.filter(iv);return e.length==0?null:function(t){return ov(av(t,e))}}function lv(r){return r!=null?cv(uv(r)):null}function hv(r){if(!r)return null;let e=r.filter(iv);return e.length==0?null:function(t){let n=av(t,e).map(sv);return Fm(n).pipe(J(ov))}}function dv(r){return r!=null?hv(uv(r)):null}function Gy(r,e){return r===null?[e]:Array.isArray(r)?[...r,e]:[r,e]}function fv(r){return r._rawValidators}function pv(r){return r._rawAsyncValidators}function mh(r){return r?Array.isArray(r)?r:[r]:[]}function ou(r,e){return Array.isArray(r)?r.includes(e):r===e}function Ky(r,e){let t=mh(e);return mh(r).forEach(i=>{ou(t,i)||t.push(i)}),t}function Wy(r,e){return mh(e).filter(t=>!ou(r,t))}var au=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=lv(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=dv(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Ir=class extends au{get formDirective(){return null}get path(){return null}},Tr=class extends au{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},uu=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},rA={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},LP=ye(B({},rA),{"[class.ng-submitted]":"isSubmitted"}),UP=(()=>{let e=class e extends uu{constructor(n){super(n)}};e.\u0275fac=function(i){return new(i||e)(re(Tr,2))},e.\u0275dir=Ne({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&Ql("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Ct]});let r=e;return r})(),jP=(()=>{let e=class e extends uu{constructor(n){super(n)}};e.\u0275fac=function(i){return new(i||e)(re(Ir,10))},e.\u0275dir=Ne({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,s){i&2&&Ql("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[Ct]});let r=e;return r})();var to="VALID",iu="INVALID",mi="PENDING",no="DISABLED";function Eh(r){return(pu(r)?r.validators:r)||null}function iA(r){return Array.isArray(r)?lv(r):r||null}function Ih(r,e){return(pu(e)?e.asyncValidators:r)||null}function sA(r){return Array.isArray(r)?dv(r):r||null}function pu(r){return r!=null&&!Array.isArray(r)&&typeof r=="object"}function gv(r,e,t){let n=r.controls;if(!(e?Object.keys(n):n).length)throw new de(1e3,"");if(!n[t])throw new de(1001,"")}function mv(r,e,t){r._forEachChild((n,i)=>{if(t[i]===void 0)throw new de(1002,"")})}var yi=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===to}get invalid(){return this.status===iu}get pending(){return this.status==mi}get disabled(){return this.status===no}get enabled(){return this.status!==no}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Ky(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Ky(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Wy(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Wy(e,this._rawAsyncValidators))}hasValidator(e){return ou(this._rawValidators,e)}hasAsyncValidator(e){return ou(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=mi,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=no,this.errors=null,this._forEachChild(n=>{n.disable(ye(B({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ye(B({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(n=>n(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=to,this._forEachChild(n=>{n.enable(ye(B({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ye(B({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===to||this.status===mi)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?no:to}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=mi,this._hasOwnPendingAsyncValidator=!0;let t=sv(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((n,i)=>n&&n._find(i),this)}getError(e,t){let n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new kt,this.statusChanges=new kt}_calculateStatus(){return this._allControlsDisabled()?no:this.errors?iu:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(mi)?mi:this._anyControlsHaveStatus(iu)?iu:to}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){pu(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=iA(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=sA(this._rawAsyncValidators)}},cu=class extends yi{constructor(e,t,n){super(Eh(t),Ih(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,n={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){mv(this,!0,e),Object.keys(e).forEach(n=>{gv(this,!0,n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(n=>{let i=this.controls[n];i&&i.patchValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((n,i)=>{n.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,n)=>(e[n]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,n)=>n._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let n=this.controls[t];n&&e(n,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,n]of Object.entries(this.controls))if(this.contains(t)&&e(n))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,n,i)=>((n.enabled||this.disabled)&&(t[i]=n.value),t))}_reduceChildren(e,t){let n=e;return this._forEachChild((i,s)=>{n=t(n,i,s)}),n}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var yh=class extends cu{};var gu=new Q("CallSetDisabledState",{providedIn:"root",factory:()=>mu}),mu="always";function yv(r,e){return[...e.path,r]}function vh(r,e,t=mu){Th(r,e),e.valueAccessor.writeValue(r.value),(r.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(r.disabled),aA(r,e),cA(r,e),uA(r,e),oA(r,e)}function Hy(r,e,t=!0){let n=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(n),e.valueAccessor.registerOnTouched(n)),hu(r,e),r&&(e._invokeOnDestroyCallbacks(),r._registerOnCollectionChange(()=>{}))}function lu(r,e){r.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function oA(r,e){if(e.valueAccessor.setDisabledState){let t=n=>{e.valueAccessor.setDisabledState(n)};r.registerOnDisabledChange(t),e._registerOnDestroy(()=>{r._unregisterOnDisabledChange(t)})}}function Th(r,e){let t=fv(r);e.validator!==null?r.setValidators(Gy(t,e.validator)):typeof t=="function"&&r.setValidators([t]);let n=pv(r);e.asyncValidator!==null?r.setAsyncValidators(Gy(n,e.asyncValidator)):typeof n=="function"&&r.setAsyncValidators([n]);let i=()=>r.updateValueAndValidity();lu(e._rawValidators,i),lu(e._rawAsyncValidators,i)}function hu(r,e){let t=!1;if(r!==null){if(e.validator!==null){let i=fv(r);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.validator);s.length!==i.length&&(t=!0,r.setValidators(s))}}if(e.asyncValidator!==null){let i=pv(r);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.asyncValidator);s.length!==i.length&&(t=!0,r.setAsyncValidators(s))}}}let n=()=>{};return lu(e._rawValidators,n),lu(e._rawAsyncValidators,n),t}function aA(r,e){e.valueAccessor.registerOnChange(t=>{r._pendingValue=t,r._pendingChange=!0,r._pendingDirty=!0,r.updateOn==="change"&&vv(r,e)})}function uA(r,e){e.valueAccessor.registerOnTouched(()=>{r._pendingTouched=!0,r.updateOn==="blur"&&r._pendingChange&&vv(r,e),r.updateOn!=="submit"&&r.markAsTouched()})}function vv(r,e){r._pendingDirty&&r.markAsDirty(),r.setValue(r._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1}function cA(r,e){let t=(n,i)=>{e.valueAccessor.writeValue(n),i&&e.viewToModelUpdate(n)};r.registerOnChange(t),e._registerOnDestroy(()=>{r._unregisterOnChange(t)})}function lA(r,e){r==null,Th(r,e)}function hA(r,e){return hu(r,e)}function _v(r,e){if(!r.hasOwnProperty("model"))return!1;let t=r.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function dA(r){return Object.getPrototypeOf(r.constructor)===du}function fA(r,e){r._syncPendingControls(),e.forEach(t=>{let n=t.control;n.updateOn==="submit"&&n._pendingChange&&(t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function wv(r,e){if(!e)return null;Array.isArray(e);let t,n,i;return e.forEach(s=>{s.constructor===tv?t=s:dA(s)?n=s:i=s}),i||n||t||null}function pA(r,e){let t=r.indexOf(e);t>-1&&r.splice(t,1)}function Qy(r,e){let t=r.indexOf(e);t>-1&&r.splice(t,1)}function Xy(r){return typeof r=="object"&&r!==null&&Object.keys(r).length===2&&"value"in r&&"disabled"in r}var ro=class extends yi{constructor(e=null,t,n){super(Eh(t),Ih(n,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),pu(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Xy(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(n=>n(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Qy(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Qy(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Xy(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var gA=r=>r instanceof ro;var mA={provide:Tr,useExisting:hn(()=>yA)},Jy=Promise.resolve(),yA=(()=>{let e=class e extends Tr{constructor(n,i,s,o,u,c){super(),this._changeDetectorRef=u,this.callSetDisabledState=c,this.control=new ro,this._registered=!1,this.name="",this.update=new kt,this._parent=n,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=wv(this,o)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){let i=n.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),_v(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){vh(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(n){Jy.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){let i=n.isDisabled.currentValue,s=i!==0&&_r(i);Jy.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?yv(n,this._parent):[n]}};e.\u0275fac=function(i){return new(i||e)(re(Ir,9),re(fu,10),re(wh,10),re(vi,10),re(zs,8),re(gu,8))},e.\u0275dir=Ne({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[bt.None,"disabled","isDisabled"],model:[bt.None,"ngModel","model"],options:[bt.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[fn([mA]),Ct,Gt]});let r=e;return r})(),qP=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Ne({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let r=e;return r})(),vA={provide:vi,useExisting:hn(()=>_A),multi:!0},_A=(()=>{let e=class e extends du{writeValue(n){let i=n??"";this.setProperty("value",i)}registerOnChange(n){this.onChange=i=>{n(i==""?null:parseFloat(i))}}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=dn(e)))(s||e)}})(),e.\u0275dir=Ne({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,s){i&1&&Ie("input",function(u){return s.onChange(u.target.value)})("blur",function(){return s.onTouched()})},features:[fn([vA]),Ct]});let r=e;return r})();var Ev=new Q("");var wA={provide:Ir,useExisting:hn(()=>EA)},EA=(()=>{let e=class e extends Ir{constructor(n,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new kt,this._setValidators(n),this._setAsyncValidators(i)}ngOnChanges(n){this._checkFormPresent(),n.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(hu(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(n){let i=this.form.get(n.path);return vh(i,n,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(n),i}getControl(n){return this.form.get(n.path)}removeControl(n){Hy(n.control||null,n,!1),pA(this.directives,n)}addFormGroup(n){this._setUpFormContainer(n)}removeFormGroup(n){this._cleanUpFormContainer(n)}getFormGroup(n){return this.form.get(n.path)}addFormArray(n){this._setUpFormContainer(n)}removeFormArray(n){this._cleanUpFormContainer(n)}getFormArray(n){return this.form.get(n.path)}updateModel(n,i){this.form.get(n.path).setValue(i)}onSubmit(n){return this.submitted=!0,fA(this.form,this.directives),this.ngSubmit.emit(n),n?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_updateDomValue(){this.directives.forEach(n=>{let i=n.control,s=this.form.get(n.path);i!==s&&(Hy(i||null,n),gA(s)&&(vh(s,n,this.callSetDisabledState),n.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(n){let i=this.form.get(n.path);lA(i,n),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(n){if(this.form){let i=this.form.get(n.path);i&&hA(i,n)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Th(this.form,this),this._oldForm&&hu(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(i){return new(i||e)(re(fu,10),re(wh,10),re(gu,8))},e.\u0275dir=Ne({type:e,selectors:[["","formGroup",""]],hostBindings:function(i,s){i&1&&Ie("submit",function(u){return s.onSubmit(u)})("reset",function(){return s.onReset()})},inputs:{form:[bt.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[fn([wA]),Ct,Gt]});let r=e;return r})();var IA={provide:Tr,useExisting:hn(()=>TA)},TA=(()=>{let e=class e extends Tr{set isDisabled(n){}constructor(n,i,s,o,u){super(),this._ngModelWarningConfig=u,this._added=!1,this.name=null,this.update=new kt,this._ngModelWarningSent=!1,this._parent=n,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=wv(this,o)}ngOnChanges(n){this._added||this._setUpControl(),_v(n,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}get path(){return yv(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}};e._ngModelWarningSentOnce=!1,e.\u0275fac=function(i){return new(i||e)(re(Ir,13),re(fu,10),re(wh,10),re(vi,10),re(Ev,8))},e.\u0275dir=Ne({type:e,selectors:[["","formControlName",""]],inputs:{name:[bt.None,"formControlName","name"],isDisabled:[bt.None,"disabled","isDisabled"],model:[bt.None,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[fn([IA]),Ct,Gt]});let r=e;return r})(),AA={provide:vi,useExisting:hn(()=>Tv),multi:!0};function Iv(r,e){return r==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${r}: ${e}`.slice(0,50))}function bA(r){return r.split(":")[0]}var Tv=(()=>{let e=class e extends du{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){this.value=n;let i=this._getOptionId(n),s=Iv(i,n);this.setProperty("value",s)}registerOnChange(n){this.onChange=i=>{this.value=this._getOptionValue(i),n(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(n){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),n))return i;return null}_getOptionValue(n){let i=bA(n);return this._optionMap.has(i)?this._optionMap.get(i):n}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=dn(e)))(s||e)}})(),e.\u0275dir=Ne({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,s){i&1&&Ie("change",function(u){return s.onChange(u.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[fn([AA]),Ct]});let r=e;return r})(),$P=(()=>{let e=class e{constructor(n,i,s){this._element=n,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(n){this._select!=null&&(this._select._optionMap.set(this.id,n),this._setElementValue(Iv(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._setElementValue(n),this._select&&this._select.writeValue(this._select.value)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(re(mr),re(vr),re(Tv,9))},e.\u0275dir=Ne({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let r=e;return r})(),CA={provide:vi,useExisting:hn(()=>Av),multi:!0};function Yy(r,e){return r==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${r}: ${e}`.slice(0,50))}function SA(r){return r.split(":")[0]}var Av=(()=>{let e=class e extends du{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){this.value=n;let i;if(Array.isArray(n)){let s=n.map(o=>this._getOptionId(o));i=(o,u)=>{o._setSelected(s.indexOf(u.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(n){this.onChange=i=>{let s=[],o=i.selectedOptions;if(o!==void 0){let u=o;for(let c=0;c<u.length;c++){let l=u[c],f=this._getOptionValue(l.value);s.push(f)}}else{let u=i.options;for(let c=0;c<u.length;c++){let l=u[c];if(l.selected){let f=this._getOptionValue(l.value);s.push(f)}}}this.value=s,n(s)}}_registerOption(n){let i=(this._idCounter++).toString();return this._optionMap.set(i,n),i}_getOptionId(n){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,n))return i;return null}_getOptionValue(n){let i=SA(n);return this._optionMap.has(i)?this._optionMap.get(i)._value:n}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=dn(e)))(s||e)}})(),e.\u0275dir=Ne({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,s){i&1&&Ie("change",function(u){return s.onChange(u.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[fn([CA]),Ct]});let r=e;return r})(),zP=(()=>{let e=class e{constructor(n,i,s){this._element=n,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(n){this._select!=null&&(this._value=n,this._setElementValue(Yy(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._select?(this._value=n,this._setElementValue(Yy(this.id,n)),this._select.writeValue(this._select.value)):this._setElementValue(n)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}_setSelected(n){this._renderer.setProperty(this._element.nativeElement,"selected",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(re(mr),re(vr),re(Av,9))},e.\u0275dir=Ne({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let r=e;return r})();var RA=(()=>{let e=class e{constructor(){this._validator=su}ngOnChanges(n){if(this.inputName in n){let i=this.normalizeInput(n[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):su,this._onChange&&this._onChange()}}validate(n){return this._validator(n)}registerOnValidatorChange(n){this._onChange=n}enabled(n){return n!=null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Ne({type:e,features:[Gt]});let r=e;return r})();var DA={provide:fu,useExisting:hn(()=>PA),multi:!0};var PA=(()=>{let e=class e extends RA{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=_r,this.createValidator=n=>rv}enabled(n){return n}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=dn(e)))(s||e)}})(),e.\u0275dir=Ne({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,s){i&2&&Fa("required",s._enabled?"":null)},inputs:{required:"required"},features:[fn([DA]),Ct]});let r=e;return r})();var bv=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=ct({type:e}),e.\u0275inj=ut({});let r=e;return r})(),_h=class extends yi{constructor(e,t,n){super(Eh(t),Ih(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,n={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(e,t={}){let n=this._adjustIndex(e);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,n={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){mv(this,!1,e),e.forEach((n,i)=>{gv(this,!1,i),this.at(i).setValue(n,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((n,i)=>{this.at(i)&&this.at(i).patchValue(n,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((n,i)=>{n.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,n)=>n._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,n)=>{e(t,n)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function Zy(r){return!!r&&(r.asyncValidators!==void 0||r.validators!==void 0||r.updateOn!==void 0)}var GP=(()=>{let e=class e{constructor(){this.useNonNullable=!1}get nonNullable(){let n=new e;return n.useNonNullable=!0,n}group(n,i=null){let s=this._reduceControls(n),o={};return Zy(i)?o=i:i!==null&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new cu(s,o)}record(n,i=null){let s=this._reduceControls(n);return new yh(s,i)}control(n,i,s){let o={};return this.useNonNullable?(Zy(i)?o=i:(o.validators=i,o.asyncValidators=s),new ro(n,ye(B({},o),{nonNullable:!0}))):new ro(n,i,s)}array(n,i,s){let o=n.map(u=>this._createControl(u));return new _h(o,i,s)}_reduceControls(n){let i={};return Object.keys(n).forEach(s=>{i[s]=this._createControl(n[s])}),i}_createControl(n){if(n instanceof ro)return n;if(n instanceof yi)return n;if(Array.isArray(n)){let i=n[0],s=n.length>1?n[1]:null,o=n.length>2?n[2]:null;return this.control(i,s,o)}else return this.control(n)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();var KP=(()=>{let e=class e{static withConfig(n){return{ngModule:e,providers:[{provide:gu,useValue:n.callSetDisabledState??mu}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=ct({type:e}),e.\u0275inj=ut({imports:[bv]});let r=e;return r})(),WP=(()=>{let e=class e{static withConfig(n){return{ngModule:e,providers:[{provide:Ev,useValue:n.warnOnNgModelWithFormControl??"always"},{provide:gu,useValue:n.callSetDisabledState??mu}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=ct({type:e}),e.\u0275inj=ut({imports:[bv]});let r=e;return r})();var ne="primary",wo=Symbol("RouteTitle"),Rh=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Ti(r){return new Rh(r)}function xA(r,e,t){let n=t.path.split("/");if(n.length>r.length||t.pathMatch==="full"&&(e.hasChildren()||n.length<r.length))return null;let i={};for(let s=0;s<n.length;s++){let o=n[s],u=r[s];if(o.startsWith(":"))i[o.substring(1)]=u;else if(o!==u.path)return null}return{consumed:r.slice(0,n.length),posParams:i}}function VA(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;++t)if(!Ht(r[t],e[t]))return!1;return!0}function Ht(r,e){let t=r?Dh(r):void 0,n=e?Dh(e):void 0;if(!t||!n||t.length!=n.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!Nv(r[i],e[i]))return!1;return!0}function Dh(r){return[...Object.keys(r),...Object.getOwnPropertySymbols(r)]}function Nv(r,e){if(Array.isArray(r)&&Array.isArray(e)){if(r.length!==e.length)return!1;let t=[...r].sort(),n=[...e].sort();return t.every((i,s)=>n[s]===i)}else return r===e}function kv(r){return r.length>0?r[r.length-1]:null}function Bn(r){return Nm(r)?r:Ba(r)?ve(Promise.resolve(r)):K(r)}var MA={exact:Fv,subset:Lv},Ov={exact:NA,subset:kA,ignored:()=>!0};function Cv(r,e,t){return MA[t.paths](r.root,e.root,t.matrixParams)&&Ov[t.queryParams](r.queryParams,e.queryParams)&&!(t.fragment==="exact"&&r.fragment!==e.fragment)}function NA(r,e){return Ht(r,e)}function Fv(r,e,t){if(!br(r.segments,e.segments)||!_u(r.segments,e.segments,t)||r.numberOfChildren!==e.numberOfChildren)return!1;for(let n in e.children)if(!r.children[n]||!Fv(r.children[n],e.children[n],t))return!1;return!0}function kA(r,e){return Object.keys(e).length<=Object.keys(r).length&&Object.keys(e).every(t=>Nv(r[t],e[t]))}function Lv(r,e,t){return Uv(r,e,e.segments,t)}function Uv(r,e,t,n){if(r.segments.length>t.length){let i=r.segments.slice(0,t.length);return!(!br(i,t)||e.hasChildren()||!_u(i,t,n))}else if(r.segments.length===t.length){if(!br(r.segments,t)||!_u(r.segments,t,n))return!1;for(let i in e.children)if(!r.children[i]||!Lv(r.children[i],e.children[i],n))return!1;return!0}else{let i=t.slice(0,r.segments.length),s=t.slice(r.segments.length);return!br(r.segments,i)||!_u(r.segments,i,n)||!r.children[ne]?!1:Uv(r.children[ne],e,s,n)}}function _u(r,e,t){return e.every((n,i)=>Ov[t](r[i].parameters,n.parameters))}var Fn=class{constructor(e=new ce([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap??=Ti(this.queryParams),this._queryParamMap}toString(){return LA.serialize(this)}},ce=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return wu(this)}},Ar=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Ti(this.parameters),this._parameterMap}toString(){return Bv(this)}};function OA(r,e){return br(r,e)&&r.every((t,n)=>Ht(t.parameters,e[n].parameters))}function br(r,e){return r.length!==e.length?!1:r.every((t,n)=>t.path===e[n].path)}function FA(r,e){let t=[];return Object.entries(r.children).forEach(([n,i])=>{n===ne&&(t=t.concat(e(i,n)))}),Object.entries(r.children).forEach(([n,i])=>{n!==ne&&(t=t.concat(e(i,n)))}),t}var Eo=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:()=>new lo,providedIn:"root"});let r=e;return r})(),lo=class{parse(e){let t=new xh(e);return new Fn(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${io(e.root,!0)}`,n=BA(e.queryParams),i=typeof e.fragment=="string"?`#${UA(e.fragment)}`:"";return`${t}${n}${i}`}},LA=new lo;function wu(r){return r.segments.map(e=>Bv(e)).join("/")}function io(r,e){if(!r.hasChildren())return wu(r);if(e){let t=r.children[ne]?io(r.children[ne],!1):"",n=[];return Object.entries(r.children).forEach(([i,s])=>{i!==ne&&n.push(`${i}:${io(s,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}else{let t=FA(r,(n,i)=>i===ne?[io(r.children[ne],!1)]:[`${i}:${io(n,!1)}`]);return Object.keys(r.children).length===1&&r.children[ne]!=null?`${wu(r)}/${t[0]}`:`${wu(r)}/(${t.join("//")})`}}function jv(r){return encodeURIComponent(r).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function yu(r){return jv(r).replace(/%3B/gi,";")}function UA(r){return encodeURI(r)}function Ph(r){return jv(r).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Eu(r){return decodeURIComponent(r)}function Sv(r){return Eu(r.replace(/\+/g,"%20"))}function Bv(r){return`${Ph(r.path)}${jA(r.parameters)}`}function jA(r){return Object.entries(r).map(([e,t])=>`;${Ph(e)}=${Ph(t)}`).join("")}function BA(r){let e=Object.entries(r).map(([t,n])=>Array.isArray(n)?n.map(i=>`${yu(t)}=${yu(i)}`).join("&"):`${yu(t)}=${yu(n)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var qA=/^[^\/()?;#]+/;function Ah(r){let e=r.match(qA);return e?e[0]:""}var $A=/^[^\/()?;=#]+/;function zA(r){let e=r.match($A);return e?e[0]:""}var GA=/^[^=?&#]+/;function KA(r){let e=r.match(GA);return e?e[0]:""}var WA=/^[^&#]+/;function HA(r){let e=r.match(WA);return e?e[0]:""}var xh=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new ce([],{}):new ce([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[ne]=new ce(e,t)),n}parseSegment(){let e=Ah(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new de(4009,!1);return this.capture(e),new Ar(Eu(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=zA(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let i=Ah(this.remaining);i&&(n=i,this.capture(n))}e[Eu(t)]=Eu(n)}parseQueryParam(e){let t=KA(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let o=HA(this.remaining);o&&(n=o,this.capture(n))}let i=Sv(t),s=Sv(n);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let n=Ah(this.remaining),i=this.remaining[n.length];if(i!=="/"&&i!==")"&&i!==";")throw new de(4010,!1);let s;n.indexOf(":")>-1?(s=n.slice(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=ne);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[ne]:new ce([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new de(4011,!1)}};function qv(r){return r.segments.length>0?new ce([],{[ne]:r}):r}function $v(r){let e={};for(let[n,i]of Object.entries(r.children)){let s=$v(i);if(n===ne&&s.segments.length===0&&s.hasChildren())for(let[o,u]of Object.entries(s.children))e[o]=u;else(s.segments.length>0||s.hasChildren())&&(e[n]=s)}let t=new ce(r.segments,e);return QA(t)}function QA(r){if(r.numberOfChildren===1&&r.children[ne]){let e=r.children[ne];return new ce(r.segments.concat(e.segments),e.children)}return r}function Ai(r){return r instanceof Fn}function XA(r,e,t=null,n=null){let i=zv(r);return Gv(i,e,t,n)}function zv(r){let e;function t(s){let o={};for(let c of s.children){let l=t(c);o[c.outlet]=l}let u=new ce(s.url,o);return s===r&&(e=u),u}let n=t(r.root),i=qv(n);return e??i}function Gv(r,e,t,n){let i=r;for(;i.parent;)i=i.parent;if(e.length===0)return bh(i,i,i,t,n);let s=JA(e);if(s.toRoot())return bh(i,i,new ce([],{}),t,n);let o=YA(s,i,r),u=o.processChildren?ao(o.segmentGroup,o.index,s.commands):Wv(o.segmentGroup,o.index,s.commands);return bh(i,o.segmentGroup,u,t,n)}function Iu(r){return typeof r=="object"&&r!=null&&!r.outlets&&!r.segmentPath}function ho(r){return typeof r=="object"&&r!=null&&r.outlets}function bh(r,e,t,n,i){let s={};n&&Object.entries(n).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(f=>`${f}`):`${l}`});let o;r===e?o=t:o=Kv(r,e,t);let u=qv($v(o));return new Fn(u,s,i)}function Kv(r,e,t){let n={};return Object.entries(r.children).forEach(([i,s])=>{s===e?n[i]=t:n[i]=Kv(s,e,t)}),new ce(r.segments,n)}var Tu=class{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&Iu(n[0]))throw new de(4003,!1);let i=n.find(ho);if(i&&i!==kv(n))throw new de(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function JA(r){if(typeof r[0]=="string"&&r.length===1&&r[0]==="/")return new Tu(!0,0,r);let e=0,t=!1,n=r.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let u={};return Object.entries(s.outlets).forEach(([c,l])=>{u[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:u}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((u,c)=>{c==0&&u==="."||(c==0&&u===""?t=!0:u===".."?e++:u!=""&&i.push(u))}),i):[...i,s]},[]);return new Tu(t,e,n)}var Ei=class{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}};function YA(r,e,t){if(r.isAbsolute)return new Ei(e,!0,0);if(!t)return new Ei(e,!1,NaN);if(t.parent===null)return new Ei(t,!0,0);let n=Iu(r.commands[0])?0:1,i=t.segments.length-1+n;return ZA(t,i,r.numberOfDoubleDots)}function ZA(r,e,t){let n=r,i=e,s=t;for(;s>i;){if(s-=i,n=n.parent,!n)throw new de(4005,!1);i=n.segments.length}return new Ei(n,!1,i-s)}function eb(r){return ho(r[0])?r[0].outlets:{[ne]:r}}function Wv(r,e,t){if(r??=new ce([],{}),r.segments.length===0&&r.hasChildren())return ao(r,e,t);let n=tb(r,e,t),i=t.slice(n.commandIndex);if(n.match&&n.pathIndex<r.segments.length){let s=new ce(r.segments.slice(0,n.pathIndex),{});return s.children[ne]=new ce(r.segments.slice(n.pathIndex),r.children),ao(s,0,i)}else return n.match&&i.length===0?new ce(r.segments,{}):n.match&&!r.hasChildren()?Vh(r,e,t):n.match?ao(r,0,i):Vh(r,e,t)}function ao(r,e,t){if(t.length===0)return new ce(r.segments,{});{let n=eb(t),i={};if(Object.keys(n).some(s=>s!==ne)&&r.children[ne]&&r.numberOfChildren===1&&r.children[ne].segments.length===0){let s=ao(r.children[ne],e,t);return new ce(r.segments,s.children)}return Object.entries(n).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=Wv(r.children[s],e,o))}),Object.entries(r.children).forEach(([s,o])=>{n[s]===void 0&&(i[s]=o)}),new ce(r.segments,i)}}function tb(r,e,t){let n=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<r.segments.length;){if(n>=t.length)return s;let o=r.segments[i],u=t[n];if(ho(u))break;let c=`${u}`,l=n<t.length-1?t[n+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!Dv(c,l,o))return s;n+=2}else{if(!Dv(c,{},o))return s;n++}i++}return{match:!0,pathIndex:i,commandIndex:n}}function Vh(r,e,t){let n=r.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(ho(s)){let c=nb(s.outlets);return new ce(n,c)}if(i===0&&Iu(t[0])){let c=r.segments[e];n.push(new Ar(c.path,Rv(t[0]))),i++;continue}let o=ho(s)?s.outlets[ne]:`${s}`,u=i<t.length-1?t[i+1]:null;o&&u&&Iu(u)?(n.push(new Ar(o,Rv(u))),i+=2):(n.push(new Ar(o,{})),i++)}return new ce(n,{})}function nb(r){let e={};return Object.entries(r).forEach(([t,n])=>{typeof n=="string"&&(n=[n]),n!==null&&(e[t]=Vh(new ce([],{}),0,n))}),e}function Rv(r){let e={};return Object.entries(r).forEach(([t,n])=>e[t]=`${n}`),e}function Dv(r,e,t){return r==t.path&&Ht(e,t.parameters)}var uo="imperative",qe=function(r){return r[r.NavigationStart=0]="NavigationStart",r[r.NavigationEnd=1]="NavigationEnd",r[r.NavigationCancel=2]="NavigationCancel",r[r.NavigationError=3]="NavigationError",r[r.RoutesRecognized=4]="RoutesRecognized",r[r.ResolveStart=5]="ResolveStart",r[r.ResolveEnd=6]="ResolveEnd",r[r.GuardsCheckStart=7]="GuardsCheckStart",r[r.GuardsCheckEnd=8]="GuardsCheckEnd",r[r.RouteConfigLoadStart=9]="RouteConfigLoadStart",r[r.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",r[r.ChildActivationStart=11]="ChildActivationStart",r[r.ChildActivationEnd=12]="ChildActivationEnd",r[r.ActivationStart=13]="ActivationStart",r[r.ActivationEnd=14]="ActivationEnd",r[r.Scroll=15]="Scroll",r[r.NavigationSkipped=16]="NavigationSkipped",r}(qe||{}),Dt=class{constructor(e,t){this.id=e,this.url=t}},bi=class extends Dt{constructor(e,t,n="imperative",i=null){super(e,t),this.type=qe.NavigationStart,this.navigationTrigger=n,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Qt=class extends Dt{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n,this.type=qe.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},wt=function(r){return r[r.Redirect=0]="Redirect",r[r.SupersededByNewNavigation=1]="SupersededByNewNavigation",r[r.NoDataFromResolver=2]="NoDataFromResolver",r[r.GuardRejected=3]="GuardRejected",r}(wt||{}),Au=function(r){return r[r.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",r[r.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",r}(Au||{}),Ln=class extends Dt{constructor(e,t,n,i){super(e,t),this.reason=n,this.code=i,this.type=qe.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Un=class extends Dt{constructor(e,t,n,i){super(e,t),this.reason=n,this.code=i,this.type=qe.NavigationSkipped}},fo=class extends Dt{constructor(e,t,n,i){super(e,t),this.error=n,this.target=i,this.type=qe.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},bu=class extends Dt{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=qe.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Mh=class extends Dt{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=qe.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Nh=class extends Dt{constructor(e,t,n,i,s){super(e,t),this.urlAfterRedirects=n,this.state=i,this.shouldActivate=s,this.type=qe.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},kh=class extends Dt{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=qe.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Oh=class extends Dt{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=qe.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Fh=class{constructor(e){this.route=e,this.type=qe.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Lh=class{constructor(e){this.route=e,this.type=qe.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Uh=class{constructor(e){this.snapshot=e,this.type=qe.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},jh=class{constructor(e){this.snapshot=e,this.type=qe.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Bh=class{constructor(e){this.snapshot=e,this.type=qe.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},qh=class{constructor(e){this.snapshot=e,this.type=qe.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Cu=class{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n,this.type=qe.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},po=class{},go=class{constructor(e){this.url=e}};var $h=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Io,this.attachRef=null}},Io=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(n,i){let s=this.getOrCreateContext(n);s.outlet=i,this.contexts.set(n,s)}onChildOutletDestroyed(n){let i=this.getContext(n);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let i=this.getContext(n);return i||(i=new $h,this.contexts.set(n,i)),i}getContext(n){return this.contexts.get(n)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),Su=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=zh(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){let t=zh(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Gh(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Gh(e,this._root).map(t=>t.value)}};function zh(r,e){if(r===e.value)return e;for(let t of e.children){let n=zh(r,t);if(n)return n}return null}function Gh(r,e){if(r===e.value)return[e];for(let t of e.children){let n=Gh(r,t);if(n.length)return n.unshift(e),n}return[]}var _t=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function wi(r){let e={};return r&&r.children.forEach(t=>e[t.value.outlet]=t),e}var Ru=class extends Su{constructor(e,t){super(e),this.snapshot=t,td(this,e)}toString(){return this.snapshot.toString()}};function Hv(r){let e=rb(r),t=new At([new Ar("",{})]),n=new At({}),i=new At({}),s=new At({}),o=new At(""),u=new jn(t,n,s,o,i,ne,r,e.root);return u.snapshot=e.root,new Ru(new _t(u,[]),e)}function rb(r){let e={},t={},n={},i="",s=new mo([],e,n,i,t,ne,r,null,{});return new Du("",new _t(s,[]))}var jn=class{constructor(e,t,n,i,s,o,u,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=n,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=u,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(J(l=>l[wo]))??K(void 0),this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(J(e=>Ti(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(J(e=>Ti(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function ed(r,e,t="emptyOnly"){let n,{routeConfig:i}=r;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?n={params:B(B({},e.params),r.params),data:B(B({},e.data),r.data),resolve:B(B(B(B({},r.data),e.data),i?.data),r._resolvedData)}:n={params:B({},r.params),data:B({},r.data),resolve:B(B({},r.data),r._resolvedData??{})},i&&Xv(i)&&(n.resolve[wo]=i.title),n}var mo=class{get title(){return this.data?.[wo]}constructor(e,t,n,i,s,o,u,c,l){this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=s,this.outlet=o,this.component=u,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Ti(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Ti(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(n=>n.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Du=class extends Su{constructor(e,t){super(t),this.url=e,td(this,t)}toString(){return Qv(this._root)}};function td(r,e){e.value._routerState=r,e.children.forEach(t=>td(r,t))}function Qv(r){let e=r.children.length>0?` { ${r.children.map(Qv).join(", ")} } `:"";return`${r.value}${e}`}function Ch(r){if(r.snapshot){let e=r.snapshot,t=r._futureSnapshot;r.snapshot=t,Ht(e.queryParams,t.queryParams)||r.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&r.fragmentSubject.next(t.fragment),Ht(e.params,t.params)||r.paramsSubject.next(t.params),VA(e.url,t.url)||r.urlSubject.next(t.url),Ht(e.data,t.data)||r.dataSubject.next(t.data)}else r.snapshot=r._futureSnapshot,r.dataSubject.next(r._futureSnapshot.data)}function Kh(r,e){let t=Ht(r.params,e.params)&&OA(r.url,e.url),n=!r.parent!=!e.parent;return t&&!n&&(!r.parent||Kh(r.parent,e.parent))}function Xv(r){return typeof r.title=="string"||r.title===null}var ib=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=ne,this.activateEvents=new kt,this.deactivateEvents=new kt,this.attachEvents=new kt,this.detachEvents=new kt,this.parentContexts=H(Io),this.location=H(sy),this.changeDetector=H(zs),this.environmentInjector=H(Mn),this.inputBinder=H(Mu,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){let{firstChange:i,previousValue:s}=n.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new de(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new de(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new de(4012,!1);this.location.detach();let n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,i){this.activated=n,this._activatedRoute=i,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){let n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,i){if(this.isActivated)throw new de(4013,!1);this._activatedRoute=n;let s=this.location,u=n.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new Wh(n,c,s.injector);this.activated=s.createComponent(u,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Ne({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Gt]});let r=e;return r})(),Wh=class r{__ngOutletInjector(e){return new r(this.route,this.childContexts,e)}constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===jn?this.route:e===Io?this.childContexts:this.parent.get(e,t)}},Mu=new Q(""),Pv=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){let{activatedRoute:i}=n,s=ka([i.queryParams,i.params,i.data]).pipe(Me(([o,u,c],l)=>(c=B(B(B({},o),u),c),l===0?K(c):Promise.resolve(c)))).subscribe(o=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(n);return}let u=hy(i.component);if(!u){this.unsubscribeFromRouteData(n);return}for(let{templateName:c}of u.inputs)n.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(n,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})();function sb(r,e,t){let n=yo(r,e._root,t?t._root:void 0);return new Ru(n,e)}function yo(r,e,t){if(t&&r.shouldReuseRoute(e.value,t.value.snapshot)){let n=t.value;n._futureSnapshot=e.value;let i=ob(r,e,t);return new _t(n,i)}else{if(r.shouldAttach(e.value)){let s=r.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(u=>yo(r,u)),o}}let n=ab(e.value),i=e.children.map(s=>yo(r,s));return new _t(n,i)}}function ob(r,e,t){return e.children.map(n=>{for(let i of t.children)if(r.shouldReuseRoute(n.value,i.value.snapshot))return yo(r,n,i);return yo(r,n)})}function ab(r){return new jn(new At(r.url),new At(r.params),new At(r.queryParams),new At(r.fragment),new At(r.data),r.outlet,r.component,r)}var Jv="ngNavigationCancelingError";function Yv(r,e){let{redirectTo:t,navigationBehaviorOptions:n}=Ai(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=Zv(!1,wt.Redirect);return i.url=t,i.navigationBehaviorOptions=n,i}function Zv(r,e){let t=new Error(`NavigationCancelingError: ${r||""}`);return t[Jv]=!0,t.cancellationCode=e,t}function ub(r){return e_(r)&&Ai(r.url)}function e_(r){return!!r&&r[Jv]}var cb=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=ui({type:e,selectors:[["ng-component"]],standalone:!0,features:[di],decls:1,vars:0,template:function(i,s){i&1&&La(0,"router-outlet")},dependencies:[ib],encapsulation:2});let r=e;return r})();function lb(r,e){return r.providers&&!r._injector&&(r._injector=Hl(r.providers,e,`Route: ${r.path}`)),r._injector??e}function nd(r){let e=r.children&&r.children.map(nd),t=e?ye(B({},r),{children:e}):B({},r);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==ne&&(t.component=cb),t}function Xt(r){return r.outlet||ne}function hb(r,e){let t=r.filter(n=>Xt(n)===e);return t.push(...r.filter(n=>Xt(n)!==e)),t}function To(r){if(!r)return null;if(r.routeConfig?._injector)return r.routeConfig._injector;for(let e=r.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var db=(r,e,t,n)=>J(i=>(new Hh(e,i.targetRouterState,i.currentRouterState,t,n).activate(r),i)),Hh=class{constructor(e,t,n,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),Ch(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){let i=wi(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],n),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,t,n){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=n.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else s&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,s=wi(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(n&&n.outlet){let o=n.outlet.detach(),u=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:u})}}deactivateRouteAndOutlet(e,t){let n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,s=wi(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(e,t,n){let i=wi(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],n),this.forwardEvent(new qh(s.value.snapshot))}),e.children.length&&this.forwardEvent(new jh(e.value.snapshot))}activateRoutes(e,t,n){let i=e.value,s=t?t.value:null;if(Ch(i),i===s)if(i.component){let o=n.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(i.component){let o=n.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let u=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(u.contexts),o.attachRef=u.componentRef,o.route=u.route.value,o.outlet&&o.outlet.attach(u.componentRef,u.route.value),Ch(u.route.value),this.activateChildRoutes(e,null,o.children)}else{let u=To(i.snapshot);o.attachRef=null,o.route=i,o.injector=u,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}},Pu=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Ii=class{constructor(e,t){this.component=e,this.route=t}};function fb(r,e,t){let n=r._root,i=e?e._root:null;return so(n,i,t,[n.value])}function pb(r){let e=r.routeConfig?r.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:r,guards:e}}function Si(r,e){let t=Symbol(),n=e.get(r,t);return n===t?typeof r=="function"&&!$m(r)?r:e.get(r):n}function so(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=wi(e);return r.children.forEach(o=>{gb(o,s[o.value.outlet],t,n.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,u])=>co(u,t.getContext(o),i)),i}function gb(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=r.value,o=e?e.value:null,u=t?t.getContext(r.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=mb(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Pu(n)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?so(r,e,u?u.children:null,n,i):so(r,e,t,n,i),c&&u&&u.outlet&&u.outlet.isActivated&&i.canDeactivateChecks.push(new Ii(u.outlet.component,o))}else o&&co(e,u,i),i.canActivateChecks.push(new Pu(n)),s.component?so(r,null,u?u.children:null,n,i):so(r,null,t,n,i);return i}function mb(r,e,t){if(typeof t=="function")return t(r,e);switch(t){case"pathParamsChange":return!br(r.url,e.url);case"pathParamsOrQueryParamsChange":return!br(r.url,e.url)||!Ht(r.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Kh(r,e)||!Ht(r.queryParams,e.queryParams);case"paramsChange":default:return!Kh(r,e)}}function co(r,e,t){let n=wi(r),i=r.value;Object.entries(n).forEach(([s,o])=>{i.component?e?co(o,e.children.getContext(s),t):co(o,null,t):co(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Ii(e.outlet.component,i)):t.canDeactivateChecks.push(new Ii(null,i)):t.canDeactivateChecks.push(new Ii(null,i))}function Ao(r){return typeof r=="function"}function yb(r){return typeof r=="boolean"}function vb(r){return r&&Ao(r.canLoad)}function _b(r){return r&&Ao(r.canActivate)}function wb(r){return r&&Ao(r.canActivateChild)}function Eb(r){return r&&Ao(r.canDeactivate)}function Ib(r){return r&&Ao(r.canMatch)}function t_(r){return r instanceof km||r?.name==="EmptyError"}var vu=Symbol("INITIAL_VALUE");function Ci(){return Me(r=>ka(r.map(e=>e.pipe(si(1),ai(vu)))).pipe(J(e=>{for(let t of e)if(t!==!0){if(t===vu)return vu;if(t===!1||t instanceof Fn)return t}return!0}),at(e=>e!==vu),si(1)))}function Tb(r,e){return vt(t=>{let{targetSnapshot:n,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?K(ye(B({},t),{guardsResult:!0})):Ab(o,n,i,r).pipe(vt(u=>u&&yb(u)?bb(n,s,r,e):K(u)),J(u=>ye(B({},t),{guardsResult:u})))})}function Ab(r,e,t,n){return ve(r).pipe(vt(i=>Pb(i.component,i.route,t,e,n)),$t(i=>i!==!0,!0))}function bb(r,e,t,n){return ve(e).pipe(xn(i=>Om(Sb(i.route.parent,n),Cb(i.route,n),Db(r,i.path,t),Rb(r,i.route,t))),$t(i=>i!==!0,!0))}function Cb(r,e){return r!==null&&e&&e(new Bh(r)),K(!0)}function Sb(r,e){return r!==null&&e&&e(new Uh(r)),K(!0)}function Rb(r,e,t){let n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||n.length===0)return K(!0);let i=n.map(s=>Ll(()=>{let o=To(e)??t,u=Si(s,o),c=_b(u)?u.canActivate(e,r):zt(o,()=>u(e,r));return Bn(c).pipe($t())}));return K(i).pipe(Ci())}function Db(r,e,t){let n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>pb(o)).filter(o=>o!==null).map(o=>Ll(()=>{let u=o.guards.map(c=>{let l=To(o.node)??t,f=Si(c,l),p=wb(f)?f.canActivateChild(n,r):zt(l,()=>f(n,r));return Bn(p).pipe($t())});return K(u).pipe(Ci())}));return K(s).pipe(Ci())}function Pb(r,e,t,n,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return K(!0);let o=s.map(u=>{let c=To(e)??i,l=Si(u,c),f=Eb(l)?l.canDeactivate(r,e,t,n):zt(c,()=>l(r,e,t,n));return Bn(f).pipe($t())});return K(o).pipe(Ci())}function xb(r,e,t,n){let i=e.canLoad;if(i===void 0||i.length===0)return K(!0);let s=i.map(o=>{let u=Si(o,r),c=vb(u)?u.canLoad(e,t):zt(r,()=>u(e,t));return Bn(c)});return K(s).pipe(Ci(),n_(n))}function n_(r){return Vm(je(e=>{if(Ai(e))throw Yv(r,e)}),J(e=>e===!0))}function Vb(r,e,t,n){let i=e.canMatch;if(!i||i.length===0)return K(!0);let s=i.map(o=>{let u=Si(o,r),c=Ib(u)?u.canMatch(e,t):zt(r,()=>u(e,t));return Bn(c)});return K(s).pipe(Ci(),n_(n))}var vo=class{constructor(e){this.segmentGroup=e||null}},xu=class extends Error{constructor(e){super(),this.urlTree=e}};function _i(r){return Us(new vo(r))}function Mb(r){return Us(new de(4e3,!1))}function Nb(r){return Us(Zv(!1,wt.GuardRejected))}var Qh=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let n=[],i=t.root;for(;;){if(n=n.concat(i.segments),i.numberOfChildren===0)return K(n);if(i.numberOfChildren>1||!i.children[ne])return Mb(e.redirectTo);i=i.children[ne]}}applyRedirectCommands(e,t,n){let i=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,n);if(t.startsWith("/"))throw new xu(i);return i}applyRedirectCreateUrlTree(e,t,n,i){let s=this.createSegmentGroup(e,t.root,n,i);return new Fn(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let n={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let u=s.substring(1);n[i]=t[u]}else n[i]=s}),n}createSegmentGroup(e,t,n,i){let s=this.createSegments(e,t.segments,n,i),o={};return Object.entries(t.children).forEach(([u,c])=>{o[u]=this.createSegmentGroup(e,c,n,i)}),new ce(s,o)}createSegments(e,t,n,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,n))}findPosParam(e,t,n){let i=n[t.path.substring(1)];if(!i)throw new de(4001,!1);return i}findOrReturn(e,t){let n=0;for(let i of t){if(i.path===e.path)return t.splice(n),i;n++}return e}},Xh={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function kb(r,e,t,n,i){let s=rd(r,e,t);return s.matched?(n=lb(e,n),Vb(n,e,t,i).pipe(J(o=>o===!0?s:B({},Xh)))):K(s)}function rd(r,e,t){if(e.path==="**")return Ob(t);if(e.path==="")return e.pathMatch==="full"&&(r.hasChildren()||t.length>0)?B({},Xh):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||xA)(t,r,e);if(!i)return B({},Xh);let s={};Object.entries(i.posParams??{}).forEach(([u,c])=>{s[u]=c.path});let o=i.consumed.length>0?B(B({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function Ob(r){return{matched:!0,parameters:r.length>0?kv(r).parameters:{},consumedSegments:r,remainingSegments:[],positionalParamSegments:{}}}function xv(r,e,t,n){return t.length>0&&Ub(r,t,n)?{segmentGroup:new ce(e,Lb(n,new ce(t,r.children))),slicedSegments:[]}:t.length===0&&jb(r,t,n)?{segmentGroup:new ce(r.segments,Fb(r,t,n,r.children)),slicedSegments:t}:{segmentGroup:new ce(r.segments,r.children),slicedSegments:t}}function Fb(r,e,t,n){let i={};for(let s of t)if(Nu(r,e,s)&&!n[Xt(s)]){let o=new ce([],{});i[Xt(s)]=o}return B(B({},n),i)}function Lb(r,e){let t={};t[ne]=e;for(let n of r)if(n.path===""&&Xt(n)!==ne){let i=new ce([],{});t[Xt(n)]=i}return t}function Ub(r,e,t){return t.some(n=>Nu(r,e,n)&&Xt(n)!==ne)}function jb(r,e,t){return t.some(n=>Nu(r,e,n))}function Nu(r,e,t){return(r.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function Bb(r,e,t,n){return Xt(r)!==n&&(n===ne||!Nu(e,t,r))?!1:rd(e,r,t).matched}function qb(r,e,t){return e.length===0&&!r.children[t]}var Jh=class{};function $b(r,e,t,n,i,s,o="emptyOnly"){return new Yh(r,e,t,n,i,o,s).recognize()}var zb=31,Yh=class{constructor(e,t,n,i,s,o,u){this.injector=e,this.configLoader=t,this.rootComponentType=n,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=u,this.applyRedirects=new Qh(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new de(4002,`'${e.segmentGroup}'`)}recognize(){let e=xv(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(J(t=>{let n=new mo([],Object.freeze({}),Object.freeze(B({},this.urlTree.queryParams)),this.urlTree.fragment,{},ne,this.rootComponentType,null,{}),i=new _t(n,t),s=new Du("",i),o=XA(n,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,ne).pipe(ii(n=>{if(n instanceof xu)return this.urlTree=n.urlTree,this.match(n.urlTree.root);throw n instanceof vo?this.noMatchError(n):n}))}inheritParamsAndData(e,t){let n=e.value,i=ed(n,t,this.paramsInheritanceStrategy);n.params=Object.freeze(i.params),n.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,n))}processSegmentGroup(e,t,n,i){return n.segments.length===0&&n.hasChildren()?this.processChildren(e,t,n):this.processSegment(e,t,n,n.segments,i,!0).pipe(J(s=>s instanceof _t?[s]:[]))}processChildren(e,t,n){let i=[];for(let s of Object.keys(n.children))s==="primary"?i.unshift(s):i.push(s);return ve(i).pipe(xn(s=>{let o=n.children[s],u=hb(t,s);return this.processSegmentGroup(e,u,o,s)}),oi((s,o)=>(s.push(...o),s)),Ul(null),Bm(),vt(s=>{if(s===null)return _i(n);let o=r_(s);return Gb(o),K(o)}))}processSegment(e,t,n,i,s,o){return ve(t).pipe(xn(u=>this.processSegmentAgainstRoute(u._injector??e,t,u,n,i,s,o).pipe(ii(c=>{if(c instanceof vo)return K(null);throw c}))),$t(u=>!!u),ii(u=>{if(t_(u))return qb(n,i,s)?K(new Jh):_i(n);throw u}))}processSegmentAgainstRoute(e,t,n,i,s,o,u){return Bb(n,i,s,o)?n.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,n,s,o):this.allowRedirects&&u?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,n,s,o):_i(i):_i(i)}expandSegmentAgainstRouteUsingRedirect(e,t,n,i,s,o){let{matched:u,consumedSegments:c,positionalParamSegments:l,remainingSegments:f}=rd(t,i,s);if(!u)return _i(t);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>zb&&(this.allowRedirects=!1));let p=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,p).pipe(vt(m=>this.processSegment(e,n,t,m.concat(f),o,!1)))}matchSegmentAgainstRoute(e,t,n,i,s){let o=kb(t,n,i,e,this.urlSerializer);return n.path==="**"&&(t.children={}),o.pipe(Me(u=>u.matched?(e=n._injector??e,this.getChildConfig(e,n,i).pipe(Me(({routes:c})=>{let l=n._loadedInjector??e,{consumedSegments:f,remainingSegments:p,parameters:m}=u,w=new mo(f,m,Object.freeze(B({},this.urlTree.queryParams)),this.urlTree.fragment,Wb(n),Xt(n),n.component??n._loadedComponent??null,n,Hb(n)),{segmentGroup:x,slicedSegments:V}=xv(t,f,p,c);if(V.length===0&&x.hasChildren())return this.processChildren(l,c,x).pipe(J(k=>k===null?null:new _t(w,k)));if(c.length===0&&V.length===0)return K(new _t(w,[]));let D=Xt(n)===s;return this.processSegment(l,c,x,V,D?ne:s,!0).pipe(J(k=>new _t(w,k instanceof _t?[k]:[])))}))):_i(t)))}getChildConfig(e,t,n){return t.children?K({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?K({routes:t._loadedRoutes,injector:t._loadedInjector}):xb(e,t,n,this.urlSerializer).pipe(vt(i=>i?this.configLoader.loadChildren(e,t).pipe(je(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):Nb(t))):K({routes:[],injector:e})}};function Gb(r){r.sort((e,t)=>e.value.outlet===ne?-1:t.value.outlet===ne?1:e.value.outlet.localeCompare(t.value.outlet))}function Kb(r){let e=r.value.routeConfig;return e&&e.path===""}function r_(r){let e=[],t=new Set;for(let n of r){if(!Kb(n)){e.push(n);continue}let i=e.find(s=>n.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...n.children),t.add(i)):e.push(n)}for(let n of t){let i=r_(n.children);e.push(new _t(n.value,i))}return e.filter(n=>!t.has(n))}function Wb(r){return r.data||{}}function Hb(r){return r.resolve||{}}function Qb(r,e,t,n,i,s){return vt(o=>$b(r,e,t,n,o.extractedUrl,i,s).pipe(J(({state:u,tree:c})=>ye(B({},o),{targetSnapshot:u,urlAfterRedirects:c}))))}function Xb(r,e){return vt(t=>{let{targetSnapshot:n,guards:{canActivateChecks:i}}=t;if(!i.length)return K(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of i_(c))o.add(l);let u=0;return ve(o).pipe(xn(c=>s.has(c)?Jb(c,n,r,e):(c.data=ed(c,c.parent,r).resolve,K(void 0))),je(()=>u++),jl(1),vt(c=>u===o.size?K(t):Dn))})}function i_(r){let e=r.children.map(t=>i_(t)).flat();return[r,...e]}function Jb(r,e,t,n){let i=r.routeConfig,s=r._resolve;return i?.title!==void 0&&!Xv(i)&&(s[wo]=i.title),Yb(s,r,e,n).pipe(J(o=>(r._resolvedData=o,r.data=ed(r,r.parent,t).resolve,null)))}function Yb(r,e,t,n){let i=Dh(r);if(i.length===0)return K({});let s={};return ve(i).pipe(vt(o=>Zb(r[o],e,t,n).pipe($t(),je(u=>{s[o]=u}))),jl(1),Um(s),ii(o=>t_(o)?Dn:Us(o)))}function Zb(r,e,t,n){let i=To(e)??n,s=Si(r,i),o=s.resolve?s.resolve(e,t):zt(i,()=>s(e,t));return Bn(o)}function Sh(r){return Me(e=>{let t=r(e);return t?ve(t).pipe(J(()=>e)):K(e)})}var s_=(()=>{let e=class e{buildTitle(n){let i,s=n.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===ne);return i}getResolvedTitleForRoute(n){return n.data[wo]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:()=>H(eC),providedIn:"root"});let r=e;return r})(),eC=(()=>{let e=class e extends s_{constructor(n){super(),this.title=n}updateTitle(n){let i=this.buildTitle(n);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(j($y))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),bo=new Q("",{providedIn:"root",factory:()=>({})}),_o=new Q(""),id=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=H(za)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return K(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);let i=Bn(n.loadComponent()).pipe(J(o_),je(o=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=o}),pr(()=>{this.componentLoaders.delete(n)})),s=new Ol(i,()=>new Tt).pipe(kl());return this.componentLoaders.set(n,s),s}loadChildren(n,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return K({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=tC(i,this.compiler,n,this.onLoadEndListener).pipe(pr(()=>{this.childrenLoaders.delete(i)})),u=new Ol(o,()=>new Tt).pipe(kl());return this.childrenLoaders.set(i,u),u}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();function tC(r,e,t,n){return Bn(r.loadChildren()).pipe(J(o_),vt(i=>i instanceof ay||Array.isArray(i)?K(i):ve(e.compileModuleAsync(i))),J(i=>{n&&n(r);let s,o,u=!1;return Array.isArray(i)?(o=i,u=!0):(s=i.create(t).injector,o=s.get(_o,[],{optional:!0,self:!0}).flat()),{routes:o.map(nd),injector:s}}))}function nC(r){return r&&typeof r=="object"&&"default"in r}function o_(r){return nC(r)?r.default:r}var sd=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:()=>H(rC),providedIn:"root"});let r=e;return r})(),rC=(()=>{let e=class e{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,i){return n}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),a_=new Q(""),u_=new Q("");function iC(r,e,t){let n=r.get(u_),i=r.get(pt);return r.get(Se).runOutsideAngular(()=>{if(!i.startViewTransition||n.skipNextTransition)return n.skipNextTransition=!1,new Promise(l=>setTimeout(l));let s,o=new Promise(l=>{s=l}),u=i.startViewTransition(()=>(s(),sC(r))),{onViewTransitionCreated:c}=n;return c&&zt(r,()=>c({transition:u,from:e,to:t})),o})}function sC(r){return new Promise(e=>{Wl(e,{injector:r})})}var od=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Tt,this.transitionAbortSubject=new Tt,this.configLoader=H(id),this.environmentInjector=H(Mn),this.urlSerializer=H(Eo),this.rootContexts=H(Io),this.location=H(Gs),this.inputBindingEnabled=H(Mu,{optional:!0})!==null,this.titleStrategy=H(s_),this.options=H(bo,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=H(sd),this.createViewTransition=H(a_,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>K(void 0),this.rootComponentType=null;let n=s=>this.events.next(new Fh(s)),i=s=>this.events.next(new Lh(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=n}complete(){this.transitions?.complete()}handleNavigationRequest(n){let i=++this.navigationId;this.transitions?.next(ye(B(B({},this.transitions.value),n),{id:i}))}setupNavigations(n,i,s){return this.transitions=new At({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:uo,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(at(o=>o.id!==0),J(o=>ye(B({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Me(o=>{let u=!1,c=!1;return K(o).pipe(Me(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",wt.SupersededByNewNavigation),Dn;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?ye(B({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let f=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),p=l.extras.onSameUrlNavigation??n.onSameUrlNavigation;if(!f&&p!=="reload"){let m="";return this.events.next(new Un(l.id,this.urlSerializer.serialize(l.rawUrl),m,Au.IgnoredSameUrlNavigation)),l.resolve(null),Dn}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return K(l).pipe(Me(m=>{let w=this.transitions?.getValue();return this.events.next(new bi(m.id,this.urlSerializer.serialize(m.extractedUrl),m.source,m.restoredState)),w!==this.transitions?.getValue()?Dn:Promise.resolve(m)}),Qb(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy),je(m=>{o.targetSnapshot=m.targetSnapshot,o.urlAfterRedirects=m.urlAfterRedirects,this.currentNavigation=ye(B({},this.currentNavigation),{finalUrl:m.urlAfterRedirects});let w=new bu(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(w)}));if(f&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:m,extractedUrl:w,source:x,restoredState:V,extras:D}=l,k=new bi(m,this.urlSerializer.serialize(w),x,V);this.events.next(k);let z=Hv(this.rootComponentType).snapshot;return this.currentTransition=o=ye(B({},l),{targetSnapshot:z,urlAfterRedirects:w,extras:ye(B({},D),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=w,K(o)}else{let m="";return this.events.next(new Un(l.id,this.urlSerializer.serialize(l.extractedUrl),m,Au.IgnoredByUrlHandlingStrategy)),l.resolve(null),Dn}}),je(l=>{let f=new Mh(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(f)}),J(l=>(this.currentTransition=o=ye(B({},l),{guards:fb(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),Tb(this.environmentInjector,l=>this.events.next(l)),je(l=>{if(o.guardsResult=l.guardsResult,Ai(l.guardsResult))throw Yv(this.urlSerializer,l.guardsResult);let f=new Nh(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(f)}),at(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",wt.GuardRejected),!1)),Sh(l=>{if(l.guards.canActivateChecks.length)return K(l).pipe(je(f=>{let p=new kh(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(p)}),Me(f=>{let p=!1;return K(f).pipe(Xb(this.paramsInheritanceStrategy,this.environmentInjector),je({next:()=>p=!0,complete:()=>{p||this.cancelNavigationTransition(f,"",wt.NoDataFromResolver)}}))}),je(f=>{let p=new Oh(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(p)}))}),Sh(l=>{let f=p=>{let m=[];p.routeConfig?.loadComponent&&!p.routeConfig._loadedComponent&&m.push(this.configLoader.loadComponent(p.routeConfig).pipe(je(w=>{p.component=w}),J(()=>{})));for(let w of p.children)m.push(...f(w));return m};return ka(f(l.targetSnapshot.root)).pipe(Ul(null),si(1))}),Sh(()=>this.afterPreactivation()),Me(()=>{let{currentSnapshot:l,targetSnapshot:f}=o,p=this.createViewTransition?.(this.environmentInjector,l.root,f.root);return p?ve(p).pipe(J(()=>o)):K(o)}),J(l=>{let f=sb(n.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=ye(B({},l),{targetRouterState:f}),this.currentNavigation.targetRouterState=f,o}),je(()=>{this.events.next(new po)}),db(this.rootContexts,n.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),si(1),je({next:l=>{u=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Qt(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{u=!0}}),qm(this.transitionAbortSubject.pipe(je(l=>{throw l}))),pr(()=>{!u&&!c&&this.cancelNavigationTransition(o,"",wt.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),ii(l=>{if(c=!0,e_(l))this.events.next(new Ln(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),ub(l)?this.events.next(new go(l.url)):o.resolve(!1);else{this.events.next(new fo(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0));try{o.resolve(n.errorHandler(l))}catch(f){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(f)}}return Dn}))}))}cancelNavigationTransition(n,i,s){let o=new Ln(n.id,this.urlSerializer.serialize(n.extractedUrl),i,s);this.events.next(o),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();function oC(r){return r!==uo}var aC=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:()=>H(uC),providedIn:"root"});let r=e;return r})(),Zh=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},uC=(()=>{let e=class e extends Zh{};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=dn(e)))(s||e)}})(),e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),c_=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:()=>H(cC),providedIn:"root"});let r=e;return r})(),cC=(()=>{let e=class e extends c_{constructor(){super(...arguments),this.location=H(Gs),this.urlSerializer=H(Eo),this.options=H(bo,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=H(sd),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Fn,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=Hv(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(i=>{i.type==="popstate"&&n(i.url,i.state)})}handleRouterEvent(n,i){if(n instanceof bi)this.stateMemento=this.createStateMemento();else if(n instanceof Un)this.rawUrlTree=i.initialUrl;else if(n instanceof bu){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else n instanceof po?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):n instanceof Ln&&(n.code===wt.GuardRejected||n.code===wt.NoDataFromResolver)?this.restoreHistory(i):n instanceof fo?this.restoreHistory(i,!0):n instanceof Qt&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,i){let s=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,u=B(B({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",u)}else{let o=B(B({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(n,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===n.finalUrl&&o===0&&(this.resetState(n),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,i){return this.canceledNavigationResolution==="computed"?{navigationId:n,\u0275routerPageId:i}:{navigationId:n}}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=dn(e)))(s||e)}})(),e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),oo=function(r){return r[r.COMPLETE=0]="COMPLETE",r[r.FAILED=1]="FAILED",r[r.REDIRECTING=2]="REDIRECTING",r}(oo||{});function l_(r,e){r.events.pipe(at(t=>t instanceof Qt||t instanceof Ln||t instanceof fo||t instanceof Un),J(t=>t instanceof Qt||t instanceof Un?oo.COMPLETE:(t instanceof Ln?t.code===wt.Redirect||t.code===wt.SupersededByNewNavigation:!1)?oo.REDIRECTING:oo.FAILED),at(t=>t!==oo.REDIRECTING),si(1)).subscribe(()=>{e()})}function lC(r){throw r}var hC={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},dC={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Ot=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=H(ja),this.stateManager=H(c_),this.options=H(bo,{optional:!0})||{},this.pendingTasks=H(qs),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=H(od),this.urlSerializer=H(Eo),this.location=H(Gs),this.urlHandlingStrategy=H(sd),this._events=new Tt,this.errorHandler=this.options.errorHandler||lC,this.navigated=!1,this.routeReuseStrategy=H(aC),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=H(_o,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!H(Mu,{optional:!0}),this.eventsSubscription=new xm,this.isNgZoneEnabled=H(Se)instanceof Se&&Se.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let n=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Ln&&i.code!==wt.Redirect&&i.code!==wt.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Qt)this.navigated=!0;else if(i instanceof go){let u=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||oC(s.source)};this.scheduleNavigation(u,uo,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}pC(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),uo,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(n,"popstate",i)},0)})}navigateToSyncWithBrowser(n,i,s){let o={replaceUrl:!0},u=s?.navigationId?s:null;if(s){let l=B({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let c=this.parseUrl(n);this.scheduleNavigation(c,i,u,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(nd),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,i={}){let{relativeTo:s,queryParams:o,fragment:u,queryParamsHandling:c,preserveFragment:l}=i,f=l?this.currentUrlTree.fragment:u,p=null;switch(c){case"merge":p=B(B({},this.currentUrlTree.queryParams),o);break;case"preserve":p=this.currentUrlTree.queryParams;break;default:p=o||null}p!==null&&(p=this.removeEmptyProps(p));let m;try{let w=s?s.snapshot:this.routerState.snapshot.root;m=zv(w)}catch{(typeof n[0]!="string"||!n[0].startsWith("/"))&&(n=[]),m=this.currentUrlTree.root}return Gv(m,n,p,f??null)}navigateByUrl(n,i={skipLocationChange:!1}){let s=Ai(n)?n:this.parseUrl(n),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,uo,null,i)}navigate(n,i={skipLocationChange:!1}){return fC(n),this.navigateByUrl(this.createUrlTree(n,i),i)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.urlSerializer.parse("/")}}isActive(n,i){let s;if(i===!0?s=B({},hC):i===!1?s=B({},dC):s=i,Ai(n))return Cv(this.currentUrlTree,n,s);let o=this.parseUrl(n);return Cv(this.currentUrlTree,o,s)}removeEmptyProps(n){return Object.entries(n).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(n,i,s,o,u){if(this.disposed)return Promise.resolve(!1);let c,l,f;u?(c=u.resolve,l=u.reject,f=u.promise):f=new Promise((m,w)=>{c=m,l=w});let p=this.pendingTasks.add();return l_(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(p))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:o,resolve:c,reject:l,promise:f,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),f.catch(m=>Promise.reject(m))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();function fC(r){for(let e=0;e<r.length;e++)if(r[e]==null)throw new de(4008,!1)}function pC(r){return!(r instanceof po)&&!(r instanceof go)}var h_=(()=>{let e=class e{constructor(n,i,s,o,u,c){this.router=n,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=u,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new Tt,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let l=u.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=n.events.subscribe(f=>{f instanceof Qt&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(n){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(n){n!=null?(this.commands=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(n,i,s,o,u){let c=this.urlTree;if(c===null||this.isAnchorElement&&(n!==0||i||s||o||u||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let n=this.urlTree;this.href=n!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(n)):null;let i=this.href===null?null:ny(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(n,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,n,i):s.removeAttribute(o,n)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(re(Ot),re(jn),Km("tabindex"),re(vr),re(mr),re(pi))},e.\u0275dir=Ne({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&Ie("click",function(u){return s.onClick(u.button,u.ctrlKey,u.shiftKey,u.altKey,u.metaKey)}),i&2&&Fa("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[bt.HasDecoratorInputTransform,"preserveFragment","preserveFragment",_r],skipLocationChange:[bt.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",_r],replaceUrl:[bt.HasDecoratorInputTransform,"replaceUrl","replaceUrl",_r],routerLink:"routerLink"},standalone:!0,features:[oy,Gt]});let r=e;return r})();var Vu=class{};var gC=(()=>{let e=class e{constructor(n,i,s,o,u){this.router=n,this.injector=s,this.preloadingStrategy=o,this.loader=u}setUpPreloading(){this.subscription=this.router.events.pipe(at(n=>n instanceof Qt),xn(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=Hl(o.providers,n,`Route: ${o.path}`));let u=o._injector??n,c=o._loadedInjector??u;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(u,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return ve(s).pipe(Fl())}preloadConfig(n,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(n,i):s=K(null);let o=s.pipe(vt(u=>u===null?K(void 0):(i._loadedRoutes=u.routes,i._loadedInjector=u.injector,this.processRoutes(u.injector??n,u.routes))));if(i.loadComponent&&!i._loadedComponent){let u=this.loader.loadComponent(i);return ve([o,u]).pipe(Fl())}else return o})}};e.\u0275fac=function(i){return new(i||e)(j(Ot),j(za),j(Mn),j(Vu),j(id))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),d_=new Q(""),mC=(()=>{let e=class e{constructor(n,i,s,o,u={}){this.urlSerializer=n,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=u,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=H(Mn),u.scrollPositionRestoration||="disabled",u.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof bi?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof Qt?(this.lastId=n.id,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.urlAfterRedirects).fragment)):n instanceof Un&&n.code===Au.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof Cu&&(n.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(n.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,i){this.zone.runOutsideAngular(()=>P(this,null,function*(){yield new Promise(s=>{setTimeout(()=>{s()}),Wl(()=>{s()},{injector:this.environmentInjector})}),this.zone.run(()=>{this.transitions.events.next(new Cu(n,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){ry()},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})();function mx(r,...e){return gr([{provide:_o,multi:!0,useValue:r},[],{provide:jn,useFactory:f_,deps:[Ot]},{provide:qa,multi:!0,useFactory:p_},e.map(t=>t.\u0275providers)])}function f_(r){return r.routerState.root}function Ri(r,e){return{\u0275kind:r,\u0275providers:e}}function p_(){let r=H(ci);return e=>{let t=r.get($a);if(e!==t.components[0])return;let n=r.get(Ot),i=r.get(g_);r.get(ad)===1&&n.initialNavigation(),r.get(m_,null,$l.Optional)?.setUpPreloading(),r.get(d_,null,$l.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var g_=new Q("",{factory:()=>new Tt}),ad=new Q("",{providedIn:"root",factory:()=>1});function yC(){return Ri(2,[{provide:ad,useValue:0},{provide:Jl,multi:!0,deps:[ci],useFactory:e=>{let t=e.get(py,Promise.resolve());return()=>t.then(()=>new Promise(n=>{let i=e.get(Ot),s=e.get(g_);l_(i,()=>{n(!0)}),e.get(od).afterPreactivation=()=>(n(!0),s.closed?K(void 0):s),i.initialNavigation()}))}}])}function vC(){return Ri(3,[{provide:Jl,multi:!0,useFactory:()=>{let e=H(Ot);return()=>{e.setUpLocationChangeListener()}}},{provide:ad,useValue:2}])}var m_=new Q("");function _C(r){return Ri(0,[{provide:m_,useExisting:gC},{provide:Vu,useExisting:r}])}function yx(){return Ri(6,[{provide:pi,useClass:Zl}])}function wC(){return Ri(8,[Pv,{provide:Mu,useExisting:Pv}])}function EC(r){let e=[{provide:a_,useValue:iC},{provide:u_,useValue:B({skipNextTransition:!!r?.skipInitialTransition},r)}];return Ri(9,e)}var Vv=new Q("ROUTER_FORROOT_GUARD"),IC=[Gs,{provide:Eo,useClass:lo},Ot,Io,{provide:jn,useFactory:f_,deps:[Ot]},id,[]],vx=(()=>{let e=class e{constructor(n){}static forRoot(n,i){return{ngModule:e,providers:[IC,[],{provide:_o,multi:!0,useValue:n},{provide:Vv,useFactory:CC,deps:[[Ot,new Vn,new zm]]},{provide:bo,useValue:i||{}},i?.useHash?AC():bC(),TC(),i?.preloadingStrategy?_C(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?SC(i):[],i?.bindToComponentInputs?wC().\u0275providers:[],i?.enableViewTransitions?EC().\u0275providers:[],RC()]}}static forChild(n){return{ngModule:e,providers:[{provide:_o,multi:!0,useValue:n}]}}};e.\u0275fac=function(i){return new(i||e)(j(Vv,8))},e.\u0275mod=ct({type:e}),e.\u0275inj=ut({});let r=e;return r})();function TC(){return{provide:d_,useFactory:()=>{let r=H(vy),e=H(Se),t=H(bo),n=H(od),i=H(Eo);return t.scrollOffset&&r.setOffset(t.scrollOffset),new mC(i,n,r,e,t)}}}function AC(){return{provide:pi,useClass:Zl}}function bC(){return{provide:pi,useClass:gy}}function CC(r){return"guarded"}function SC(r){return[r.initialNavigation==="disabled"?vC().\u0275providers:[],r.initialNavigation==="enabledBlocking"?yC().\u0275providers:[]]}var Mv=new Q("");function RC(){return[{provide:Mv,useFactory:p_},{provide:qa,multi:!0,useExisting:Mv}]}var PC="firebase",xC="10.12.3";Rt(PC,xC,"app");var pn=new $s("ANGULARFIRE2_VERSION");function Rx(r,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(r).getImmediate({optional:!0})}var VC=(r,e)=>{let t=e?[e]:Qa(),n=[];return t.forEach(i=>{i.container.getProvider(r).instances.forEach(o=>{n.includes(o)||n.push(o)})}),n},Sr=class{constructor(){return VC(MC)}},MC="app-check";function Di(){}var ku=class{zone;delegate;constructor(e,t=Mm){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,n){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,t,n)}},ud=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Di,{},Di,Di)),t.pipe(je({next:n,complete:n,error:n})).subscribe(e).add(n)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Pi=(()=>{class r{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new ku(Zone.current)),this.insideAngular=t.run(()=>new ku(Zone.current,Na)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(n){return new(n||r)(j(Se))};static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function Ou(){let r=globalThis.\u0275AngularFireScheduler;if(!r)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return r}function NC(r){return Ou().ngZone.runOutsideAngular(()=>r())}function Cr(r){return Ou().ngZone.run(()=>r())}function rt(r){return kC(Ou())(r)}function kC(r){return function(t){return t=t.lift(new ud(r.ngZone)),t.pipe(fr(r.outsideAngular),Pn(r.insideAngular))}}var OC=(r,e)=>function(){let n=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Cr(()=>r.apply(void 0,n))},y_=(r,e)=>function(){let t,n=arguments;for(let s=0;s<arguments.length;s++)typeof n[s]=="function"&&(e&&(t||=Cr(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Di,{},Di,Di))),n[s]=OC(n[s],t));let i=NC(()=>r.apply(this,n));if(!e)if(i instanceof qt){let s=Ou();return i.pipe(fr(s.outsideAngular),Pn(s.insideAngular))}else return Cr(()=>i);return i instanceof qt?i.pipe(rt):i instanceof Promise?Cr(()=>new Promise((s,o)=>i.then(u=>Cr(()=>s(u)),u=>Cr(()=>o(u))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:Cr(()=>i)};var Co=class{constructor(e){return e}},cd=class{constructor(){return Qa()}};function FC(r){return r&&r.length===1?r[0]:new Co(Hs())}var ld=new Q("angularfire2._apps"),LC={provide:Co,useFactory:FC,deps:[[new Vn,ld]]},UC={provide:cd,deps:[[new Vn,ld]]};function jC(r){return(e,t)=>{let n=t.get(nt);Rt("angularfire",pn.full,"core"),Rt("angularfire",pn.full,"app"),Rt("angular",Ua.full,n.toString());let i=e.runOutsideAngular(()=>r(t));return new Co(i)}}function Lx(r,...e){return gr([LC,UC,{provide:ld,useFactory:jC(r),multi:!0,deps:[Se,ci,Pi,...e]}])}var Ux=y_(by,!0);var BC="firebase",qC="10.12.3";gt.registerVersion(BC,qC,"app-compat");var $C=["ngOnDestroy"],w_=(r,e,t,n={})=>new Proxy(r,{get:(i,s)=>t.runOutsideAngular(()=>{if(r[s])return n?.spy?.get&&n.spy.get(s,r[s]),r[s];if($C.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(u=>{let c=u?.[s];return typeof c=="function"?c.bind(u):c?.then?c.then(l=>t.run(()=>l)):t.run(()=>c)});return new Proxy(()=>{},{get:(u,c)=>o[c],apply:(u,c,l)=>o.then(f=>{let p=f?.(...l);return n?.spy?.apply&&n.spy.apply(s,l,p),p})})})});var Fu=class{constructor(e){return e}},xi=new Q("angularfire2.app.options"),Vi=new Q("angularfire2.app.name");function So(r,e,t){let n=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||n;let o=gt.apps.filter(u=>u&&u.name===i.name)[0]||e.runOutsideAngular(()=>gt.initializeApp(r,i));try{if(JSON.stringify(r)!==JSON.stringify(o.options)){let u=!!module.hot;zC("error",`${o.name} Firebase App already initialized with different options${u?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Fu(o)}var zC=(r,...e)=>{Yl()&&typeof console<"u"&&console[r](...e)},GC={provide:Fu,useFactory:So,deps:[xi,Se,[new Vn,Vi]]},Xx=(()=>{class r{static initializeApp(t,n){return{ngModule:r,providers:[{provide:xi,useValue:t},{provide:Vi,useValue:n}]}}constructor(t){gt.registerVersion("angularfire",pn.full,"core"),gt.registerVersion("angularfire",pn.full,"app-compat"),gt.registerVersion("angular",Ua.full,t.toString())}static \u0275fac=function(n){return new(n||r)(j(nt))};static \u0275mod=ct({type:r});static \u0275inj=ut({providers:[GC]})}return r})();function Lu(r,e,t,n,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(u=>u[0]===r)||[];if(s)return KC(i,o)||(__("error",`${e} was already initialized on the ${t} Firebase App with different settings.${WC?" You may need to reload as Firebase is not HMR aware.":""}`),__("warn",{is:i,was:o})),s;{let u=n();return globalThis.\u0275AngularfireInstanceCache.push([r,u,i]),u}}function KC(r,e){try{return r.toString()===e.toString()}catch{return r===e}}var WC=typeof module<"u"&&!!module.hot,__=(r,...e)=>{Yl()&&typeof console<"u"&&console[r](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var HC=new Map,QC={activated:!1,tokenObservers:[]},XC={initialized:!1,enabled:!1};function Ft(r){return HC.get(r)||Object.assign({},QC)}function b_(){return XC}var JC="https://content-firebaseappcheck.googleapis.com/v1";var YC="exchangeDebugToken",E_={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},oV=24*60*60*1e3;var dd=class{constructor(e,t,n,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return P(this,null,function*(){this.stop();try{this.pending=new eh,this.pending.promise.catch(t=>{}),yield ZC(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new eh,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function ZC(r){return new Promise(e=>{setTimeout(e,r)})}var eS={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},qn=new Ty("appCheck","AppCheck",eS);function C_(r){if(!Ft(r).activated)throw qn.create("use-before-activation",{appName:r.name})}function S_(n,i){return P(this,arguments,function*({url:r,body:e},t){let s={"Content-Type":"application/json"},o=t.getImmediate({optional:!0});if(o){let w=yield o.getHeartbeatsHeader();w&&(s["X-Firebase-Client"]=w)}let u={method:"POST",body:JSON.stringify(e),headers:s},c;try{c=yield fetch(r,u)}catch(w){throw qn.create("fetch-network-error",{originalErrorMessage:w?.message})}if(c.status!==200)throw qn.create("fetch-status-error",{httpStatus:c.status});let l;try{l=yield c.json()}catch(w){throw qn.create("fetch-parse-error",{originalErrorMessage:w?.message})}let f=l.ttl.match(/^([\d.]+)(s)$/);if(!f||!f[2]||isNaN(Number(f[1])))throw qn.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let p=Number(f[1])*1e3,m=Date.now();return{token:l.token,expireTimeMillis:m+p,issuedAtTimeMillis:m}})}function R_(r,e){let{projectId:t,appId:n,apiKey:i}=r.options;return{url:`${JC}/projects/${t}/apps/${n}:${YC}?key=${i}`,body:{debug_token:e}}}var tS="firebase-app-check-database",nS=1,fd="firebase-app-check-store";var Uu=null;function rS(){return Uu||(Uu=new Promise((r,e)=>{try{let t=indexedDB.open(tS,nS);t.onsuccess=n=>{r(n.target.result)},t.onerror=n=>{var i;e(qn.create("storage-open",{originalErrorMessage:(i=n.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=n=>{let i=n.target.result;switch(n.oldVersion){case 0:i.createObjectStore(fd,{keyPath:"compositeKey"})}}}catch(t){e(qn.create("storage-open",{originalErrorMessage:t?.message}))}}),Uu)}function iS(r,e){return sS(oS(r),e)}function sS(r,e){return P(this,null,function*(){let n=(yield rS()).transaction(fd,"readwrite"),s=n.objectStore(fd).put({compositeKey:r,value:e});return new Promise((o,u)=>{s.onsuccess=c=>{o()},n.onerror=c=>{var l;u(qn.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})})}function oS(r){return`${r.options.appId}-${r.name}`}var pd=new Ha("@firebase/app-check");function hd(r,e){return Wa()?iS(r,e).catch(t=>{pd.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function D_(){return b_().enabled}function P_(){return P(this,null,function*(){let r=b_();if(r.enabled&&r.token)return r.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var aS={error:"UNKNOWN_ERROR"};function uS(r){return _y.encodeString(JSON.stringify(r),!1)}function gd(r,e=!1){return P(this,null,function*(){let t=r.app;C_(t);let n=Ft(t),i=n.token,s;if(i&&!Ro(i)&&(n.token=void 0,i=void 0),!i){let c=yield n.cachedTokenPromise;c&&(Ro(c)?i=c:yield hd(t,void 0))}if(!e&&i&&Ro(i))return{token:i.token};let o=!1;if(D_()){n.exchangeTokenPromise||(n.exchangeTokenPromise=S_(R_(t,yield P_()),r.heartbeatServiceProvider).finally(()=>{n.exchangeTokenPromise=void 0}),o=!0);let c=yield n.exchangeTokenPromise;return yield hd(t,c),n.token=c,{token:c.token}}try{n.exchangeTokenPromise||(n.exchangeTokenPromise=n.provider.getToken().finally(()=>{n.exchangeTokenPromise=void 0}),o=!0),i=yield Ft(t).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?pd.warn(c.message):pd.error(c),s=c}let u;return i?s?Ro(i)?u={token:i.token,internalError:s}:u=T_(s):(u={token:i.token},n.token=i,yield hd(t,i)):u=T_(s),o&&dS(t,u),u})}function cS(r){return P(this,null,function*(){let e=r.app;C_(e);let{provider:t}=Ft(e);if(D_()){let n=yield P_(),{token:i}=yield S_(R_(e,n),r.heartbeatServiceProvider);return{token:i}}else{let{token:n}=yield t.getToken();return{token:n}}})}function lS(r,e,t,n){let{app:i}=r,s=Ft(i),o={next:t,error:n,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Ro(s.token)){let u=s.token;Promise.resolve().then(()=>{t({token:u.token}),I_(r)}).catch(()=>{})}s.cachedTokenPromise.then(()=>I_(r))}function x_(r,e){let t=Ft(r),n=t.tokenObservers.filter(i=>i.next!==e);n.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=n}function I_(r){let{app:e}=r,t=Ft(e),n=t.tokenRefresher;n||(n=hS(r),t.tokenRefresher=n),!n.isRunning()&&t.isTokenAutoRefreshEnabled&&n.start()}function hS(r){let{app:e}=r;return new dd(()=>P(this,null,function*(){let t=Ft(e),n;if(t.token?n=yield gd(r,!0):n=yield gd(r),n.error)throw n.error;if(n.internalError)throw n.internalError}),()=>!0,()=>{let t=Ft(e);if(t.token){let n=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return n=Math.min(n,i),Math.max(0,n-Date.now())}else return 0},E_.RETRIAL_MIN_WAIT,E_.RETRIAL_MAX_WAIT)}function dS(r,e){let t=Ft(r).tokenObservers;for(let n of t)try{n.type==="EXTERNAL"&&e.error!=null?n.error(e.error):n.next(e)}catch{}}function Ro(r){return r.expireTimeMillis-Date.now()>0}function T_(r){return{token:uS(aS),error:r}}var md=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=Ft(this.app);for(let t of e)x_(this.app,t.next);return Promise.resolve()}};function fS(r,e){return new md(r,e)}function pS(r){return{getToken:e=>gd(r,e),getLimitedUseToken:()=>cS(r),addTokenListener:e=>lS(r,"INTERNAL",e),removeTokenListener:e=>x_(r.app,e)}}var gS="@firebase/app-check",mS="0.8.5";var yS="app-check",A_="app-check-internal";function vS(){Ws(new wr(yS,r=>{let e=r.getProvider("app").getImmediate(),t=r.getProvider("heartbeat");return fS(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((r,e,t)=>{r.getProvider(A_).initialize()})),Ws(new wr(A_,r=>{let e=r.getProvider("app-check").getImmediate();return pS(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Rt(gS,mS)}vS();var _S=["localhost","0.0.0.0","127.0.0.1"],vV=typeof window<"u"&&_S.includes(window.location.hostname);var yd=new Q("angularfire2.auth.use-emulator"),vd=new Q("angularfire2.auth.settings"),_d=new Q("angularfire2.auth.tenant-id"),wd=new Q("angularfire2.auth.langugage-code"),Ed=new Q("angularfire2.auth.use-device-language"),Id=new Q("angularfire.auth.persistence"),Td=(r,e,t,n,i,s,o,u)=>Lu(`${r.name}.auth`,"AngularFireAuth",r.name,()=>{let c=e.runOutsideAngular(()=>r.auth());if(t&&c.useEmulator(...t),n&&(c.tenantId=n),c.languageCode=i,s&&c.useDeviceLanguage(),o)for(let[l,f]of Object.entries(o))c.settings[l]=f;return u&&c.setPersistence(u),c},[t,n,i,s,o,u]),M_=(()=>{class r{authState;idToken;user;idTokenResult;credential;constructor(t,n,i,s,o,u,c,l,f,p,m,w){let x=new Tt,V=K(void 0).pipe(Pn(o.outsideAngular),Me(()=>s.runOutsideAngular(()=>import("./chunk-EXDAETL6.js"))),J(()=>So(t,s,n)),J(D=>Td(D,s,u,l,f,p,c,m)),Bl({bufferSize:1,refCount:!1}));if(Nn(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=K(null);else{V.pipe($t()).subscribe();let D=V.pipe(Me(F=>F.getRedirectResult().then($=>$,()=>null)),rt,Bl({bufferSize:1,refCount:!1})),k=V.pipe(Me(F=>new qt($=>({unsubscribe:s.runOutsideAngular(()=>F.onAuthStateChanged(X=>$.next(X),X=>$.error(X),()=>$.complete()))})))),z=V.pipe(Me(F=>new qt($=>({unsubscribe:s.runOutsideAngular(()=>F.onIdTokenChanged(X=>$.next(X),X=>$.error(X),()=>$.complete()))}))));this.authState=D.pipe(ql(k),fr(o.outsideAngular),Pn(o.insideAngular)),this.user=D.pipe(ql(z),fr(o.outsideAngular),Pn(o.insideAngular)),this.idToken=this.user.pipe(Me(F=>F?ve(F.getIdToken()):K(null))),this.idTokenResult=this.user.pipe(Me(F=>F?ve(F.getIdTokenResult()):K(null))),this.credential=Lm(D,x,this.authState.pipe(at(F=>!F))).pipe(J(F=>F?.user?F:null),fr(o.outsideAngular),Pn(o.insideAngular))}return w_(this,V,s,{spy:{apply:(D,k,z)=>{(D.startsWith("signIn")||D.startsWith("createUser"))&&z.then(F=>x.next(F))}}})}static \u0275fac=function(n){return new(n||r)(j(xi),j(Vi,8),j(nt),j(Se),j(Pi),j(yd,8),j(vd,8),j(_d,8),j(wd,8),j(Ed,8),j(Id,8),j(Sr,8))};static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"any"})}return r})();var N_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},k_={};var $n,Ad;(function(){var r;function e(E,y){function _(){}_.prototype=y.prototype,E.D=y.prototype,E.prototype=new _,E.prototype.constructor=E,E.C=function(I,T,b){for(var v=Array(arguments.length-2),un=2;un<arguments.length;un++)v[un-2]=arguments[un];return y.prototype[T].apply(I,v)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,y,_){_||(_=0);var I=Array(16);if(typeof y=="string")for(var T=0;16>T;++T)I[T]=y.charCodeAt(_++)|y.charCodeAt(_++)<<8|y.charCodeAt(_++)<<16|y.charCodeAt(_++)<<24;else for(T=0;16>T;++T)I[T]=y[_++]|y[_++]<<8|y[_++]<<16|y[_++]<<24;y=E.g[0],_=E.g[1],T=E.g[2];var b=E.g[3],v=y+(b^_&(T^b))+I[0]+3614090360&4294967295;y=_+(v<<7&4294967295|v>>>25),v=b+(T^y&(_^T))+I[1]+3905402710&4294967295,b=y+(v<<12&4294967295|v>>>20),v=T+(_^b&(y^_))+I[2]+606105819&4294967295,T=b+(v<<17&4294967295|v>>>15),v=_+(y^T&(b^y))+I[3]+3250441966&4294967295,_=T+(v<<22&4294967295|v>>>10),v=y+(b^_&(T^b))+I[4]+4118548399&4294967295,y=_+(v<<7&4294967295|v>>>25),v=b+(T^y&(_^T))+I[5]+1200080426&4294967295,b=y+(v<<12&4294967295|v>>>20),v=T+(_^b&(y^_))+I[6]+2821735955&4294967295,T=b+(v<<17&4294967295|v>>>15),v=_+(y^T&(b^y))+I[7]+4249261313&4294967295,_=T+(v<<22&4294967295|v>>>10),v=y+(b^_&(T^b))+I[8]+1770035416&4294967295,y=_+(v<<7&4294967295|v>>>25),v=b+(T^y&(_^T))+I[9]+2336552879&4294967295,b=y+(v<<12&4294967295|v>>>20),v=T+(_^b&(y^_))+I[10]+4294925233&4294967295,T=b+(v<<17&4294967295|v>>>15),v=_+(y^T&(b^y))+I[11]+2304563134&4294967295,_=T+(v<<22&4294967295|v>>>10),v=y+(b^_&(T^b))+I[12]+1804603682&4294967295,y=_+(v<<7&4294967295|v>>>25),v=b+(T^y&(_^T))+I[13]+4254626195&4294967295,b=y+(v<<12&4294967295|v>>>20),v=T+(_^b&(y^_))+I[14]+2792965006&4294967295,T=b+(v<<17&4294967295|v>>>15),v=_+(y^T&(b^y))+I[15]+1236535329&4294967295,_=T+(v<<22&4294967295|v>>>10),v=y+(T^b&(_^T))+I[1]+4129170786&4294967295,y=_+(v<<5&4294967295|v>>>27),v=b+(_^T&(y^_))+I[6]+3225465664&4294967295,b=y+(v<<9&4294967295|v>>>23),v=T+(y^_&(b^y))+I[11]+643717713&4294967295,T=b+(v<<14&4294967295|v>>>18),v=_+(b^y&(T^b))+I[0]+3921069994&4294967295,_=T+(v<<20&4294967295|v>>>12),v=y+(T^b&(_^T))+I[5]+3593408605&4294967295,y=_+(v<<5&4294967295|v>>>27),v=b+(_^T&(y^_))+I[10]+38016083&4294967295,b=y+(v<<9&4294967295|v>>>23),v=T+(y^_&(b^y))+I[15]+3634488961&4294967295,T=b+(v<<14&4294967295|v>>>18),v=_+(b^y&(T^b))+I[4]+3889429448&4294967295,_=T+(v<<20&4294967295|v>>>12),v=y+(T^b&(_^T))+I[9]+568446438&4294967295,y=_+(v<<5&4294967295|v>>>27),v=b+(_^T&(y^_))+I[14]+3275163606&4294967295,b=y+(v<<9&4294967295|v>>>23),v=T+(y^_&(b^y))+I[3]+4107603335&4294967295,T=b+(v<<14&4294967295|v>>>18),v=_+(b^y&(T^b))+I[8]+1163531501&4294967295,_=T+(v<<20&4294967295|v>>>12),v=y+(T^b&(_^T))+I[13]+2850285829&4294967295,y=_+(v<<5&4294967295|v>>>27),v=b+(_^T&(y^_))+I[2]+4243563512&4294967295,b=y+(v<<9&4294967295|v>>>23),v=T+(y^_&(b^y))+I[7]+1735328473&4294967295,T=b+(v<<14&4294967295|v>>>18),v=_+(b^y&(T^b))+I[12]+2368359562&4294967295,_=T+(v<<20&4294967295|v>>>12),v=y+(_^T^b)+I[5]+4294588738&4294967295,y=_+(v<<4&4294967295|v>>>28),v=b+(y^_^T)+I[8]+2272392833&4294967295,b=y+(v<<11&4294967295|v>>>21),v=T+(b^y^_)+I[11]+1839030562&4294967295,T=b+(v<<16&4294967295|v>>>16),v=_+(T^b^y)+I[14]+4259657740&4294967295,_=T+(v<<23&4294967295|v>>>9),v=y+(_^T^b)+I[1]+2763975236&4294967295,y=_+(v<<4&4294967295|v>>>28),v=b+(y^_^T)+I[4]+1272893353&4294967295,b=y+(v<<11&4294967295|v>>>21),v=T+(b^y^_)+I[7]+4139469664&4294967295,T=b+(v<<16&4294967295|v>>>16),v=_+(T^b^y)+I[10]+3200236656&4294967295,_=T+(v<<23&4294967295|v>>>9),v=y+(_^T^b)+I[13]+681279174&4294967295,y=_+(v<<4&4294967295|v>>>28),v=b+(y^_^T)+I[0]+3936430074&4294967295,b=y+(v<<11&4294967295|v>>>21),v=T+(b^y^_)+I[3]+3572445317&4294967295,T=b+(v<<16&4294967295|v>>>16),v=_+(T^b^y)+I[6]+76029189&4294967295,_=T+(v<<23&4294967295|v>>>9),v=y+(_^T^b)+I[9]+3654602809&4294967295,y=_+(v<<4&4294967295|v>>>28),v=b+(y^_^T)+I[12]+3873151461&4294967295,b=y+(v<<11&4294967295|v>>>21),v=T+(b^y^_)+I[15]+530742520&4294967295,T=b+(v<<16&4294967295|v>>>16),v=_+(T^b^y)+I[2]+3299628645&4294967295,_=T+(v<<23&4294967295|v>>>9),v=y+(T^(_|~b))+I[0]+4096336452&4294967295,y=_+(v<<6&4294967295|v>>>26),v=b+(_^(y|~T))+I[7]+1126891415&4294967295,b=y+(v<<10&4294967295|v>>>22),v=T+(y^(b|~_))+I[14]+2878612391&4294967295,T=b+(v<<15&4294967295|v>>>17),v=_+(b^(T|~y))+I[5]+4237533241&4294967295,_=T+(v<<21&4294967295|v>>>11),v=y+(T^(_|~b))+I[12]+1700485571&4294967295,y=_+(v<<6&4294967295|v>>>26),v=b+(_^(y|~T))+I[3]+2399980690&4294967295,b=y+(v<<10&4294967295|v>>>22),v=T+(y^(b|~_))+I[10]+4293915773&4294967295,T=b+(v<<15&4294967295|v>>>17),v=_+(b^(T|~y))+I[1]+2240044497&4294967295,_=T+(v<<21&4294967295|v>>>11),v=y+(T^(_|~b))+I[8]+1873313359&4294967295,y=_+(v<<6&4294967295|v>>>26),v=b+(_^(y|~T))+I[15]+4264355552&4294967295,b=y+(v<<10&4294967295|v>>>22),v=T+(y^(b|~_))+I[6]+2734768916&4294967295,T=b+(v<<15&4294967295|v>>>17),v=_+(b^(T|~y))+I[13]+1309151649&4294967295,_=T+(v<<21&4294967295|v>>>11),v=y+(T^(_|~b))+I[4]+4149444226&4294967295,y=_+(v<<6&4294967295|v>>>26),v=b+(_^(y|~T))+I[11]+3174756917&4294967295,b=y+(v<<10&4294967295|v>>>22),v=T+(y^(b|~_))+I[2]+718787259&4294967295,T=b+(v<<15&4294967295|v>>>17),v=_+(b^(T|~y))+I[9]+3951481745&4294967295,E.g[0]=E.g[0]+y&4294967295,E.g[1]=E.g[1]+(T+(v<<21&4294967295|v>>>11))&4294967295,E.g[2]=E.g[2]+T&4294967295,E.g[3]=E.g[3]+b&4294967295}n.prototype.u=function(E,y){y===void 0&&(y=E.length);for(var _=y-this.blockSize,I=this.B,T=this.h,b=0;b<y;){if(T==0)for(;b<=_;)i(this,E,b),b+=this.blockSize;if(typeof E=="string"){for(;b<y;)if(I[T++]=E.charCodeAt(b++),T==this.blockSize){i(this,I),T=0;break}}else for(;b<y;)if(I[T++]=E[b++],T==this.blockSize){i(this,I),T=0;break}}this.h=T,this.o+=y},n.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var y=1;y<E.length-8;++y)E[y]=0;var _=8*this.o;for(y=E.length-8;y<E.length;++y)E[y]=_&255,_/=256;for(this.u(E),E=Array(16),y=_=0;4>y;++y)for(var I=0;32>I;I+=8)E[_++]=this.g[y]>>>I&255;return E};function s(E,y){var _=u;return Object.prototype.hasOwnProperty.call(_,E)?_[E]:_[E]=y(E)}function o(E,y){this.h=y;for(var _=[],I=!0,T=E.length-1;0<=T;T--){var b=E[T]|0;I&&b==y||(_[T]=b,I=!1)}this.g=_}var u={};function c(E){return-128<=E&&128>E?s(E,function(y){return new o([y|0],0>y?-1:0)}):new o([E|0],0>E?-1:0)}function l(E){if(isNaN(E)||!isFinite(E))return p;if(0>E)return D(l(-E));for(var y=[],_=1,I=0;E>=_;I++)y[I]=E/_|0,_*=4294967296;return new o(y,0)}function f(E,y){if(E.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(E.charAt(0)=="-")return D(f(E.substring(1),y));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=l(Math.pow(y,8)),I=p,T=0;T<E.length;T+=8){var b=Math.min(8,E.length-T),v=parseInt(E.substring(T,T+b),y);8>b?(b=l(Math.pow(y,b)),I=I.j(b).add(l(v))):(I=I.j(_),I=I.add(l(v)))}return I}var p=c(0),m=c(1),w=c(16777216);r=o.prototype,r.m=function(){if(V(this))return-D(this).m();for(var E=0,y=1,_=0;_<this.g.length;_++){var I=this.i(_);E+=(0<=I?I:4294967296+I)*y,y*=4294967296}return E},r.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(x(this))return"0";if(V(this))return"-"+D(this).toString(E);for(var y=l(Math.pow(E,6)),_=this,I="";;){var T=$(_,y).g;_=k(_,T.j(y));var b=((0<_.g.length?_.g[0]:_.h)>>>0).toString(E);if(_=T,x(_))return b+I;for(;6>b.length;)b="0"+b;I=b+I}},r.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function x(E){if(E.h!=0)return!1;for(var y=0;y<E.g.length;y++)if(E.g[y]!=0)return!1;return!0}function V(E){return E.h==-1}r.l=function(E){return E=k(this,E),V(E)?-1:x(E)?0:1};function D(E){for(var y=E.g.length,_=[],I=0;I<y;I++)_[I]=~E.g[I];return new o(_,~E.h).add(m)}r.abs=function(){return V(this)?D(this):this},r.add=function(E){for(var y=Math.max(this.g.length,E.g.length),_=[],I=0,T=0;T<=y;T++){var b=I+(this.i(T)&65535)+(E.i(T)&65535),v=(b>>>16)+(this.i(T)>>>16)+(E.i(T)>>>16);I=v>>>16,b&=65535,v&=65535,_[T]=v<<16|b}return new o(_,_[_.length-1]&-2147483648?-1:0)};function k(E,y){return E.add(D(y))}r.j=function(E){if(x(this)||x(E))return p;if(V(this))return V(E)?D(this).j(D(E)):D(D(this).j(E));if(V(E))return D(this.j(D(E)));if(0>this.l(w)&&0>E.l(w))return l(this.m()*E.m());for(var y=this.g.length+E.g.length,_=[],I=0;I<2*y;I++)_[I]=0;for(I=0;I<this.g.length;I++)for(var T=0;T<E.g.length;T++){var b=this.i(I)>>>16,v=this.i(I)&65535,un=E.i(T)>>>16,ws=E.i(T)&65535;_[2*I+2*T]+=v*ws,z(_,2*I+2*T),_[2*I+2*T+1]+=b*ws,z(_,2*I+2*T+1),_[2*I+2*T+1]+=v*un,z(_,2*I+2*T+1),_[2*I+2*T+2]+=b*un,z(_,2*I+2*T+2)}for(I=0;I<y;I++)_[I]=_[2*I+1]<<16|_[2*I];for(I=y;I<2*y;I++)_[I]=0;return new o(_,0)};function z(E,y){for(;(E[y]&65535)!=E[y];)E[y+1]+=E[y]>>>16,E[y]&=65535,y++}function F(E,y){this.g=E,this.h=y}function $(E,y){if(x(y))throw Error("division by zero");if(x(E))return new F(p,p);if(V(E))return y=$(D(E),y),new F(D(y.g),D(y.h));if(V(y))return y=$(E,D(y)),new F(D(y.g),y.h);if(30<E.g.length){if(V(E)||V(y))throw Error("slowDivide_ only works with positive integers.");for(var _=m,I=y;0>=I.l(E);)_=X(_),I=X(I);var T=Y(_,1),b=Y(I,1);for(I=Y(I,2),_=Y(_,2);!x(I);){var v=b.add(I);0>=v.l(E)&&(T=T.add(_),b=v),I=Y(I,1),_=Y(_,1)}return y=k(E,T.j(y)),new F(T,y)}for(T=p;0<=E.l(y);){for(_=Math.max(1,Math.floor(E.m()/y.m())),I=Math.ceil(Math.log(_)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),b=l(_),v=b.j(y);V(v)||0<v.l(E);)_-=I,b=l(_),v=b.j(y);x(b)&&(b=m),T=T.add(b),E=k(E,v)}return new F(T,E)}r.A=function(E){return $(this,E).h},r.and=function(E){for(var y=Math.max(this.g.length,E.g.length),_=[],I=0;I<y;I++)_[I]=this.i(I)&E.i(I);return new o(_,this.h&E.h)},r.or=function(E){for(var y=Math.max(this.g.length,E.g.length),_=[],I=0;I<y;I++)_[I]=this.i(I)|E.i(I);return new o(_,this.h|E.h)},r.xor=function(E){for(var y=Math.max(this.g.length,E.g.length),_=[],I=0;I<y;I++)_[I]=this.i(I)^E.i(I);return new o(_,this.h^E.h)};function X(E){for(var y=E.g.length+1,_=[],I=0;I<y;I++)_[I]=E.i(I)<<1|E.i(I-1)>>>31;return new o(_,E.h)}function Y(E,y){var _=y>>5;y%=32;for(var I=E.g.length-_,T=[],b=0;b<I;b++)T[b]=0<y?E.i(b+_)>>>y|E.i(b+_+1)<<32-y:E.i(b+_);return new o(T,E.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Ad=k_.Md5=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=f,$n=k_.Integer=o}).apply(typeof N_<"u"?N_:typeof self<"u"?self:typeof window<"u"?window:{});var ju=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},gn={};var bd,Cd,Mi,Sd,Do,Bu,Rd,Dd,Pd;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,h,d){return a==Array.prototype||a==Object.prototype||(a[h]=d.value),a};function t(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof ju=="object"&&ju];for(var h=0;h<a.length;++h){var d=a[h];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var n=t(this);function i(a,h){if(h)e:{var d=n;a=a.split(".");for(var g=0;g<a.length-1;g++){var A=a[g];if(!(A in d))break e;d=d[A]}a=a[a.length-1],g=d[a],h=h(g),h!=g&&h!=null&&e(d,a,{configurable:!0,writable:!0,value:h})}}function s(a,h){a instanceof String&&(a+="");var d=0,g=!1,A={next:function(){if(!g&&d<a.length){var S=d++;return{value:h(S,a[S]),done:!1}}return g=!0,{done:!0,value:void 0}}};return A[Symbol.iterator]=function(){return A},A}i("Array.prototype.values",function(a){return a||function(){return s(this,function(h,d){return d})}});var o=o||{},u=this||self;function c(a){var h=typeof a;return h=h!="object"?h:a?Array.isArray(a)?"array":h:"null",h=="array"||h=="object"&&typeof a.length=="number"}function l(a){var h=typeof a;return h=="object"&&a!=null||h=="function"}function f(a,h,d){return a.call.apply(a.bind,arguments)}function p(a,h,d){if(!a)throw Error();if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var A=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(A,g),a.apply(h,A)}}return function(){return a.apply(h,arguments)}}function m(a,h,d){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,m.apply(null,arguments)}function w(a,h){var d=Array.prototype.slice.call(arguments,1);return function(){var g=d.slice();return g.push.apply(g,arguments),a.apply(this,g)}}function x(a,h){function d(){}d.prototype=h.prototype,a.aa=h.prototype,a.prototype=new d,a.prototype.constructor=a,a.Qb=function(g,A,S){for(var O=Array(arguments.length-2),he=2;he<arguments.length;he++)O[he-2]=arguments[he];return h.prototype[A].apply(g,O)}}function V(a){let h=a.length;if(0<h){let d=Array(h);for(let g=0;g<h;g++)d[g]=a[g];return d}return[]}function D(a,h){for(let d=1;d<arguments.length;d++){let g=arguments[d];if(c(g)){let A=a.length||0,S=g.length||0;a.length=A+S;for(let O=0;O<S;O++)a[A+O]=g[O]}else a.push(g)}}class k{constructor(h,d){this.i=h,this.j=d,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function z(a){return/^[\s\xa0]*$/.test(a)}function F(){var a=u.navigator;return a&&(a=a.userAgent)?a:""}function $(a){return $[" "](a),a}$[" "]=function(){};var X=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function Y(a,h,d){for(let g in a)h.call(d,a[g],g,a)}function E(a,h){for(let d in a)h.call(void 0,a[d],d,a)}function y(a){let h={};for(let d in a)h[d]=a[d];return h}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(a,h){let d,g;for(let A=1;A<arguments.length;A++){g=arguments[A];for(d in g)a[d]=g[d];for(let S=0;S<_.length;S++)d=_[S],Object.prototype.hasOwnProperty.call(g,d)&&(a[d]=g[d])}}function T(a){var h=1;a=a.split(":");let d=[];for(;0<h&&a.length;)d.push(a.shift()),h--;return a.length&&d.push(a.join(":")),d}function b(a){u.setTimeout(()=>{throw a},0)}function v(){var a=cl;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}class un{constructor(){this.h=this.g=null}add(h,d){let g=ws.get();g.set(h,d),this.h?this.h.next=g:this.g=g,this.h=g}}var ws=new k(()=>new gT,a=>a.reset());class gT{constructor(){this.next=this.g=this.h=null}set(h,d){this.h=h,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let Es,Is=!1,cl=new un,Pg=()=>{let a=u.Promise.resolve(void 0);Es=()=>{a.then(mT)}};var mT=()=>{for(var a;a=v();){try{a.h.call(a.g)}catch(d){b(d)}var h=ws;h.j(a),100>h.h&&(h.h++,a.next=h.g,h.g=a)}Is=!1};function bn(){this.s=this.s,this.C=this.C}bn.prototype.s=!1,bn.prototype.ma=function(){this.s||(this.s=!0,this.N())},bn.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function We(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}We.prototype.h=function(){this.defaultPrevented=!0};var yT=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{let d=()=>{};u.addEventListener("test",d,h),u.removeEventListener("test",d,h)}catch{}return a}();function Ts(a,h){if(We.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var d=this.type=a.type,g=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=h,h=a.relatedTarget){if(X){e:{try{$(h.nodeName);var A=!0;break e}catch{}A=!1}A||(h=null)}}else d=="mouseover"?h=a.fromElement:d=="mouseout"&&(h=a.toElement);this.relatedTarget=h,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:vT[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&Ts.aa.h.call(this)}}x(Ts,We);var vT={2:"touch",3:"pen",4:"mouse"};Ts.prototype.h=function(){Ts.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var As="closure_listenable_"+(1e6*Math.random()|0),_T=0;function wT(a,h,d,g,A){this.listener=a,this.proxy=null,this.src=h,this.type=d,this.capture=!!g,this.ha=A,this.key=++_T,this.da=this.fa=!1}function ya(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function va(a){this.src=a,this.g={},this.h=0}va.prototype.add=function(a,h,d,g,A){var S=a.toString();a=this.g[S],a||(a=this.g[S]=[],this.h++);var O=hl(a,h,g,A);return-1<O?(h=a[O],d||(h.fa=!1)):(h=new wT(h,this.src,S,!!g,A),h.fa=d,a.push(h)),h};function ll(a,h){var d=h.type;if(d in a.g){var g=a.g[d],A=Array.prototype.indexOf.call(g,h,void 0),S;(S=0<=A)&&Array.prototype.splice.call(g,A,1),S&&(ya(h),a.g[d].length==0&&(delete a.g[d],a.h--))}}function hl(a,h,d,g){for(var A=0;A<a.length;++A){var S=a[A];if(!S.da&&S.listener==h&&S.capture==!!d&&S.ha==g)return A}return-1}var dl="closure_lm_"+(1e6*Math.random()|0),fl={};function xg(a,h,d,g,A){if(g&&g.once)return Mg(a,h,d,g,A);if(Array.isArray(h)){for(var S=0;S<h.length;S++)xg(a,h[S],d,g,A);return null}return d=yl(d),a&&a[As]?a.K(h,d,l(g)?!!g.capture:!!g,A):Vg(a,h,d,!1,g,A)}function Vg(a,h,d,g,A,S){if(!h)throw Error("Invalid event type");var O=l(A)?!!A.capture:!!A,he=gl(a);if(he||(a[dl]=he=new va(a)),d=he.add(h,d,g,O,S),d.proxy)return d;if(g=ET(),d.proxy=g,g.src=a,g.listener=d,a.addEventListener)yT||(A=O),A===void 0&&(A=!1),a.addEventListener(h.toString(),g,A);else if(a.attachEvent)a.attachEvent(kg(h.toString()),g);else if(a.addListener&&a.removeListener)a.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return d}function ET(){function a(d){return h.call(a.src,a.listener,d)}let h=IT;return a}function Mg(a,h,d,g,A){if(Array.isArray(h)){for(var S=0;S<h.length;S++)Mg(a,h[S],d,g,A);return null}return d=yl(d),a&&a[As]?a.L(h,d,l(g)?!!g.capture:!!g,A):Vg(a,h,d,!0,g,A)}function Ng(a,h,d,g,A){if(Array.isArray(h))for(var S=0;S<h.length;S++)Ng(a,h[S],d,g,A);else g=l(g)?!!g.capture:!!g,d=yl(d),a&&a[As]?(a=a.i,h=String(h).toString(),h in a.g&&(S=a.g[h],d=hl(S,d,g,A),-1<d&&(ya(S[d]),Array.prototype.splice.call(S,d,1),S.length==0&&(delete a.g[h],a.h--)))):a&&(a=gl(a))&&(h=a.g[h.toString()],a=-1,h&&(a=hl(h,d,g,A)),(d=-1<a?h[a]:null)&&pl(d))}function pl(a){if(typeof a!="number"&&a&&!a.da){var h=a.src;if(h&&h[As])ll(h.i,a);else{var d=a.type,g=a.proxy;h.removeEventListener?h.removeEventListener(d,g,a.capture):h.detachEvent?h.detachEvent(kg(d),g):h.addListener&&h.removeListener&&h.removeListener(g),(d=gl(h))?(ll(d,a),d.h==0&&(d.src=null,h[dl]=null)):ya(a)}}}function kg(a){return a in fl?fl[a]:fl[a]="on"+a}function IT(a,h){if(a.da)a=!0;else{h=new Ts(h,this);var d=a.listener,g=a.ha||a.src;a.fa&&pl(a),a=d.call(g,h)}return a}function gl(a){return a=a[dl],a instanceof va?a:null}var ml="__closure_events_fn_"+(1e9*Math.random()>>>0);function yl(a){return typeof a=="function"?a:(a[ml]||(a[ml]=function(h){return a.handleEvent(h)}),a[ml])}function He(){bn.call(this),this.i=new va(this),this.M=this,this.F=null}x(He,bn),He.prototype[As]=!0,He.prototype.removeEventListener=function(a,h,d,g){Ng(this,a,h,d,g)};function et(a,h){var d,g=a.F;if(g)for(d=[];g;g=g.F)d.push(g);if(a=a.M,g=h.type||h,typeof h=="string")h=new We(h,a);else if(h instanceof We)h.target=h.target||a;else{var A=h;h=new We(g,a),I(h,A)}if(A=!0,d)for(var S=d.length-1;0<=S;S--){var O=h.g=d[S];A=_a(O,g,!0,h)&&A}if(O=h.g=a,A=_a(O,g,!0,h)&&A,A=_a(O,g,!1,h)&&A,d)for(S=0;S<d.length;S++)O=h.g=d[S],A=_a(O,g,!1,h)&&A}He.prototype.N=function(){if(He.aa.N.call(this),this.i){var a=this.i,h;for(h in a.g){for(var d=a.g[h],g=0;g<d.length;g++)ya(d[g]);delete a.g[h],a.h--}}this.F=null},He.prototype.K=function(a,h,d,g){return this.i.add(String(a),h,!1,d,g)},He.prototype.L=function(a,h,d,g){return this.i.add(String(a),h,!0,d,g)};function _a(a,h,d,g){if(h=a.i.g[String(h)],!h)return!0;h=h.concat();for(var A=!0,S=0;S<h.length;++S){var O=h[S];if(O&&!O.da&&O.capture==d){var he=O.listener,Ge=O.ha||O.src;O.fa&&ll(a.i,O),A=he.call(Ge,g)!==!1&&A}}return A&&!g.defaultPrevented}function Og(a,h,d){if(typeof a=="function")d&&(a=m(a,d));else if(a&&typeof a.handleEvent=="function")a=m(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:u.setTimeout(a,h||0)}function Fg(a){a.g=Og(()=>{a.g=null,a.i&&(a.i=!1,Fg(a))},a.l);let h=a.h;a.h=null,a.m.apply(null,h)}class TT extends bn{constructor(h,d){super(),this.m=h,this.l=d,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Fg(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function bs(a){bn.call(this),this.h=a,this.g={}}x(bs,bn);var Lg=[];function Ug(a){Y(a.g,function(h,d){this.g.hasOwnProperty(d)&&pl(h)},a),a.g={}}bs.prototype.N=function(){bs.aa.N.call(this),Ug(this)},bs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var vl=u.JSON.stringify,AT=u.JSON.parse,bT=class{stringify(a){return u.JSON.stringify(a,void 0)}parse(a){return u.JSON.parse(a,void 0)}};function _l(){}_l.prototype.h=null;function jg(a){return a.h||(a.h=a.i())}function Bg(){}var Cs={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function wl(){We.call(this,"d")}x(wl,We);function El(){We.call(this,"c")}x(El,We);var cr={},qg=null;function wa(){return qg=qg||new He}cr.La="serverreachability";function $g(a){We.call(this,cr.La,a)}x($g,We);function Ss(a){let h=wa();et(h,new $g(h))}cr.STAT_EVENT="statevent";function zg(a,h){We.call(this,cr.STAT_EVENT,a),this.stat=h}x(zg,We);function tt(a){let h=wa();et(h,new zg(h,a))}cr.Ma="timingevent";function Gg(a,h){We.call(this,cr.Ma,a),this.size=h}x(Gg,We);function Rs(a,h){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){a()},h)}function Ds(){this.g=!0}Ds.prototype.xa=function(){this.g=!1};function CT(a,h,d,g,A,S){a.info(function(){if(a.g)if(S)for(var O="",he=S.split("&"),Ge=0;Ge<he.length;Ge++){var ue=he[Ge].split("=");if(1<ue.length){var Qe=ue[0];ue=ue[1];var Xe=Qe.split("_");O=2<=Xe.length&&Xe[1]=="type"?O+(Qe+"="+ue+"&"):O+(Qe+"=redacted&")}}else O=null;else O=S;return"XMLHTTP REQ ("+g+") [attempt "+A+"]: "+h+`
`+d+`
`+O})}function ST(a,h,d,g,A,S,O){a.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+A+"]: "+h+`
`+d+`
`+S+" "+O})}function ei(a,h,d,g){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+DT(a,d)+(g?" "+g:"")})}function RT(a,h){a.info(function(){return"TIMEOUT: "+h})}Ds.prototype.info=function(){};function DT(a,h){if(!a.g)return h;if(!h)return null;try{var d=JSON.parse(h);if(d){for(a=0;a<d.length;a++)if(Array.isArray(d[a])){var g=d[a];if(!(2>g.length)){var A=g[1];if(Array.isArray(A)&&!(1>A.length)){var S=A[0];if(S!="noop"&&S!="stop"&&S!="close")for(var O=1;O<A.length;O++)A[O]=""}}}}return vl(d)}catch{return h}}var Ea={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Kg={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Il;function Ia(){}x(Ia,_l),Ia.prototype.g=function(){return new XMLHttpRequest},Ia.prototype.i=function(){return{}},Il=new Ia;function Cn(a,h,d,g){this.j=a,this.i=h,this.l=d,this.R=g||1,this.U=new bs(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Wg}function Wg(){this.i=null,this.g="",this.h=!1}var Hg={},Tl={};function Al(a,h,d){a.L=1,a.v=Ca(cn(h)),a.m=d,a.P=!0,Qg(a,null)}function Qg(a,h){a.F=Date.now(),Ta(a),a.A=cn(a.v);var d=a.A,g=a.R;Array.isArray(g)||(g=[String(g)]),cm(d.i,"t",g),a.C=0,d=a.j.J,a.h=new Wg,a.g=Sm(a.j,d?h:null,!a.m),0<a.O&&(a.M=new TT(m(a.Y,a,a.g),a.O)),h=a.U,d=a.g,g=a.ca;var A="readystatechange";Array.isArray(A)||(A&&(Lg[0]=A.toString()),A=Lg);for(var S=0;S<A.length;S++){var O=xg(d,A[S],g||h.handleEvent,!1,h.h||h);if(!O)break;h.g[O.key]=O}h=a.H?y(a.H):{},a.m?(a.u||(a.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,h)):(a.u="GET",a.g.ea(a.A,a.u,null,h)),Ss(),CT(a.i,a.u,a.A,a.l,a.R,a.m)}Cn.prototype.ca=function(a){a=a.target;let h=this.M;h&&ln(a)==3?h.j():this.Y(a)},Cn.prototype.Y=function(a){try{if(a==this.g)e:{let Xe=ln(this.g);var h=this.g.Ba();let ri=this.g.Z();if(!(3>Xe)&&(Xe!=3||this.g&&(this.h.h||this.g.oa()||mm(this.g)))){this.J||Xe!=4||h==7||(h==8||0>=ri?Ss(3):Ss(2)),bl(this);var d=this.g.Z();this.X=d;t:if(Xg(this)){var g=mm(this.g);a="";var A=g.length,S=ln(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){lr(this),Ps(this);var O="";break t}this.h.i=new u.TextDecoder}for(h=0;h<A;h++)this.h.h=!0,a+=this.h.i.decode(g[h],{stream:!(S&&h==A-1)});g.length=0,this.h.g+=a,this.C=0,O=this.h.g}else O=this.g.oa();if(this.o=d==200,ST(this.i,this.u,this.A,this.l,this.R,Xe,d),this.o){if(this.T&&!this.K){t:{if(this.g){var he,Ge=this.g;if((he=Ge.g?Ge.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(he)){var ue=he;break t}}ue=null}if(d=ue)ei(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Cl(this,d);else{this.o=!1,this.s=3,tt(12),lr(this),Ps(this);break e}}if(this.P){d=!0;let Nt;for(;!this.J&&this.C<O.length;)if(Nt=PT(this,O),Nt==Tl){Xe==4&&(this.s=4,tt(14),d=!1),ei(this.i,this.l,null,"[Incomplete Response]");break}else if(Nt==Hg){this.s=4,tt(15),ei(this.i,this.l,O,"[Invalid Chunk]"),d=!1;break}else ei(this.i,this.l,Nt,null),Cl(this,Nt);if(Xg(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Xe!=4||O.length!=0||this.h.h||(this.s=1,tt(16),d=!1),this.o=this.o&&d,!d)ei(this.i,this.l,O,"[Invalid Chunked Response]"),lr(this),Ps(this);else if(0<O.length&&!this.W){this.W=!0;var Qe=this.j;Qe.g==this&&Qe.ba&&!Qe.M&&(Qe.j.info("Great, no buffering proxy detected. Bytes received: "+O.length),Vl(Qe),Qe.M=!0,tt(11))}}else ei(this.i,this.l,O,null),Cl(this,O);Xe==4&&lr(this),this.o&&!this.J&&(Xe==4?Tm(this.j,this):(this.o=!1,Ta(this)))}else WT(this.g),d==400&&0<O.indexOf("Unknown SID")?(this.s=3,tt(12)):(this.s=0,tt(13)),lr(this),Ps(this)}}}catch{}finally{}};function Xg(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function PT(a,h){var d=a.C,g=h.indexOf(`
`,d);return g==-1?Tl:(d=Number(h.substring(d,g)),isNaN(d)?Hg:(g+=1,g+d>h.length?Tl:(h=h.slice(g,g+d),a.C=g+d,h)))}Cn.prototype.cancel=function(){this.J=!0,lr(this)};function Ta(a){a.S=Date.now()+a.I,Jg(a,a.I)}function Jg(a,h){if(a.B!=null)throw Error("WatchDog timer not null");a.B=Rs(m(a.ba,a),h)}function bl(a){a.B&&(u.clearTimeout(a.B),a.B=null)}Cn.prototype.ba=function(){this.B=null;let a=Date.now();0<=a-this.S?(RT(this.i,this.A),this.L!=2&&(Ss(),tt(17)),lr(this),this.s=2,Ps(this)):Jg(this,this.S-a)};function Ps(a){a.j.G==0||a.J||Tm(a.j,a)}function lr(a){bl(a);var h=a.M;h&&typeof h.ma=="function"&&h.ma(),a.M=null,Ug(a.U),a.g&&(h=a.g,a.g=null,h.abort(),h.ma())}function Cl(a,h){try{var d=a.j;if(d.G!=0&&(d.g==a||Sl(d.h,a))){if(!a.K&&Sl(d.h,a)&&d.G==3){try{var g=d.Da.g.parse(h)}catch{g=null}if(Array.isArray(g)&&g.length==3){var A=g;if(A[0]==0){e:if(!d.u){if(d.g)if(d.g.F+3e3<a.F)xa(d),Da(d);else break e;xl(d),tt(18)}}else d.za=A[1],0<d.za-d.T&&37500>A[2]&&d.F&&d.v==0&&!d.C&&(d.C=Rs(m(d.Za,d),6e3));if(1>=em(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else dr(d,11)}else if((a.K||d.g==a)&&xa(d),!z(h))for(A=d.Da.g.parse(h),h=0;h<A.length;h++){let ue=A[h];if(d.T=ue[0],ue=ue[1],d.G==2)if(ue[0]=="c"){d.K=ue[1],d.ia=ue[2];let Qe=ue[3];Qe!=null&&(d.la=Qe,d.j.info("VER="+d.la));let Xe=ue[4];Xe!=null&&(d.Aa=Xe,d.j.info("SVER="+d.Aa));let ri=ue[5];ri!=null&&typeof ri=="number"&&0<ri&&(g=1.5*ri,d.L=g,d.j.info("backChannelRequestTimeoutMs_="+g)),g=d;let Nt=a.g;if(Nt){let Ma=Nt.g?Nt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ma){var S=g.h;S.g||Ma.indexOf("spdy")==-1&&Ma.indexOf("quic")==-1&&Ma.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(Rl(S,S.h),S.h=null))}if(g.D){let Ml=Nt.g?Nt.g.getResponseHeader("X-HTTP-Session-Id"):null;Ml&&(g.ya=Ml,me(g.I,g.D,Ml))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-a.F,d.j.info("Handshake RTT: "+d.R+"ms")),g=d;var O=a;if(g.qa=Cm(g,g.J?g.ia:null,g.W),O.K){tm(g.h,O);var he=O,Ge=g.L;Ge&&(he.I=Ge),he.B&&(bl(he),Ta(he)),g.g=O}else Em(g);0<d.i.length&&Pa(d)}else ue[0]!="stop"&&ue[0]!="close"||dr(d,7);else d.G==3&&(ue[0]=="stop"||ue[0]=="close"?ue[0]=="stop"?dr(d,7):Pl(d):ue[0]!="noop"&&d.l&&d.l.ta(ue),d.v=0)}}Ss(4)}catch{}}var xT=class{constructor(a,h){this.g=a,this.map=h}};function Yg(a){this.l=a||10,u.PerformanceNavigationTiming?(a=u.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Zg(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function em(a){return a.h?1:a.g?a.g.size:0}function Sl(a,h){return a.h?a.h==h:a.g?a.g.has(h):!1}function Rl(a,h){a.g?a.g.add(h):a.h=h}function tm(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}Yg.prototype.cancel=function(){if(this.i=nm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let a of this.g.values())a.cancel();this.g.clear()}};function nm(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let h=a.i;for(let d of a.g.values())h=h.concat(d.D);return h}return V(a.i)}function VT(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(c(a)){for(var h=[],d=a.length,g=0;g<d;g++)h.push(a[g]);return h}h=[],d=0;for(g in a)h[d++]=a[g];return h}function MT(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(c(a)||typeof a=="string"){var h=[];a=a.length;for(var d=0;d<a;d++)h.push(d);return h}h=[],d=0;for(let g in a)h[d++]=g;return h}}}function rm(a,h){if(a.forEach&&typeof a.forEach=="function")a.forEach(h,void 0);else if(c(a)||typeof a=="string")Array.prototype.forEach.call(a,h,void 0);else for(var d=MT(a),g=VT(a),A=g.length,S=0;S<A;S++)h.call(void 0,g[S],d&&d[S],a)}var im=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function NT(a,h){if(a){a=a.split("&");for(var d=0;d<a.length;d++){var g=a[d].indexOf("="),A=null;if(0<=g){var S=a[d].substring(0,g);A=a[d].substring(g+1)}else S=a[d];h(S,A?decodeURIComponent(A.replace(/\+/g," ")):"")}}}function hr(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof hr){this.h=a.h,Aa(this,a.j),this.o=a.o,this.g=a.g,ba(this,a.s),this.l=a.l;var h=a.i,d=new Ms;d.i=h.i,h.g&&(d.g=new Map(h.g),d.h=h.h),sm(this,d),this.m=a.m}else a&&(h=String(a).match(im))?(this.h=!1,Aa(this,h[1]||"",!0),this.o=xs(h[2]||""),this.g=xs(h[3]||"",!0),ba(this,h[4]),this.l=xs(h[5]||"",!0),sm(this,h[6]||"",!0),this.m=xs(h[7]||"")):(this.h=!1,this.i=new Ms(null,this.h))}hr.prototype.toString=function(){var a=[],h=this.j;h&&a.push(Vs(h,om,!0),":");var d=this.g;return(d||h=="file")&&(a.push("//"),(h=this.o)&&a.push(Vs(h,om,!0),"@"),a.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&a.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&a.push("/"),a.push(Vs(d,d.charAt(0)=="/"?FT:OT,!0))),(d=this.i.toString())&&a.push("?",d),(d=this.m)&&a.push("#",Vs(d,UT)),a.join("")};function cn(a){return new hr(a)}function Aa(a,h,d){a.j=d?xs(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function ba(a,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);a.s=h}else a.s=null}function sm(a,h,d){h instanceof Ms?(a.i=h,jT(a.i,a.h)):(d||(h=Vs(h,LT)),a.i=new Ms(h,a.h))}function me(a,h,d){a.i.set(h,d)}function Ca(a){return me(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function xs(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Vs(a,h,d){return typeof a=="string"?(a=encodeURI(a).replace(h,kT),d&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function kT(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var om=/[#\/\?@]/g,OT=/[#\?:]/g,FT=/[#\?]/g,LT=/[#\?@]/g,UT=/#/g;function Ms(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function Sn(a){a.g||(a.g=new Map,a.h=0,a.i&&NT(a.i,function(h,d){a.add(decodeURIComponent(h.replace(/\+/g," ")),d)}))}r=Ms.prototype,r.add=function(a,h){Sn(this),this.i=null,a=ti(this,a);var d=this.g.get(a);return d||this.g.set(a,d=[]),d.push(h),this.h+=1,this};function am(a,h){Sn(a),h=ti(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function um(a,h){return Sn(a),h=ti(a,h),a.g.has(h)}r.forEach=function(a,h){Sn(this),this.g.forEach(function(d,g){d.forEach(function(A){a.call(h,A,g,this)},this)},this)},r.na=function(){Sn(this);let a=Array.from(this.g.values()),h=Array.from(this.g.keys()),d=[];for(let g=0;g<h.length;g++){let A=a[g];for(let S=0;S<A.length;S++)d.push(h[g])}return d},r.V=function(a){Sn(this);let h=[];if(typeof a=="string")um(this,a)&&(h=h.concat(this.g.get(ti(this,a))));else{a=Array.from(this.g.values());for(let d=0;d<a.length;d++)h=h.concat(a[d])}return h},r.set=function(a,h){return Sn(this),this.i=null,a=ti(this,a),um(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},r.get=function(a,h){return a?(a=this.V(a),0<a.length?String(a[0]):h):h};function cm(a,h,d){am(a,h),0<d.length&&(a.i=null,a.g.set(ti(a,h),V(d)),a.h+=d.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";let a=[],h=Array.from(this.g.keys());for(var d=0;d<h.length;d++){var g=h[d];let S=encodeURIComponent(String(g)),O=this.V(g);for(g=0;g<O.length;g++){var A=S;O[g]!==""&&(A+="="+encodeURIComponent(String(O[g]))),a.push(A)}}return this.i=a.join("&")};function ti(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function jT(a,h){h&&!a.j&&(Sn(a),a.i=null,a.g.forEach(function(d,g){var A=g.toLowerCase();g!=A&&(am(this,g),cm(this,A,d))},a)),a.j=h}function BT(a,h){let d=new Ds;if(u.Image){let g=new Image;g.onload=w(Rn,d,"TestLoadImage: loaded",!0,h,g),g.onerror=w(Rn,d,"TestLoadImage: error",!1,h,g),g.onabort=w(Rn,d,"TestLoadImage: abort",!1,h,g),g.ontimeout=w(Rn,d,"TestLoadImage: timeout",!1,h,g),u.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=a}else h(!1)}function qT(a,h){let d=new Ds,g=new AbortController,A=setTimeout(()=>{g.abort(),Rn(d,"TestPingServer: timeout",!1,h)},1e4);fetch(a,{signal:g.signal}).then(S=>{clearTimeout(A),S.ok?Rn(d,"TestPingServer: ok",!0,h):Rn(d,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(A),Rn(d,"TestPingServer: error",!1,h)})}function Rn(a,h,d,g,A){try{A&&(A.onload=null,A.onerror=null,A.onabort=null,A.ontimeout=null),g(d)}catch{}}function $T(){this.g=new bT}function zT(a,h,d){let g=d||"";try{rm(a,function(A,S){let O=A;l(A)&&(O=vl(A)),h.push(g+S+"="+encodeURIComponent(O))})}catch(A){throw h.push(g+"type="+encodeURIComponent("_badmap")),A}}function Ns(a){this.l=a.Ub||null,this.j=a.eb||!1}x(Ns,_l),Ns.prototype.g=function(){return new Sa(this.l,this.j)},Ns.prototype.i=function(a){return function(){return a}}({});function Sa(a,h){He.call(this),this.D=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(Sa,He),r=Sa.prototype,r.open=function(a,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=h,this.readyState=1,Os(this)},r.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(h.body=a),(this.D||u).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ks(this)),this.readyState=0},r.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Os(this)),this.g&&(this.readyState=3,Os(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;lm(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function lm(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}r.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?ks(this):Os(this),this.readyState==3&&lm(this)}},r.Ra=function(a){this.g&&(this.response=this.responseText=a,ks(this))},r.Qa=function(a){this.g&&(this.response=a,ks(this))},r.ga=function(){this.g&&ks(this)};function ks(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Os(a)}r.setRequestHeader=function(a,h){this.u.append(a,h)},r.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";let a=[],h=this.h.entries();for(var d=h.next();!d.done;)d=d.value,a.push(d[0]+": "+d[1]),d=h.next();return a.join(`\r
`)};function Os(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Sa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function hm(a){let h="";return Y(a,function(d,g){h+=g,h+=":",h+=d,h+=`\r
`}),h}function Dl(a,h,d){e:{for(g in d){var g=!1;break e}g=!0}g||(d=hm(d),typeof a=="string"?d!=null&&encodeURIComponent(String(d)):me(a,h,d))}function Ce(a){He.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(Ce,He);var GT=/^https?$/i,KT=["POST","PUT"];r=Ce.prototype,r.Ha=function(a){this.J=a},r.ea=function(a,h,d,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Il.g(),this.v=this.o?jg(this.o):jg(Il),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(S){dm(this,S);return}if(a=d||"",d=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var A in g)d.set(A,g[A]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(let S of g.keys())d.set(S,g.get(S));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(d.keys()).find(S=>S.toLowerCase()=="content-type"),A=u.FormData&&a instanceof u.FormData,!(0<=Array.prototype.indexOf.call(KT,h,void 0))||g||A||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[S,O]of d)this.g.setRequestHeader(S,O);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{gm(this),this.u=!0,this.g.send(a),this.u=!1}catch(S){dm(this,S)}};function dm(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.m=5,fm(a),Ra(a)}function fm(a){a.A||(a.A=!0,et(a,"complete"),et(a,"error"))}r.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,et(this,"complete"),et(this,"abort"),Ra(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ra(this,!0)),Ce.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?pm(this):this.bb())},r.bb=function(){pm(this)};function pm(a){if(a.h&&typeof o<"u"&&(!a.v[1]||ln(a)!=4||a.Z()!=2)){if(a.u&&ln(a)==4)Og(a.Ea,0,a);else if(et(a,"readystatechange"),ln(a)==4){a.h=!1;try{let O=a.Z();e:switch(O){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var d;if(!(d=h)){var g;if(g=O===0){var A=String(a.D).match(im)[1]||null;!A&&u.self&&u.self.location&&(A=u.self.location.protocol.slice(0,-1)),g=!GT.test(A?A.toLowerCase():"")}d=g}if(d)et(a,"complete"),et(a,"success");else{a.m=6;try{var S=2<ln(a)?a.g.statusText:""}catch{S=""}a.l=S+" ["+a.Z()+"]",fm(a)}}finally{Ra(a)}}}}function Ra(a,h){if(a.g){gm(a);let d=a.g,g=a.v[0]?()=>{}:null;a.g=null,a.v=null,h||et(a,"ready");try{d.onreadystatechange=g}catch{}}}function gm(a){a.I&&(u.clearTimeout(a.I),a.I=null)}r.isActive=function(){return!!this.g};function ln(a){return a.g?a.g.readyState:0}r.Z=function(){try{return 2<ln(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(a){if(this.g){var h=this.g.responseText;return a&&h.indexOf(a)==0&&(h=h.substring(a.length)),AT(h)}};function mm(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function WT(a){let h={};a=(a.g&&2<=ln(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<a.length;g++){if(z(a[g]))continue;var d=T(a[g]);let A=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();let S=h[A]||[];h[A]=S,S.push(d)}E(h,function(g){return g.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Fs(a,h,d){return d&&d.internalChannelParams&&d.internalChannelParams[a]||h}function ym(a){this.Aa=0,this.i=[],this.j=new Ds,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Fs("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Fs("baseRetryDelayMs",5e3,a),this.cb=Fs("retryDelaySeedMs",1e4,a),this.Wa=Fs("forwardChannelMaxRetries",2,a),this.wa=Fs("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Yg(a&&a.concurrentRequestLimit),this.Da=new $T,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=ym.prototype,r.la=8,r.G=1,r.connect=function(a,h,d,g){tt(0),this.W=a,this.H=h||{},d&&g!==void 0&&(this.H.OSID=d,this.H.OAID=g),this.F=this.X,this.I=Cm(this,null,this.W),Pa(this)};function Pl(a){if(vm(a),a.G==3){var h=a.U++,d=cn(a.I);if(me(d,"SID",a.K),me(d,"RID",h),me(d,"TYPE","terminate"),Ls(a,d),h=new Cn(a,a.j,h),h.L=2,h.v=Ca(cn(d)),d=!1,u.navigator&&u.navigator.sendBeacon)try{d=u.navigator.sendBeacon(h.v.toString(),"")}catch{}!d&&u.Image&&(new Image().src=h.v,d=!0),d||(h.g=Sm(h.j,null),h.g.ea(h.v)),h.F=Date.now(),Ta(h)}bm(a)}function Da(a){a.g&&(Vl(a),a.g.cancel(),a.g=null)}function vm(a){Da(a),a.u&&(u.clearTimeout(a.u),a.u=null),xa(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&u.clearTimeout(a.s),a.s=null)}function Pa(a){if(!Zg(a.h)&&!a.s){a.s=!0;var h=a.Ga;Es||Pg(),Is||(Es(),Is=!0),cl.add(h,a),a.B=0}}function HT(a,h){return em(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=h.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=Rs(m(a.Ga,a,h),Am(a,a.B)),a.B++,!0)}r.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;let A=new Cn(this,this.j,a),S=this.o;if(this.S&&(S?(S=y(S),I(S,this.S)):S=this.S),this.m!==null||this.O||(A.H=S,S=null),this.P)e:{for(var h=0,d=0;d<this.i.length;d++){t:{var g=this.i[d];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(h+=g,4096<h){h=d;break e}if(h===4096||d===this.i.length-1){h=d+1;break e}}h=1e3}else h=1e3;h=wm(this,A,h),d=cn(this.I),me(d,"RID",a),me(d,"CVER",22),this.D&&me(d,"X-HTTP-Session-Id",this.D),Ls(this,d),S&&(this.O?h="headers="+encodeURIComponent(String(hm(S)))+"&"+h:this.m&&Dl(d,this.m,S)),Rl(this.h,A),this.Ua&&me(d,"TYPE","init"),this.P?(me(d,"$req",h),me(d,"SID","null"),A.T=!0,Al(A,d,null)):Al(A,d,h),this.G=2}}else this.G==3&&(a?_m(this,a):this.i.length==0||Zg(this.h)||_m(this))};function _m(a,h){var d;h?d=h.l:d=a.U++;let g=cn(a.I);me(g,"SID",a.K),me(g,"RID",d),me(g,"AID",a.T),Ls(a,g),a.m&&a.o&&Dl(g,a.m,a.o),d=new Cn(a,a.j,d,a.B+1),a.m===null&&(d.H=a.o),h&&(a.i=h.D.concat(a.i)),h=wm(a,d,1e3),d.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Rl(a.h,d),Al(d,g,h)}function Ls(a,h){a.H&&Y(a.H,function(d,g){me(h,g,d)}),a.l&&rm({},function(d,g){me(h,g,d)})}function wm(a,h,d){d=Math.min(a.i.length,d);var g=a.l?m(a.l.Na,a.l,a):null;e:{var A=a.i;let S=-1;for(;;){let O=["count="+d];S==-1?0<d?(S=A[0].g,O.push("ofs="+S)):S=0:O.push("ofs="+S);let he=!0;for(let Ge=0;Ge<d;Ge++){let ue=A[Ge].g,Qe=A[Ge].map;if(ue-=S,0>ue)S=Math.max(0,A[Ge].g-100),he=!1;else try{zT(Qe,O,"req"+ue+"_")}catch{g&&g(Qe)}}if(he){g=O.join("&");break e}}}return a=a.i.splice(0,d),h.D=a,g}function Em(a){if(!a.g&&!a.u){a.Y=1;var h=a.Fa;Es||Pg(),Is||(Es(),Is=!0),cl.add(h,a),a.v=0}}function xl(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=Rs(m(a.Fa,a),Am(a,a.v)),a.v++,!0)}r.Fa=function(){if(this.u=null,Im(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=Rs(m(this.ab,this),a)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,tt(10),Da(this),Im(this))};function Vl(a){a.A!=null&&(u.clearTimeout(a.A),a.A=null)}function Im(a){a.g=new Cn(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var h=cn(a.qa);me(h,"RID","rpc"),me(h,"SID",a.K),me(h,"AID",a.T),me(h,"CI",a.F?"0":"1"),!a.F&&a.ja&&me(h,"TO",a.ja),me(h,"TYPE","xmlhttp"),Ls(a,h),a.m&&a.o&&Dl(h,a.m,a.o),a.L&&(a.g.I=a.L);var d=a.g;a=a.ia,d.L=1,d.v=Ca(cn(h)),d.m=null,d.P=!0,Qg(d,a)}r.Za=function(){this.C!=null&&(this.C=null,Da(this),xl(this),tt(19))};function xa(a){a.C!=null&&(u.clearTimeout(a.C),a.C=null)}function Tm(a,h){var d=null;if(a.g==h){xa(a),Vl(a),a.g=null;var g=2}else if(Sl(a.h,h))d=h.D,tm(a.h,h),g=1;else return;if(a.G!=0){if(h.o)if(g==1){d=h.m?h.m.length:0,h=Date.now()-h.F;var A=a.B;g=wa(),et(g,new Gg(g,d)),Pa(a)}else Em(a);else if(A=h.s,A==3||A==0&&0<h.X||!(g==1&&HT(a,h)||g==2&&xl(a)))switch(d&&0<d.length&&(h=a.h,h.i=h.i.concat(d)),A){case 1:dr(a,5);break;case 4:dr(a,10);break;case 3:dr(a,6);break;default:dr(a,2)}}}function Am(a,h){let d=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(d*=2),d*h}function dr(a,h){if(a.j.info("Error code "+h),h==2){var d=m(a.fb,a),g=a.Xa;let A=!g;g=new hr(g||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Aa(g,"https"),Ca(g),A?BT(g.toString(),d):qT(g.toString(),d)}else tt(2);a.G=0,a.l&&a.l.sa(h),bm(a),vm(a)}r.fb=function(a){a?(this.j.info("Successfully pinged google.com"),tt(2)):(this.j.info("Failed to ping google.com"),tt(1))};function bm(a){if(a.G=0,a.ka=[],a.l){let h=nm(a.h);(h.length!=0||a.i.length!=0)&&(D(a.ka,h),D(a.ka,a.i),a.h.i.length=0,V(a.i),a.i.length=0),a.l.ra()}}function Cm(a,h,d){var g=d instanceof hr?cn(d):new hr(d);if(g.g!="")h&&(g.g=h+"."+g.g),ba(g,g.s);else{var A=u.location;g=A.protocol,h=h?h+"."+A.hostname:A.hostname,A=+A.port;var S=new hr(null);g&&Aa(S,g),h&&(S.g=h),A&&ba(S,A),d&&(S.l=d),g=S}return d=a.D,h=a.ya,d&&h&&me(g,d,h),me(g,"VER",a.la),Ls(a,g),g}function Sm(a,h,d){if(h&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=a.Ca&&!a.pa?new Ce(new Ns({eb:d})):new Ce(a.pa),h.Ha(a.J),h}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function Rm(){}r=Rm.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function Va(){}Va.prototype.g=function(a,h){return new yt(a,h)};function yt(a,h){He.call(this),this.g=new ym(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(a?a["X-WebChannel-Client-Profile"]=h.va:a={"X-WebChannel-Client-Profile":h.va}),this.g.S=a,(a=h&&h.Sb)&&!z(a)&&(this.g.m=a),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!z(h)&&(this.g.D=h,a=this.h,a!==null&&h in a&&(a=this.h,h in a&&delete a[h])),this.j=new ni(this)}x(yt,He),yt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},yt.prototype.close=function(){Pl(this.g)},yt.prototype.o=function(a){var h=this.g;if(typeof a=="string"){var d={};d.__data__=a,a=d}else this.u&&(d={},d.__data__=vl(a),a=d);h.i.push(new xT(h.Ya++,a)),h.G==3&&Pa(h)},yt.prototype.N=function(){this.g.l=null,delete this.j,Pl(this.g),delete this.g,yt.aa.N.call(this)};function Dm(a){wl.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){e:{for(let d in h){a=d;break e}a=void 0}(this.i=a)&&(a=this.i,h=h!==null&&a in h?h[a]:void 0),this.data=h}else this.data=a}x(Dm,wl);function Pm(){El.call(this),this.status=1}x(Pm,El);function ni(a){this.g=a}x(ni,Rm),ni.prototype.ua=function(){et(this.g,"a")},ni.prototype.ta=function(a){et(this.g,new Dm(a))},ni.prototype.sa=function(a){et(this.g,new Pm)},ni.prototype.ra=function(){et(this.g,"b")},Va.prototype.createWebChannel=Va.prototype.g,yt.prototype.send=yt.prototype.o,yt.prototype.open=yt.prototype.m,yt.prototype.close=yt.prototype.close,Pd=gn.createWebChannelTransport=function(){return new Va},Dd=gn.getStatEventTarget=function(){return wa()},Rd=gn.Event=cr,Bu=gn.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ea.NO_ERROR=0,Ea.TIMEOUT=8,Ea.HTTP_ERROR=6,Do=gn.ErrorCode=Ea,Kg.COMPLETE="complete",Sd=gn.EventType=Kg,Bg.EventType=Cs,Cs.OPEN="a",Cs.CLOSE="b",Cs.ERROR="c",Cs.MESSAGE="d",He.prototype.listen=He.prototype.K,Mi=gn.WebChannel=Bg,Cd=gn.FetchXmlHttpFactory=Ns,Ce.prototype.listenOnce=Ce.prototype.L,Ce.prototype.getLastError=Ce.prototype.Ka,Ce.prototype.getLastErrorCode=Ce.prototype.Ba,Ce.prototype.getStatus=Ce.prototype.Z,Ce.prototype.getResponseJson=Ce.prototype.Oa,Ce.prototype.getResponseText=Ce.prototype.oa,Ce.prototype.send=Ce.prototype.ea,Ce.prototype.setWithCredentials=Ce.prototype.Ha,bd=gn.XhrIo=Ce}).apply(typeof ju<"u"?ju:typeof self<"u"?self:typeof window<"u"?window:{});var O_="@firebase/firestore";var Fe=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Fe.UNAUTHENTICATED=new Fe(null),Fe.GOOGLE_CREDENTIALS=new Fe("google-credentials-uid"),Fe.FIRST_PARTY=new Fe("first-party-uid"),Fe.MOCK_USER=new Fe("mock-user");var ls="10.12.3";var Xn=new Ha("@firebase/firestore");function Li(){return Xn.logLevel}function Ow(r){Xn.setLogLevel(r)}function N(r,...e){if(Xn.logLevel<=Kt.DEBUG){let t=e.map(Np);Xn.debug(`Firestore (${ls}): ${r}`,...t)}}function Pe(r,...e){if(Xn.logLevel<=Kt.ERROR){let t=e.map(Np);Xn.error(`Firestore (${ls}): ${r}`,...t)}}function xt(r,...e){if(Xn.logLevel<=Kt.WARN){let t=e.map(Np);Xn.warn(`Firestore (${ls}): ${r}`,...t)}}function Np(r){if(typeof r=="string")return r;try{return function(t){return JSON.stringify(t)}(r)}catch{return r}}function q(r="Unexpected state"){let e=`FIRESTORE (${ls}) INTERNAL ASSERTION FAILED: `+r;throw Pe(e),new Error(e)}function G(r,e){r||q()}function Fw(r,e){r||q()}function U(r,e){return r}var R={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},M=class extends Iy{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Le=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Yu=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},kd=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Fe.UNAUTHENTICATED))}shutdown(){}},Od=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Fd=class{constructor(e){this.t=e,this.currentUser=Fe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i,i=c=>this.i!==n?(n=this.i,t(c)):Promise.resolve(),s=new Le;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Le,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>P(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},u=c=>{N("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>u(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?u(c):(N("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Le)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(N("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(G(typeof n.accessToken=="string"),new Yu(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return G(e===null||typeof e=="string"),new Fe(e)}},Ld=class{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=Fe.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Ud=class{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new Ld(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Fe.FIRST_PARTY))}shutdown(){}invalidateToken(){}},jd=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Bd=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let n=s=>{s.error!=null&&N("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,N("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};let i=s=>{N("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):N("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(G(typeof t.token=="string"),this.R=t.token,new jd(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function ES(r){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}var Zu=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";for(;n.length<20;){let i=ES(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+=e.charAt(i[s]%e.length))}return n}};function Z(r,e){return r<e?-1:r>e?1:0}function Wi(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}function Lw(r){return r+"\0"}var be=class r{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new M(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new M(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new M(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new M(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return r.fromMillis(Date.now())}static fromDate(e){return r.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new r(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Z(this.nanoseconds,e.nanoseconds):Z(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var W=class r{constructor(e){this.timestamp=e}static fromTimestamp(e){return new r(e)}static min(){return new r(new be(0,0))}static max(){return new r(new be(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var ec=class r{constructor(e,t,n){t===void 0?t=0:t>e.length&&q(),n===void 0?n=e.length-t:n>e.length-t&&q(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return r.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof r?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let n=Math.min(e.length,t.length);for(let i=0;i<n;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},oe=class r extends ec{construct(e,t,n){return new r(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let n of e){if(n.indexOf("//")>=0)throw new M(R.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new r(t)}static emptyPath(){return new r([])}},IS=/^[_a-zA-Z][_a-zA-Z0-9]*$/,xe=class r extends ec{construct(e,t,n){return new r(e,t,n)}static isValidIdentifier(e){return IS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),r.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new r(["__name__"])}static fromServerFormat(e){let t=[],n="",i=0,s=()=>{if(n.length===0)throw new M(R.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""},o=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new M(R.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new M(R.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else u==="`"?(o=!o,i++):u!=="."||o?(n+=u,i++):(s(),i++)}if(s(),o)throw new M(R.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new r(t)}static emptyPath(){return new r([])}};var L=class r{constructor(e){this.path=e}static fromPath(e){return new r(oe.fromString(e))}static fromName(e){return new r(oe.fromString(e).popFirst(5))}static empty(){return new r(oe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&oe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return oe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new r(new oe(e.slice()))}};var Hi=class{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}};function qd(r){return r.fields.find(e=>e.kind===2)}function Dr(r){return r.fields.filter(e=>e.kind!==2)}Hi.UNKNOWN_ID=-1;var zi=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var Bo=class r{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new r(0,Vt.min())}};function Uw(r,e){let t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=W.fromTimestamp(n===1e9?new be(t+1,0):new be(t,n));return new Vt(i,L.empty(),e)}function jw(r){return new Vt(r.readTime,r.key,-1)}var Vt=class r{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new r(W.min(),L.empty(),-1)}static max(){return new r(W.max(),L.empty(),-1)}};function kp(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=L.comparator(r.documentKey,e.documentKey),t!==0?t:Z(r.largestBatchId,e.largestBatchId))}var Bw="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",tc=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function or(r){return P(this,null,function*(){if(r.code!==R.FAILED_PRECONDITION||r.message!==Bw)throw r;N("LocalStore","Unexpectedly lost primary lease")})}var C=class r{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&q(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new r((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof r?t:r.resolve(t)}catch(t){return r.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):r.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):r.reject(t)}static resolve(e){return new r((t,n)=>{t(e)})}static reject(e){return new r((t,n)=>{n(e)})}static waitFor(e){return new r((t,n)=>{let i=0,s=0,o=!1;e.forEach(u=>{++i,u.next(()=>{++s,o&&s===i&&t()},c=>n(c))}),o=!0,s===i&&t()})}static or(e){let t=r.resolve(!1);for(let n of e)t=t.next(i=>i?r.resolve(i):n());return t}static forEach(e,t){let n=[];return e.forEach((i,s)=>{n.push(t.call(this,i,s))}),this.waitFor(n)}static mapArray(e,t){return new r((n,i)=>{let s=e.length,o=new Array(s),u=0;for(let c=0;c<s;c++){let l=c;t(e[l]).next(f=>{o[l]=f,++u,u===s&&n(o)},f=>i(f))}})}static doWhile(e,t){return new r((n,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):n()};s()})}};var nc=class r{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Le,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new kr(e,t.error)):this.V.resolve()},this.transaction.onerror=n=>{let i=Op(n.target.error);this.V.reject(new kr(e,i))}}static open(e,t,n,i){try{return new r(t,e.transaction(i,n))}catch(s){throw new kr(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(N("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new zd(t)}},Jn=class r{constructor(e,t,n){this.name=e,this.version=t,this.p=n,r.S(Ks())===12.2&&Pe("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return N("SimpleDb","Removing database:",e),Pr(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Wa())return!1;if(r.C())return!0;let e=Ks(),t=r.S(e),n=0<t&&t<10,i=qw(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}M(e){return P(this,null,function*(){return this.db||(N("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,n)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{n(new kr(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?n(new M(R.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?n(new M(R.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):n(new kr(e,o))},i.onupgradeneeded=s=>{N("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{N("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,n,i){return P(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let u=nc.open(this.db,e,s?"readonly":"readwrite",n),c=i(u).next(l=>(u.g(),l)).catch(l=>(u.abort(l),C.reject(l))).toPromise();return c.catch(()=>{}),yield u.m,c}catch(u){let c=u,l=c.name!=="FirebaseError"&&o<3;if(N("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function qw(r){let e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var $d=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Pr(this.B.delete())}},kr=class extends M{constructor(e,t){super(R.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function ar(r){return r.name==="IndexedDbTransactionError"}var zd=class{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(N("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(N("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Pr(n)}add(e){return N("SimpleDb","ADD",this.store.name,e,e),Pr(this.store.add(e))}get(e){return Pr(this.store.get(e)).next(t=>(t===void 0&&(t=null),N("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return N("SimpleDb","DELETE",this.store.name,e),Pr(this.store.delete(e))}count(){return N("SimpleDb","COUNT",this.store.name),Pr(this.store.count())}U(e,t){let n=this.options(e,t),i=n.index?this.store.index(n.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(n.range);return new C((o,u)=>{s.onerror=c=>{u(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(n),o=[];return this.W(s,(u,c)=>{o.push(c)}).next(()=>o)}}G(e,t){let n=this.store.getAll(e,t===null?void 0:t);return new C((i,s)=>{n.onerror=o=>{s(o.target.error)},n.onsuccess=o=>{i(o.target.result)}})}j(e,t){N("SimpleDb","DELETE ALL",this.store.name);let n=this.options(e,t);n.H=!1;let i=this.cursor(n);return this.W(i,(s,o,u)=>u.delete())}J(e,t){let n;t?n=e:(n={},t=e);let i=this.cursor(n);return this.W(i,t)}Y(e){let t=this.cursor({});return new C((n,i)=>{t.onerror=s=>{let o=Op(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(u=>{u?o.continue():n()}):n()}})}W(e,t){let n=[];return new C((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let u=o.target.result;if(!u)return void i();let c=new $d(u),l=t(u.primaryKey,u.value,c);if(l instanceof C){let f=l.catch(p=>(c.done(),C.reject(p)));n.push(f)}c.isDone?i():c.K===null?u.continue():u.continue(c.K)}}).next(()=>C.waitFor(n))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function Pr(r){return new C((e,t)=>{r.onsuccess=n=>{let i=n.target.result;e(i)},r.onerror=n=>{let i=Op(n.target.error);t(i)}})}var F_=!1;function Op(r){let e=Jn.S(Ks());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(r.message.indexOf(t)>=0){let n=new M("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return F_||(F_=!0,setTimeout(()=>{throw n},0)),n}}return r}var Gd=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){N("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>P(this,null,function*(){this.task=null;try{N("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){ar(t)?N("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield or(t)}yield this.X(6e4)}))}},Kd=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return P(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let n=new Set,i=t,s=!0;return C.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!n.has(o))return N("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(u=>{i-=u,n.add(o)});s=!1})).next(()=>t-i)}ne(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,n).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(u=>(N("IndexBackfiller",`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(e,t,u))).next(()=>o.size)}))}re(e,t){let n=e;return t.changes.forEach((i,s)=>{let o=jw(s);kp(o,n)>0&&(n=o)}),new Vt(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}};var Et=(()=>{class r{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.ie(i),this.se=i=>n.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return r.oe=-1,r})();function ca(r){return r==null}function qo(r){return r===0&&1/r==-1/0}function $w(r){return typeof r=="number"&&Number.isInteger(r)&&!qo(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}function it(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=L_(e)),e=TS(r.get(t),e);return L_(e)}function TS(r,e){let t=e,n=r.length;for(let i=0;i<n;i++){let s=r.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function L_(r){return r+""}function Jt(r){let e=r.length;if(G(e>=2),e===2)return G(r.charAt(0)===""&&r.charAt(1)===""),oe.emptyPath();let t=e-2,n=[],i="";for(let s=0;s<e;){let o=r.indexOf("",s);switch((o<0||o>t)&&q(),r.charAt(o+1)){case"":let u=r.substring(s,o),c;i.length===0?c=u:(i+=u,c=i,i=""),n.push(c);break;case"":i+=r.substring(s,o),i+="\0";break;case"":i+=r.substring(s,o+1);break;default:q()}s=o+2}return new oe(n)}var U_=["userId","batchId"];function Ku(r,e){return[r,it(e)]}function zw(r,e,t){return[r,it(e),t]}var AS={},bS=["prefixPath","collectionGroup","readTime","documentId"],CS=["prefixPath","collectionGroup","documentId"],SS=["collectionGroup","readTime","prefixPath","documentId"],RS=["canonicalId","targetId"],DS=["targetId","path"],PS=["path","targetId"],xS=["collectionId","parent"],VS=["indexId","uid"],MS=["uid","sequenceNumber"],NS=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],kS=["indexId","uid","orderedDocumentKey"],OS=["userId","collectionPath","documentId"],FS=["userId","collectionPath","largestBatchId"],LS=["userId","collectionGroup","largestBatchId"],Gw=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],US=[...Gw,"documentOverlays"],Kw=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Ww=Kw,Hw=[...Ww,"indexConfiguration","indexState","indexEntries"],jS=Hw;var $o=class extends tc{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function ze(r,e){let t=U(r);return Jn.F(t._e,e)}function j_(r){let e=0;for(let t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function Wr(r,e){for(let t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function Qw(r){for(let e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}var Ee=class r{constructor(e,t){this.comparator=e,this.root=t||Zt.EMPTY}insert(e,t){return new r(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Zt.BLACK,null,null))}remove(e){return new r(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Zt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){let i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){let e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $i(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $i(this.root,e,this.comparator,!1)}getReverseIterator(){return new $i(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $i(this.root,e,this.comparator,!0)}},$i=class{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Zt=class r{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??r.RED,this.left=i??r.EMPTY,this.right=s??r.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new r(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this,s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return r.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return r.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,r.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,r.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw q();let e=this.left.check();if(e!==this.right.check())throw q();return e+(this.isRed()?0:1)}};Zt.EMPTY=null,Zt.RED=!0,Zt.BLACK=!1;Zt.EMPTY=new class{constructor(){this.size=0}get key(){throw q()}get value(){throw q()}get color(){throw q()}get left(){throw q()}get right(){throw q()}copy(e,t,n,i,s){return this}insert(e,t,n){return new Zt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var fe=class r{constructor(e){this.comparator=e,this.data=new Ee(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){let n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){let i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new rc(this.data.getIterator())}getIteratorFrom(e){return new rc(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof r)||this.size!==e.size)return!1;let t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new r(this.comparator);return t.data=e,t}},rc=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Ni(r){return r.hasNext()?r.getNext():void 0}var It=class r{constructor(e){this.fields=e,e.sort(xe.comparator)}static empty(){return new r([])}unionWith(e){let t=new fe(xe.comparator);for(let n of this.fields)t=t.add(n);for(let n of e)t=t.add(n);return new r(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Wi(this.fields,e.fields,(t,n)=>t.isEqual(n))}};var ic=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function Xw(){return typeof atob<"u"}var $e=class r{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new ic("Invalid base64 string: "+s):s}}(e);return new r(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new r(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Z(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};$e.EMPTY_BYTE_STRING=new $e("");var BS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vn(r){if(G(!!r),typeof r=="string"){let e=0,t=BS.exec(r);if(G(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Re(r.seconds),nanos:Re(r.nanos)}}function Re(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function Yn(r){return typeof r=="string"?$e.fromBase64String(r):$e.fromUint8Array(r)}function Hc(r){var e,t;return((t=(((e=r?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Fp(r){let e=r.mapValue.fields.__previous_value__;return Hc(e)?Fp(e):e}function zo(r){let e=vn(r.mapValue.fields.__local_write_time__.timestampValue);return new be(e.seconds,e.nanos)}var Wd=class{constructor(e,t,n,i,s,o,u,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=c,this.useFetchStreams=l}},Zn=class r{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new r("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof r&&e.projectId===this.projectId&&e.database===this.database}};var Hn={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Wu={nullValue:"NULL_VALUE"};function Or(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?Hc(r)?4:Jw(r)?9007199254740991:10:q()}function nn(r,e){if(r===e)return!0;let t=Or(r);if(t!==Or(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return zo(r).isEqual(zo(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=vn(i.timestampValue),u=vn(s.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(i,s){return Yn(i.bytesValue).isEqual(Yn(s.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(i,s){return Re(i.geoPointValue.latitude)===Re(s.geoPointValue.latitude)&&Re(i.geoPointValue.longitude)===Re(s.geoPointValue.longitude)}(r,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Re(i.integerValue)===Re(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Re(i.doubleValue),u=Re(s.doubleValue);return o===u?qo(o)===qo(u):isNaN(o)&&isNaN(u)}return!1}(r,e);case 9:return Wi(r.arrayValue.values||[],e.arrayValue.values||[],nn);case 10:return function(i,s){let o=i.mapValue.fields||{},u=s.mapValue.fields||{};if(j_(o)!==j_(u))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(u[c]===void 0||!nn(o[c],u[c])))return!1;return!0}(r,e);default:return q()}}function Go(r,e){return(r.values||[]).find(t=>nn(t,e))!==void 0}function er(r,e){if(r===e)return 0;let t=Or(r),n=Or(e);if(t!==n)return Z(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Z(r.booleanValue,e.booleanValue);case 2:return function(s,o){let u=Re(s.integerValue||s.doubleValue),c=Re(o.integerValue||o.doubleValue);return u<c?-1:u>c?1:u===c?0:isNaN(u)?isNaN(c)?0:-1:1}(r,e);case 3:return B_(r.timestampValue,e.timestampValue);case 4:return B_(zo(r),zo(e));case 5:return Z(r.stringValue,e.stringValue);case 6:return function(s,o){let u=Yn(s),c=Yn(o);return u.compareTo(c)}(r.bytesValue,e.bytesValue);case 7:return function(s,o){let u=s.split("/"),c=o.split("/");for(let l=0;l<u.length&&l<c.length;l++){let f=Z(u[l],c[l]);if(f!==0)return f}return Z(u.length,c.length)}(r.referenceValue,e.referenceValue);case 8:return function(s,o){let u=Z(Re(s.latitude),Re(o.latitude));return u!==0?u:Z(Re(s.longitude),Re(o.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return function(s,o){let u=s.values||[],c=o.values||[];for(let l=0;l<u.length&&l<c.length;++l){let f=er(u[l],c[l]);if(f)return f}return Z(u.length,c.length)}(r.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Hn.mapValue&&o===Hn.mapValue)return 0;if(s===Hn.mapValue)return 1;if(o===Hn.mapValue)return-1;let u=s.fields||{},c=Object.keys(u),l=o.fields||{},f=Object.keys(l);c.sort(),f.sort();for(let p=0;p<c.length&&p<f.length;++p){let m=Z(c[p],f[p]);if(m!==0)return m;let w=er(u[c[p]],l[f[p]]);if(w!==0)return w}return Z(c.length,f.length)}(r.mapValue,e.mapValue);default:throw q()}}function B_(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return Z(r,e);let t=vn(r),n=vn(e),i=Z(t.seconds,n.seconds);return i!==0?i:Z(t.nanos,n.nanos)}function Qi(r){return Hd(r)}function Hd(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){let n=vn(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return Yn(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return L.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",i=!0;for(let s of t.values||[])i?i=!1:n+=",",n+=Hd(s);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){let n=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of n)s?s=!1:i+=",",i+=`${o}:${Hd(t.fields[o])}`;return i+"}"}(r.mapValue):q()}function Fr(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function Qd(r){return!!r&&"integerValue"in r}function Ko(r){return!!r&&"arrayValue"in r}function q_(r){return!!r&&"nullValue"in r}function $_(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function Hu(r){return!!r&&"mapValue"in r}function Oo(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){let e={mapValue:{fields:{}}};return Wr(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Oo(n)),e}if(r.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Oo(r.arrayValue.values[t]);return e}return Object.assign({},r)}function Jw(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function qS(r){return"nullValue"in r?Wu:"booleanValue"in r?{booleanValue:!1}:"integerValue"in r||"doubleValue"in r?{doubleValue:NaN}:"timestampValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in r?{stringValue:""}:"bytesValue"in r?{bytesValue:""}:"referenceValue"in r?Fr(Zn.empty(),L.empty()):"geoPointValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in r?{arrayValue:{}}:"mapValue"in r?{mapValue:{}}:q()}function $S(r){return"nullValue"in r?{booleanValue:!1}:"booleanValue"in r?{doubleValue:NaN}:"integerValue"in r||"doubleValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in r?{stringValue:""}:"stringValue"in r?{bytesValue:""}:"bytesValue"in r?Fr(Zn.empty(),L.empty()):"referenceValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in r?{arrayValue:{}}:"arrayValue"in r?{mapValue:{}}:"mapValue"in r?Hn:q()}function z_(r,e){let t=er(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?-1:!r.inclusive&&e.inclusive?1:0}function G_(r,e){let t=er(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?1:!r.inclusive&&e.inclusive?-1:0}var Ze=class r{constructor(e){this.value=e}static empty(){return new r({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Hu(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Oo(t)}setAll(e){let t=xe.emptyPath(),n={},i=[];e.forEach((o,u)=>{if(!t.isImmediateParentOf(u)){let c=this.getFieldsMap(t);this.applyChanges(c,n,i),n={},i=[],t=u.popLast()}o?n[u.lastSegment()]=Oo(o):i.push(u.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){let t=this.field(e.popLast());Hu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return nn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];Hu(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){Wr(t,(i,s)=>e[i]=s);for(let i of n)delete e[i]}clone(){return new r(Oo(this.value))}};function Yw(r){let e=[];return Wr(r.fields,(t,n)=>{let i=new xe([t]);if(Hu(n)){let s=Yw(n.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new It(e)}var Ue=class r{constructor(e,t,n,i,s,o,u){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=o,this.documentState=u}static newInvalidDocument(e){return new r(e,0,W.min(),W.min(),W.min(),Ze.empty(),0)}static newFoundDocument(e,t,n,i){return new r(e,1,t,W.min(),n,i,0)}static newNoDocument(e,t){return new r(e,2,t,W.min(),W.min(),Ze.empty(),0)}static newUnknownDocument(e,t){return new r(e,3,t,W.min(),W.min(),Ze.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(W.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ze.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ze.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=W.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof r&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new r(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var rn=class{constructor(e,t){this.position=e,this.inclusive=t}};function K_(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){let s=e[i],o=r.position[i];if(s.field.isKeyField()?n=L.comparator(L.fromName(o.referenceValue),t.key):n=er(o,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function W_(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!nn(r.position[t],e.position[t]))return!1;return!0}var Lr=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function zS(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}var sc=class{},ie=class r extends sc{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new Yd(e,t,n):t==="array-contains"?new tf(e,n):t==="in"?new oc(e,n):t==="not-in"?new nf(e,n):t==="array-contains-any"?new rf(e,n):new r(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new Zd(e,n):new ef(e,n)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(er(t,this.value)):t!==null&&Or(this.value)===Or(t)&&this.matchesComparison(er(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return q()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},le=class r extends sc{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new r(e,t)}matches(e){return Xi(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function Xi(r){return r.op==="and"}function Xd(r){return r.op==="or"}function Lp(r){return Zw(r)&&Xi(r)}function Zw(r){for(let e of r.filters)if(e instanceof le)return!1;return!0}function Jd(r){if(r instanceof ie)return r.field.canonicalString()+r.op.toString()+Qi(r.value);if(Lp(r))return r.filters.map(e=>Jd(e)).join(",");{let e=r.filters.map(t=>Jd(t)).join(",");return`${r.op}(${e})`}}function eE(r,e){return r instanceof ie?function(n,i){return i instanceof ie&&n.op===i.op&&n.field.isEqual(i.field)&&nn(n.value,i.value)}(r,e):r instanceof le?function(n,i){return i instanceof le&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,o,u)=>s&&eE(o,i.filters[u]),!0):!1}(r,e):void q()}function tE(r,e){let t=r.filters.concat(e);return le.create(t,r.op)}function nE(r){return r instanceof ie?function(t){return`${t.field.canonicalString()} ${t.op} ${Qi(t.value)}`}(r):r instanceof le?function(t){return t.op.toString()+" {"+t.getFilters().map(nE).join(" ,")+"}"}(r):"Filter"}var Yd=class extends ie{constructor(e,t,n){super(e,t,n),this.key=L.fromName(n.referenceValue)}matches(e){let t=L.comparator(e.key,this.key);return this.matchesComparison(t)}},Zd=class extends ie{constructor(e,t){super(e,"in",t),this.keys=rE("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},ef=class extends ie{constructor(e,t){super(e,"not-in",t),this.keys=rE("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function rE(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>L.fromName(n.referenceValue))}var tf=class extends ie{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Ko(t)&&Go(t.arrayValue,this.value)}},oc=class extends ie{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Go(this.value.arrayValue,t)}},nf=class extends ie{constructor(e,t){super(e,"not-in",t)}matches(e){if(Go(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Go(this.value.arrayValue,t)}},rf=class extends ie{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Ko(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>Go(this.value.arrayValue,n))}};var sf=class{constructor(e,t=null,n=[],i=[],s=null,o=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=o,this.endAt=u,this.ue=null}};function of(r,e=null,t=[],n=[],i=null,s=null,o=null){return new sf(r,e,t,n,i,s,o)}function Ur(r){let e=U(r);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>Jd(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),ca(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Qi(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Qi(n)).join(",")),e.ue=t}return e.ue}function la(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!zS(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!eE(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!W_(r.startAt,e.startAt)&&W_(r.endAt,e.endAt)}function ac(r){return L.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}function uc(r,e){return r.filters.filter(t=>t instanceof ie&&t.field.isEqual(e))}function H_(r,e,t){let n=Wu,i=!0;for(let s of uc(r,e)){let o=Wu,u=!0;switch(s.op){case"<":case"<=":o=qS(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,u=!1;break;case"!=":case"not-in":o=Wu}z_({value:n,inclusive:i},{value:o,inclusive:u})<0&&(n=o,i=u)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){let o=t.position[s];z_({value:n,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(n=o,i=t.inclusive);break}}return{value:n,inclusive:i}}function Q_(r,e,t){let n=Hn,i=!0;for(let s of uc(r,e)){let o=Hn,u=!0;switch(s.op){case">=":case">":o=$S(s.value),u=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,u=!1;break;case"!=":case"not-in":o=Hn}G_({value:n,inclusive:i},{value:o,inclusive:u})>0&&(n=o,i=u)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){let o=t.position[s];G_({value:n,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(n=o,i=t.inclusive);break}}return{value:n,inclusive:i}}var Lt=class{constructor(e,t=null,n=[],i=[],s=null,o="F",u=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=o,this.startAt=u,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function iE(r,e,t,n,i,s,o,u){return new Lt(r,e,t,n,i,s,o,u)}function hs(r){return new Lt(r)}function X_(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function Up(r){return r.collectionGroup!==null}function Gi(r){let e=U(r);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new fe(xe.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(u=u.add(l.field))})}),u})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Lr(s,n))}),t.has(xe.keyField().canonicalString())||e.ce.push(new Lr(xe.keyField(),n))}return e.ce}function st(r){let e=U(r);return e.le||(e.le=GS(e,Gi(r))),e.le}function GS(r,e){if(r.limitType==="F")return of(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Lr(i.field,s)});let t=r.endAt?new rn(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new rn(r.startAt.position,r.startAt.inclusive):null;return of(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function af(r,e){let t=r.filters.concat([e]);return new Lt(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function cc(r,e,t){return new Lt(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function ha(r,e){return la(st(r),st(e))&&r.limitType===e.limitType}function sE(r){return`${Ur(st(r))}|lt:${r.limitType}`}function Ui(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>nE(i)).join(", ")}]`),ca(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>Qi(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>Qi(i)).join(",")),`Target(${n})`}(st(r))}; limitType=${r.limitType})`}function da(r,e){return e.isFoundDocument()&&function(n,i){let s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):L.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(r,e)&&function(n,i){for(let s of Gi(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(r,e)&&function(n,i){for(let s of n.filters)if(!s.matches(i))return!1;return!0}(r,e)&&function(n,i){return!(n.startAt&&!function(o,u,c){let l=K_(o,u,c);return o.inclusive?l<=0:l<0}(n.startAt,Gi(n),i)||n.endAt&&!function(o,u,c){let l=K_(o,u,c);return o.inclusive?l>=0:l>0}(n.endAt,Gi(n),i))}(r,e)}function oE(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function aE(r){return(e,t)=>{let n=!1;for(let i of Gi(r)){let s=KS(i,e,t);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function KS(r,e,t){let n=r.field.isKeyField()?L.comparator(e.key,t.key):function(s,o,u){let c=o.data.field(s),l=u.data.field(s);return c!==null&&l!==null?er(c,l):q()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return q()}}var sn=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(let[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Wr(this.inner,(t,n)=>{for(let[i,s]of n)e(i,s)})}isEmpty(){return Qw(this.inner)}size(){return this.innerSize}};var WS=new Ee(L.comparator);function mt(){return WS}var uE=new Ee(L.comparator);function No(...r){let e=uE;for(let t of r)e=e.insert(t.key,t);return e}function cE(r){let e=uE;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Yt(){return Fo()}function lE(){return Fo()}function Fo(){return new sn(r=>r.toString(),(r,e)=>r.isEqual(e))}var HS=new Ee(L.comparator),QS=new fe(L.comparator);function te(...r){let e=QS;for(let t of r)e=e.add(t);return e}var XS=new fe(Z);function jp(){return XS}function hE(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qo(e)?"-0":e}}function dE(r){return{integerValue:""+r}}function fE(r,e){return $w(e)?dE(e):hE(r,e)}var Ji=class{constructor(){this._=void 0}};function JS(r,e,t){return r instanceof tr?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Hc(s)&&(s=Fp(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):r instanceof _n?gE(r,e):r instanceof wn?mE(r,e):function(i,s){let o=pE(i,s),u=J_(o)+J_(i.Pe);return Qd(o)&&Qd(i.Pe)?dE(u):hE(i.serializer,u)}(r,e)}function YS(r,e,t){return r instanceof _n?gE(r,e):r instanceof wn?mE(r,e):t}function pE(r,e){return r instanceof nr?function(n){return Qd(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}var tr=class extends Ji{},_n=class extends Ji{constructor(e){super(),this.elements=e}};function gE(r,e){let t=yE(e);for(let n of r.elements)t.some(i=>nn(i,n))||t.push(n);return{arrayValue:{values:t}}}var wn=class extends Ji{constructor(e){super(),this.elements=e}};function mE(r,e){let t=yE(e);for(let n of r.elements)t=t.filter(i=>!nn(i,n));return{arrayValue:{values:t}}}var nr=class extends Ji{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function J_(r){return Re(r.integerValue||r.doubleValue)}function yE(r){return Ko(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}var jr=class{constructor(e,t){this.field=e,this.transform=t}};function ZS(r,e){return r.field.isEqual(e.field)&&function(n,i){return n instanceof _n&&i instanceof _n||n instanceof wn&&i instanceof wn?Wi(n.elements,i.elements,nn):n instanceof nr&&i instanceof nr?nn(n.Pe,i.Pe):n instanceof tr&&i instanceof tr}(r.transform,e.transform)}var uf=class{constructor(e,t){this.version=e,this.transformResults=t}},De=class r{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new r}static exists(e){return new r(void 0,e)}static updateTime(e){return new r(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Qu(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}var Yi=class{};function vE(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new ir(r.key,De.none()):new rr(r.key,r.data,De.none());{let t=r.data,n=Ze.empty(),i=new fe(xe.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?n.delete(s):n.set(s,o),i=i.add(s)}return new Ut(r.key,n,new It(i.toArray()),De.none())}}function eR(r,e,t){r instanceof rr?function(i,s,o){let u=i.value.clone(),c=Z_(i.fieldTransforms,s,o.transformResults);u.setAll(c),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(r,e,t):r instanceof Ut?function(i,s,o){if(!Qu(i.precondition,s))return void s.convertToUnknownDocument(o.version);let u=Z_(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(_E(i)),c.setAll(u),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(r,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Lo(r,e,t,n){return r instanceof rr?function(s,o,u,c){if(!Qu(s.precondition,o))return u;let l=s.value.clone(),f=ew(s.fieldTransforms,c,o);return l.setAll(f),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(r,e,t,n):r instanceof Ut?function(s,o,u,c){if(!Qu(s.precondition,o))return u;let l=ew(s.fieldTransforms,c,o),f=o.data;return f.setAll(_E(s)),f.setAll(l),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(r,e,t,n):function(s,o,u){return Qu(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u}(r,e,t)}function tR(r,e){let t=null;for(let n of r.fieldTransforms){let i=e.data.field(n.field),s=pE(n.transform,i||null);s!=null&&(t===null&&(t=Ze.empty()),t.set(n.field,s))}return t||null}function Y_(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Wi(n,i,(s,o)=>ZS(s,o))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}var rr=class extends Yi{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Ut=class extends Yi{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function _E(r){let e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let n=r.data.field(t);e.set(t,n)}}),e}function Z_(r,e,t){let n=new Map;G(r.length===t.length);for(let i=0;i<t.length;i++){let s=r[i],o=s.transform,u=e.data.field(s.field);n.set(s.field,YS(o,u,t[i]))}return n}function ew(r,e,t){let n=new Map;for(let i of r){let s=i.transform,o=t.data.field(i.field);n.set(i.field,JS(s,o,e))}return n}var ir=class extends Yi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Wo=class extends Yi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Ho=class{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){let n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&eR(s,e,n[i])}}applyToLocalView(e,t){for(let n of this.baseMutations)n.key.isEqual(e.key)&&(t=Lo(n,e,t,this.localWriteTime));for(let n of this.mutations)n.key.isEqual(e.key)&&(t=Lo(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let n=lE();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,u=this.applyToLocalView(o,s.mutatedFields);u=t.has(i.key)?null:u;let c=vE(o,u);c!==null&&n.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(W.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),te())}isEqual(e){return this.batchId===e.batchId&&Wi(this.mutations,e.mutations,(t,n)=>Y_(t,n))&&Wi(this.baseMutations,e.baseMutations,(t,n)=>Y_(t,n))}},cf=class r{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){G(e.mutations.length===n.length);let i=function(){return HS}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,n[o].version);return new r(e,t,n,i)}};var Qo=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var lf=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ke,se;function wE(r){switch(r){default:return q();case R.CANCELLED:case R.UNKNOWN:case R.DEADLINE_EXCEEDED:case R.RESOURCE_EXHAUSTED:case R.INTERNAL:case R.UNAVAILABLE:case R.UNAUTHENTICATED:return!1;case R.INVALID_ARGUMENT:case R.NOT_FOUND:case R.ALREADY_EXISTS:case R.PERMISSION_DENIED:case R.FAILED_PRECONDITION:case R.ABORTED:case R.OUT_OF_RANGE:case R.UNIMPLEMENTED:case R.DATA_LOSS:return!0}}function EE(r){if(r===void 0)return Pe("GRPC error has no .code"),R.UNKNOWN;switch(r){case ke.OK:return R.OK;case ke.CANCELLED:return R.CANCELLED;case ke.UNKNOWN:return R.UNKNOWN;case ke.DEADLINE_EXCEEDED:return R.DEADLINE_EXCEEDED;case ke.RESOURCE_EXHAUSTED:return R.RESOURCE_EXHAUSTED;case ke.INTERNAL:return R.INTERNAL;case ke.UNAVAILABLE:return R.UNAVAILABLE;case ke.UNAUTHENTICATED:return R.UNAUTHENTICATED;case ke.INVALID_ARGUMENT:return R.INVALID_ARGUMENT;case ke.NOT_FOUND:return R.NOT_FOUND;case ke.ALREADY_EXISTS:return R.ALREADY_EXISTS;case ke.PERMISSION_DENIED:return R.PERMISSION_DENIED;case ke.FAILED_PRECONDITION:return R.FAILED_PRECONDITION;case ke.ABORTED:return R.ABORTED;case ke.OUT_OF_RANGE:return R.OUT_OF_RANGE;case ke.UNIMPLEMENTED:return R.UNIMPLEMENTED;case ke.DATA_LOSS:return R.DATA_LOSS;default:return q()}}(se=ke||(ke={}))[se.OK=0]="OK",se[se.CANCELLED=1]="CANCELLED",se[se.UNKNOWN=2]="UNKNOWN",se[se.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",se[se.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",se[se.NOT_FOUND=5]="NOT_FOUND",se[se.ALREADY_EXISTS=6]="ALREADY_EXISTS",se[se.PERMISSION_DENIED=7]="PERMISSION_DENIED",se[se.UNAUTHENTICATED=16]="UNAUTHENTICATED",se[se.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",se[se.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",se[se.ABORTED=10]="ABORTED",se[se.OUT_OF_RANGE=11]="OUT_OF_RANGE",se[se.UNIMPLEMENTED=12]="UNIMPLEMENTED",se[se.INTERNAL=13]="INTERNAL",se[se.UNAVAILABLE=14]="UNAVAILABLE",se[se.DATA_LOSS=15]="DATA_LOSS";var tw=null;function IE(){return new TextEncoder}var nR=new $n([4294967295,4294967295],0);function nw(r){let e=IE().encode(r),t=new Ad;return t.update(e),new Uint8Array(t.digest())}function rw(r){let e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new $n([t,n],0),new $n([i,s],0)]}var hf=class r{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Nr(`Invalid padding: ${t}`);if(n<0)throw new Nr(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Nr(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Nr(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=$n.fromNumber(this.Ie)}Ee(e,t,n){let i=e.add(t.multiply($n.fromNumber(n)));return i.compare(nR)===1&&(i=new $n([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=nw(e),[n,i]=rw(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(n,i,s);if(!this.de(o))return!1}return!0}static create(e,t,n){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new r(s,i,t);return n.forEach(u=>o.insert(u)),o}insert(e){if(this.Ie===0)return;let t=nw(e),[n,i]=rw(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(n,i,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}},Nr=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Xo=class r{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){let i=new Map;return i.set(e,Jo.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new r(W.min(),i,new Ee(Z),mt(),te())}},Jo=class r{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new r(n,t,te(),te(),te())}};var Ki=class{constructor(e,t,n,i){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=i}},lc=class{constructor(e,t){this.targetId=e,this.me=t}},hc=class{constructor(e,t,n=$e.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}},dc=class{constructor(){this.fe=0,this.ge=sw(),this.pe=$e.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=te(),t=te(),n=te();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:q()}}),new Jo(this.pe,this.ye,e,t,n)}ve(){this.we=!1,this.ge=sw()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,G(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},df=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=mt(),this.qe=iw(),this.Qe=new Ee(Z)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.ve(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:q()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((n,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,n=e.me.count,i=this.Je(t);if(i){let s=i.target;if(ac(s))if(n===0){let o=new L(s.path);this.Ue(t,o,Ue.newNoDocument(o,W.min()))}else G(n===1);else{let o=this.Ye(t);if(o!==n){let u=this.Ze(e),c=u?this.Xe(u,e,o):1;if(c!==0){this.je(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}tw?.et(function(f,p,m,w,x){var V,D,k,z,F,$;let X={localCacheCount:f,existenceFilterCount:p.count,databaseId:m.database,projectId:m.projectId},Y=p.unchangedNames;return Y&&(X.bloomFilter={applied:x===0,hashCount:(V=Y?.hashCount)!==null&&V!==void 0?V:0,bitmapLength:(z=(k=(D=Y?.bits)===null||D===void 0?void 0:D.bitmap)===null||k===void 0?void 0:k.length)!==null&&z!==void 0?z:0,padding:($=(F=Y?.bits)===null||F===void 0?void 0:F.padding)!==null&&$!==void 0?$:0,mightContain:E=>{var y;return(y=w?.mightContain(E))!==null&&y!==void 0&&y}}),X}(o,e.me,this.Le.tt(),u,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=t,o,u;try{o=Yn(n).toUint8Array()}catch(c){if(c instanceof ic)return xt("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{u=new hf(o,i,s)}catch(c){return xt(c instanceof Nr?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return u.Ie===0?null:u}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){let n=this.Le.getRemoteKeysForTarget(t),i=0;return n.forEach(s=>{let o=this.Le.tt(),u=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let u=this.Je(o);if(u){if(s.current&&ac(u.target)){let c=new L(u.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Ue.newNoDocument(c,e))}s.be&&(t.set(o,s.Ce()),s.ve())}});let n=te();this.qe.forEach((s,o)=>{let u=!0;o.forEachWhile(c=>{let l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(n=n.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new Xo(e,t,this.Qe,this.ke,n);return this.ke=mt(),this.qe=iw(),this.Qe=new Ee(Z),i}$e(e,t){if(!this.ze(e))return;let n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new dc,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new fe(Z),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||N("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new dc),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function iw(){return new Ee(L.comparator)}function sw(){return new Ee(L.comparator)}var rR={asc:"ASCENDING",desc:"DESCENDING"},iR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},sR={and:"AND",or:"OR"},ff=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function pf(r,e){return r.useProto3Json||ca(e)?e:{value:e}}function Zi(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function TE(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function oR(r,e){return Zi(r,e.toTimestamp())}function Ve(r){return G(!!r),W.fromTimestamp(function(t){let n=vn(t);return new be(n.seconds,n.nanos)}(r))}function Bp(r,e){return gf(r,e).canonicalString()}function gf(r,e){let t=function(i){return new oe(["projects",i.projectId,"databases",i.database])}(r).child("documents");return e===void 0?t:t.child(e)}function AE(r){let e=oe.fromString(r);return G(NE(e)),e}function Yo(r,e){return Bp(r.databaseId,e.path)}function en(r,e){let t=AE(e);if(t.get(1)!==r.databaseId.projectId)throw new M(R.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new M(R.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new L(SE(t))}function bE(r,e){return Bp(r.databaseId,e)}function CE(r){let e=AE(r);return e.length===4?oe.emptyPath():SE(e)}function mf(r){return new oe(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function SE(r){return G(r.length>4&&r.get(4)==="documents"),r.popFirst(5)}function ow(r,e,t){return{name:Yo(r,e),fields:t.value.mapValue.fields}}function RE(r,e,t){let n=en(r,e.name),i=Ve(e.updateTime),s=e.createTime?Ve(e.createTime):W.min(),o=new Ze({mapValue:{fields:e.fields}}),u=Ue.newFoundDocument(n,i,s,o);return t&&u.setHasCommittedMutations(),t?u.setHasCommittedMutations():u}function aR(r,e){return"found"in e?function(n,i){G(!!i.found),i.found.name,i.found.updateTime;let s=en(n,i.found.name),o=Ve(i.found.updateTime),u=i.found.createTime?Ve(i.found.createTime):W.min(),c=new Ze({mapValue:{fields:i.found.fields}});return Ue.newFoundDocument(s,o,u,c)}(r,e):"missing"in e?function(n,i){G(!!i.missing),G(!!i.readTime);let s=en(n,i.missing),o=Ve(i.readTime);return Ue.newNoDocument(s,o)}(r,e):q()}function uR(r,e){let t;if("targetChange"in e){e.targetChange;let n=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:q()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,f){return l.useProto3Json?(G(f===void 0||typeof f=="string"),$e.fromBase64String(f||"")):(G(f===void 0||f instanceof Buffer||f instanceof Uint8Array),$e.fromUint8Array(f||new Uint8Array))}(r,e.targetChange.resumeToken),o=e.targetChange.cause,u=o&&function(l){let f=l.code===void 0?R.UNKNOWN:EE(l.code);return new M(f,l.message||"")}(o);t=new hc(n,i,s,u||null)}else if("documentChange"in e){e.documentChange;let n=e.documentChange;n.document,n.document.name,n.document.updateTime;let i=en(r,n.document.name),s=Ve(n.document.updateTime),o=n.document.createTime?Ve(n.document.createTime):W.min(),u=new Ze({mapValue:{fields:n.document.fields}}),c=Ue.newFoundDocument(i,s,o,u),l=n.targetIds||[],f=n.removedTargetIds||[];t=new Ki(l,f,c.key,c)}else if("documentDelete"in e){e.documentDelete;let n=e.documentDelete;n.document;let i=en(r,n.document),s=n.readTime?Ve(n.readTime):W.min(),o=Ue.newNoDocument(i,s),u=n.removedTargetIds||[];t=new Ki([],u,o.key,o)}else if("documentRemove"in e){e.documentRemove;let n=e.documentRemove;n.document;let i=en(r,n.document),s=n.removedTargetIds||[];t=new Ki([],s,i,null)}else{if(!("filter"in e))return q();{e.filter;let n=e.filter;n.targetId;let{count:i=0,unchangedNames:s}=n,o=new lf(i,s),u=n.targetId;t=new lc(u,o)}}return t}function Zo(r,e){let t;if(e instanceof rr)t={update:ow(r,e.key,e.value)};else if(e instanceof ir)t={delete:Yo(r,e.key)};else if(e instanceof Ut)t={update:ow(r,e.key,e.data),updateMask:pR(e.fieldMask)};else{if(!(e instanceof Wo))return q();t={verify:Yo(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(s,o){let u=o.transform;if(u instanceof tr)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof _n)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof wn)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof nr)return{fieldPath:o.field.canonicalString(),increment:u.Pe};throw q()}(0,n))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:oR(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:q()}(r,e.precondition)),t}function yf(r,e){let t=e.currentDocument?function(s){return s.updateTime!==void 0?De.updateTime(Ve(s.updateTime)):s.exists!==void 0?De.exists(s.exists):De.none()}(e.currentDocument):De.none(),n=e.updateTransforms?e.updateTransforms.map(i=>function(o,u){let c=null;if("setToServerValue"in u)G(u.setToServerValue==="REQUEST_TIME"),c=new tr;else if("appendMissingElements"in u){let f=u.appendMissingElements.values||[];c=new _n(f)}else if("removeAllFromArray"in u){let f=u.removeAllFromArray.values||[];c=new wn(f)}else"increment"in u?c=new nr(o,u.increment):q();let l=xe.fromServerFormat(u.fieldPath);return new jr(l,c)}(r,i)):[];if(e.update){e.update.name;let i=en(r,e.update.name),s=new Ze({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let l=c.fieldPaths||[];return new It(l.map(f=>xe.fromServerFormat(f)))}(e.updateMask);return new Ut(i,s,o,t,n)}return new rr(i,s,t,n)}if(e.delete){let i=en(r,e.delete);return new ir(i,t)}if(e.verify){let i=en(r,e.verify);return new Wo(i,t)}return q()}function cR(r,e){return r&&r.length>0?(G(e!==void 0),r.map(t=>function(i,s){let o=i.updateTime?Ve(i.updateTime):Ve(s);return o.isEqual(W.min())&&(o=Ve(s)),new uf(o,i.transformResults||[])}(t,e))):[]}function DE(r,e){return{documents:[bE(r,e.path)]}}function PE(r,e){let t={structuredQuery:{}},n=e.path,i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=bE(r,i);let s=function(l){if(l.length!==0)return ME(le.create(l,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(l){if(l.length!==0)return l.map(f=>function(m){return{field:ji(m.field),direction:hR(m.dir)}}(f))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let u=pf(r,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function xE(r){let e=CE(r.parent),t=r.structuredQuery,n=t.from?t.from.length:0,i=null;if(n>0){G(n===1);let f=t.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=function(p){let m=VE(p);return m instanceof le&&Lp(m)?m.getFilters():[m]}(t.where));let o=[];t.orderBy&&(o=function(p){return p.map(m=>function(x){return new Lr(Bi(x.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(m))}(t.orderBy));let u=null;t.limit&&(u=function(p){let m;return m=typeof p=="object"?p.value:p,ca(m)?null:m}(t.limit));let c=null;t.startAt&&(c=function(p){let m=!!p.before,w=p.values||[];return new rn(w,m)}(t.startAt));let l=null;return t.endAt&&(l=function(p){let m=!p.before,w=p.values||[];return new rn(w,m)}(t.endAt)),iE(e,i,o,s,u,"F",c,l)}function lR(r,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return q()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function VE(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let n=Bi(t.unaryFilter.field);return ie.create(n,"==",{doubleValue:NaN});case"IS_NULL":let i=Bi(t.unaryFilter.field);return ie.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Bi(t.unaryFilter.field);return ie.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Bi(t.unaryFilter.field);return ie.create(o,"!=",{nullValue:"NULL_VALUE"});default:return q()}}(r):r.fieldFilter!==void 0?function(t){return ie.create(Bi(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return q()}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return le.create(t.compositeFilter.filters.map(n=>VE(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return q()}}(t.compositeFilter.op))}(r):q()}function hR(r){return rR[r]}function dR(r){return iR[r]}function fR(r){return sR[r]}function ji(r){return{fieldPath:r.canonicalString()}}function Bi(r){return xe.fromServerFormat(r.fieldPath)}function ME(r){return r instanceof ie?function(t){if(t.op==="=="){if($_(t.value))return{unaryFilter:{field:ji(t.field),op:"IS_NAN"}};if(q_(t.value))return{unaryFilter:{field:ji(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if($_(t.value))return{unaryFilter:{field:ji(t.field),op:"IS_NOT_NAN"}};if(q_(t.value))return{unaryFilter:{field:ji(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ji(t.field),op:dR(t.op),value:t.value}}}(r):r instanceof le?function(t){let n=t.getFilters().map(i=>ME(i));return n.length===1?n[0]:{compositeFilter:{op:fR(t.op),filters:n}}}(r):q()}function pR(r){let e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function NE(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}var es=class r{constructor(e,t,n,i,s=W.min(),o=W.min(),u=$e.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=c}withSequenceNumber(e){return new r(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new r(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var fc=class{constructor(e){this.ct=e}};function gR(r,e){let t;if(e.document)t=RE(r.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let n=L.fromSegments(e.noDocument.path),i=qr(e.noDocument.readTime);t=Ue.newNoDocument(n,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return q();{let n=L.fromSegments(e.unknownDocument.path),i=qr(e.unknownDocument.version);t=Ue.newUnknownDocument(n,i)}}return e.readTime&&t.setReadTime(function(i){let s=new be(i[0],i[1]);return W.fromTimestamp(s)}(e.readTime)),t}function aw(r,e){let t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:pc(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(s,o){return{name:Yo(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Zi(s,o.version.toTimestamp()),createTime:Zi(s,o.createTime.toTimestamp())}}(r.ct,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:Br(e.version)};else{if(!e.isUnknownDocument())return q();n.unknownDocument={path:t.path.toArray(),version:Br(e.version)}}return n}function pc(r){let e=r.toTimestamp();return[e.seconds,e.nanoseconds]}function Br(r){let e=r.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function qr(r){let e=new be(r.seconds,r.nanoseconds);return W.fromTimestamp(e)}function xr(r,e){let t=(e.baseMutations||[]).map(s=>yf(r.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let u=e.mutations[s+1];o.updateTransforms=u.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let n=e.mutations.map(s=>yf(r.ct,s)),i=be.fromMillis(e.localWriteTimeMs);return new Ho(e.batchId,i,t,n)}function ko(r){let e=qr(r.readTime),t=r.lastLimboFreeSnapshotVersion!==void 0?qr(r.lastLimboFreeSnapshotVersion):W.min(),n;return n=function(s){return s.documents!==void 0}(r.query)?function(s){return G(s.documents.length===1),st(hs(CE(s.documents[0])))}(r.query):function(s){return st(xE(s))}(r.query),new es(n,r.targetId,"TargetPurposeListen",r.lastListenSequenceNumber,e,t,$e.fromBase64String(r.resumeToken))}function kE(r,e){let t=Br(e.snapshotVersion),n=Br(e.lastLimboFreeSnapshotVersion),i;i=ac(e.target)?DE(r.ct,e.target):PE(r.ct,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ur(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:i}}function qp(r){let e=xE({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?cc(e,e.limit,"L"):e}function xd(r,e){return new Qo(e.largestBatchId,yf(r.ct,e.overlayMutation))}function uw(r,e){let t=e.path.lastSegment();return[r,it(e.path.popLast()),t]}function cw(r,e,t,n){return{indexId:r,uid:e,sequenceNumber:t,readTime:Br(n.readTime),documentKey:it(n.documentKey.path),largestBatchId:n.largestBatchId}}var vf=class{getBundleMetadata(e,t){return lw(e).get(t).next(n=>{if(n)return function(s){return{id:s.bundleId,createTime:qr(s.createTime),version:s.version}}(n)})}saveBundleMetadata(e,t){return lw(e).put(function(i){return{bundleId:i.id,createTime:Br(Ve(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return hw(e).get(t).next(n=>{if(n)return function(s){return{name:s.name,query:qp(s.bundledQuery),readTime:qr(s.readTime)}}(n)})}saveNamedQuery(e,t){return hw(e).put(function(i){return{name:i.name,readTime:Br(Ve(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function lw(r){return ze(r,"bundles")}function hw(r){return ze(r,"namedQueries")}var gc=class r{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let n=t.uid||"";return new r(e,n)}getOverlay(e,t){return Po(e).get(uw(this.userId,t)).next(n=>n?xd(this.serializer,n):null)}getOverlays(e,t){let n=Yt();return C.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){let i=[];return n.forEach((s,o)=>{let u=new Qo(t,o);i.push(this.ht(e,u))}),C.waitFor(i)}removeOverlaysForBatchId(e,t,n){let i=new Set;t.forEach(o=>i.add(it(o.getCollectionPath())));let s=[];return i.forEach(o=>{let u=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,n+1],!1,!0);s.push(Po(e).j("collectionPathOverlayIndex",u))}),C.waitFor(s)}getOverlaysForCollection(e,t,n){let i=Yt(),s=it(t),o=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Po(e).U("collectionPathOverlayIndex",o).next(u=>{for(let c of u){let l=xd(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,n,i){let s=Yt(),o,u=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Po(e).J({index:"collectionGroupOverlayIndex",range:u},(c,l,f)=>{let p=xd(this.serializer,l);s.size()<i||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):f.done()}).next(()=>s)}ht(e,t){return Po(e).put(function(i,s,o){let[u,c,l]=uw(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Zo(i.ct,o.mutation)}}(this.serializer,this.userId,t))}};function Po(r){return ze(r,"documentOverlays")}var mn=class{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(Re(e.integerValue));else if("doubleValue"in e){let n=Re(e.doubleValue);isNaN(n)?this.Et(t,13):(this.Et(t,15),qo(n)?t.dt(0):t.dt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Et(t,20),typeof n=="string"&&(n=vn(n)),t.At(`${n.seconds||""}`),t.dt(n.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(Yn(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){let n=e.geoPointValue;this.Et(t,45),t.dt(n.latitude||0),t.dt(n.longitude||0)}else"mapValue"in e?Jw(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):q()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){let n=e.fields||{};this.Et(t,55);for(let i of Object.keys(n))this.Rt(i,t),this.It(n[i],t)}wt(e,t){let n=e.values||[];this.Et(t,50);for(let i of n)this.It(i,t)}gt(e,t){this.Et(t,37),L.fromName(e).path.forEach(n=>{this.Et(t,60),this.St(n,t)})}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}};mn.bt=new mn;function mR(r){if(r===0)return 8;let e=0;return!(r>>4)&&(e+=4,r<<=4),!(r>>6)&&(e+=2,r<<=2),!(r>>7)&&(e+=1),e}function dw(r){let e=64-function(n){let i=0;for(let s=0;s<8;++s){let o=mR(255&n[s]);if(i+=o,o!==8)break}return i}(r);return Math.ceil(e/8)}var _f=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let t=e[Symbol.iterator](),n=t.next();for(;!n.done;)this.Ct(n.value),n=t.next();this.vt()}Ft(e){let t=e[Symbol.iterator](),n=t.next();for(;!n.done;)this.Mt(n.value),n=t.next();this.xt()}Ot(e){for(let t of e){let n=t.charCodeAt(0);if(n<128)this.Ct(n);else if(n<2048)this.Ct(960|n>>>6),this.Ct(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Ct(480|n>>>12),this.Ct(128|63&n>>>6),this.Ct(128|63&n);else{let i=t.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let t of e){let n=t.charCodeAt(0);if(n<128)this.Mt(n);else if(n<2048)this.Mt(960|n>>>6),this.Mt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Mt(480|n>>>12),this.Mt(128|63&n>>>6),this.Mt(128|63&n);else{let i=t.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Lt(e){let t=this.Bt(e),n=dw(t);this.kt(1+n),this.buffer[this.position++]=255&n;for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=255&t[i]}qt(e){let t=this.Bt(e),n=dw(t);this.kt(1+n),this.buffer[this.position++]=~(255&n);for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){let t=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),n=(128&t[0])!=0;t[0]^=n?255:128;for(let i=1;i<t.length;++i)t[i]^=n?255:0;return t}Ct(e){let t=255&e;t===0?(this.Kt(0),this.Kt(255)):t===255?(this.Kt(255),this.Kt(0)):this.Kt(t)}Mt(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);let i=new Uint8Array(n);i.set(this.buffer),this.buffer=i}},wf=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}},Ef=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},Vr=class{constructor(){this.Gt=new _f,this.zt=new wf(this.Gt),this.jt=new Ef(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var Mr=class r{constructor(e,t,n,i){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=i}Jt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new r(this.indexId,this.documentKey,this.arrayValue,n)}};function zn(r,e){let t=r.indexId-e.indexId;return t!==0?t:(t=fw(r.arrayValue,e.arrayValue),t!==0?t:(t=fw(r.directionalValue,e.directionalValue),t!==0?t:L.comparator(r.documentKey,e.documentKey)))}function fw(r,e){for(let t=0;t<r.length&&t<e.length;++t){let n=r[t]-e[t];if(n!==0)return n}return r.length-e.length}var mc=class{constructor(e){this.Yt=new fe((t,n)=>xe.comparator(t.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let t of e.filters){let n=t;n.isInequality()?this.Yt=this.Yt.add(n):this.Xt.push(n)}}get en(){return this.Yt.size>1}tn(e){if(G(e.collectionGroup===this.collectionId),this.en)return!1;let t=qd(e);if(t!==void 0&&!this.nn(t))return!1;let n=Dr(e),i=new Set,s=0,o=0;for(;s<n.length&&this.nn(n[s]);++s)i=i.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.Yt.size>0){let u=this.Yt.getIterator().getNext();if(!i.has(u.field.canonicalString())){let c=n[s];if(!this.rn(u,c)||!this.sn(this.Zt[o++],c))return!1}++s}for(;s<n.length;++s){let u=n[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],u))return!1}return!0}on(){if(this.en)return null;let e=new fe(xe.comparator),t=[];for(let n of this.Xt)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new zi(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new zi(n.field,0))}for(let n of this.Zt)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new zi(n.field,n.dir==="asc"?0:1)));return new Hi(Hi.UNKNOWN_ID,this.collectionId,t,Bo.empty())}nn(e){for(let t of this.Xt)if(this.rn(t,e))return!0;return!1}rn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function OE(r){var e,t;if(G(r instanceof ie||r instanceof le),r instanceof ie){if(r instanceof oc){let i=((t=(e=r.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>ie.create(r.field,"==",s)))||[];return le.create(i,"or")}return r}let n=r.filters.map(i=>OE(i));return le.create(n,r.op)}function yR(r){if(r.getFilters().length===0)return[];let e=Af(OE(r));return G(FE(e)),If(e)||Tf(e)?[e]:e.getFilters()}function If(r){return r instanceof ie}function Tf(r){return r instanceof le&&Lp(r)}function FE(r){return If(r)||Tf(r)||function(t){if(t instanceof le&&Xd(t)){for(let n of t.getFilters())if(!If(n)&&!Tf(n))return!1;return!0}return!1}(r)}function Af(r){if(G(r instanceof ie||r instanceof le),r instanceof ie)return r;if(r.filters.length===1)return Af(r.filters[0]);let e=r.filters.map(n=>Af(n)),t=le.create(e,r.op);return t=yc(t),FE(t)?t:(G(t instanceof le),G(Xi(t)),G(t.filters.length>1),t.filters.reduce((n,i)=>$p(n,i)))}function $p(r,e){let t;return G(r instanceof ie||r instanceof le),G(e instanceof ie||e instanceof le),t=r instanceof ie?e instanceof ie?function(i,s){return le.create([i,s],"and")}(r,e):pw(r,e):e instanceof ie?pw(e,r):function(i,s){if(G(i.filters.length>0&&s.filters.length>0),Xi(i)&&Xi(s))return tE(i,s.getFilters());let o=Xd(i)?i:s,u=Xd(i)?s:i,c=o.filters.map(l=>$p(l,u));return le.create(c,"or")}(r,e),yc(t)}function pw(r,e){if(Xi(e))return tE(e,r.getFilters());{let t=e.filters.map(n=>$p(r,n));return le.create(t,"or")}}function yc(r){if(G(r instanceof ie||r instanceof le),r instanceof ie)return r;let e=r.getFilters();if(e.length===1)return yc(e[0]);if(Zw(r))return r;let t=e.map(i=>yc(i)),n=[];return t.forEach(i=>{i instanceof ie?n.push(i):i instanceof le&&(i.op===r.op?n.push(...i.filters):n.push(i))}),n.length===1?n[0]:le.create(n,r.op)}var bf=class{constructor(){this._n=new ea}addToCollectionParentIndex(e,t){return this._n.add(t),C.resolve()}getCollectionParents(e,t){return C.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return C.resolve()}deleteFieldIndex(e,t){return C.resolve()}deleteAllFieldIndexes(e){return C.resolve()}createTargetIndexes(e,t){return C.resolve()}getDocumentsMatchingTarget(e,t){return C.resolve(null)}getIndexType(e,t){return C.resolve(0)}getFieldIndexes(e,t){return C.resolve([])}getNextCollectionGroupToUpdate(e){return C.resolve(null)}getMinOffset(e,t){return C.resolve(Vt.min())}getMinOffsetFromCollectionGroup(e,t){return C.resolve(Vt.min())}updateCollectionGroup(e,t,n){return C.resolve()}updateIndexEntries(e,t){return C.resolve()}},ea=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new fe(oe.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){let t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new fe(oe.comparator)).toArray()}};var qu=new Uint8Array(0),Cf=class{constructor(e,t){this.databaseId=t,this.an=new ea,this.un=new sn(n=>Ur(n),(n,i)=>la(n,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.an.has(t)){let n=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.an.add(t)});let s={collectionId:n,parent:it(i)};return gw(e).put(s)}return C.resolve()}getCollectionParents(e,t){let n=[],i=IDBKeyRange.bound([t,""],[Lw(t),""],!1,!0);return gw(e).U(i).next(s=>{for(let o of s){if(o.collectionId!==t)break;n.push(Jt(o.parent))}return n})}addFieldIndex(e,t){let n=xo(e),i=function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;let s=n.add(i);if(t.indexState){let o=Oi(e);return s.next(u=>{o.put(cw(u,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let n=xo(e),i=Oi(e),s=ki(e);return n.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=xo(e),n=ki(e),i=Oi(e);return t.j().next(()=>n.j()).next(()=>i.j())}createTargetIndexes(e,t){return C.forEach(this.cn(t),n=>this.getIndexType(e,n).next(i=>{if(i===0||i===1){let s=new mc(n).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let n=ki(e),i=!0,s=new Map;return C.forEach(this.cn(t),o=>this.ln(e,o).next(u=>{i&&(i=!!u),s.set(o,u)})).next(()=>{if(i){let o=te(),u=[];return C.forEach(s,(c,l)=>{N("IndexedDbIndexManager",`Using index ${function(F){return`id=${F.indexId}|cg=${F.collectionGroup}|f=${F.fields.map($=>`${$.fieldPath}:${$.kind}`).join(",")}`}(c)} to execute ${Ur(t)}`);let f=function(F,$){let X=qd($);if(X===void 0)return null;for(let Y of uc(F,X.fieldPath))switch(Y.op){case"array-contains-any":return Y.value.arrayValue.values||[];case"array-contains":return[Y.value]}return null}(l,c),p=function(F,$){let X=new Map;for(let Y of Dr($))for(let E of uc(F,Y.fieldPath))switch(E.op){case"==":case"in":X.set(Y.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return X.set(Y.fieldPath.canonicalString(),E.value),Array.from(X.values())}return null}(l,c),m=function(F,$){let X=[],Y=!0;for(let E of Dr($)){let y=E.kind===0?H_(F,E.fieldPath,F.startAt):Q_(F,E.fieldPath,F.startAt);X.push(y.value),Y&&(Y=y.inclusive)}return new rn(X,Y)}(l,c),w=function(F,$){let X=[],Y=!0;for(let E of Dr($)){let y=E.kind===0?Q_(F,E.fieldPath,F.endAt):H_(F,E.fieldPath,F.endAt);X.push(y.value),Y&&(Y=y.inclusive)}return new rn(X,Y)}(l,c),x=this.hn(c,l,m),V=this.hn(c,l,w),D=this.Pn(c,l,p),k=this.In(c.indexId,f,x,m.inclusive,V,w.inclusive,D);return C.forEach(k,z=>n.G(z,t.limit).next(F=>{F.forEach($=>{let X=L.fromSegments($.documentKey);o.has(X)||(o=o.add(X),u.push(X))})}))}).next(()=>u)}return C.resolve(null)})}cn(e){let t=this.un.get(e);return t||(e.filters.length===0?t=[e]:t=yR(le.create(e.filters,"and")).map(n=>of(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}In(e,t,n,i,s,o,u){let c=(t!=null?t.length:1)*Math.max(n.length,s.length),l=c/(t!=null?t.length:1),f=[];for(let p=0;p<c;++p){let m=t?this.Tn(t[p/l]):qu,w=this.En(e,m,n[p%l],i),x=this.dn(e,m,s[p%l],o),V=u.map(D=>this.En(e,m,D,!0));f.push(...this.createRange(w,x,V))}return f}En(e,t,n,i){let s=new Mr(e,L.empty(),t,n);return i?s:s.Jt()}dn(e,t,n,i){let s=new Mr(e,L.empty(),t,n);return i?s.Jt():s}ln(e,t){let n=new mc(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let u of s)n.tn(u)&&(!o||u.fields.length>o.fields.length)&&(o=u);return o})}getIndexType(e,t){let n=2,i=this.cn(t);return C.forEach(i,s=>this.ln(e,s).next(o=>{o?n!==0&&o.fields.length<function(c){let l=new fe(xe.comparator),f=!1;for(let p of c.filters)for(let m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?f=!0:l=l.add(m.field));for(let p of c.orderBy)p.field.isKeyField()||(l=l.add(p.field));return l.size+(f?1:0)}(s)&&(n=1):n=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&n===2?1:n)}An(e,t){let n=new Vr;for(let i of Dr(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=n.Ht(i.kind);mn.bt.Pt(s,o)}return n.Wt()}Tn(e){let t=new Vr;return mn.bt.Pt(e,t.Ht(0)),t.Wt()}Rn(e,t){let n=new Vr;return mn.bt.Pt(Fr(this.databaseId,t),n.Ht(function(s){let o=Dr(s);return o.length===0?0:o[o.length-1].kind}(e))),n.Wt()}Pn(e,t,n){if(n===null)return[];let i=[];i.push(new Vr);let s=0;for(let o of Dr(e)){let u=n[s++];for(let c of i)if(this.Vn(t,o.fieldPath)&&Ko(u))i=this.mn(i,o,u);else{let l=c.Ht(o.kind);mn.bt.Pt(u,l)}}return this.fn(i)}hn(e,t,n){return this.Pn(e,t,n.position)}fn(e){let t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Wt();return t}mn(e,t,n){let i=[...e],s=[];for(let o of n.arrayValue.values||[])for(let u of i){let c=new Vr;c.seed(u.Wt()),mn.bt.Pt(o,c.Ht(t.kind)),s.push(c)}return s}Vn(e,t){return!!e.filters.find(n=>n instanceof ie&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,t){let n=xo(e),i=Oi(e);return(t?n.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.U()).next(s=>{let o=[];return C.forEach(s,u=>i.get([u.indexId,this.uid]).next(c=>{o.push(function(f,p){let m=p?new Bo(p.sequenceNumber,new Vt(qr(p.readTime),new L(Jt(p.documentKey)),p.largestBatchId)):Bo.empty(),w=f.fields.map(([x,V])=>new zi(xe.fromServerFormat(x),V));return new Hi(f.indexId,f.collectionGroup,w,m)}(u,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((n,i)=>{let s=n.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Z(n.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,n){let i=xo(e),s=Oi(e);return this.gn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(u=>C.forEach(u,c=>s.put(cw(c.indexId,this.uid,o,n)))))}updateIndexEntries(e,t){let n=new Map;return C.forEach(t,(i,s)=>{let o=n.get(i.collectionGroup);return(o?C.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(u=>(n.set(i.collectionGroup,u),C.forEach(u,c=>this.pn(e,i,c).next(l=>{let f=this.yn(s,c);return l.isEqual(f)?C.resolve():this.wn(e,s,c,l,f)}))))})}Sn(e,t,n,i){return ki(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(n,t.key),documentKey:t.key.path.toArray()})}bn(e,t,n,i){return ki(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(n,t.key),t.key.path.toArray()])}pn(e,t,n){let i=ki(e),s=new fe(zn);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.Rn(n,t)])},(o,u)=>{s=s.add(new Mr(n.indexId,t,u.arrayValue,u.directionalValue))}).next(()=>s)}yn(e,t){let n=new fe(zn),i=this.An(t,e);if(i==null)return n;let s=qd(t);if(s!=null){let o=e.data.field(s.fieldPath);if(Ko(o))for(let u of o.arrayValue.values||[])n=n.add(new Mr(t.indexId,e.key,this.Tn(u),i))}else n=n.add(new Mr(t.indexId,e.key,qu,i));return n}wn(e,t,n,i,s){N("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let o=[];return function(c,l,f,p,m){let w=c.getIterator(),x=l.getIterator(),V=Ni(w),D=Ni(x);for(;V||D;){let k=!1,z=!1;if(V&&D){let F=f(V,D);F<0?z=!0:F>0&&(k=!0)}else V!=null?z=!0:k=!0;k?(p(D),D=Ni(x)):z?(m(V),V=Ni(w)):(V=Ni(w),D=Ni(x))}}(i,s,zn,u=>{o.push(this.Sn(e,t,n,u))},u=>{o.push(this.bn(e,t,n,u))}),C.waitFor(o)}gn(e){let t=1;return Oi(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((o,u)=>zn(o,u)).filter((o,u,c)=>!u||zn(o,c[u-1])!==0);let i=[];i.push(e);for(let o of n){let u=zn(o,e),c=zn(o,t);if(u===0)i[0]=e.Jt();else if(u>0&&c<0)i.push(o),i.push(o.Jt());else if(c>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let u=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,qu,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,qu,[]];s.push(IDBKeyRange.bound(u,c))}return s}Dn(e,t){return zn(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(mw)}getMinOffset(e,t){return C.mapArray(this.cn(t),n=>this.ln(e,n).next(i=>i||q())).next(mw)}};function gw(r){return ze(r,"collectionParents")}function ki(r){return ze(r,"indexEntries")}function xo(r){return ze(r,"indexConfiguration")}function Oi(r){return ze(r,"indexState")}function mw(r){G(r.length!==0);let e=r[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<r.length;n++){let i=r[n].indexState.offset;kp(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Vt(e.readTime,e.documentKey,t)}var yw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Pt=class r{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new r(e,r.DEFAULT_COLLECTION_PERCENTILE,r.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function LE(r,e,t){let n=r.store("mutations"),i=r.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId),u=0,c=n.J({range:o},(f,p,m)=>(u++,m.delete()));s.push(c.next(()=>{G(u===1)}));let l=[];for(let f of t.mutations){let p=zw(e,f.key.path,t.batchId);s.push(i.delete(p)),l.push(f.key)}return C.waitFor(s).next(()=>l)}function vc(r){if(!r)return 0;let e;if(r.document)e=r.document;else if(r.unknownDocument)e=r.unknownDocument;else{if(!r.noDocument)throw q();e=r.noDocument}return JSON.stringify(e).length}Pt.DEFAULT_COLLECTION_PERCENTILE=10,Pt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Pt.DEFAULT=new Pt(41943040,Pt.DEFAULT_COLLECTION_PERCENTILE,Pt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Pt.DISABLED=new Pt(-1,0,0);var _c=class r{constructor(e,t,n,i){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=i,this.Cn={}}static lt(e,t,n,i){G(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new r(s,t,n,i)}checkEmpty(e){let t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Gn(e).J({index:"userMutationsIndex",range:n},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,n,i){let s=qi(e),o=Gn(e);return o.add({}).next(u=>{G(typeof u=="number");let c=new Ho(u,t,n,i),l=function(w,x,V){let D=V.baseMutations.map(z=>Zo(w.ct,z)),k=V.mutations.map(z=>Zo(w.ct,z));return{userId:x,batchId:V.batchId,localWriteTimeMs:V.localWriteTime.toMillis(),baseMutations:D,mutations:k}}(this.serializer,this.userId,c),f=[],p=new fe((m,w)=>Z(m.canonicalString(),w.canonicalString()));for(let m of i){let w=zw(this.userId,m.key.path,u);p=p.add(m.key.path.popLast()),f.push(o.put(l)),f.push(s.put(w,AS))}return p.forEach(m=>{f.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Cn[u]=c.keys()}),C.waitFor(f).next(()=>c)})}lookupMutationBatch(e,t){return Gn(e).get(t).next(n=>n?(G(n.userId===this.userId),xr(this.serializer,n)):null)}vn(e,t){return this.Cn[t]?C.resolve(this.Cn[t]):this.lookupMutationBatch(e,t).next(n=>{if(n){let i=n.keys();return this.Cn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let n=t+1,i=IDBKeyRange.lowerBound([this.userId,n]),s=null;return Gn(e).J({index:"userMutationsIndex",range:i},(o,u,c)=>{u.userId===this.userId&&(G(u.batchId>=n),s=xr(this.serializer,u)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Gn(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{n=s.batchId,o.done()}).next(()=>n)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Gn(e).U("userMutationsIndex",t).next(n=>n.map(i=>xr(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let n=Ku(this.userId,t.path),i=IDBKeyRange.lowerBound(n),s=[];return qi(e).J({range:i},(o,u,c)=>{let[l,f,p]=o,m=Jt(f);if(l===this.userId&&t.path.isEqual(m))return Gn(e).get(p).next(w=>{if(!w)throw q();G(w.userId===this.userId),s.push(xr(this.serializer,w))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new fe(Z),i=[];return t.forEach(s=>{let o=Ku(this.userId,s.path),u=IDBKeyRange.lowerBound(o),c=qi(e).J({range:u},(l,f,p)=>{let[m,w,x]=l,V=Jt(w);m===this.userId&&s.path.isEqual(V)?n=n.add(x):p.done()});i.push(c)}),C.waitFor(i).next(()=>this.Fn(e,n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,i=n.length+1,s=Ku(this.userId,n),o=IDBKeyRange.lowerBound(s),u=new fe(Z);return qi(e).J({range:o},(c,l,f)=>{let[p,m,w]=c,x=Jt(m);p===this.userId&&n.isPrefixOf(x)?x.length===i&&(u=u.add(w)):f.done()}).next(()=>this.Fn(e,u))}Fn(e,t){let n=[],i=[];return t.forEach(s=>{i.push(Gn(e).get(s).next(o=>{if(o===null)throw q();G(o.userId===this.userId),n.push(xr(this.serializer,o))}))}),C.waitFor(i).next(()=>n)}removeMutationBatch(e,t){return LE(e._e,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.Mn(t.batchId)}),C.forEach(n,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return C.resolve();let n=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return qi(e).J({range:n},(s,o,u)=>{if(s[0]===this.userId){let c=Jt(s[1]);i.push(c)}else u.done()}).next(()=>{G(i.length===0)})})}containsKey(e,t){return UE(e,this.userId,t)}xn(e){return jE(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function UE(r,e,t){let n=Ku(e,t.path),i=n[1],s=IDBKeyRange.lowerBound(n),o=!1;return qi(r).J({range:s,H:!0},(u,c,l)=>{let[f,p,m]=u;f===e&&p===i&&(o=!0),l.done()}).next(()=>o)}function Gn(r){return ze(r,"mutations")}function qi(r){return ze(r,"documentMutations")}function jE(r){return ze(r,"mutationQueues")}var ts=class r{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new r(0)}static Ln(){return new r(-1)}};var Sf=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{let n=new ts(t.highestTargetId);return t.highestTargetId=n.next(),this.kn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>W.fromTimestamp(new be(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.kn(e,i)))}addTargetData(e,t){return this.qn(e,t).next(()=>this.Bn(e).next(n=>(n.targetCount+=1,this.Qn(t,n),this.kn(e,n))))}updateTargetData(e,t){return this.qn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Fi(e).delete(t.targetId)).next(()=>this.Bn(e)).next(n=>(G(n.targetCount>0),n.targetCount-=1,this.kn(e,n)))}removeTargets(e,t,n){let i=0,s=[];return Fi(e).J((o,u)=>{let c=ko(u);c.sequenceNumber<=t&&n.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>C.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Fi(e).J((n,i)=>{let s=ko(i);t(s)})}Bn(e){return vw(e).get("targetGlobalKey").next(t=>(G(t!==null),t))}kn(e,t){return vw(e).put("targetGlobalKey",t)}qn(e,t){return Fi(e).put(kE(this.serializer,t))}Qn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){let n=Ur(t),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),s=null;return Fi(e).J({range:i,index:"queryTargetsIndex"},(o,u,c)=>{let l=ko(u);la(t,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,t,n){let i=[],s=Kn(e);return t.forEach(o=>{let u=it(o.path);i.push(s.put({targetId:n,path:u})),i.push(this.referenceDelegate.addReference(e,n,o))}),C.waitFor(i)}removeMatchingKeys(e,t,n){let i=Kn(e);return C.forEach(t,s=>{let o=it(s.path);return C.waitFor([i.delete([n,o]),this.referenceDelegate.removeReference(e,n,s)])})}removeMatchingKeysForTargetId(e,t){let n=Kn(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(i)}getMatchingKeysForTargetId(e,t){let n=IDBKeyRange.bound([t],[t+1],!1,!0),i=Kn(e),s=te();return i.J({range:n,H:!0},(o,u,c)=>{let l=Jt(o[1]),f=new L(l);s=s.add(f)}).next(()=>s)}containsKey(e,t){let n=it(t.path),i=IDBKeyRange.bound([n],[Lw(n)],!1,!0),s=0;return Kn(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,u],c,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}ot(e,t){return Fi(e).get(t).next(n=>n?ko(n):null)}};function Fi(r){return ze(r,"targets")}function vw(r){return ze(r,"targetGlobal")}function Kn(r){return ze(r,"targetDocuments")}function _w([r,e],[t,n]){let i=Z(r,t);return i===0?Z(e,n):i}var Rf=class{constructor(e){this.Kn=e,this.buffer=new fe(_w),this.$n=0}Un(){return++this.$n}Wn(e){let t=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(t);else{let n=this.buffer.last();_w(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}},Df=class{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){N("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>P(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){ar(t)?N("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield or(t)}yield this.zn(3e5)}))}},Pf=class{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.Hn(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return C.resolve(Et.oe);let n=new Rf(t);return this.jn.forEachTarget(e,i=>n.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>n.Wn(i))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.jn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(N("LruGarbageCollector","Garbage collection skipped; disabled"),C.resolve(yw)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(N("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),yw):this.Yn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,t){let n,i,s,o,u,c,l,f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(N("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(n=p,u=Date.now(),this.removeTargets(e,n,t))).next(p=>(s=p,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(p=>(l=Date.now(),Li()<=Kt.DEBUG&&N("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${i} in `+(u-o)+`ms
	Removed ${s} targets in `+(c-u)+`ms
	Removed ${p} documents in `+(l-c)+`ms
Total Duration: ${l-f}ms`),C.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}};function vR(r,e){return new Pf(r,e)}var xf=class{constructor(e,t){this.db=e,this.garbageCollector=vR(this,t)}Hn(e){let t=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}Zn(e){let t=0;return this.Jn(e,n=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Jn(e,t){return this.Xn(e,(n,i)=>t(i))}addReference(e,t,n){return $u(e,n)}removeReference(e,t,n){return $u(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return $u(e,t)}er(e,t){return function(i,s){let o=!1;return jE(i).Y(u=>UE(i,u,s).next(c=>(c&&(o=!0),C.resolve(!c)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){let n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,u)=>{if(u<=t){let c=this.er(e,o).next(l=>{if(!l)return s++,n.getEntry(e,o).next(()=>(n.removeEntry(o,W.min()),Kn(e).delete(function(p){return[0,it(p.path)]}(o))))});i.push(c)}}).next(()=>C.waitFor(i)).next(()=>n.apply(e)).next(()=>s)}removeTarget(e,t){let n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return $u(e,t)}Xn(e,t){let n=Kn(e),i,s=Et.oe;return n.J({index:"documentTargetsIndex"},([o,u],{path:c,sequenceNumber:l})=>{o===0?(s!==Et.oe&&t(new L(Jt(i)),s),s=l,i=c):s=Et.oe}).next(()=>{s!==Et.oe&&t(new L(Jt(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function $u(r,e){return Kn(r).put(function(n,i){return{targetId:0,path:it(n.path),sequenceNumber:i}}(e,r.currentSequenceNumber))}var wc=class{constructor(){this.changes=new sn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ue.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let n=this.changes.get(t);return n!==void 0?C.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Vf=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Rr(e).put(n)}removeEntry(e,t,n){return Rr(e).delete(function(s,o){let u=s.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],pc(o),u[u.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.tr(e,n)))}getEntry(e,t){let n=Ue.newInvalidDocument(t);return Rr(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Vo(t))},(i,s)=>{n=this.nr(t,s)}).next(()=>n)}rr(e,t){let n={size:0,document:Ue.newInvalidDocument(t)};return Rr(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Vo(t))},(i,s)=>{n={document:this.nr(t,s),size:vc(s)}}).next(()=>n)}getEntries(e,t){let n=mt();return this.ir(e,t,(i,s)=>{let o=this.nr(i,s);n=n.insert(i,o)}).next(()=>n)}sr(e,t){let n=mt(),i=new Ee(L.comparator);return this.ir(e,t,(s,o)=>{let u=this.nr(s,o);n=n.insert(s,u),i=i.insert(s,vc(o))}).next(()=>({documents:n,_r:i}))}ir(e,t,n){if(t.isEmpty())return C.resolve();let i=new fe(Iw);t.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(Vo(i.first()),Vo(i.last())),o=i.getIterator(),u=o.getNext();return Rr(e).J({index:"documentKeyIndex",range:s},(c,l,f)=>{let p=L.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;u&&Iw(u,p)<0;)n(u,null),u=o.getNext();u&&u.isEqual(p)&&(n(u,l),u=o.hasNext()?o.getNext():null),u?f.$(Vo(u)):f.done()}).next(()=>{for(;u;)n(u,null),u=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,n,i,s){let o=t.path,u=[o.popLast().toArray(),o.lastSegment(),pc(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Rr(e).U(IDBKeyRange.bound(u,c,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let f=mt();for(let p of l){let m=this.nr(L.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(da(t,m)||i.has(m.key))&&(f=f.insert(m.key,m))}return f})}getAllFromCollectionGroup(e,t,n,i){let s=mt(),o=Ew(t,n),u=Ew(t,Vt.max());return Rr(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,u,!0)},(c,l,f)=>{let p=this.nr(L.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(p.key,p),s.size===i&&f.done()}).next(()=>s)}newChangeBuffer(e){return new Mf(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return ww(e).get("remoteDocumentGlobalKey").next(t=>(G(!!t),t))}tr(e,t){return ww(e).put("remoteDocumentGlobalKey",t)}nr(e,t){if(t){let n=gR(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(W.min())))return n}return Ue.newInvalidDocument(e)}};function BE(r){return new Vf(r)}var Mf=class extends wc{constructor(e,t){super(),this.ar=e,this.trackRemovals=t,this.ur=new sn(n=>n.toString(),(n,i)=>n.isEqual(i))}applyChanges(e){let t=[],n=0,i=new fe((s,o)=>Z(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let u=this.ur.get(s);if(t.push(this.ar.removeEntry(e,s,u.readTime)),o.isValidDocument()){let c=aw(this.ar.serializer,o);i=i.add(s.path.popLast());let l=vc(c);n+=l-u.size,t.push(this.ar.addEntry(e,s,c))}else if(n-=u.size,this.trackRemovals){let c=aw(this.ar.serializer,o.convertToNoDocument(W.min()));t.push(this.ar.addEntry(e,s,c))}}),i.forEach(s=>{t.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.ar.updateMetadata(e,n)),C.waitFor(t)}getFromCache(e,t){return this.ar.rr(e,t).next(n=>(this.ur.set(t,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,t){return this.ar.sr(e,t).next(({documents:n,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:n.get(s).readTime})}),n))}};function ww(r){return ze(r,"remoteDocumentGlobal")}function Rr(r){return ze(r,"remoteDocumentsV14")}function Vo(r){let e=r.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Ew(r,e){let t=e.documentKey.path.toArray();return[r,pc(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Iw(r,e){let t=r.path.toArray(),n=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<n.length-2;++s)if(i=Z(t[s],n[s]),i)return i;return i=Z(t.length,n.length),i||(i=Z(t[t.length-2],n[n.length-2]),i||Z(t[t.length-1],n[n.length-1]))}var Nf=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Ec=class{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(n!==null&&Lo(n.mutation,i,It.empty(),be.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,te()).next(()=>n))}getLocalViewOfDocuments(e,t,n=te()){let i=Yt();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(s=>{let o=No();return s.forEach((u,c)=>{o=o.insert(u,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let n=Yt();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,te()))}populateOverlays(e,t,n){let i=[];return n.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,u)=>{t.set(o,u)})})}computeViews(e,t,n,i){let s=mt(),o=Fo(),u=function(){return Fo()}();return t.forEach((c,l)=>{let f=n.get(l.key);i.has(l.key)&&(f===void 0||f.mutation instanceof Ut)?s=s.insert(l.key,l):f!==void 0?(o.set(l.key,f.mutation.getFieldMask()),Lo(f.mutation,l,f.mutation.getFieldMask(),be.now())):o.set(l.key,It.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,f)=>o.set(l,f)),t.forEach((l,f)=>{var p;return u.set(l,new Nf(f,(p=o.get(l))!==null&&p!==void 0?p:null))}),u))}recalculateAndSaveOverlays(e,t){let n=Fo(),i=new Ee((o,u)=>o-u),s=te();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let u of o)u.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let f=n.get(c)||It.empty();f=u.applyToLocalView(l,f),n.set(c,f);let p=(i.get(u.batchId)||te()).add(c);i=i.insert(u.batchId,p)})}).next(()=>{let o=[],u=i.getReverseIterator();for(;u.hasNext();){let c=u.getNext(),l=c.key,f=c.value,p=lE();f.forEach(m=>{if(!s.has(m)){let w=vE(t.get(m),n.get(m));w!==null&&p.set(m,w),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,p))}return C.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return function(o){return L.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Up(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):C.resolve(Yt()),u=-1,c=s;return o.next(l=>C.forEach(l,(f,p)=>(u<p.largestBatchId&&(u=p.largestBatchId),s.get(f)?C.resolve():this.remoteDocumentCache.getEntry(e,f).next(m=>{c=c.insert(f,m)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,te())).next(f=>({batchId:u,changes:cE(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new L(t)).next(n=>{let i=No();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){let s=t.collectionGroup,o=No();return this.indexManager.getCollectionParents(e,s).next(u=>C.forEach(u,c=>{let l=function(p,m){return new Lt(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,n,i).next(f=>{f.forEach((p,m)=>{o=o.insert(p,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,i))).next(o=>{s.forEach((c,l)=>{let f=l.getKey();o.get(f)===null&&(o=o.insert(f,Ue.newInvalidDocument(f)))});let u=No();return o.forEach((c,l)=>{let f=s.get(c);f!==void 0&&Lo(f.mutation,l,It.empty(),be.now()),da(t,l)&&(u=u.insert(c,l))}),u})}};var kf=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return C.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Ve(i.createTime)}}(t)),C.resolve()}getNamedQuery(e,t){return C.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(i){return{name:i.name,query:qp(i.bundledQuery),readTime:Ve(i.readTime)}}(t)),C.resolve()}};var Of=class{constructor(){this.overlays=new Ee(L.comparator),this.hr=new Map}getOverlay(e,t){return C.resolve(this.overlays.get(t))}getOverlays(e,t){let n=Yt();return C.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,s)=>{this.ht(e,t,s)}),C.resolve()}removeOverlaysForBatchId(e,t,n){let i=this.hr.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(n)),C.resolve()}getOverlaysForCollection(e,t,n){let i=Yt(),s=t.length+1,o=new L(t.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){let c=u.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>n&&i.set(c.getKey(),c)}return C.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new Ee((l,f)=>l-f),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>n){let f=s.get(l.largestBatchId);f===null&&(f=Yt(),s=s.insert(l.largestBatchId,f)),f.set(l.getKey(),l)}}let u=Yt(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,f)=>u.set(l,f)),!(u.size()>=i)););return C.resolve(u)}ht(e,t,n){let i=this.overlays.get(n.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(n.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new Qo(t,n));let s=this.hr.get(t);s===void 0&&(s=te(),this.hr.set(t,s)),this.hr.set(t,s.add(n.key))}};var ta=class{constructor(){this.Pr=new fe(Oe.Ir),this.Tr=new fe(Oe.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){let n=new Oe(e,t);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.Ar(new Oe(e,t))}Rr(e,t){e.forEach(n=>this.removeReference(n,t))}Vr(e){let t=new L(new oe([])),n=new Oe(t,e),i=new Oe(t,e+1),s=[];return this.Tr.forEachInRange([n,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let t=new L(new oe([])),n=new Oe(t,e),i=new Oe(t,e+1),s=te();return this.Tr.forEachInRange([n,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Oe(e,0),n=this.Pr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}},Oe=class{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return L.comparator(e.key,t.key)||Z(e.pr,t.pr)}static Er(e,t){return Z(e.pr,t.pr)||L.comparator(e.key,t.key)}};var Ff=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new fe(Oe.Ir)}checkEmpty(e){return C.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Ho(s,t,n,i);this.mutationQueue.push(o);for(let u of i)this.wr=this.wr.add(new Oe(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return C.resolve(o)}lookupMutationBatch(e,t){return C.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){let n=t+1,i=this.br(n),s=i<0?0:i;return C.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return C.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return C.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let n=new Oe(t,0),i=new Oe(t,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([n,i],o=>{let u=this.Sr(o.pr);s.push(u)}),C.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new fe(Z);return t.forEach(i=>{let s=new Oe(i,0),o=new Oe(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],u=>{n=n.add(u.pr)})}),C.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,i=n.length+1,s=n;L.isDocumentKey(s)||(s=s.child(""));let o=new Oe(new L(s),0),u=new fe(Z);return this.wr.forEachWhile(c=>{let l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===i&&(u=u.add(c.pr)),!0)},o),C.resolve(this.Dr(u))}Dr(e){let t=[];return e.forEach(n=>{let i=this.Sr(n);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){G(this.Cr(t.batchId,"removed")===0),this.mutationQueue.shift();let n=this.wr;return C.forEach(t.mutations,i=>{let s=new Oe(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=n})}Mn(e){}containsKey(e,t){let n=new Oe(t,0),i=this.wr.firstAfterOrEqual(n);return C.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,C.resolve()}Cr(e,t){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Lf=class{constructor(e){this.vr=e,this.docs=function(){return new Ee(L.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let n=t.key,i=this.docs.get(n),s=i?i.size:0,o=this.vr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let n=this.docs.get(t);return C.resolve(n?n.document.mutableCopy():Ue.newInvalidDocument(t))}getEntries(e,t){let n=mt();return t.forEach(i=>{let s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Ue.newInvalidDocument(i))}),C.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=mt(),o=t.path,u=new L(o.child("")),c=this.docs.getIteratorFrom(u);for(;c.hasNext();){let{key:l,value:{document:f}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||kp(jw(f),n)<=0||(i.has(f.key)||da(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return C.resolve(s)}getAllFromCollectionGroup(e,t,n,i){q()}Fr(e,t){return C.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new Uf(this)}getSize(e){return C.resolve(this.size)}},Uf=class extends wc{constructor(e){super(),this.ar=e}applyChanges(e){let t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.ar.addEntry(e,i)):this.ar.removeEntry(n)}),C.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}};var jf=class{constructor(e){this.persistence=e,this.Mr=new sn(t=>Ur(t),la),this.lastRemoteSnapshotVersion=W.min(),this.highestTargetId=0,this.Or=0,this.Nr=new ta,this.targetCount=0,this.Lr=ts.Nn()}forEachTarget(e,t){return this.Mr.forEach((n,i)=>t(i)),C.resolve()}getLastRemoteSnapshotVersion(e){return C.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return C.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),C.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Or&&(this.Or=t),C.resolve()}qn(e){this.Mr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Lr=new ts(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,C.resolve()}updateTargetData(e,t){return this.qn(t),C.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,C.resolve()}removeTargets(e,t,n){let i=0,s=[];return this.Mr.forEach((o,u)=>{u.sequenceNumber<=t&&n.get(u.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),C.waitFor(s).next(()=>i)}getTargetCount(e){return C.resolve(this.targetCount)}getTargetData(e,t){let n=this.Mr.get(t)||null;return C.resolve(n)}addMatchingKeys(e,t,n){return this.Nr.dr(t,n),C.resolve()}removeMatchingKeys(e,t,n){this.Nr.Rr(t,n);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),C.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),C.resolve()}getMatchingKeysForTargetId(e,t){let n=this.Nr.gr(t);return C.resolve(n)}containsKey(e,t){return C.resolve(this.Nr.containsKey(t))}};var Ic=class{constructor(e,t){this.Br={},this.overlays={},this.kr=new Et(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new jf(this),this.indexManager=new bf,this.remoteDocumentCache=function(i){return new Lf(i)}(n=>this.referenceDelegate.Kr(n)),this.serializer=new fc(t),this.$r=new kf(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Of,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Br[e.toKey()];return n||(n=new Ff(t,this.referenceDelegate),this.Br[e.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,n){N("MemoryPersistence","Starting transaction:",e);let i=new Bf(this.kr.next());return this.referenceDelegate.Ur(),n(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,t){return C.or(Object.values(this.Br).map(n=>()=>n.containsKey(e,t)))}},Bf=class extends tc{constructor(e){super(),this.currentSequenceNumber=e}},Tc=class r{constructor(e){this.persistence=e,this.zr=new ta,this.jr=null}static Hr(e){return new r(e)}get Jr(){if(this.jr)return this.jr;throw q()}addReference(e,t,n){return this.zr.addReference(n,t),this.Jr.delete(n.toString()),C.resolve()}removeReference(e,t,n){return this.zr.removeReference(n,t),this.Jr.add(n.toString()),C.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),C.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach(i=>this.Jr.add(i.toString()));let n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}Ur(){this.jr=new Set}Wr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return C.forEach(this.Jr,n=>{let i=L.fromPath(n);return this.Yr(e,i).next(s=>{s||t.removeEntry(i,W.min())})}).next(()=>(this.jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Yr(e,t).next(n=>{n?this.Jr.delete(t.toString()):this.Jr.add(t.toString())})}Kr(e){return 0}Yr(e,t){return C.or([()=>C.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}};var qf=class{constructor(e){this.serializer=e}O(e,t,n,i){let s=new nc("createOrUpgrade",t);n<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",U_,{unique:!0}),c.createObjectStore("documentMutations")}(e),Tw(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=C.resolve();return n<3&&i>=3&&(n!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),Tw(e)),o=o.next(()=>function(c){let l=c.store("targetGlobal"),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:W.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",f)}(s))),n<4&&i>=4&&(n!==0&&(o=o.next(()=>function(c,l){return l.store("mutations").U().next(f=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",U_,{unique:!0});let p=l.store("mutations"),m=f.map(w=>p.put(w));return C.waitFor(m)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),n<5&&i>=5&&(o=o.next(()=>this.Xr(s))),n<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),n<7&&i>=7&&(o=o.next(()=>this.ti(s))),n<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),n<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&i>=10&&(o=o.next(()=>this.ri(s))),n<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&i>=12&&(o=o.next(()=>{(function(c){let l=c.createObjectStore("documentOverlays",{keyPath:OS});l.createIndex("collectionPathOverlayIndex",FS,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",LS,{unique:!1})})(e)})),n<13&&i>=13&&(o=o.next(()=>function(c){let l=c.createObjectStore("remoteDocumentsV14",{keyPath:bS});l.createIndex("documentKeyIndex",CS),l.createIndex("collectionGroupIndex",SS)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&i>=14&&(o=o.next(()=>this.si(e,s))),n<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:VS}).createIndex("sequenceNumberIndex",MS,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:NS}).createIndex("documentKeyIndex",kS,{unique:!1})}(e))),n<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),o}ei(e){let t=0;return e.store("remoteDocuments").J((n,i)=>{t+=vc(i)}).next(()=>{let n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}Xr(e){let t=e.store("mutationQueues"),n=e.store("mutations");return t.U().next(i=>C.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",o).next(u=>C.forEach(u,c=>{G(c.userId===s.userId);let l=xr(this.serializer,c);return LE(e,s.userId,l).next(()=>{})}))}))}ti(e){let t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return n.J((o,u)=>{let c=new oe(o),l=function(p){return[0,it(p)]}(c);s.push(t.get(l).next(f=>f?C.resolve():(p=>t.put({targetId:0,path:it(p),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>C.waitFor(s))})}ni(e,t){e.createObjectStore("collectionParents",{keyPath:xS});let n=t.store("collectionParents"),i=new ea,s=o=>{if(i.add(o)){let u=o.lastSegment(),c=o.popLast();return n.put({collectionId:u,parent:it(c)})}};return t.store("remoteDocuments").J({H:!0},(o,u)=>{let c=new oe(o);return s(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,u,c],l)=>{let f=Jt(u);return s(f.popLast())}))}ri(e){let t=e.store("targets");return t.J((n,i)=>{let s=ko(i),o=kE(this.serializer,s);return t.put(o)})}ii(e,t){let n=t.store("remoteDocuments"),i=[];return n.J((s,o)=>{let u=t.store("remoteDocumentsV14"),c=function(p){return p.document?new L(oe.fromString(p.document.name).popFirst(5)):p.noDocument?L.fromSegments(p.noDocument.path):p.unknownDocument?L.fromSegments(p.unknownDocument.path):q()}(o).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(u.put(l))}).next(()=>C.waitFor(i))}si(e,t){let n=t.store("mutations"),i=BE(this.serializer),s=new Ic(Tc.Hr,this.serializer.ct);return n.U().next(o=>{let u=new Map;return o.forEach(c=>{var l;let f=(l=u.get(c.userId))!==null&&l!==void 0?l:te();xr(this.serializer,c).keys().forEach(p=>f=f.add(p)),u.set(c.userId,f)}),C.forEach(u,(c,l)=>{let f=new Fe(l),p=gc.lt(this.serializer,f),m=s.getIndexManager(f),w=_c.lt(f,this.serializer,m,s.referenceDelegate);return new Ec(i,w,p,m).recalculateAndSaveOverlaysForDocumentKeys(new $o(t,Et.oe),c).next()})})}};function Tw(r){r.createObjectStore("targetDocuments",{keyPath:DS}).createIndex("documentTargetsIndex",PS,{unique:!0}),r.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",RS,{unique:!0}),r.createObjectStore("targetGlobal")}var Vd="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",$f=class r{constructor(e,t,n,i,s,o,u,c,l,f,p=16){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.oi=s,this.window=o,this.document=u,this._i=l,this.ai=f,this.ui=p,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=m=>Promise.resolve(),!r.D())throw new M(R.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new xf(this,i),this.Ti=t+"main",this.serializer=new fc(c),this.Ei=new Jn(this.Ti,this.ui,new qf(this.serializer)),this.Qr=new Sf(this.referenceDelegate,this.serializer),this.remoteDocumentCache=BE(this.serializer),this.$r=new vf,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,f===!1&&Pe("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new M(R.FAILED_PRECONDITION,Vd);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new Et(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=t=>P(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(t=>P(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>P(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>zu(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(t=>{t||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(t=>this.isPrimary&&!t?this.yi(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(ar(e))return N("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return N("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return Mo(e).get("owner").next(t=>C.resolve(this.Si(t)))}bi(e){return zu(e).delete(this.clientId)}Di(){return P(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let n=ze(t,"clientMetadata");return n.U().next(i=>{let s=this.vi(i,18e5),o=i.filter(u=>s.indexOf(u)===-1);return C.forEach(o,u=>n.delete(u.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let t of e)this.di.removeItem(this.Fi(t.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?C.resolve(!0):Mo(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)){if(this.Si(t)&&this.networkEnabled)return!0;if(!this.Si(t)){if(!t.allowTabSynchronization)throw new M(R.FAILED_PRECONDITION,Vd);return!1}}return!(!this.networkEnabled||!this.inForeground)||zu(e).U().next(n=>this.vi(n,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,u=this.networkEnabled===i.networkEnabled;if(s||o&&u)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&N("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return P(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new $o(e,Et.oe);return this.yi(t).next(()=>this.bi(t))}),this.Ei.close(),this.Li()})}vi(e,t){return e.filter(n=>this.Ci(n.updateTimeMs,t)&&!this.Mi(n.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>zu(e).U().next(t=>this.vi(t,18e5).map(n=>n.clientId)))}get started(){return this.qr}getMutationQueue(e,t){return _c.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Cf(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return gc.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,t,n){N("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=function(c){return c===16?jS:c===15?Hw:c===14?Ww:c===13?Kw:c===12?US:c===11?Gw:void q()}(this.ui),o;return this.Ei.runTransaction(e,i,s,u=>(o=new $o(u,this.kr?this.kr.next():Et.oe),t==="readwrite-primary"?this.gi(o).next(c=>!!c||this.pi(o)).next(c=>{if(!c)throw Pe(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new M(R.FAILED_PRECONDITION,Bw);return n(o)}).next(c=>this.wi(o).next(()=>c)):this.ki(o).next(()=>n(o)))).then(u=>(o.raiseOnCommittedEvent(),u))}ki(e){return Mo(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)&&!this.Si(t)&&!(this.ai||this.allowTabSynchronization&&t.allowTabSynchronization))throw new M(R.FAILED_PRECONDITION,Vd)})}wi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Mo(e).put("owner",t)}static D(){return Jn.D()}yi(e){let t=Mo(e);return t.get("owner").next(n=>this.Si(n)?(N("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):C.resolve())}Ci(e,t){let n=Date.now();return!(e<n-t)&&(!(e>n)||(Pe(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let t=/(?:Version|Mobile)\/1[456]/;th()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var t;try{let n=((t=this.di)===null||t===void 0?void 0:t.getItem(this.Fi(e)))!==null;return N("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Pe("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){Pe("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Mo(r){return ze(r,"owner")}function zu(r){return ze(r,"clientMetadata")}function zp(r,e){let t=r.projectId;return r.isDefaultDatabase||(t+="."+r.database),"firestore/"+e+"/"+t+"/"}var zf=class r{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.qi=n,this.Qi=i}static Ki(e,t){let n=te(),i=te();for(let s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new r(e,t.fromCache,n,i)}};var Gf=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Ac=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return th()?8:qw(Ks())>0?6:4}()}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,n,i){let s={result:null};return this.ji(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,t,i,n).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new Gf;return this.Ji(e,t,o).next(u=>{if(s.result=u,this.Ui)return this.Yi(e,t,o,u.size)})}).next(()=>s.result)}Yi(e,t,n,i){return n.documentReadCount<this.Wi?(Li()<=Kt.DEBUG&&N("QueryEngine","SDK will not create cache indexes for query:",Ui(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),C.resolve()):(Li()<=Kt.DEBUG&&N("QueryEngine","Query:",Ui(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Gi*i?(Li()<=Kt.DEBUG&&N("QueryEngine","The SDK decides to create cache indexes for query:",Ui(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,st(t))):C.resolve())}ji(e,t){if(X_(t))return C.resolve(null);let n=st(t);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=cc(t,null,"F"),n=st(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{let o=te(...s);return this.zi.getDocuments(e,o).next(u=>this.indexManager.getMinOffset(e,n).next(c=>{let l=this.Zi(t,u);return this.Xi(t,l,o,c.readTime)?this.ji(e,cc(t,null,"F")):this.es(e,l,t,c)}))})))}Hi(e,t,n,i){return X_(t)||i.isEqual(W.min())?C.resolve(null):this.zi.getDocuments(e,n).next(s=>{let o=this.Zi(t,s);return this.Xi(t,o,n,i)?C.resolve(null):(Li()<=Kt.DEBUG&&N("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ui(t)),this.es(e,o,t,Uw(i,-1)).next(u=>u))})}Zi(e,t){let n=new fe(aE(e));return t.forEach((i,s)=>{da(e,s)&&(n=n.add(s))}),n}Xi(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,t,n){return Li()<=Kt.DEBUG&&N("QueryEngine","Using full collection scan to execute query:",Ui(t)),this.zi.getDocumentsMatchingQuery(e,t,Vt.min(),n)}es(e,t,n,i){return this.zi.getDocumentsMatchingQuery(e,n,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Kf=class{constructor(e,t,n,i){this.persistence=e,this.ts=t,this.serializer=i,this.ns=new Ee(Z),this.rs=new sn(s=>Ur(s),la),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(n)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ec(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ns))}};function qE(r,e,t,n){return new Kf(r,e,t,n)}function $E(r,e){return P(this,null,function*(){let t=U(r);return yield t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,t._s(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{let o=[],u=[],c=te();for(let l of i){o.push(l.batchId);for(let f of l.mutations)c=c.add(f.key)}for(let l of s){u.push(l.batchId);for(let f of l.mutations)c=c.add(f.key)}return t.localDocuments.getDocuments(n,c).next(l=>({us:l,removedBatchIds:o,addedBatchIds:u}))})})})}function _R(r,e){let t=U(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{let i=e.batch.keys(),s=t.os.newChangeBuffer({trackRemovals:!0});return function(u,c,l,f){let p=l.batch,m=p.keys(),w=C.resolve();return m.forEach(x=>{w=w.next(()=>f.getEntry(c,x)).next(V=>{let D=l.docVersions.get(x);G(D!==null),V.version.compareTo(D)<0&&(p.applyToRemoteDocument(V,l),V.isValidDocument()&&(V.setReadTime(l.commitVersion),f.addEntry(V)))})}),w.next(()=>u.mutationQueue.removeMutationBatch(c,p))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(u){let c=te();for(let l=0;l<u.mutationResults.length;++l)u.mutationResults[l].transformResults.length>0&&(c=c.add(u.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}function zE(r){let e=U(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Qr.getLastRemoteSnapshotVersion(t))}function wR(r,e){let t=U(r),n=e.snapshotVersion,i=t.ns;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.os.newChangeBuffer({trackRemovals:!0});i=t.ns;let u=[];e.targetChanges.forEach((f,p)=>{let m=i.get(p);if(!m)return;u.push(t.Qr.removeMatchingKeys(s,f.removedDocuments,p).next(()=>t.Qr.addMatchingKeys(s,f.addedDocuments,p)));let w=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?w=w.withResumeToken($e.EMPTY_BYTE_STRING,W.min()).withLastLimboFreeSnapshotVersion(W.min()):f.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(f.resumeToken,n)),i=i.insert(p,w),function(V,D,k){return V.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-V.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(m,w,f)&&u.push(t.Qr.updateTargetData(s,w))});let c=mt(),l=te();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(s,f))}),u.push(GE(s,o,e.documentUpdates).next(f=>{c=f.cs,l=f.ls})),!n.isEqual(W.min())){let f=t.Qr.getLastRemoteSnapshotVersion(s).next(p=>t.Qr.setTargetsMetadata(s,s.currentSequenceNumber,n));u.push(f)}return C.waitFor(u).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.ns=i,s))}function GE(r,e,t){let n=te(),i=te();return t.forEach(s=>n=n.add(s)),e.getEntries(r,n).next(s=>{let o=mt();return t.forEach((u,c)=>{let l=s.get(u);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(u)),c.isNoDocument()&&c.version.isEqual(W.min())?(e.removeEntry(u,c.readTime),o=o.insert(u,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(u,c)):N("LocalStore","Ignoring outdated watch update for ",u,". Current version:",l.version," Watch version:",c.version)}),{cs:o,ls:i}})}function ER(r,e){let t=U(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function ns(r,e){let t=U(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Qr.getTargetData(n,e).next(s=>s?(i=s,C.resolve(i)):t.Qr.allocateTargetId(n).next(o=>(i=new es(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Qr.addTargetData(n,i).next(()=>i))))}).then(n=>{let i=t.ns.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ns=t.ns.insert(n.targetId,n),t.rs.set(e,n.targetId)),n})}function rs(r,e,t){return P(this,null,function*(){let n=U(r),i=n.ns.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!ar(o))throw o;N("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.ns=n.ns.remove(e),n.rs.delete(i.target)})}function bc(r,e,t){let n=U(r),i=W.min(),s=te();return n.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,f){let p=U(c),m=p.rs.get(f);return m!==void 0?C.resolve(p.ns.get(m)):p.Qr.getTargetData(l,f)}(n,o,st(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,n.Qr.getMatchingKeysForTargetId(o,u.targetId).next(c=>{s=c})}).next(()=>n.ts.getDocumentsMatchingQuery(o,e,t?i:W.min(),t?s:te())).next(u=>(HE(n,oE(e),u),{documents:u,hs:s})))}function KE(r,e){let t=U(r),n=U(t.Qr),i=t.ns.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>n.ot(s,e).next(o=>o?o.target:null))}function WE(r,e){let t=U(r),n=t.ss.get(e)||W.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.os.getAllFromCollectionGroup(i,e,Uw(n,-1),Number.MAX_SAFE_INTEGER)).then(i=>(HE(t,e,i),i))}function HE(r,e,t){let n=r.ss.get(e)||W.min();t.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),r.ss.set(e,n)}function IR(r,e,t,n){return P(this,null,function*(){let i=U(r),s=te(),o=mt();for(let l of t){let f=e.Ps(l.metadata.name);l.document&&(s=s.add(f));let p=e.Is(l);p.setReadTime(e.Ts(l.metadata.readTime)),o=o.insert(f,p)}let u=i.os.newChangeBuffer({trackRemovals:!0}),c=yield ns(i,function(f){return st(hs(oe.fromString(`__bundle__/docs/${f}`)))}(n));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>GE(l,u,o).next(f=>(u.apply(l),f)).next(f=>i.Qr.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.Qr.addMatchingKeys(l,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,f.cs,f.ls)).next(()=>f.cs)))})}function TR(n,i){return P(this,arguments,function*(r,e,t=te()){let s=yield ns(r,st(qp(e.bundledQuery))),o=U(r);return o.persistence.runTransaction("Save named query","readwrite",u=>{let c=Ve(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.$r.saveNamedQuery(u,e);let l=s.withResumeToken($e.EMPTY_BYTE_STRING,c);return o.ns=o.ns.insert(l.targetId,l),o.Qr.updateTargetData(u,l).next(()=>o.Qr.removeMatchingKeysForTargetId(u,s.targetId)).next(()=>o.Qr.addMatchingKeys(u,t,s.targetId)).next(()=>o.$r.saveNamedQuery(u,e))})})}function Aw(r,e){return`firestore_clients_${r}_${e}`}function bw(r,e,t){let n=`firestore_mutations_${r}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}function Md(r,e){return`firestore_targets_${r}_${e}`}var Cc=class r{constructor(e,t,n,i){this.user=e,this.batchId=t,this.state=n,this.error=i}static Es(e,t,n){let i=JSON.parse(n),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new M(i.error.code,i.error.message))),o?new r(e,t,i.state,s):(Pe("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Uo=class r{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Es(e,t){let n=JSON.parse(t),i,s=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object");return s&&n.error&&(s=typeof n.error.message=="string"&&typeof n.error.code=="string",s&&(i=new M(n.error.code,n.error.message))),s?new r(e,n.state,i):(Pe("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Sc=class r{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Es(e,t){let n=JSON.parse(t),i=typeof n=="object"&&n.activeTargetIds instanceof Array,s=jp();for(let o=0;i&&o<n.activeTargetIds.length;++o)i=$w(n.activeTargetIds[o]),s=s.add(n.activeTargetIds[o]);return i?new r(e,s):(Pe("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},Wf=class r{constructor(e,t){this.clientId=e,this.onlineState=t}static Es(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new r(t.clientId,t.onlineState):(Pe("SharedClientState",`Failed to parse online state: ${e}`),null)}},na=class{constructor(){this.activeTargetIds=jp()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},jo=class{constructor(e,t,n,i,s){this.window=e,this.oi=t,this.persistenceKey=n,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new Ee(Z),this.started=!1,this.ys=[];let o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=Aw(this.persistenceKey,this.Vs),this.Ss=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new na),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Fs=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return P(this,null,function*(){let e=yield this.syncEngine.Bi();for(let n of e){if(n===this.Vs)continue;let i=this.getItem(Aw(this.persistenceKey,n));if(i){let s=Sc.Es(n,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let t=this.storage.getItem(this.vs);if(t){let n=this.xs(t);n&&this.Os(n)}for(let n of this.ys)this.gs(n);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let t=!1;return this.ps.forEach((n,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,t,n){this.Ls(e,t,n),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){let n=this.storage.getItem(Md(this.persistenceKey,e));if(n){let i=Uo.Es(e,n);i&&(t=i.state)}}return this.ks.As(e),this.Ms(),t}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Md(this.persistenceKey,e))}updateQueryState(e,t,n){this.qs(e,t,n)}handleUserChange(e,t,n){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,n.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return N("SharedClientState","READ",e,t),t}setItem(e,t){N("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){N("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let t=e;if(t.storageArea===this.storage){if(N("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ws)return void Pe("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>P(this,null,function*(){if(this.started){if(t.key!==null){if(this.bs.test(t.key)){if(t.newValue==null){let n=this.$s(t.key);return this.Us(n,null)}{let n=this.Ws(t.key,t.newValue);if(n)return this.Us(n.clientId,n)}}else if(this.Ds.test(t.key)){if(t.newValue!==null){let n=this.Gs(t.key,t.newValue);if(n)return this.zs(n)}}else if(this.Cs.test(t.key)){if(t.newValue!==null){let n=this.js(t.key,t.newValue);if(n)return this.Hs(n)}}else if(t.key===this.vs){if(t.newValue!==null){let n=this.xs(t.newValue);if(n)return this.Os(n)}}else if(t.key===this.Ss){let n=function(s){let o=Et.oe;if(s!=null)try{let u=JSON.parse(s);G(typeof u=="number"),o=u}catch(u){Pe("SharedClientState","Failed to read sequence number from WebStorage",u)}return o}(t.newValue);n!==Et.oe&&this.sequenceNumberHandler(n)}else if(t.key===this.Fs){let n=this.Js(t.newValue);yield Promise.all(n.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(t)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,t,n){let i=new Cc(this.currentUser,e,t,n),s=bw(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Bs(e){let t=bw(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Qs(e){let t={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(t))}qs(e,t,n){let i=Md(this.persistenceKey,e),s=new Uo(e,t,n);this.setItem(i,s.ds())}Ks(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Fs,t)}$s(e){let t=this.bs.exec(e);return t?t[1]:null}Ws(e,t){let n=this.$s(e);return Sc.Es(n,t)}Gs(e,t){let n=this.Ds.exec(e),i=Number(n[1]),s=n[2]!==void 0?n[2]:null;return Cc.Es(new Fe(s),i,t)}js(e,t){let n=this.Cs.exec(e),i=Number(n[1]);return Uo.Es(i,t)}xs(e){return Wf.Es(e)}Js(e){return JSON.parse(e)}zs(e){return P(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);N("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,t){let n=t?this.ps.insert(e,t):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(n),o=[],u=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||u.push(c)}),this.syncEngine.eo(o,u).then(()=>{this.ps=n})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let t=jp();return e.forEach((n,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},Rc=class{constructor(){this.no=new na,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,n){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new na,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Hf=class{io(e){}shutdown(){}};var Dc=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){N("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){N("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Gu=null;function Nd(){return Gu===null?Gu=function(){return 268435456+Math.round(2147483648*Math.random())}():Gu++,"0x"+Gu.toString(16)}var AR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Qf=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}};var Ye="WebChannelConnection",Xf=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let n=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.wo=n+"://"+t.host,this.So=`projects/${i}/databases/${s}`,this.bo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Do(){return!1}Co(t,n,i,s,o){let u=Nd(),c=this.vo(t,n.toUriEncodedString());N("RestConnection",`Sending RPC '${t}' ${u}:`,c,i);let l={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(l,s,o),this.Mo(t,c,l,i).then(f=>(N("RestConnection",`Received RPC '${t}' ${u}: `,f),f),f=>{throw xt("RestConnection",`RPC '${t}' ${u} failed with error: `,f,"url: ",c,"request:",i),f})}xo(t,n,i,s,o,u){return this.Co(t,n,i,s,o)}Fo(t,n,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ls}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}vo(t,n){let i=AR[t];return`${this.wo}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,t,n,i){let s=Nd();return new Promise((o,u)=>{let c=new bd;c.setWithCredentials(!0),c.listenOnce(Sd.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Do.NO_ERROR:let f=c.getResponseJson();N(Ye,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),o(f);break;case Do.TIMEOUT:N(Ye,`RPC '${e}' ${s} timed out`),u(new M(R.DEADLINE_EXCEEDED,"Request time out"));break;case Do.HTTP_ERROR:let p=c.getStatus();if(N(Ye,`RPC '${e}' ${s} failed with status:`,p,"response text:",c.getResponseText()),p>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);let w=m?.error;if(w&&w.status&&w.message){let x=function(D){let k=D.toLowerCase().replace(/_/g,"-");return Object.values(R).indexOf(k)>=0?k:R.UNKNOWN}(w.status);u(new M(x,w.message))}else u(new M(R.UNKNOWN,"Server responded with status "+c.getStatus()))}else u(new M(R.UNAVAILABLE,"Connection failed."));break;default:q()}}finally{N(Ye,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);N(Ye,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",l,n,15)})}Oo(e,t,n){let i=Nd(),s=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Pd(),u=Dd(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new Cd({})),this.Fo(c.initMessageHeaders,t,n),c.encodeInitMessageHeaders=!0;let f=s.join("");N(Ye,`Creating RPC '${e}' stream ${i}: ${f}`,c);let p=o.createWebChannel(f,c),m=!1,w=!1,x=new Qf({lo:D=>{w?N(Ye,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(m||(N(Ye,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),N(Ye,`RPC '${e}' stream ${i} sending:`,D),p.send(D))},ho:()=>p.close()}),V=(D,k,z)=>{D.listen(k,F=>{try{z(F)}catch($){setTimeout(()=>{throw $},0)}})};return V(p,Mi.EventType.OPEN,()=>{w||(N(Ye,`RPC '${e}' stream ${i} transport opened.`),x.mo())}),V(p,Mi.EventType.CLOSE,()=>{w||(w=!0,N(Ye,`RPC '${e}' stream ${i} transport closed`),x.po())}),V(p,Mi.EventType.ERROR,D=>{w||(w=!0,xt(Ye,`RPC '${e}' stream ${i} transport errored:`,D),x.po(new M(R.UNAVAILABLE,"The operation could not be completed")))}),V(p,Mi.EventType.MESSAGE,D=>{var k;if(!w){let z=D.data[0];G(!!z);let F=z,$=F.error||((k=F[0])===null||k===void 0?void 0:k.error);if($){N(Ye,`RPC '${e}' stream ${i} received error:`,$);let X=$.status,Y=function(_){let I=ke[_];if(I!==void 0)return EE(I)}(X),E=$.message;Y===void 0&&(Y=R.INTERNAL,E="Unknown error status: "+X+" with message "+$.message),w=!0,x.po(new M(Y,E)),p.close()}else N(Ye,`RPC '${e}' stream ${i} received:`,z),x.yo(z)}}),V(u,Rd.STAT_EVENT,D=>{D.stat===Bu.PROXY?N(Ye,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===Bu.NOPROXY&&N(Ye,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{x.fo()},0),x}};function QE(){return typeof window<"u"?window:null}function Xu(){return typeof document<"u"?document:null}function fa(r){return new ff(r,!0)}var ra=class{constructor(e,t,n=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=t,this.No=n,this.Lo=i,this.Bo=s,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();let t=Math.floor(this.ko+this.Uo()),n=Math.max(0,Date.now()-this.Qo),i=Math.max(0,t-n);i>0&&N("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.ko} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}};var Pc=class{constructor(e,t,n,i,s,o,u,c){this.oi=e,this.Go=n,this.zo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=c,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new ra(e,t)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}stop(){return P(this,null,function*(){this.Zo()&&(yield this.close(0))})}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}r_(){return P(this,null,function*(){if(this.Xo())return this.close(0)})}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}close(e,t){return P(this,null,function*(){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():t&&t.code===R.RESOURCE_EXHAUSTED?(Pe(t.toString()),Pe("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):t&&t.code===R.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Ao(t)})}__(){}auth(){this.state=1;let e=this.a_(this.jo),t=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.jo===t&&this.u_(n,i)},n=>{e(()=>{let i=new M(R.UNKNOWN,"Fetching auth token failed: "+n.message);return this.c_(i)})})}u_(e,t){let n=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po(()=>{n(()=>this.listener.Po())}),this.stream.To(()=>{n(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(i=>{n(()=>this.c_(i))}),this.stream.onMessage(i=>{n(()=>this.onMessage(i))})}e_(){this.state=5,this.Yo.$o(()=>P(this,null,function*(){this.state=0,this.start()}))}c_(e){return N("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return t=>{this.oi.enqueueAndForget(()=>this.jo===e?t():(N("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Jf=class extends Pc{constructor(e,t,n,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s}l_(e,t){return this.connection.Oo("Listen",e,t)}onMessage(e){this.Yo.reset();let t=uR(this.serializer,e),n=function(s){if(!("targetChange"in s))return W.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?W.min():o.readTime?Ve(o.readTime):W.min()}(e);return this.listener.h_(t,n)}P_(e){let t={};t.database=mf(this.serializer),t.addTarget=function(s,o){let u,c=o.target;if(u=ac(c)?{documents:DE(s,c)}:{query:PE(s,c)._t},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=TE(s,o.resumeToken);let l=pf(s,o.expectedCount);l!==null&&(u.expectedCount=l)}else if(o.snapshotVersion.compareTo(W.min())>0){u.readTime=Zi(s,o.snapshotVersion.toTimestamp());let l=pf(s,o.expectedCount);l!==null&&(u.expectedCount=l)}return u}(this.serializer,e);let n=lR(this.serializer,e);n&&(t.labels=n),this.i_(t)}I_(e){let t={};t.database=mf(this.serializer),t.removeTarget=e,this.i_(t)}},Yf=class extends Pc{constructor(e,t,n,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,t){return this.connection.Oo("Write",e,t)}onMessage(e){if(G(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();let t=cR(e.writeResults,e.commitTime),n=Ve(e.commitTime);return this.listener.A_(n,t)}return G(!e.writeResults||e.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){let e={};e.database=mf(this.serializer),this.i_(e)}d_(e){let t={streamToken:this.lastStreamToken,writes:e.map(n=>Zo(this.serializer,n))};this.i_(t)}};var Zf=class extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.m_=!1}f_(){if(this.m_)throw new M(R.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,t,n,i){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,gf(t,n),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new M(R.UNKNOWN,s.toString())})}xo(e,t,n,i,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.xo(e,gf(t,n),i,o,u,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new M(R.UNKNOWN,o.toString())})}terminate(){this.m_=!0,this.connection.terminate()}},ep=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(Pe(t),this.y_=!1):N("OnlineStateTracker",t)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}};var tp=class{constructor(e,t,n,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.io(o=>{n.enqueueAndForget(()=>P(this,null,function*(){ur(this)&&(N("RemoteStore","Restarting streams for network reachability change."),yield function(c){return P(this,null,function*(){let l=U(c);l.M_.add(4),yield ds(l),l.N_.set("Unknown"),l.M_.delete(4),yield pa(l)})}(this))}))}),this.N_=new ep(n,i)}};function pa(r){return P(this,null,function*(){if(ur(r))for(let e of r.x_)yield e(!0)})}function ds(r){return P(this,null,function*(){for(let e of r.x_)yield e(!1)})}function Qc(r,e){let t=U(r);t.F_.has(e.targetId)||(t.F_.set(e.targetId,e),Wp(t)?Kp(t):ps(t).Xo()&&Gp(t,e))}function is(r,e){let t=U(r),n=ps(t);t.F_.delete(e),n.Xo()&&XE(t,e),t.F_.size===0&&(n.Xo()?n.n_():ur(t)&&t.N_.set("Unknown"))}function Gp(r,e){if(r.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(W.min())>0){let t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ps(r).P_(e)}function XE(r,e){r.L_.xe(e),ps(r).I_(e)}function Kp(r){r.L_=new df({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>r.F_.get(e)||null,tt:()=>r.datastore.serializer.databaseId}),ps(r).start(),r.N_.w_()}function Wp(r){return ur(r)&&!ps(r).Zo()&&r.F_.size>0}function ur(r){return U(r).M_.size===0}function JE(r){r.L_=void 0}function bR(r){return P(this,null,function*(){r.N_.set("Online")})}function CR(r){return P(this,null,function*(){r.F_.forEach((e,t)=>{Gp(r,e)})})}function SR(r,e){return P(this,null,function*(){JE(r),Wp(r)?(r.N_.D_(e),Kp(r)):r.N_.set("Unknown")})}function RR(r,e,t){return P(this,null,function*(){if(r.N_.set("Online"),e instanceof hc&&e.state===2&&e.cause)try{yield function(i,s){return P(this,null,function*(){let o=s.cause;for(let u of s.targetIds)i.F_.has(u)&&(yield i.remoteSyncer.rejectListen(u,o),i.F_.delete(u),i.L_.removeTarget(u))})}(r,e)}catch(n){N("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),yield xc(r,n)}else if(e instanceof Ki?r.L_.Ke(e):e instanceof lc?r.L_.He(e):r.L_.We(e),!t.isEqual(W.min()))try{let n=yield zE(r.localStore);t.compareTo(n)>=0&&(yield function(s,o){let u=s.L_.rt(o);return u.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let f=s.F_.get(l);f&&s.F_.set(l,f.withResumeToken(c.resumeToken,o))}}),u.targetMismatches.forEach((c,l)=>{let f=s.F_.get(c);if(!f)return;s.F_.set(c,f.withResumeToken($e.EMPTY_BYTE_STRING,f.snapshotVersion)),XE(s,c);let p=new es(f.target,c,l,f.sequenceNumber);Gp(s,p)}),s.remoteSyncer.applyRemoteEvent(u)}(r,t))}catch(n){N("RemoteStore","Failed to raise snapshot:",n),yield xc(r,n)}})}function xc(r,e,t){return P(this,null,function*(){if(!ar(e))throw e;r.M_.add(1),yield ds(r),r.N_.set("Offline"),t||(t=()=>zE(r.localStore)),r.asyncQueue.enqueueRetryable(()=>P(this,null,function*(){N("RemoteStore","Retrying IndexedDB access"),yield t(),r.M_.delete(1),yield pa(r)}))})}function YE(r,e){return e().catch(t=>xc(r,t,e))}function fs(r){return P(this,null,function*(){let e=U(r),t=sr(e),n=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;DR(e);)try{let i=yield ER(e.localStore,n);if(i===null){e.v_.length===0&&t.n_();break}n=i.batchId,PR(e,i)}catch(i){yield xc(e,i)}ZE(e)&&eI(e)})}function DR(r){return ur(r)&&r.v_.length<10}function PR(r,e){r.v_.push(e);let t=sr(r);t.Xo()&&t.E_&&t.d_(e.mutations)}function ZE(r){return ur(r)&&!sr(r).Zo()&&r.v_.length>0}function eI(r){sr(r).start()}function xR(r){return P(this,null,function*(){sr(r).V_()})}function VR(r){return P(this,null,function*(){let e=sr(r);for(let t of r.v_)e.d_(t.mutations)})}function MR(r,e,t){return P(this,null,function*(){let n=r.v_.shift(),i=cf.from(n,e,t);yield YE(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),yield fs(r)})}function NR(r,e){return P(this,null,function*(){e&&sr(r).E_&&(yield function(n,i){return P(this,null,function*(){if(function(o){return wE(o)&&o!==R.ABORTED}(i.code)){let s=n.v_.shift();sr(n).t_(),yield YE(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield fs(n)}})}(r,e)),ZE(r)&&eI(r)})}function Cw(r,e){return P(this,null,function*(){let t=U(r);t.asyncQueue.verifyOperationInProgress(),N("RemoteStore","RemoteStore received new credentials");let n=ur(t);t.M_.add(3),yield ds(t),n&&t.N_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.M_.delete(3),yield pa(t)})}function np(r,e){return P(this,null,function*(){let t=U(r);e?(t.M_.delete(2),yield pa(t)):e||(t.M_.add(2),yield ds(t),t.N_.set("Unknown"))})}function ps(r){return r.B_||(r.B_=function(t,n,i){let s=U(t);return s.f_(),new Jf(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{Po:bR.bind(null,r),To:CR.bind(null,r),Ao:SR.bind(null,r),h_:RR.bind(null,r)}),r.x_.push(e=>P(this,null,function*(){e?(r.B_.t_(),Wp(r)?Kp(r):r.N_.set("Unknown")):(yield r.B_.stop(),JE(r))}))),r.B_}function sr(r){return r.k_||(r.k_=function(t,n,i){let s=U(t);return s.f_(),new Yf(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{Po:()=>Promise.resolve(),To:xR.bind(null,r),Ao:NR.bind(null,r),R_:VR.bind(null,r),A_:MR.bind(null,r)}),r.x_.push(e=>P(this,null,function*(){e?(r.k_.t_(),yield fs(r)):(yield r.k_.stop(),r.v_.length>0&&(N("RemoteStore",`Stopping write stream with ${r.v_.length} pending writes`),r.v_=[]))}))),r.k_}var rp=class r{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Le,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,s){let o=Date.now()+n,u=new r(e,t,o,i,s);return u.start(n),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new M(R.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function gs(r,e){if(Pe("AsyncQueue",`${e}: ${r}`),ar(r))return new M(R.UNAVAILABLE,`${e}: ${r}`);throw r}var Vc=class r{constructor(e){this.comparator=e?(t,n)=>e(t,n)||L.comparator(t.key,n.key):(t,n)=>L.comparator(t.key,n.key),this.keyedMap=No(),this.sortedSet=new Ee(this.comparator)}static emptySet(e){return new r(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof r)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let n=new r;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}};var Mc=class{constructor(){this.q_=new Ee(L.comparator)}track(e){let t=e.doc.key,n=this.q_.get(t);n?e.type!==0&&n.type===3?this.q_=this.q_.insert(t,e):e.type===3&&n.type!==1?this.q_=this.q_.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.q_=this.q_.remove(t):e.type===1&&n.type===2?this.q_=this.q_.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):q():this.q_=this.q_.insert(t,e)}Q_(){let e=[];return this.q_.inorderTraversal((t,n)=>{e.push(n)}),e}},ss=class r{constructor(e,t,n,i,s,o,u,c,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,i,s){let o=[];return t.forEach(u=>{o.push({type:0,doc:u})}),new r(e,t,Vc.emptySet(t),o,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ha(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}};var ip=class{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}},sp=class{constructor(){this.queries=new sn(e=>sE(e),ha),this.onlineState="Unknown",this.z_=new Set}};function Hp(r,e){return P(this,null,function*(){let t=U(r),n=3,i=e.query,s=t.queries.get(i);s?!s.W_()&&e.G_()&&(n=2):(s=new ip,n=e.G_()?0:1);try{switch(n){case 0:s.K_=yield t.onListen(i,!0);break;case 1:s.K_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let u=gs(o,`Initialization of query '${Ui(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,s),s.U_.push(e),e.j_(t.onlineState),s.K_&&e.H_(s.K_)&&Xp(t)})}function Qp(r,e){return P(this,null,function*(){let t=U(r),n=e.query,i=3,s=t.queries.get(n);if(s){let o=s.U_.indexOf(e);o>=0&&(s.U_.splice(o,1),s.U_.length===0?i=e.G_()?0:1:!s.W_()&&e.G_()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}})}function kR(r,e){let t=U(r),n=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let u of o.U_)u.H_(i)&&(n=!0);o.K_=i}}n&&Xp(t)}function OR(r,e,t){let n=U(r),i=n.queries.get(e);if(i)for(let s of i.U_)s.onError(t);n.queries.delete(e)}function Xp(r){r.z_.forEach(e=>{e.next()})}var op,Sw;(Sw=op||(op={})).J_="default",Sw.Cache="cache";var ia=class{constructor(e,t,n){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=n||{}}H_(e){if(!this.options.includeMetadataChanges){let n=[];for(let i of e.docChanges)i.type!==3&&n.push(i);e=new ss(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){if(!e.fromCache||!this.G_())return!0;let n=t!=="Offline";return(!this.options.ra||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ea(e){if(e.docChanges.length>0)return!0;let t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}na(e){e=ss.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==op.Cache}};var ap=class{constructor(e,t){this.ia=e,this.byteLength=t}sa(){return"metadata"in this.ia}};var Nc=class{constructor(e){this.serializer=e}Ps(e){return en(this.serializer,e)}Is(e){return e.metadata.exists?RE(this.serializer,e.document,!1):Ue.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return Ve(e)}},up=class{constructor(e,t,n){this.oa=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=tI(e)}_a(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++t;let n=oe.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}aa(e){let t=new Map,n=new Nc(this.serializer);for(let i of e)if(i.metadata.queries){let s=n.Ps(i.metadata.name);for(let o of i.metadata.queries){let u=(t.get(o)||te()).add(s);t.set(o,u)}}return t}complete(){return P(this,null,function*(){let e=yield IR(this.localStore,new Nc(this.serializer),this.documents,this.oa.id),t=this.aa(this.documents);for(let n of this.queries)yield TR(this.localStore,n,t.get(n.name));return this.progress.taskState="Success",{progress:this.progress,ua:this.collectionGroups,ca:e}})}};function tI(r){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:r.totalDocuments,totalBytes:r.totalBytes}}var kc=class{constructor(e){this.key=e}},Oc=class{constructor(e){this.key=e}},Fc=class{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=te(),this.mutatedKeys=te(),this.Ia=aE(e),this.Ta=new Vc(this.Ia)}get Ea(){return this.la}da(e,t){let n=t?t.Aa:new Mc,i=t?t.Ta:this.Ta,s=t?t.mutatedKeys:this.mutatedKeys,o=i,u=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,p)=>{let m=i.get(f),w=da(this.query,p)?p:null,x=!!m&&this.mutatedKeys.has(m.key),V=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations),D=!1;m&&w?m.data.isEqual(w.data)?x!==V&&(n.track({type:3,doc:w}),D=!0):this.Ra(m,w)||(n.track({type:2,doc:w}),D=!0,(c&&this.Ia(w,c)>0||l&&this.Ia(w,l)<0)&&(u=!0)):!m&&w?(n.track({type:0,doc:w}),D=!0):m&&!w&&(n.track({type:1,doc:m}),D=!0,(c||l)&&(u=!0)),D&&(w?(o=o.add(w),s=V?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{Ta:o,Aa:n,Xi:u,mutatedKeys:s}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){let s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;let o=e.Aa.Q_();o.sort((f,p)=>function(w,x){let V=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return q()}};return V(w)-V(x)}(f.type,p.type)||this.Ia(f.doc,p.doc)),this.Va(n),i=i!=null&&i;let u=t&&!i?this.ma():[],c=this.Pa.size===0&&this.current&&!i?1:0,l=c!==this.ha;return this.ha=c,o.length!==0||l?{snapshot:new ss(this.query,e.Ta,s,o,e.mutatedKeys,c===0,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),fa:u}:{fa:u}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new Mc,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(t=>this.la=this.la.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.la=this.la.delete(t)),this.current=e.current)}ma(){if(!this.current)return[];let e=this.Pa;this.Pa=te(),this.Ta.forEach(n=>{this.ga(n.key)&&(this.Pa=this.Pa.add(n.key))});let t=[];return e.forEach(n=>{this.Pa.has(n)||t.push(new Oc(n))}),this.Pa.forEach(n=>{e.has(n)||t.push(new kc(n))}),t}pa(e){this.la=e.hs,this.Pa=te();let t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return ss.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}},cp=class{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}},lp=class{constructor(e){this.key=e,this.wa=!1}},hp=class{constructor(e,t,n,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new sn(u=>sE(u),ha),this.Da=new Map,this.Ca=new Set,this.va=new Ee(L.comparator),this.Fa=new Map,this.Ma=new ta,this.xa={},this.Oa=new Map,this.Na=ts.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}};function FR(r,e,t=!0){return P(this,null,function*(){let n=Xc(r),i,s=n.ba.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ya()):i=yield nI(n,e,t,!0),i})}function LR(r,e){return P(this,null,function*(){let t=Xc(r);yield nI(t,e,!0,!1)})}function nI(r,e,t,n){return P(this,null,function*(){let i=yield ns(r.localStore,st(e)),s=i.targetId,o=t?r.sharedClientState.addLocalQueryTarget(s):"not-current",u;return n&&(u=yield Jp(r,e,s,o==="current",i.resumeToken)),r.isPrimaryClient&&t&&Qc(r.remoteStore,i),u})}function Jp(r,e,t,n,i){return P(this,null,function*(){r.Ba=(p,m,w)=>function(V,D,k,z){return P(this,null,function*(){let F=D.view.da(k);F.Xi&&(F=yield bc(V.localStore,D.query,!1).then(({documents:E})=>D.view.da(E,F)));let $=z&&z.targetChanges.get(D.targetId),X=z&&z.targetMismatches.get(D.targetId)!=null,Y=D.view.applyChanges(F,V.isPrimaryClient,$,X);return dp(V,D.targetId,Y.fa),Y.snapshot})}(r,p,m,w);let s=yield bc(r.localStore,e,!0),o=new Fc(e,s.hs),u=o.da(s.documents),c=Jo.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),l=o.applyChanges(u,r.isPrimaryClient,c);dp(r,t,l.fa);let f=new cp(e,t,o);return r.ba.set(e,f),r.Da.has(t)?r.Da.get(t).push(e):r.Da.set(t,[e]),l.snapshot})}function UR(r,e,t){return P(this,null,function*(){let n=U(r),i=n.ba.get(e),s=n.Da.get(i.targetId);if(s.length>1)return n.Da.set(i.targetId,s.filter(o=>!ha(o,e))),void n.ba.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||(yield rs(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),t&&is(n.remoteStore,i.targetId),os(n,i.targetId)}).catch(or))):(os(n,i.targetId),yield rs(n.localStore,i.targetId,!0))})}function jR(r,e){return P(this,null,function*(){let t=U(r),n=t.ba.get(e),i=t.Da.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),is(t.remoteStore,n.targetId))})}function BR(r,e,t){return P(this,null,function*(){let n=tg(r);try{let i=yield function(o,u){let c=U(o),l=be.now(),f=u.reduce((w,x)=>w.add(x.key),te()),p,m;return c.persistence.runTransaction("Locally write mutations","readwrite",w=>{let x=mt(),V=te();return c.os.getEntries(w,f).next(D=>{x=D,x.forEach((k,z)=>{z.isValidDocument()||(V=V.add(k))})}).next(()=>c.localDocuments.getOverlayedDocuments(w,x)).next(D=>{p=D;let k=[];for(let z of u){let F=tR(z,p.get(z.key).overlayedDocument);F!=null&&k.push(new Ut(z.key,F,Yw(F.value.mapValue),De.exists(!0)))}return c.mutationQueue.addMutationBatch(w,l,k,u)}).next(D=>{m=D;let k=D.applyToLocalDocumentSet(p,V);return c.documentOverlayCache.saveOverlays(w,D.batchId,k)})}).then(()=>({batchId:m.batchId,changes:cE(p)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(o,u,c){let l=o.xa[o.currentUser.toKey()];l||(l=new Ee(Z)),l=l.insert(u,c),o.xa[o.currentUser.toKey()]=l}(n,i.batchId,t),yield Tn(n,i.changes),yield fs(n.remoteStore)}catch(i){let s=gs(i,"Failed to persist write");t.reject(s)}})}function rI(r,e){return P(this,null,function*(){let t=U(r);try{let n=yield wR(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Fa.get(s);o&&(G(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.wa=!0:i.modifiedDocuments.size>0?G(o.wa):i.removedDocuments.size>0&&(G(o.wa),o.wa=!1))}),yield Tn(t,n,e)}catch(n){yield or(n)}})}function Rw(r,e,t){let n=U(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){let i=[];n.ba.forEach((s,o)=>{let u=o.view.j_(e);u.snapshot&&i.push(u.snapshot)}),function(o,u){let c=U(o);c.onlineState=u;let l=!1;c.queries.forEach((f,p)=>{for(let m of p.U_)m.j_(u)&&(l=!0)}),l&&Xp(c)}(n.eventManager,e),i.length&&n.Sa.h_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function qR(r,e,t){return P(this,null,function*(){let n=U(r);n.sharedClientState.updateQueryState(e,"rejected",t);let i=n.Fa.get(e),s=i&&i.key;if(s){let o=new Ee(L.comparator);o=o.insert(s,Ue.newNoDocument(s,W.min()));let u=te().add(s),c=new Xo(W.min(),new Map,new Ee(Z),o,u);yield rI(n,c),n.va=n.va.remove(s),n.Fa.delete(e),eg(n)}else yield rs(n.localStore,e,!1).then(()=>os(n,e,t)).catch(or)})}function $R(r,e){return P(this,null,function*(){let t=U(r),n=e.batch.batchId;try{let i=yield _R(t.localStore,e);Zp(t,n,null),Yp(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),yield Tn(t,i)}catch(i){yield or(i)}})}function zR(r,e,t){return P(this,null,function*(){let n=U(r);try{let i=yield function(o,u){let c=U(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let f;return c.mutationQueue.lookupMutationBatch(l,u).next(p=>(G(p!==null),f=p.keys(),c.mutationQueue.removeMutationBatch(l,p))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,f,u)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,f)).next(()=>c.localDocuments.getDocuments(l,f))})}(n.localStore,e);Zp(n,e,t),Yp(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),yield Tn(n,i)}catch(i){yield or(i)}})}function GR(r,e){return P(this,null,function*(){let t=U(r);ur(t.remoteStore)||N("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let n=yield function(o){let u=U(o);return u.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>u.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(n===-1)return void e.resolve();let i=t.Oa.get(n)||[];i.push(e),t.Oa.set(n,i)}catch(n){let i=gs(n,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function Yp(r,e){(r.Oa.get(e)||[]).forEach(t=>{t.resolve()}),r.Oa.delete(e)}function Zp(r,e,t){let n=U(r),i=n.xa[n.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.xa[n.currentUser.toKey()]=i}}function os(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(let n of r.Da.get(e))r.ba.delete(n),t&&r.Sa.ka(n,t);r.Da.delete(e),r.isPrimaryClient&&r.Ma.Vr(e).forEach(n=>{r.Ma.containsKey(n)||iI(r,n)})}function iI(r,e){r.Ca.delete(e.path.canonicalString());let t=r.va.get(e);t!==null&&(is(r.remoteStore,t),r.va=r.va.remove(e),r.Fa.delete(t),eg(r))}function dp(r,e,t){for(let n of t)n instanceof kc?(r.Ma.addReference(n.key,e),KR(r,n)):n instanceof Oc?(N("SyncEngine","Document no longer in limbo: "+n.key),r.Ma.removeReference(n.key,e),r.Ma.containsKey(n.key)||iI(r,n.key)):q()}function KR(r,e){let t=e.key,n=t.path.canonicalString();r.va.get(t)||r.Ca.has(n)||(N("SyncEngine","New document in limbo: "+t),r.Ca.add(n),eg(r))}function eg(r){for(;r.Ca.size>0&&r.va.size<r.maxConcurrentLimboResolutions;){let e=r.Ca.values().next().value;r.Ca.delete(e);let t=new L(oe.fromString(e)),n=r.Na.next();r.Fa.set(n,new lp(t)),r.va=r.va.insert(t,n),Qc(r.remoteStore,new es(st(hs(t.path)),n,"TargetPurposeLimboResolution",Et.oe))}}function Tn(r,e,t){return P(this,null,function*(){let n=U(r),i=[],s=[],o=[];n.ba.isEmpty()||(n.ba.forEach((u,c)=>{o.push(n.Ba(c,e,t).then(l=>{var f;if((l||t)&&n.isPrimaryClient){let p=l?!l.fromCache:(f=t?.targetChanges.get(c.targetId))===null||f===void 0?void 0:f.current;n.sharedClientState.updateQueryState(c.targetId,p?"current":"not-current")}if(l){i.push(l);let p=zf.Ki(c.targetId,l);s.push(p)}}))}),yield Promise.all(o),n.Sa.h_(i),yield function(c,l){return P(this,null,function*(){let f=U(c);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>C.forEach(l,m=>C.forEach(m.qi,w=>f.persistence.referenceDelegate.addReference(p,m.targetId,w)).next(()=>C.forEach(m.Qi,w=>f.persistence.referenceDelegate.removeReference(p,m.targetId,w)))))}catch(p){if(!ar(p))throw p;N("LocalStore","Failed to update sequence numbers: "+p)}for(let p of l){let m=p.targetId;if(!p.fromCache){let w=f.ns.get(m),x=w.snapshotVersion,V=w.withLastLimboFreeSnapshotVersion(x);f.ns=f.ns.insert(m,V)}}})}(n.localStore,s))})}function WR(r,e){return P(this,null,function*(){let t=U(r);if(!t.currentUser.isEqual(e)){N("SyncEngine","User change. New user:",e.toKey());let n=yield $E(t.localStore,e);t.currentUser=e,function(s,o){s.Oa.forEach(u=>{u.forEach(c=>{c.reject(new M(R.CANCELLED,o))})}),s.Oa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),yield Tn(t,n.us)}})}function HR(r,e){let t=U(r),n=t.Fa.get(e);if(n&&n.wa)return te().add(n.key);{let i=te(),s=t.Da.get(e);if(!s)return i;for(let o of s){let u=t.ba.get(o);i=i.unionWith(u.view.Ea)}return i}}function QR(r,e){return P(this,null,function*(){let t=U(r),n=yield bc(t.localStore,e.query,!0),i=e.view.pa(n);return t.isPrimaryClient&&dp(t,e.targetId,i.fa),i})}function XR(r,e){return P(this,null,function*(){let t=U(r);return WE(t.localStore,e).then(n=>Tn(t,n))})}function JR(r,e,t,n){return P(this,null,function*(){let i=U(r),s=yield function(u,c){let l=U(u),f=U(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",p=>f.vn(p,c).next(m=>m?l.localDocuments.getDocuments(p,m):C.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?yield fs(i.remoteStore):t==="acknowledged"||t==="rejected"?(Zp(i,e,n||null),Yp(i,e),function(u,c){U(U(u).mutationQueue).Mn(c)}(i.localStore,e)):q(),yield Tn(i,s)):N("SyncEngine","Cannot apply mutation batch with id: "+e)})}function YR(r,e){return P(this,null,function*(){let t=U(r);if(Xc(t),tg(t),e===!0&&t.La!==!0){let n=t.sharedClientState.getAllActiveQueryTargets(),i=yield Dw(t,n.toArray());t.La=!0,yield np(t.remoteStore,!0);for(let s of i)Qc(t.remoteStore,s)}else if(e===!1&&t.La!==!1){let n=[],i=Promise.resolve();t.Da.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?n.push(o):i=i.then(()=>(os(t,o),rs(t.localStore,o,!0))),is(t.remoteStore,o)}),yield i,yield Dw(t,n),function(o){let u=U(o);u.Fa.forEach((c,l)=>{is(u.remoteStore,l)}),u.Ma.mr(),u.Fa=new Map,u.va=new Ee(L.comparator)}(t),t.La=!1,yield np(t.remoteStore,!1)}})}function Dw(r,e,t){return P(this,null,function*(){let n=U(r),i=[],s=[];for(let o of e){let u,c=n.Da.get(o);if(c&&c.length!==0){u=yield ns(n.localStore,st(c[0]));for(let l of c){let f=n.ba.get(l),p=yield QR(n,f);p.snapshot&&s.push(p.snapshot)}}else{let l=yield KE(n.localStore,o);u=yield ns(n.localStore,l),yield Jp(n,sI(l),o,!1,u.resumeToken)}i.push(u)}return n.Sa.h_(s),i})}function sI(r){return iE(r.path,r.collectionGroup,r.orderBy,r.filters,r.limit,"F",r.startAt,r.endAt)}function ZR(r){return function(t){return U(U(t).persistence).Bi()}(U(r).localStore)}function eD(r,e,t,n){return P(this,null,function*(){let i=U(r);if(i.La)return void N("SyncEngine","Ignoring unexpected query state notification.");let s=i.Da.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield WE(i.localStore,oE(s[0])),u=Xo.createSynthesizedRemoteEventForCurrentChange(e,t==="current",$e.EMPTY_BYTE_STRING);yield Tn(i,o,u);break}case"rejected":yield rs(i.localStore,e,!0),os(i,e,n);break;default:q()}})}function tD(r,e,t){return P(this,null,function*(){let n=Xc(r);if(n.La){for(let i of e){if(n.Da.has(i)&&n.sharedClientState.isActiveQueryTarget(i)){N("SyncEngine","Adding an already active target "+i);continue}let s=yield KE(n.localStore,i),o=yield ns(n.localStore,s);yield Jp(n,sI(s),o.targetId,!1,o.resumeToken),Qc(n.remoteStore,o)}for(let i of t)n.Da.has(i)&&(yield rs(n.localStore,i,!1).then(()=>{is(n.remoteStore,i),os(n,i)}).catch(or))}})}function Xc(r){let e=U(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=rI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=HR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=qR.bind(null,e),e.Sa.h_=kR.bind(null,e.eventManager),e.Sa.ka=OR.bind(null,e.eventManager),e}function tg(r){let e=U(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=$R.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=zR.bind(null,e),e}function nD(r,e,t){let n=U(r);(function(s,o,u){return P(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(w,x){let V=U(w),D=Ve(x.createTime);return V.persistence.runTransaction("hasNewerBundle","readonly",k=>V.$r.getBundleMetadata(k,x.id)).then(k=>!!k&&k.createTime.compareTo(D)>=0)}(s.localStore,c))return yield o.close(),u._completeWith(function(w){return{taskState:"Success",documentsLoaded:w.totalDocuments,bytesLoaded:w.totalBytes,totalDocuments:w.totalDocuments,totalBytes:w.totalBytes}}(c)),Promise.resolve(new Set);u._updateProgress(tI(c));let l=new up(c,s.localStore,o.serializer),f=yield o.qa();for(;f;){let m=yield l._a(f);m&&u._updateProgress(m),f=yield o.qa()}let p=yield l.complete();return yield Tn(s,p.ca,void 0),yield function(w,x){let V=U(w);return V.persistence.runTransaction("Save bundle","readwrite",D=>V.$r.saveBundleMetadata(D,x))}(s.localStore,c),u._completeWith(p.progress),Promise.resolve(p.ua)}catch(c){return xt("SyncEngine",`Loading bundle failed with ${c}`),u._failWith(c),Promise.resolve(new Set)}})})(n,e,t).then(i=>{n.sharedClientState.notifyBundleLoaded(i)})}var sa=class{constructor(){this.synchronizeTabs=!1}initialize(e){return P(this,null,function*(){this.serializer=fa(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return qE(this.persistence,new Ac,e.initialUser,this.serializer)}createPersistence(e){return new Ic(Tc.Hr,this.serializer)}createSharedClientState(e){return new Rc}terminate(){return P(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Lc=class r extends sa{constructor(e,t,n){super(),this.Qa=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}initialize(e){return P(this,null,function*(){yield Nl(r.prototype,this,"initialize").call(this,e),yield this.Qa.initialize(this,e),yield tg(this.Qa.syncEngine),yield fs(this.Qa.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return qE(this.persistence,new Ac,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let n=this.persistence.referenceDelegate.garbageCollector;return new Df(n,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let n=new Kd(t,this.persistence);return new Gd(e.asyncQueue,n)}createPersistence(e){let t=zp(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Pt.withCacheSize(this.cacheSizeBytes):Pt.DEFAULT;return new $f(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,QE(),Xu(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Rc}},fp=class r extends Lc{constructor(e,t){super(e,t,!1),this.Qa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return P(this,null,function*(){yield Nl(r.prototype,this,"initialize").call(this,e);let t=this.Qa.syncEngine;this.sharedClientState instanceof jo&&(this.sharedClientState.syncEngine={Zs:JR.bind(null,t),Xs:eD.bind(null,t),eo:tD.bind(null,t),Bi:ZR.bind(null,t),Ys:XR.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.fi(n=>P(this,null,function*(){yield YR(this.Qa.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let t=QE();if(!jo.D(t))throw new M(R.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let n=zp(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new jo(t,e.asyncQueue,n,e.clientId,e.initialUser)}},oa=class{initialize(e,t){return P(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Rw(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=WR.bind(null,this.syncEngine),yield np(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new sp}()}createDatastore(e){let t=fa(e.databaseInfo.databaseId),n=function(s){return new Xf(s)}(e.databaseInfo);return function(s,o,u,c){return new Zf(s,o,u,c)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,i,s,o,u){return new tp(n,i,s,o,u)}(this.localStore,this.datastore,e.asyncQueue,t=>Rw(this.syncEngine,t,0),function(){return Dc.D()?new Dc:new Hf}())}createSyncEngine(e,t){return function(i,s,o,u,c,l,f){let p=new hp(i,s,o,u,c,l);return f&&(p.La=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return P(this,null,function*(){var e;yield function(n){return P(this,null,function*(){let i=U(n);N("RemoteStore","RemoteStore shutting down."),i.M_.add(5),yield ds(i),i.O_.shutdown(),i.N_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function Pw(r,e=10240){let t=0;return{read(){return P(this,null,function*(){if(t<r.byteLength){let i={value:r.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return P(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var as=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):Pe("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var pp=class{constructor(e,t){this.Ua=e,this.serializer=t,this.metadata=new Le,this.buffer=new Uint8Array,this.Wa=function(){return new TextDecoder("utf-8")}(),this.Ga().then(n=>{n&&n.sa()?this.metadata.resolve(n.ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(n?.ia)}`))},n=>this.metadata.reject(n))}close(){return this.Ua.cancel()}getMetadata(){return P(this,null,function*(){return this.metadata.promise})}qa(){return P(this,null,function*(){return yield this.getMetadata(),this.Ga()})}Ga(){return P(this,null,function*(){let e=yield this.za();if(e===null)return null;let t=this.Wa.decode(e),n=Number(t);isNaN(n)&&this.ja(`length string (${t}) is not valid number`);let i=yield this.Ha(n);return new ap(JSON.parse(i),e.length+n)})}Ja(){return this.buffer.findIndex(e=>e===123)}za(){return P(this,null,function*(){for(;this.Ja()<0&&!(yield this.Ya()););if(this.buffer.length===0)return null;let e=this.Ja();e<0&&this.ja("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}Ha(e){return P(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ya())&&this.ja("Reached the end of bundle when more is expected.");let t=this.Wa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}ja(e){throw this.Ua.cancel(),new Error(`Invalid bundle format: ${e}`)}Ya(){return P(this,null,function*(){let e=yield this.Ua.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var gp=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return P(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new M(R.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,s){return P(this,null,function*(){let o=U(i),u={documents:s.map(p=>Yo(o.serializer,p))},c=yield o.xo("BatchGetDocuments",o.serializer.databaseId,oe.emptyPath(),u,s.length),l=new Map;c.forEach(p=>{let m=aR(o.serializer,p);l.set(m.key.toString(),m)});let f=[];return s.forEach(p=>{let m=l.get(p.toString());G(!!m),f.push(m)}),f})}(this.datastore,e);return t.forEach(n=>this.recordVersion(n)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new ir(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return P(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,n)=>{let i=L.fromPath(n);this.mutations.push(new Wo(i,this.precondition(i)))}),yield function(n,i){return P(this,null,function*(){let s=U(n),o={writes:i.map(u=>Zo(s.serializer,u))};yield s.Co("Commit",s.serializer.databaseId,oe.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw q();t=W.min()}let n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new M(R.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(W.min())?De.exists(!1):De.updateTime(t):De.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(W.min()))throw new M(R.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return De.updateTime(t)}return De.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var mp=class{constructor(e,t,n,i,s){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=i,this.deferred=s,this.Za=n.maxAttempts,this.Yo=new ra(this.asyncQueue,"transaction_retry")}Xa(){this.Za-=1,this.eu()}eu(){this.Yo.$o(()=>P(this,null,function*(){let e=new gp(this.datastore),t=this.tu(e);t&&t.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(i=>{this.nu(i)}))}).catch(n=>{this.nu(n)})}))}tu(e){try{let t=this.updateFunction(e);return!ca(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}nu(e){this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget(()=>(this.eu(),Promise.resolve()))):this.deferred.reject(e)}ru(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!wE(t)}return!1}};var yp=class{constructor(e,t,n,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=Fe.UNAUTHENTICATED,this.clientId=Zu.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,s=>P(this,null,function*(){N("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(n,s=>(N("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new M(R.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Le;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>P(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let n=gs(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}};function Ju(r,e){return P(this,null,function*(){r.asyncQueue.verifyOperationInProgress(),N("FirestoreClient","Initializing OfflineComponentProvider");let t=r.configuration;yield e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(i=>P(this,null,function*(){n.isEqual(i)||(yield $E(e.localStore,i),n=i)})),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e})}function vp(r,e){return P(this,null,function*(){r.asyncQueue.verifyOperationInProgress();let t=yield ng(r);N("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>Cw(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,i)=>Cw(e.remoteStore,i)),r._onlineComponents=e})}function oI(r){return r.name==="FirebaseError"?r.code===R.FAILED_PRECONDITION||r.code===R.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}function ng(r){return P(this,null,function*(){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){N("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Ju(r,r._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!oI(t))throw t;xt("Error using user provided cache. Falling back to memory cache: "+t),yield Ju(r,new sa)}}else N("FirestoreClient","Using default OfflineComponentProvider"),yield Ju(r,new sa);return r._offlineComponents})}function Jc(r){return P(this,null,function*(){return r._onlineComponents||(r._uninitializedComponentsProvider?(N("FirestoreClient","Using user provided OnlineComponentProvider"),yield vp(r,r._uninitializedComponentsProvider._online)):(N("FirestoreClient","Using default OnlineComponentProvider"),yield vp(r,new oa))),r._onlineComponents})}function aI(r){return ng(r).then(e=>e.persistence)}function rg(r){return ng(r).then(e=>e.localStore)}function uI(r){return Jc(r).then(e=>e.remoteStore)}function ig(r){return Jc(r).then(e=>e.syncEngine)}function rD(r){return Jc(r).then(e=>e.datastore)}function us(r){return P(this,null,function*(){let e=yield Jc(r),t=e.eventManager;return t.onListen=FR.bind(null,e.syncEngine),t.onUnlisten=UR.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=LR.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=jR.bind(null,e.syncEngine),t})}function iD(r){return r.asyncQueue.enqueue(()=>P(this,null,function*(){let e=yield aI(r),t=yield uI(r);return e.setNetworkEnabled(!0),function(i){let s=U(i);return s.M_.delete(0),pa(s)}(t)}))}function sD(r){return r.asyncQueue.enqueue(()=>P(this,null,function*(){let e=yield aI(r),t=yield uI(r);return e.setNetworkEnabled(!1),function(i){return P(this,null,function*(){let s=U(i);s.M_.add(0),yield ds(s),s.N_.set("Offline")})}(t)}))}function oD(r,e){let t=new Le;return r.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(i,s,o){return P(this,null,function*(){try{let u=yield function(l,f){let p=U(l);return p.persistence.runTransaction("read document","readonly",m=>p.localDocuments.getDocument(m,f))}(i,s);u.isFoundDocument()?o.resolve(u):u.isNoDocument()?o.resolve(null):o.reject(new M(R.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(u){let c=gs(u,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield rg(r),e,t)})),t.promise}function cI(r,e,t={}){let n=new Le;return r.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(s,o,u,c,l){let f=new as({next:m=>{o.enqueueAndForget(()=>Qp(s,p));let w=m.docs.has(u);!w&&m.fromCache?l.reject(new M(R.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&m.fromCache&&c&&c.source==="server"?l.reject(new M(R.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new ia(hs(u.path),f,{includeMetadataChanges:!0,ra:!0});return Hp(s,p)}(yield us(r),r.asyncQueue,e,t,n)})),n.promise}function aD(r,e){let t=new Le;return r.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(i,s,o){return P(this,null,function*(){try{let u=yield bc(i,s,!0),c=new Fc(s,u.hs),l=c.da(u.documents),f=c.applyChanges(l,!1);o.resolve(f.snapshot)}catch(u){let c=gs(u,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield rg(r),e,t)})),t.promise}function lI(r,e,t={}){let n=new Le;return r.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(s,o,u,c,l){let f=new as({next:m=>{o.enqueueAndForget(()=>Qp(s,p)),m.fromCache&&c.source==="server"?l.reject(new M(R.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new ia(u,f,{includeMetadataChanges:!0,ra:!0});return Hp(s,p)}(yield us(r),r.asyncQueue,e,t,n)})),n.promise}function uD(r,e){let t=new as(e);return r.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(i,s){U(i).z_.add(s),s.next()}(yield us(r),t)})),()=>{t.$a(),r.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(i,s){U(i).z_.delete(s)}(yield us(r),t)}))}}function cD(r,e,t,n){let i=function(o,u){let c;return c=typeof o=="string"?IE().encode(o):o,function(f,p){return new pp(f,p)}(function(f,p){if(f instanceof Uint8Array)return Pw(f,p);if(f instanceof ArrayBuffer)return Pw(new Uint8Array(f),p);if(f instanceof ReadableStream)return f.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),u)}(t,fa(e));r.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){nD(yield ig(r),i,n)}))}function lD(r,e){return r.asyncQueue.enqueue(()=>P(this,null,function*(){return function(n,i){let s=U(n);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield rg(r),e)}))}function hI(r){let e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}var xw=new Map;function sg(r,e,t){if(!t)throw new M(R.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function og(r,e,t,n){if(e===!0&&n===!0)throw new M(R.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function Vw(r){if(!L.isDocumentKey(r))throw new M(R.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function Mw(r){if(L.isDocumentKey(r))throw new M(R.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function Yc(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{let e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":q()}function ae(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new M(R.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Yc(r);throw new M(R.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}function dI(r,e){if(e<=0)throw new M(R.INVALID_ARGUMENT,`Function ${r}() requires a positive number, but it was: ${e}.`)}var Uc=class{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new M(R.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new M(R.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}og("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=hI((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new M(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new M(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new M(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},$r=class{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Uc({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new M(R.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new M(R.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Uc(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new kd;switch(n.type){case"firstParty":return new Ud(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new M(R.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let n=xw.get(t);n&&(N("ComponentProvider","Removing Datastore"),xw.delete(t),n.terminate())}(this),Promise.resolve()}};function ag(r,e,t,n={}){var i;let s=(r=ae(r,$r))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&xt("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),r._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),n.mockUserToken){let u,c;if(typeof n.mockUserToken=="string")u=n.mockUserToken,c=Fe.MOCK_USER;else{u=Ey(n.mockUserToken,(i=r._app)===null||i===void 0?void 0:i.options.projectId);let l=n.mockUserToken.sub||n.mockUserToken.user_id;if(!l)throw new M(R.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Fe(l)}r._authCredentials=new Od(new Yu(u,c))}}var Ke=class r{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new r(this.firestore,e,this._query)}},ge=class r{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new tn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new r(this.firestore,e,this._key)}},tn=class r extends Ke{constructor(e,t,n){super(e,t,hs(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new ge(this.firestore,null,new L(e))}withConverter(e){return new r(this.firestore,e,this._path)}};function ug(r,e,...t){if(r=Ae(r),sg("collection","path",e),r instanceof $r){let n=oe.fromString(e,...t);return Mw(n),new tn(r,null,n)}{if(!(r instanceof ge||r instanceof tn))throw new M(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=r._path.child(oe.fromString(e,...t));return Mw(n),new tn(r.firestore,null,n)}}function fI(r,e){if(r=ae(r,$r),sg("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new M(R.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Ke(r,null,function(n){return new Lt(oe.emptyPath(),n)}(e))}function ga(r,e,...t){if(r=Ae(r),arguments.length===1&&(e=Zu.newId()),sg("doc","path",e),r instanceof $r){let n=oe.fromString(e,...t);return Vw(n),new ge(r,null,new L(n))}{if(!(r instanceof ge||r instanceof tn))throw new M(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=r._path.child(oe.fromString(e,...t));return Vw(n),new ge(r.firestore,r instanceof tn?r.converter:null,new L(n))}}function cg(r,e){return r=Ae(r),e=Ae(e),(r instanceof ge||r instanceof tn)&&(e instanceof ge||e instanceof tn)&&r.firestore===e.firestore&&r.path===e.path&&r.converter===e.converter}function lg(r,e){return r=Ae(r),e=Ae(e),r instanceof Ke&&e instanceof Ke&&r.firestore===e.firestore&&ha(r._query,e._query)&&r.converter===e.converter}var _p=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new ra(this,"async_queue_retry"),this.hu=()=>{let t=Xu();t&&N("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Yo.Wo()};let e=Xu();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let t=Xu();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let t=new Le;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return P(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!ar(e))throw e;N("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}})}Iu(e){let t=this.iu.then(()=>(this.uu=!0,e().catch(n=>{this.au=n,this.uu=!1;let i=function(o){let u=o.message||"";return o.stack&&(u=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),u}(n);throw Pe("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.uu=!1,n))));return this.iu=t,t}enqueueAfterDelay(e,t,n){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);let i=rp.createAndSchedule(this,e,t,n,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&q()}verifyOperationInProgress(){}du(){return P(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(let t of this._u)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let t=this._u.indexOf(e);this._u.splice(t,1)}};function wp(r){return function(t,n){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(r,["next","error","complete"])}var Ep=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Le,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var pI=-1,Te=class extends $r{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=function(){return new _p}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||gI(this),this._firestoreClient.terminate()}};function HV(r,e){let t=typeof r=="object"?r:Hs(),n=typeof r=="string"?r:e||"(default)",i=rh(t,"firestore").getImmediate({identifier:n});if(!i._initialized){let s=wy("firestore");s&&ag(i,...s)}return i}function Be(r){return r._firestoreClient||gI(r),r._firestoreClient.verifyNotTerminated(),r._firestoreClient}function gI(r){var e,t,n;let i=r._freezeSettings(),s=function(u,c,l,f){return new Wd(u,c,l,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,hI(f.experimentalLongPollingOptions),f.useFetchStreams)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,i);r._firestoreClient=new yp(r._authCredentials,r._appCheckCredentials,r._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(r._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function mI(r,e){bI(r=ae(r,Te));let t=Be(r);if(t._uninitializedComponentsProvider)throw new M(R.FAILED_PRECONDITION,"SDK cache is already specified.");xt("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=r._freezeSettings(),i=new oa;return vI(t,i,new Lc(i,n.cacheSizeBytes,e?.forceOwnership))}function yI(r){bI(r=ae(r,Te));let e=Be(r);if(e._uninitializedComponentsProvider)throw new M(R.FAILED_PRECONDITION,"SDK cache is already specified.");xt("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=r._freezeSettings(),n=new oa;return vI(e,n,new fp(n,t.cacheSizeBytes))}function vI(r,e,t){let n=new Le;return r.asyncQueue.enqueue(()=>P(this,null,function*(){try{yield Ju(r,t),yield vp(r,e),n.resolve()}catch(i){let s=i;if(!oI(s))throw s;xt("Error enabling indexeddb cache. Falling back to memory cache: "+s),n.reject(s)}})).then(()=>n.promise)}function _I(r){if(r._initialized&&!r._terminated)throw new M(R.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Le;return r._queue.enqueueAndForgetEvenWhileRestricted(()=>P(this,null,function*(){try{yield function(n){return P(this,null,function*(){if(!Jn.D())return Promise.resolve();let i=n+"main";yield Jn.delete(i)})}(zp(r._databaseId,r._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function wI(r){return function(t){let n=new Le;return t.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return GR(yield ig(t),n)})),n.promise}(Be(r=ae(r,Te)))}function EI(r){return iD(Be(r=ae(r,Te)))}function II(r){return sD(Be(r=ae(r,Te)))}function TI(r,e){let t=Be(r=ae(r,Te)),n=new Ep;return cD(t,r._databaseId,e,n),n}function AI(r,e){return lD(Be(r=ae(r,Te)),e).then(t=>t?new Ke(r,null,t.query):null)}function bI(r){if(r._initialized||r._terminated)throw new M(R.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var on=class r{constructor(e){this._byteString=e}static fromBase64String(e){try{return new r($e.fromBase64String(e))}catch(t){throw new M(R.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new r($e.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var jt=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new M(R.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var En=class{constructor(e){this._methodName=e}};var zr=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new M(R.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new M(R.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Z(this._lat,e._lat)||Z(this._long,e._long)}};var hD=/^__.*__$/,Ip=class{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Ut(e,this.data,this.fieldMask,t,this.fieldTransforms):new rr(e,this.data,t,this.fieldTransforms)}},jc=class{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Ut(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function CI(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw q()}}var Bc=class r{constructor(e,t,n,i,s,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new r(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;let n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:n,yu:!1});return i.wu(e),i}Su(e){var t;let n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:n,yu:!1});return i.mu(),i}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return qc(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(CI(this.fu)&&hD.test(e))throw this.Du('Document fields cannot begin and end with "__"')}},Tp=class{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||fa(e)}Fu(e,t,n,i=!1){return new Bc({fu:e,methodName:t,vu:n,path:xe.emptyPath(),yu:!1,Cu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Hr(r){let e=r._freezeSettings(),t=fa(r._databaseId);return new Tp(r._databaseId,!!e.ignoreUndefinedProperties,t)}function Zc(r,e,t,n,i,s={}){let o=r.Fu(s.merge||s.mergeFields?2:0,e,t,i);fg("Data must be an object, but it was:",o,n);let u=DI(n,o),c,l;if(s.merge)c=new It(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let f=[];for(let p of s.mergeFields){let m=Rp(e,p,t);if(!o.contains(m))throw new M(R.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);xI(f,m)||f.push(m)}c=new It(f),l=o.fieldTransforms.filter(p=>c.covers(p.field))}else c=null,l=o.fieldTransforms;return new Ip(new Ze(u),c,l)}var aa=class r extends En{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof r}};function SI(r,e,t){return new Bc({fu:3,vu:e.settings.vu,methodName:r._methodName,yu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var Ap=class r extends En{_toFieldTransform(e){return new jr(e.path,new tr)}isEqual(e){return e instanceof r}},bp=class r extends En{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=SI(this,e,!0),n=this.Mu.map(s=>Qr(s,t)),i=new _n(n);return new jr(e.path,i)}isEqual(e){return e instanceof r&&nh(this.Mu,e.Mu)}},Cp=class r extends En{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=SI(this,e,!0),n=this.Mu.map(s=>Qr(s,t)),i=new wn(n);return new jr(e.path,i)}isEqual(e){return e instanceof r&&nh(this.Mu,e.Mu)}},Sp=class r extends En{constructor(e,t){super(e),this.xu=t}_toFieldTransform(e){let t=new nr(e.serializer,fE(e.serializer,this.xu));return new jr(e.path,t)}isEqual(e){return e instanceof r&&this.xu===e.xu}};function hg(r,e,t,n){let i=r.Fu(1,e,t);fg("Data must be an object, but it was:",i,n);let s=[],o=Ze.empty();Wr(n,(c,l)=>{let f=pg(e,c,t);l=Ae(l);let p=i.Su(f);if(l instanceof aa)s.push(f);else{let m=Qr(l,p);m!=null&&(s.push(f),o.set(f,m))}});let u=new It(s);return new jc(o,u,i.fieldTransforms)}function dg(r,e,t,n,i,s){let o=r.Fu(1,e,t),u=[Rp(e,n,t)],c=[i];if(s.length%2!=0)throw new M(R.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)u.push(Rp(e,s[m])),c.push(s[m+1]);let l=[],f=Ze.empty();for(let m=u.length-1;m>=0;--m)if(!xI(l,u[m])){let w=u[m],x=c[m];x=Ae(x);let V=o.Su(w);if(x instanceof aa)l.push(w);else{let D=Qr(x,V);D!=null&&(l.push(w),f.set(w,D))}}let p=new It(l);return new jc(f,p,o.fieldTransforms)}function RI(r,e,t,n=!1){return Qr(t,r.Fu(n?4:3,e))}function Qr(r,e){if(PI(r=Ae(r)))return fg("Unsupported field value:",e,r),DI(r,e);if(r instanceof En)return function(n,i){if(!CI(i.fu))throw i.Du(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Du(`${n._methodName}() is not currently supported inside arrays`);let s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(n,i){let s=[],o=0;for(let u of n){let c=Qr(u,i.bu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(r,e)}return function(n,i){if((n=Ae(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return fE(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){let s=be.fromDate(n);return{timestampValue:Zi(i.serializer,s)}}if(n instanceof be){let s=new be(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Zi(i.serializer,s)}}if(n instanceof zr)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof on)return{bytesValue:TE(i.serializer,n._byteString)};if(n instanceof ge){let s=i.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw i.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Bp(n.firestore._databaseId||i.databaseId,n._key.path)}}throw i.Du(`Unsupported field value: ${Yc(n)}`)}(r,e)}function DI(r,e){let t={};return Qw(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Wr(r,(n,i)=>{let s=Qr(i,e.pu(n));s!=null&&(t[n]=s)}),{mapValue:{fields:t}}}function PI(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof be||r instanceof zr||r instanceof on||r instanceof ge||r instanceof En)}function fg(r,e,t){if(!PI(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let n=Yc(t);throw n==="an object"?e.Du(r+" a custom object"):e.Du(r+" "+n)}}function Rp(r,e,t){if((e=Ae(e))instanceof jt)return e._internalPath;if(typeof e=="string")return pg(r,e);throw qc("Field path arguments must be of type string or ",r,!1,void 0,t)}var dD=new RegExp("[~\\*/\\[\\]]");function pg(r,e,t){if(e.search(dD)>=0)throw qc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new jt(...e.split("."))._internalPath}catch{throw qc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function qc(r,e,t,n,i){let s=n&&!n.isEmpty(),o=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${n}`),o&&(c+=` in document ${i}`),c+=")"),new M(R.INVALID_ARGUMENT,u+r+c)}function xI(r,e){return r.some(t=>t.isEqual(e))}var Gr=class{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ge(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Dp(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(el("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Dp=class extends Gr{data(){return super.data()}};function el(r,e){return typeof e=="string"?pg(r,e):e instanceof jt?e._internalPath:e._delegate._internalPath}function VI(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new M(R.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ua=class{},Kr=class extends ua{};function An(r,e,...t){let n=[];e instanceof ua&&n.push(e),n=n.concat(t),function(s){let o=s.filter(c=>c instanceof Pp).length,u=s.filter(c=>c instanceof $c).length;if(o>1||o>0&&u>0)throw new M(R.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(let i of n)r=i._apply(r);return r}var $c=class r extends Kr{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new r(e,t,n)}_apply(e){let t=this._parse(e);return qI(e._query,t),new Ke(e.firestore,e.converter,af(e._query,t))}_parse(e){let t=Hr(e.firestore);return function(s,o,u,c,l,f,p){let m;if(l.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new M(R.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){kw(p,f);let w=[];for(let x of p)w.push(Nw(c,s,x));m={arrayValue:{values:w}}}else m=Nw(c,s,p)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||kw(p,f),m=RI(u,o,p,f==="in"||f==="not-in");return ie.create(l,f,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function MI(r,e,t){let n=e,i=el("where",r);return $c._create(i,n,t)}var Pp=class r extends ua{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new r(e,t)}_parse(e){let t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:le.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,u=s.getFlattenedFilters();for(let c of u)qI(o,c),o=af(o,c)}(e._query,t),new Ke(e.firestore,e.converter,af(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var xp=class r extends Kr{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new r(e,t)}_apply(e){let t=function(i,s,o){if(i.startAt!==null)throw new M(R.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new M(R.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Lr(s,o)}(e._query,this._field,this._direction);return new Ke(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new Lt(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function NI(r,e="asc"){let t=e,n=el("orderBy",r);return xp._create(n,t)}var zc=class r extends Kr{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new r(e,t,n)}_apply(e){return new Ke(e.firestore,e.converter,cc(e._query,this._limit,this._limitType))}};function kI(r){return dI("limit",r),zc._create("limit",r,"F")}function OI(r){return dI("limitToLast",r),zc._create("limitToLast",r,"L")}var Gc=class r extends Kr{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new r(e,t,n)}_apply(e){let t=BI(e,this.type,this._docOrFields,this._inclusive);return new Ke(e.firestore,e.converter,function(i,s){return new Lt(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}};function FI(...r){return Gc._create("startAt",r,!0)}function LI(...r){return Gc._create("startAfter",r,!1)}var Kc=class r extends Kr{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new r(e,t,n)}_apply(e){let t=BI(e,this.type,this._docOrFields,this._inclusive);return new Ke(e.firestore,e.converter,function(i,s){return new Lt(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}};function UI(...r){return Kc._create("endBefore",r,!1)}function jI(...r){return Kc._create("endAt",r,!0)}function BI(r,e,t,n){if(t[0]=Ae(t[0]),t[0]instanceof Gr)return function(s,o,u,c,l){if(!c)throw new M(R.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${u}().`);let f=[];for(let p of Gi(s))if(p.field.isKeyField())f.push(Fr(o,c.key));else{let m=c.data.field(p.field);if(Hc(m))throw new M(R.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){let w=p.field.canonicalString();throw new M(R.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${w}' (used as the orderBy) does not exist.`)}f.push(m)}return new rn(f,l)}(r._query,r.firestore._databaseId,e,t[0]._document,n);{let i=Hr(r.firestore);return function(o,u,c,l,f,p){let m=o.explicitOrderBy;if(f.length>m.length)throw new M(R.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let w=[];for(let x=0;x<f.length;x++){let V=f[x];if(m[x].field.isKeyField()){if(typeof V!="string")throw new M(R.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof V}`);if(!Up(o)&&V.indexOf("/")!==-1)throw new M(R.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${V}' contains a slash.`);let D=o.path.child(oe.fromString(V));if(!L.isDocumentKey(D))throw new M(R.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${D}' is not because it contains an odd number of segments.`);let k=new L(D);w.push(Fr(u,k))}else{let D=RI(c,l,V);w.push(D)}}return new rn(w,p)}(r._query,r.firestore._databaseId,i,e,t,n)}}function Nw(r,e,t){if(typeof(t=Ae(t))=="string"){if(t==="")throw new M(R.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Up(e)&&t.indexOf("/")!==-1)throw new M(R.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let n=e.path.child(oe.fromString(t));if(!L.isDocumentKey(n))throw new M(R.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Fr(r,new L(n))}if(t instanceof ge)return Fr(r,t._key);throw new M(R.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Yc(t)}.`)}function kw(r,e){if(!Array.isArray(r)||r.length===0)throw new M(R.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function qI(r,e){let t=function(i,s){for(let o of i)for(let u of o.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(r.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new M(R.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new M(R.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var cs=class{convertValue(e,t="none"){switch(Or(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Re(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Yn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw q()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let n={};return Wr(e,(i,s)=>{n[i]=this.convertValue(s,t)}),n}convertGeoPoint(e){return new zr(Re(e.latitude),Re(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":let n=Fp(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(zo(e));default:return null}}convertTimestamp(e){let t=vn(e);return new be(t.seconds,t.nanos)}convertDocumentKey(e,t){let n=oe.fromString(e);G(NE(n));let i=new Zn(n.get(1),n.get(3)),s=new L(n.popFirst(5));return i.isEqual(t)||Pe(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function tl(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}var Vp=class extends cs{constructor(e){super(),this.firestore=e}convertBytes(e){return new on(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new ge(this.firestore,null,t)}};var yn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Mt=class extends Gr{constructor(e,t,n,i,s,o){super(e,t,n,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Qn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let n=this._document.data.field(el("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}},Qn=class extends Mt{data(e={}){return super.data(e)}},Bt=class{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new yn(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Qn(this._firestore,this._userDataWriter,n.key,n,new yn(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new M(R.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(u=>{let c=new Qn(i._firestore,i._userDataWriter,u.doc.key,u.doc,new yn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{let c=new Qn(i._firestore,i._userDataWriter,u.doc.key,u.doc,new yn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,f=-1;return u.type!==0&&(l=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),f=o.indexOf(u.doc.key)),{type:fD(u.type),doc:c,oldIndex:l,newIndex:f}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function fD(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return q()}}function gg(r,e){return r instanceof Mt&&e instanceof Mt?r._firestore===e._firestore&&r._key.isEqual(e._key)&&(r._document===null?e._document===null:r._document.isEqual(e._document))&&r._converter===e._converter:r instanceof Bt&&e instanceof Bt&&r._firestore===e._firestore&&lg(r.query,e.query)&&r.metadata.isEqual(e.metadata)&&r._snapshot.isEqual(e._snapshot)}function $I(r){r=ae(r,ge);let e=ae(r.firestore,Te);return cI(Be(e),r._key).then(t=>_g(e,r,t))}var In=class extends cs{constructor(e){super(),this.firestore=e}convertBytes(e){return new on(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new ge(this.firestore,null,t)}};function zI(r){r=ae(r,ge);let e=ae(r.firestore,Te),t=Be(e),n=new In(e);return oD(t,r._key).then(i=>new Mt(e,n,r._key,i,new yn(i!==null&&i.hasLocalMutations,!0),r.converter))}function GI(r){r=ae(r,ge);let e=ae(r.firestore,Te);return cI(Be(e),r._key,{source:"server"}).then(t=>_g(e,r,t))}function KI(r){r=ae(r,Ke);let e=ae(r.firestore,Te),t=Be(e),n=new In(e);return VI(r._query),lI(t,r._query).then(i=>new Bt(e,n,r,i))}function WI(r){r=ae(r,Ke);let e=ae(r.firestore,Te),t=Be(e),n=new In(e);return aD(t,r._query).then(i=>new Bt(e,n,r,i))}function HI(r){r=ae(r,Ke);let e=ae(r.firestore,Te),t=Be(e),n=new In(e);return lI(t,r._query,{source:"server"}).then(i=>new Bt(e,n,r,i))}function mg(r,e,t){r=ae(r,ge);let n=ae(r.firestore,Te),i=tl(r.converter,e,t);return ms(n,[Zc(Hr(n),"setDoc",r._key,i,r.converter!==null,t).toMutation(r._key,De.none())])}function yg(r,e,t,...n){r=ae(r,ge);let i=ae(r.firestore,Te),s=Hr(i),o;return o=typeof(e=Ae(e))=="string"||e instanceof jt?dg(s,"updateDoc",r._key,e,t,n):hg(s,"updateDoc",r._key,e),ms(i,[o.toMutation(r._key,De.exists(!0))])}function QI(r){return ms(ae(r.firestore,Te),[new ir(r._key,De.none())])}function XI(r,e){let t=ae(r.firestore,Te),n=ga(r),i=tl(r.converter,e);return ms(t,[Zc(Hr(r.firestore),"addDoc",n._key,i,r.converter!==null,{}).toMutation(n._key,De.exists(!1))]).then(()=>n)}function vg(r,...e){var t,n,i;r=Ae(r);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||wp(e[o])||(s=e[o],o++);let u={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(wp(e[o])){let p=e[o];e[o]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[o+1]=(n=p.error)===null||n===void 0?void 0:n.bind(p),e[o+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let c,l,f;if(r instanceof ge)l=ae(r.firestore,Te),f=hs(r._key.path),c={next:p=>{e[o]&&e[o](_g(l,r,p))},error:e[o+1],complete:e[o+2]};else{let p=ae(r,Ke);l=ae(p.firestore,Te),f=p._query;let m=new In(l);c={next:w=>{e[o]&&e[o](new Bt(l,m,p,w))},error:e[o+1],complete:e[o+2]},VI(r._query)}return function(m,w,x,V){let D=new as(V),k=new ia(w,D,x);return m.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return Hp(yield us(m),k)})),()=>{D.$a(),m.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return Qp(yield us(m),k)}))}}(Be(l),f,u,c)}function JI(r,e){return uD(Be(r=ae(r,Te)),wp(e)?e:{next:e})}function ms(r,e){return function(n,i){let s=new Le;return n.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return BR(yield ig(n),i,s)})),s.promise}(Be(r),e)}function _g(r,e,t){let n=t.docs.get(e._key),i=new In(r);return new Mt(r,i,e._key,n,new yn(t.hasPendingWrites,t.fromCache),e.converter)}var pD={maxAttempts:5};var Wc=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Hr(e)}set(e,t,n){this._verifyNotCommitted();let i=Wn(e,this._firestore),s=tl(i.converter,t,n),o=Zc(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,n);return this._mutations.push(o.toMutation(i._key,De.none())),this}update(e,t,n,...i){this._verifyNotCommitted();let s=Wn(e,this._firestore),o;return o=typeof(t=Ae(t))=="string"||t instanceof jt?dg(this._dataReader,"WriteBatch.update",s._key,t,n,i):hg(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,De.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Wn(e,this._firestore);return this._mutations=this._mutations.concat(new ir(t._key,De.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new M(R.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Wn(r,e){if((r=Ae(r)).firestore!==e)throw new M(R.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}var Mp=class extends class{constructor(t,n){this._firestore=t,this._transaction=n,this._dataReader=Hr(t)}get(t){let n=Wn(t,this._firestore),i=new Vp(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return q();let o=s[0];if(o.isFoundDocument())return new Gr(this._firestore,i,o.key,o,n.converter);if(o.isNoDocument())return new Gr(this._firestore,i,n._key,null,n.converter);throw q()})}set(t,n,i){let s=Wn(t,this._firestore),o=tl(s.converter,n,i),u=Zc(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,u),this}update(t,n,i,...s){let o=Wn(t,this._firestore),u;return u=typeof(n=Ae(n))=="string"||n instanceof jt?dg(this._dataReader,"Transaction.update",o._key,n,i,s):hg(this._dataReader,"Transaction.update",o._key,n),this._transaction.update(o._key,u),this}delete(t){let n=Wn(t,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Wn(e,this._firestore),n=new In(this._firestore);return super.get(e).then(i=>new Mt(this._firestore,n,t._key,i._document,new yn(!1,!1),t.converter))}};function YI(r,e,t){r=ae(r,Te);let n=Object.assign(Object.assign({},pD),t);return function(s){if(s.maxAttempts<1)throw new M(R.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(s,o,u){let c=new Le;return s.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){let l=yield rD(s);new mp(s.asyncQueue,l,u,o,c).Xa()})),c.promise}(Be(r),i=>e(new Mp(r,i)),n)}function ZI(){return new aa("deleteField")}function eT(){return new Ap("serverTimestamp")}function tT(...r){return new bp("arrayUnion",r)}function nT(...r){return new Cp("arrayRemove",r)}function rT(r){return new Sp("increment",r)}(function(e,t=!0){(function(i){ls=i})(Ay),Ws(new wr("firestore",(n,{instanceIdentifier:i,options:s})=>{let o=n.getProvider("app").getImmediate(),u=new Te(new Fd(n.getProvider("auth-internal")),new Bd(n.getProvider("app-check-internal")),function(l,f){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new M(R.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zn(l.options.projectId,f)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),Rt(O_,"4.6.4",e),Rt(O_,"4.6.4","esm2017")})();var gD="@firebase/firestore-compat",mD="0.3.33";function bg(r,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new M("invalid-argument",`Invalid options passed to function ${r}(): You cannot specify both "merge" and "mergeFields".`);return e}function iT(){if(typeof Uint8Array>"u")throw new M("unimplemented","Uint8Arrays are not available in this environment.")}function sT(){if(!Xw())throw new M("unimplemented","Blobs are unavailable in Firestore in this environment.")}var nl=class r{constructor(e){this._delegate=e}static fromBase64String(e){return sT(),new r(on.fromBase64String(e))}static fromUint8Array(e){return iT(),new r(on.fromUint8Array(e))}toBase64(){return sT(),this._delegate.toBase64()}toUint8Array(){return iT(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function wg(r){return yD(r,["next","error","complete"])}function yD(r,e){if(typeof r!="object"||r===null)return!1;let t=r;for(let n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}var Eg=class{enableIndexedDbPersistence(e,t){return mI(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return yI(e._delegate)}clearIndexedDbPersistence(e){return _I(e._delegate)}},rl=class{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof Zn||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&xt("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,n={}){ag(this._delegate,e,t,n)}enableNetwork(){return EI(this._delegate)}disableNetwork(){return II(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,og("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return wI(this._delegate)}onSnapshotsInSync(e){return JI(this._delegate,e)}get app(){if(!this._appCompat)throw new M("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new _s(this,ug(this._delegate,e))}catch(t){throw ot(t,"collection()","Firestore.collection()")}}doc(e){try{return new an(this,ga(this._delegate,e))}catch(t){throw ot(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Zr(this,fI(this._delegate,e))}catch(t){throw ot(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return YI(this._delegate,t=>e(new il(this,t)))}batch(){return Be(this._delegate),new sl(new Wc(this._delegate,e=>ms(this._delegate,e)))}loadBundle(e){return TI(this._delegate,e)}namedQuery(e){return AI(this._delegate,e).then(t=>t?new Zr(this,t):null)}},ys=class extends cs{constructor(e){super(),this.firestore=e}convertBytes(e){return new nl(new on(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return an.forKey(t,this.firestore,null)}};function vD(r){Ow(r)}var il=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new ys(e)}get(e){let t=Xr(e);return this._delegate.get(t).then(n=>new Jr(this._firestore,new Mt(this._firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,t.converter)))}set(e,t,n){let i=Xr(e);return n?(bg("Transaction.set",n),this._delegate.set(i,t,n)):this._delegate.set(i,t),this}update(e,t,n,...i){let s=Xr(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,n,...i),this}delete(e){let t=Xr(e);return this._delegate.delete(t),this}},sl=class{constructor(e){this._delegate=e}set(e,t,n){let i=Xr(e);return n?(bg("WriteBatch.set",n),this._delegate.set(i,t,n)):this._delegate.set(i,t),this}update(e,t,n,...i){let s=Xr(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,n,...i),this}delete(e){let t=Xr(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},vs=class r{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){let n=new Qn(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Yr(this._firestore,n),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let n=r.INSTANCES,i=n.get(e);i||(i=new WeakMap,n.set(e,i));let s=i.get(t);return s||(s=new r(e,new ys(e),t),i.set(t,s)),s}};vs.INSTANCES=new WeakMap;var an=class r{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ys(e)}static forPath(e,t,n){if(e.length%2!==0)throw new M("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new r(t,new ge(t._delegate,n,new L(e)))}static forKey(e,t,n){return new r(t,new ge(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new _s(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new _s(this.firestore,ug(this._delegate,e))}catch(t){throw ot(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Ae(e),e instanceof ge?cg(this._delegate,e):!1}set(e,t){t=bg("DocumentReference.set",t);try{return t?mg(this._delegate,e,t):mg(this._delegate,e)}catch(n){throw ot(n,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{return arguments.length===1?yg(this._delegate,e):yg(this._delegate,e,t,...n)}catch(i){throw ot(i,"updateDoc()","DocumentReference.update()")}}delete(){return QI(this._delegate)}onSnapshot(...e){let t=oT(e),n=aT(e,i=>new Jr(this.firestore,new Mt(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return vg(this._delegate,t,n)}get(e){let t;return e?.source==="cache"?t=zI(this._delegate):e?.source==="server"?t=GI(this._delegate):t=$I(this._delegate),t.then(n=>new Jr(this.firestore,new Mt(this.firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,this._delegate.converter)))}withConverter(e){return new r(this.firestore,e?this._delegate.withConverter(vs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function ot(r,e,t){return r.message=r.message.replace(e,t),r}function oT(r){for(let e of r)if(typeof e=="object"&&!wg(e))return e;return{}}function aT(r,e){var t,n;let i;return wg(r[0])?i=r[0]:wg(r[1])?i=r[1]:typeof r[0]=="function"?i={next:r[0],error:r[1],complete:r[2]}:i={next:r[1],error:r[2],complete:r[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(n=i.complete)===null||n===void 0?void 0:n.bind(i)}}var Jr=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new an(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return gg(this._delegate,e._delegate)}},Yr=class extends Jr{data(e){let t=this._delegate.data(e);return this._delegate._converter||Fw(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},Zr=class r{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ys(e)}where(e,t,n){try{return new r(this.firestore,An(this._delegate,MI(e,t,n)))}catch(i){throw ot(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new r(this.firestore,An(this._delegate,NI(e,t)))}catch(n){throw ot(n,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new r(this.firestore,An(this._delegate,kI(e)))}catch(t){throw ot(t,"limit()","Query.limit()")}}limitToLast(e){try{return new r(this.firestore,An(this._delegate,OI(e)))}catch(t){throw ot(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new r(this.firestore,An(this._delegate,FI(...e)))}catch(t){throw ot(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new r(this.firestore,An(this._delegate,LI(...e)))}catch(t){throw ot(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new r(this.firestore,An(this._delegate,UI(...e)))}catch(t){throw ot(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new r(this.firestore,An(this._delegate,jI(...e)))}catch(t){throw ot(t,"endAt()","Query.endAt()")}}isEqual(e){return lg(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=WI(this._delegate):e?.source==="server"?t=HI(this._delegate):t=KI(this._delegate),t.then(n=>new ma(this.firestore,new Bt(this.firestore._delegate,this._userDataWriter,this._delegate,n._snapshot)))}onSnapshot(...e){let t=oT(e),n=aT(e,i=>new ma(this.firestore,new Bt(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return vg(this._delegate,t,n)}withConverter(e){return new r(this.firestore,e?this._delegate.withConverter(vs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},Ig=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Yr(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},ma=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Zr(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Yr(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Ig(this._firestore,t))}forEach(e,t){this._delegate.forEach(n=>{e.call(t,new Yr(this._firestore,n))})}isEqual(e){return gg(this._delegate,e._delegate)}},_s=class r extends Zr{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new an(this.firestore,e):null}doc(e){try{return e===void 0?new an(this.firestore,ga(this._delegate)):new an(this.firestore,ga(this._delegate,e))}catch(t){throw ot(t,"doc()","CollectionReference.doc()")}}add(e){return XI(this._delegate,e).then(t=>new an(this.firestore,t))}isEqual(e){return cg(this._delegate,e._delegate)}withConverter(e){return new r(this.firestore,e?this._delegate.withConverter(vs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Xr(r){return ae(r,ge)}var Tg=class r{constructor(...e){this._delegate=new jt(...e)}static documentId(){return new r(xe.keyField().canonicalString())}isEqual(e){return e=Ae(e),e instanceof jt?this._delegate._internalPath.isEqual(e._internalPath):!1}};var Ag=class r{constructor(e){this._delegate=e}static serverTimestamp(){let e=eT();return e._methodName="FieldValue.serverTimestamp",new r(e)}static delete(){let e=ZI();return e._methodName="FieldValue.delete",new r(e)}static arrayUnion(...e){let t=tT(...e);return t._methodName="FieldValue.arrayUnion",new r(t)}static arrayRemove(...e){let t=nT(...e);return t._methodName="FieldValue.arrayRemove",new r(t)}static increment(e){let t=rT(e);return t._methodName="FieldValue.increment",new r(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var _D={Firestore:rl,GeoPoint:zr,Timestamp:be,Blob:nl,Transaction:il,WriteBatch:sl,DocumentReference:an,DocumentSnapshot:Jr,Query:Zr,QueryDocumentSnapshot:Yr,QuerySnapshot:ma,CollectionReference:_s,FieldPath:Tg,FieldValue:Ag,setLogLevel:vD,CACHE_SIZE_UNLIMITED:pI};function wD(r,e){r.INTERNAL.registerComponent(new wr("firestore-compat",t=>{let n=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(n,i)},"PUBLIC").setServiceProps(Object.assign({},_D)))}function ED(r){wD(r,(e,t)=>new rl(e,t,new Eg)),r.registerVersion(gD,mD)}ED(gt);function ID(r,e=Na){return new qt(t=>{let n;return e!=null?e.schedule(()=>{n=r.onSnapshot({includeMetadataChanges:!0},t)}):n=r.onSnapshot({includeMetadataChanges:!0},t),()=>{n?.()}})}function uT(r,e){return ID(r,e)}function TD(r,e){return uT(r,e).pipe(ai(void 0),Oa(),J(t=>{let[n,i]=t;return i.exists?n?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function Rg(r,e){return uT(r,e).pipe(J(t=>({payload:t,type:"query"})))}var ol=class{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let n=this.ref.collection(e),{ref:i,query:s}=fT(n,t);return new ul(i,s,this.afs)}snapshotChanges(){return TD(this.ref,this.afs.schedulers.outsideAngular).pipe(rt)}valueChanges(e={}){return this.snapshotChanges().pipe(J(({payload:t})=>e.idField?ye(B({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return ve(this.ref.get(e)).pipe(rt)}};function al(r,e){return Rg(r,e).pipe(ai(void 0),Oa(),J(t=>{let[n,i]=t,s=i.payload.docChanges(),o=s.map(u=>({type:u.type,payload:u}));return n&&JSON.stringify(n.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((u,c)=>{let l=s.find(p=>p.doc.ref.isEqual(u.ref)),f=n?.payload.docs.find(p=>p.ref.isEqual(u.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(u.metadata)||!l&&f&&JSON.stringify(f.metadata)===JSON.stringify(u.metadata)||o.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:u}})}),o}))}function cT(r,e,t){return al(r,t).pipe(oi((n,i)=>AD(n,i.map(s=>s.payload),e),[]),jm(),J(n=>n.map(i=>({type:i.type,payload:i}))))}function AD(r,e,t){return e.forEach(n=>{t.indexOf(n.type)>-1&&(r=bD(r,n))}),r}function Cg(r,e,t,...n){let i=r.slice();return i.splice(e,t,...n),i}function bD(r,e){switch(e.type){case"added":if(!(r[e.newIndex]&&r[e.newIndex].doc.ref.isEqual(e.doc.ref)))return Cg(r,e.newIndex,0,e);break;case"modified":if(r[e.oldIndex]==null||r[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=r.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return Cg(r,e.newIndex,1,e);break;case"removed":if(r[e.oldIndex]&&r[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Cg(r,e.oldIndex,1);break}return r}function lT(r){return(!r||r.length===0)&&(r=["added","removed","modified"]),r}var ul=class{ref;query;afs;constructor(e,t,n){this.ref=e,this.query=t,this.afs=n}stateChanges(e){let t=al(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(J(n=>n.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(ai(void 0),Oa(),at(([n,i])=>i.length>0||!n),J(([,n])=>n),rt)}auditTrail(e){return this.stateChanges(e).pipe(oi((t,n)=>[...t,...n],[]))}snapshotChanges(e){let t=lT(e);return cT(this.query,t,this.afs.schedulers.outsideAngular).pipe(rt)}valueChanges(e={}){return Rg(this.query,this.afs.schedulers.outsideAngular).pipe(J(t=>t.payload.docs.map(n=>e.idField?ye(B({},n.data()),{[e.idField]:n.id}):n.data())),rt)}get(e){return ve(this.query.get(e)).pipe(rt)}add(e){return this.ref.add(e)}doc(e){return new ol(this.ref.doc(e),this.afs)}},Sg=class{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?al(this.query,this.afs.schedulers.outsideAngular).pipe(rt):al(this.query,this.afs.schedulers.outsideAngular).pipe(J(t=>t.filter(n=>e.indexOf(n.type)>-1)),at(t=>t.length>0),rt)}auditTrail(e){return this.stateChanges(e).pipe(oi((t,n)=>[...t,...n],[]))}snapshotChanges(e){let t=lT(e);return cT(this.query,t,this.afs.schedulers.outsideAngular).pipe(rt)}valueChanges(e={}){return Rg(this.query,this.afs.schedulers.outsideAngular).pipe(J(n=>n.payload.docs.map(i=>e.idField?B({[e.idField]:i.id},i.data()):i.data())),rt)}get(e){return ve(this.query.get(e)).pipe(rt)}},hT=new Q("angularfire2.enableFirestorePersistence"),dT=new Q("angularfire2.firestore.persistenceSettings"),CD=new Q("angularfire2.firestore.settings"),SD=new Q("angularfire2.firestore.use-emulator");function fT(r,e=t=>t){return{query:e(r),ref:r}}var Dg=(()=>{class r{schedulers;firestore;persistenceEnabled$;constructor(t,n,i,s,o,u,c,l,f,p,m,w,x,V,D,k,z){this.schedulers=c;let F=So(t,u,n),$=f;p&&Td(F,u,m,x,V,D,w,k),[this.firestore,this.persistenceEnabled$]=Lu(`${F.name}.firestore`,"AngularFirestore",F.name,()=>{let X=u.runOutsideAngular(()=>F.firestore());if(s&&X.settings(s),$&&X.useEmulator(...$),i&&!Nn(o)){let Y=()=>{try{return ve(X.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(E){return typeof console<"u"&&console.warn(E),K(!1)}};return[X,u.runOutsideAngular(Y)]}else return[X,K(!1)]},[s,$,i])}collection(t,n){let i;typeof t=="string"?i=this.firestore.collection(t):i=t;let{ref:s,query:o}=fT(i,n),u=this.schedulers.ngZone.run(()=>s);return new ul(u,o,this)}collectionGroup(t,n){let i=n||(o=>o),s=this.firestore.collectionGroup(t);return new Sg(i(s),this)}doc(t){let n;typeof t=="string"?n=this.firestore.doc(t):n=t;let i=this.schedulers.ngZone.run(()=>n);return new ol(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(n){return new(n||r)(j(xi),j(Vi,8),j(hT,8),j(CD,8),j(nt),j(Se),j(Pi),j(dT,8),j(SD,8),j(M_,8),j(yd,8),j(vd,8),j(_d,8),j(wd,8),j(Ed,8),j(Id,8),j(Sr,8))};static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"any"})}return r})(),vM=(()=>{class r{constructor(){gt.registerVersion("angularfire",pn.full,"fst-compat")}static enablePersistence(t){return{ngModule:r,providers:[{provide:hT,useValue:!0},{provide:dT,useValue:t}]}}static \u0275fac=function(n){return new(n||r)};static \u0275mod=ct({type:r});static \u0275inj=ut({providers:[Dg]})}return r})();var pT=(()=>{let e=class e{constructor(n){this._firestore=n,this._refresh$=new Tt}get refresh$(){return this._refresh$}crearUsuario(n){return this._firestore.collection("usuarios").add(n)}getListadoUsuario(){return this._firestore.collection("usuarios").stateChanges()}getPerfilUsuario(n){return this._firestore.collection("usuarios",i=>i.where("email","==",n)).snapshotChanges()}getEspecialistaAutorizado(n){return this._firestore.collection("usuarios",i=>i.where("email","==",n).where("aprobadoPorAdmin","==",!0)).snapshotChanges()}eliminarUsuario(n){return this._firestore.collection("usuarios").doc(n).delete()}modificarUsuario(n,i){return this._firestore.collection("usuarios").doc(n).update(i)}getUsuario(n){return this._firestore.collection("usuarios").doc(n).snapshotChanges()}habilitarCuenta(n){return console.log("servicio habilitarCuenta"),this._firestore.collection("usuarios").doc(n).update({aprobadoPorAdmin:"SI"})}deshabilitarCuenta(n){return this._firestore.collection("usuarios").doc(n).update({aprobadoPorAdmin:"NO"})}crearTurno(n){return this._firestore.collection("turnos").add(n)}getEspecialidades(){return this._firestore.collection("turnos").stateChanges()}getListaEspecialistas(){return this._firestore.collection("turnos").stateChanges()}getTurnosDrYEspecialidad(n,i){return this._firestore.collection("turnos",s=>s.where("email","==",i).where("especialidad","==",n)).snapshotChanges()}getTurnosDr(n){return this._firestore.collection("turnos",i=>i.where("email","==",n)).snapshotChanges()}eleminarHorarioLaboralTurno(n){return this._firestore.collection("turnos").doc(n).delete()}crearTurnoPacientes(n){return this._firestore.collection("turnopaciente").add(n)}getTurnoPacientes(n){return this._firestore.collection("turnopaciente",i=>i.where("emailPaciente","==",n)).snapshotChanges()}getTurnosPacienteFiltradoDrYEspecialidad(n,i){return this._firestore.collection("turnopaciente",s=>s.where("emailEspecialista","==",i).where("especialidad","==",n)).snapshotChanges()}cancelarTurnoPaciente(n,i,s){return this._firestore.collection("turnopaciente").doc(n).update({estado:i,canceladoComentario:s})}calificacionTurnoPaciente(n,i){return this._firestore.collection("turnopaciente").doc(n).update({atencion:i})}encuestaTurnoPaciente(n,i){return this._firestore.collection("turnopaciente").doc(n).update({encuesta:i})}getTurnoEspecialista(n){return this._firestore.collection("turnopaciente",i=>i.where("emailEspecialista","==",n)).snapshotChanges()}getHistoriaClinicaPaciente(n){return this._firestore.collection("turnopaciente",i=>i.where("emailPaciente","==",n)).snapshotChanges()}getVerResaniaPaciente(n){return this._firestore.collection("turnopaciente",i=>i.where("id","==",n)).snapshotChanges()}aceptarTurnoEspecialista(n,i){return this._firestore.collection("turnopaciente").doc(n).update({estado:i})}finalizadaAtencion(n,i,s,o){return this._firestore.collection("turnopaciente").doc(n).update({estado:i,resena:s,diagnostico:o})}guardarHistoriaClinicaServicio(n,i,s,o,u,c,l,f,p,m,w){return this._firestore.collection("turnopaciente").doc(n).update({altura:i,peso:s,temperatura:o,presion:u,clave1:c,valor1:l,clave2:f,valor2:p,clave3:m,valor3:w})}getHistoriaClinicaEspecialistaAlmenosUno(n){return this._firestore.collection("turnopaciente",i=>i.where("emailEspecialista","==",n).where("estado","==","FINALIZADO")).snapshotChanges()}getPerfil(n){return this._firestore.collection("usuarios",i=>i.where("email","==",n)).snapshotChanges()}};e.\u0275fac=function(i){return new(i||e)(j(Dg))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();function PD(r,e){if(r&1){let t=St();_e(0,"li",3)(1,"a",9),Ie("click",function(){lt(t);let i=ft();return ht(i.misTurnos())}),pe(2,"- Mis Turnos - "),we()()}}function xD(r,e){if(r&1){let t=St();_e(0,"li",3)(1,"a",9),Ie("click",function(){lt(t);let i=ft();return ht(i.solicitarTurno())}),pe(2,"Solicitar Turno - "),we()()}}function VD(r,e){if(r&1){let t=St();_e(0,"li",3)(1,"a",9),Ie("click",function(){lt(t);let i=ft();return ht(i.perfilPaciente())}),pe(2,"Mi Perfil"),we()()}}function MD(r,e){if(r&1){let t=St();_e(0,"li",3)(1,"a",9),Ie("click",function(){lt(t);let i=ft();return ht(i.misTurnoEspecialista())}),pe(2,"- Mis Turnos -"),we()()}}function ND(r,e){if(r&1){let t=St();_e(0,"li",3)(1,"a",9),Ie("click",function(){lt(t);let i=ft();return ht(i.misPacientes())}),pe(2,"Pacientes -"),we()()}}function kD(r,e){if(r&1){let t=St();_e(0,"li",3)(1,"a",9),Ie("click",function(){lt(t);let i=ft();return ht(i.perfilEspecialista())}),pe(2,"Mi Perfil"),we()()}}function OD(r,e){if(r&1){let t=St();_e(0,"li",3)(1,"a",9),Ie("click",function(){lt(t);let i=ft();return ht(i.turnosclinica())}),pe(2,"- Turnos -"),we()()}}function FD(r,e){if(r&1){let t=St();_e(0,"li",3)(1,"a",10),Ie("click",function(){lt(t);let i=ft();return ht(i.solicitarTurnoAdmin())}),pe(2,"Solicitar Turno -"),we()()}}function LD(r,e){if(r&1){let t=St();_e(0,"li",3)(1,"a",9),Ie("click",function(){lt(t);let i=ft();return ht(i.Perfil())}),pe(2,"Mi Perfil -"),we()()}}function UD(r,e){if(r&1){let t=St();_e(0,"li",11)(1,"a",12),pe(2,"Usuarios"),we(),_e(3,"ul",13)(4,"li")(5,"a",14),Ie("click",function(){lt(t);let i=ft();return ht(i.habilitarInhabilitar())}),pe(6,"Habilitar/Inhabilitar Especialista"),we()(),_e(7,"li")(8,"a",14),Ie("click",function(){lt(t);let i=ft();return ht(i.usuarioAdmin())}),pe(9,"Datos de los Usuarios"),we()(),_e(10,"li")(11,"a",14),Ie("click",function(){lt(t);let i=ft();return ht(i.genUsuarioAdmin())}),pe(12,"Generar usuario"),we()()()()}}function jD(r,e){if(r&1){let t=St();_e(0,"li",11)(1,"a",12),pe(2,"- Informes"),we(),_e(3,"ul",15)(4,"li")(5,"a",14),Ie("click",function(){lt(t);let i=ft();return ht(i.ingresos())}),pe(6,"Log de Ingresos"),we()()()()}}var IM=(()=>{let e=class e{constructor(n,i){this.rutas=n,this.unUsuario=i,this.listPerfil=[]}ngOnInit(){this.obtener_localstorage()}inicio(){this.rutas.navigate(["bienvenido"]),window.location.reload()}ngOnChanges(n){}desloguearse(){localStorage.removeItem("user"),localStorage.removeItem("userPerfil"),localStorage.removeItem("autorizadoPerfil"),localStorage.removeItem("perfil"),this.email="",this.id="",this.perfil="",this.gralPerfil="",this.rutas.navigate(["bienvenidoLogin"])}obtener_localstorage(){let n=JSON.parse(localStorage.getItem("user"));this.email=n.email,this.id=n.uid,this.getPerfil(this.email)}misTurnos(){this.rutas.navigate(["paciente/misTurnos"])}solicitarTurno(){this.rutas.navigate(["paciente/solicitarTurno"])}cancelarTurnos(){this.rutas.navigate(["paciente/cancelarTurno"])}perfilPaciente(){this.rutas.navigate(["paciente/perfilPaciente"])}misTurnoEspecialista(){this.rutas.navigate(["especialista/misTurnoEsp"])}solicitarTurnoEspecialista(){this.rutas.navigate(["especialista/misTurnosAdm"])}rechazarTurnoEspecialista(){this.rutas.navigate(["especialista/rechazarTurnos"])}finalizarTurnoEspecialista(){this.rutas.navigate(["especialista/finalizarTurno"])}crearTurnoEspecialista(){this.rutas.navigate(["especialista/crearTurnos"])}resEspecialista(){this.rutas.navigate(["especialista/resEsp"])}perfilEspecialista(){this.rutas.navigate(["especialista/perfilEsp"])}misPacientes(){this.rutas.navigate(["especialista/misPacientes"])}genUsuarioAdmin(){this.rutas.navigate(["admin/genUsAdmin"])}solicitarTurnoAdmin(){this.rutas.navigate(["admin/misTurnosAdm"])}usuarioAdmin(){this.rutas.navigate(["admin/usuariosAdmin"])}habilitarInhabilitar(){this.rutas.navigate(["admin/habEsp"])}Perfil(){this.rutas.navigate(["admin/perfilAdm"])}turnosclinica(){this.rutas.navigate(["admin/turnosclinica"])}logreporte(){this.rutas.navigate(["admin/logReporte"])}ingresos(){this.rutas.navigate(["admin/ingresos"])}getPerfil(n){console.log("correo :",n),this.unUsuario.getPerfilUsuario(n).subscribe(i=>{i.forEach(o=>{this.listPerfil.push(B({id:o.payload.doc.id},o.payload.doc.data()))});let s={perfil:this.listPerfil[0].perfil,apellido:this.listPerfil[0].apellido,nombre:this.listPerfil[0].nombre,dni:this.listPerfil[0].dni,email:this.listPerfil[0].email,aprobadoPorAdmin:this.listPerfil[0].aprobadoPorAdmin,especialidad:this.listPerfil[0].especialidad,otraEspecialidad:this.listPerfil[0].otraEspecialidad,fotoPerfilUno:this.listPerfil[0].fotoPerfilUno,fotoPerfilDos:this.listPerfil[0].fotoPerfilDos};this.gralPerfil=s.perfil})}};e.\u0275fac=function(i){return new(i||e)(re(Ot),re(pT))},e.\u0275cmp=ui({type:e,selectors:[["app-menu-gral"]],standalone:!0,features:[Gt,di],decls:30,vars:13,consts:[[1,"navbar","navbar-expand-md","navbar-dark","fixed-top","bg-dark"],["id","navbarsExampleDefault",1,"collapse","navbar-collapse"],[1,"navbar-nav","mr-auto"],[1,"nav-item","active"],[1,"nav-link",3,"click"],[1,"sr-only"],[1,"nav-link"],["class","nav-item active",4,"ngIf"],["class","nav-item active dropdown-submenu",4,"ngIf"],[1,"nav-link","button",3,"click"],["onclick","this.blur();",1,"nav-link","button",3,"click"],[1,"nav-item","active","dropdown-submenu"],["data-toggle","dropdown",1,"nav-link","button"],[1,"dropdown-menu"],[1,"dropdown-item","button",3,"click"],[1,"dropdown-menu","button"]],template:function(i,s){i&1&&(_e(0,"nav",0)(1,"div",1)(2,"ul",2)(3,"li",3)(4,"a",4),Ie("click",function(){return s.inicio()}),pe(5,"Bienvenido "),_e(6,"span",5),pe(7,"(current)"),we()()(),_e(8,"li",3)(9,"a",6)(10,"b"),pe(11,"Perfil:"),we(),pe(12),_e(13,"b"),pe(14,"Usuario:"),we(),pe(15),we()(),uy(16,PD,3,0,"li",7)(17,xD,3,0,"li",7)(18,VD,3,0,"li",7)(19,MD,3,0,"li",7)(20,ND,3,0,"li",7)(21,kD,3,0,"li",7)(22,OD,3,0,"li",7)(23,FD,3,0,"li",7)(24,LD,3,0,"li",7)(25,UD,13,0,"li",8)(26,jD,7,0,"li",8),_e(27,"li",3)(28,"a",9),Ie("click",function(){return s.desloguearse()}),pe(29," - Desloguearse"),we()()()()()),i&2&&(Je(12),Xl(" ",s.gralPerfil," - "),Je(3),Xl(" ",s.email,""),Je(),dt("ngIf",s.gralPerfil=="Paciente"),Je(),dt("ngIf",s.gralPerfil=="Paciente"),Je(),dt("ngIf",s.gralPerfil=="Paciente"),Je(),dt("ngIf",s.gralPerfil=="Especialista"),Je(),dt("ngIf",s.gralPerfil=="Especialista"),Je(),dt("ngIf",s.gralPerfil=="Especialista"),Je(),dt("ngIf",s.gralPerfil=="Administrador"),Je(),dt("ngIf",s.gralPerfil=="Administrador"),Je(),dt("ngIf",s.gralPerfil=="Administrador"),Je(),dt("ngIf",s.gralPerfil=="Administrador"),Je(),dt("ngIf",s.gralPerfil=="Administrador"))},dependencies:[my],styles:['.dropdown-submenu[_ngcontent-%COMP%]{position:relative}.dropdown-submenu[_ngcontent-%COMP%] > .dropdown-menu[_ngcontent-%COMP%]{top:0;left:100%;margin-top:-6px;margin-left:-1px;-webkit-border-radius:0 6px 6px 6px;-moz-border-radius:0 6px 6px;border-radius:0 6px 6px}.dropdown-submenu[_ngcontent-%COMP%]:hover > .dropdown-menu[_ngcontent-%COMP%]{display:block}.dropdown-submenu[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:after{display:block;content:" ";float:right;width:0;height:0;border-color:transparent;border-style:solid;border-width:5px 0 5px 5px;border-left-color:#ccc;margin-top:5px;margin-right:-10px}.dropdown-submenu[_ngcontent-%COMP%]:hover > a[_ngcontent-%COMP%]:after{border-left-color:#fff}footer[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{padding-top:80px}.texto-blanco[_ngcontent-%COMP%]{color:#fff}.button[_ngcontent-%COMP%]{cursor:pointer}']});let r=e;return r})();var BD=()=>["/auth"],SM=(()=>{let e=class e{constructor(){}ngOnInit(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=ui({type:e,selectors:[["app-menu-inicio"]],standalone:!0,features:[di],decls:10,vars:2,consts:[[1,"navbar","navbar-expand-lg","navbar-dark","bg-dark"],["href","#",1,"navbar-brand"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarColor02","aria-controls","navbarColor02","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarColor02",1,"collapse","navbar-collapse"],[1,"navbar-nav","me-auto"],[1,"nav-item"],[1,"nav-link",3,"routerLink"]],template:function(i,s){i&1&&(_e(0,"nav",0)(1,"a",1),pe(2,"Bienvenidos"),we(),_e(3,"button",2),La(4,"span",3),we(),_e(5,"div",4)(6,"ul",5)(7,"li",6)(8,"a",7),pe(9,"Ingresar"),we()()()()()),i&2&&(Je(8),dt("routerLink",cy(1,BD)))},dependencies:[h_]});let r=e;return r})();export{eP as a,Oy as b,EP as c,q0 as d,ib as e,Ot as f,mx as g,yx as h,EC as i,vx as j,pn as k,Rx as l,VC as m,Sr as n,Pi as o,y_ as p,Co as q,cd as r,Lx as s,Ux as t,Xx as u,M_ as v,HV as w,Dg as x,vM as y,pT as z,IM as A,SM as B,tv as C,zy as D,UP as E,jP as F,yA as G,qP as H,_A as I,EA as J,TA as K,$P as L,zP as M,PA as N,GP as O,KP as P,WP as Q};
