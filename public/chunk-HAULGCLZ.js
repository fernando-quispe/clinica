import{$ as Pn,$a as Nt,$b as fy,A as ri,Aa as $l,B as Rn,Ba as ci,C as Ol,Ca as li,D as ii,Da as Hm,E as Lm,Ea as Qm,F as Um,Fa as Xm,Fb as Mn,G as pr,Ga as Jm,Gb as hi,H as $t,Ha as Ym,Hb as uy,I as Fl,Ia as Zm,J as jm,Ja as ey,K as Oa,Ka as yr,Kb as $s,L as si,Lb as La,M as Ll,Mb as Ua,N as oi,Na as ty,Nb as ja,O as Me,Oa as Bs,Ob as Ql,P as Ul,Pa as et,Pb as Ba,Q as Bm,Qa as re,Qb as qa,R as Ue,Ra as ny,Rb as $a,S as me,Sb as Xl,T as Dn,Tb as zs,U as ee,Ua as ry,Ub as cy,V as ht,Va as vr,Vb as di,W as qm,Wb as ly,X as Q,Xa as Se,Xb as fi,Y as jl,Ya as zl,Yb as hy,Z as j,Za as iy,Zb as dy,_ as H,_b as pt,a as Pm,aa as $m,ab as sy,ac as pi,b as xm,ba as js,bb as oy,bc as py,c as qt,ca as bt,cb as Gl,cc as Jl,d as Vl,da as ai,db as qs,dc as Gs,e as Ml,ea as dt,eb as ay,ec as za,f as Tt,fa as Be,fb as Kl,g as At,gb as ft,gc as gy,h as ka,ha as gr,i as Vm,ib as Wl,j as Cn,ja as zm,jc as my,k as Sn,ka as xn,kb as he,l as fr,la as zt,lb as de,lc as kn,m as Ee,ma as ln,mb as Fa,mc as yy,n as K,na as qe,nc as Ga,o as Us,oa as $e,p as Mm,pa as Vn,pb as Ct,q as km,qa as Gm,r as J,ra as ui,rb as pe,s as Na,sa as Bl,sb as ze,t as vt,ta as mr,u as kl,ua as kt,v as Nm,va as Km,w as Nl,wa as ql,x as Om,xa as Wm,xb as ce,y as Fm,ya as st,z as lt,zb as Hl}from"./chunk-VP7AJPYJ.js";import{a as vy,b as _y,c as Yl,d as wy,e as Ks,f as Zl,g as Ka,h as Ey,i as Iy,j as eh,k as Ae,l as _r,m as Gt,n as Wa,o as Ws,p as th,q as Ty,r as Ay,s as Hs,t as Ha,u as St,v as gt}from"./chunk-HLIJDICJ.js";import{a as B,b as we,i as xl,j as P}from"./chunk-SO6VPFYA.js";var Xs=class{},Xa=class{},wr=class r{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let n=t.indexOf(":");if(n>0){let i=t.slice(0,n),s=i.toLowerCase(),o=t.slice(n+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,n)=>{this.setHeaderEntries(n,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,n])=>{this.setHeaderEntries(t,n)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof r?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new r;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof r?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if(typeof n=="string"&&(n=[n]),n.length===0)return;this.maybeSetNormalizedName(e.name,t);let i=(e.op==="a"?this.headers.get(t):void 0)||[];i.push(...n),this.headers.set(t,i);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let o=this.headers.get(t);if(!o)return;o=o.filter(u=>s.indexOf(u)===-1),o.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}break}}setHeaderEntries(e,t){let n=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,n),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var rh=class{encodeKey(e){return by(e)}encodeValue(e){return by(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function YT(r,e){let t=new Map;return r.length>0&&r.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[o,u]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],c=t.get(o)||[];c.push(u),t.set(o,c)}),t}var ZT=/%(\d[a-f0-9])/gi,e0={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function by(r){return encodeURIComponent(r).replace(ZT,(e,t)=>e0[t]??e)}function Qa(r){return`${r}`}var Nn=class r{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new rh,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=YT(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let n=e.fromObject[t],i=Array.isArray(n)?n.map(Qa):[Qa(n)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(n=>{let i=e[n];Array.isArray(i)?i.forEach(s=>{t.push({param:n,value:s,op:"a"})}):t.push({param:n,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new r({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(Qa(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let n=this.map.get(e.param)||[],i=n.indexOf(Qa(e.value));i!==-1&&n.splice(i,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var ih=class{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function t0(r){switch(r){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function Cy(r){return typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer}function Sy(r){return typeof Blob<"u"&&r instanceof Blob}function Ry(r){return typeof FormData<"u"&&r instanceof FormData}function n0(r){return typeof URLSearchParams<"u"&&r instanceof URLSearchParams}var Qs=class r{constructor(e,t,n,i){this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(t0(this.method)||i?(this.body=n!==void 0?n:null,s=i):s=n,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new wr,this.context??=new ih,!this.params)this.params=new Nn,this.urlWithParams=t;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=t;else{let u=t.indexOf("?"),c=u===-1?"?":u<t.length-1?"&":"";this.urlWithParams=t+c+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||Cy(this.body)||Sy(this.body)||Ry(this.body)||n0(this.body)?this.body:this.body instanceof Nn?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Ry(this.body)?null:Sy(this.body)?this.body.type||null:Cy(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof Nn?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let t=e.method||this.method,n=e.url||this.url,i=e.responseType||this.responseType,s=e.transferCache??this.transferCache,o=e.body!==void 0?e.body:this.body,u=e.withCredentials??this.withCredentials,c=e.reportProgress??this.reportProgress,l=e.headers||this.headers,f=e.params||this.params,p=e.context??this.context;return e.setHeaders!==void 0&&(l=Object.keys(e.setHeaders).reduce((m,w)=>m.set(w,e.setHeaders[w]),l)),e.setParams&&(f=Object.keys(e.setParams).reduce((m,w)=>m.set(w,e.setParams[w]),f)),new r(t,n,o,{params:f,headers:l,context:p,reportProgress:c,responseType:i,withCredentials:u,transferCache:s})}},gi=function(r){return r[r.Sent=0]="Sent",r[r.UploadProgress=1]="UploadProgress",r[r.ResponseHeader=2]="ResponseHeader",r[r.DownloadProgress=3]="DownloadProgress",r[r.Response=4]="Response",r[r.User=5]="User",r}(gi||{}),Js=class{constructor(e,t=Za.Ok,n="OK"){this.headers=e.headers||new wr,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},sh=class r extends Js{constructor(e={}){super(e),this.type=gi.ResponseHeader}clone(e={}){return new r({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Ja=class r extends Js{constructor(e={}){super(e),this.type=gi.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new r({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Ya=class extends Js{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},Za=function(r){return r[r.Continue=100]="Continue",r[r.SwitchingProtocols=101]="SwitchingProtocols",r[r.Processing=102]="Processing",r[r.EarlyHints=103]="EarlyHints",r[r.Ok=200]="Ok",r[r.Created=201]="Created",r[r.Accepted=202]="Accepted",r[r.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",r[r.NoContent=204]="NoContent",r[r.ResetContent=205]="ResetContent",r[r.PartialContent=206]="PartialContent",r[r.MultiStatus=207]="MultiStatus",r[r.AlreadyReported=208]="AlreadyReported",r[r.ImUsed=226]="ImUsed",r[r.MultipleChoices=300]="MultipleChoices",r[r.MovedPermanently=301]="MovedPermanently",r[r.Found=302]="Found",r[r.SeeOther=303]="SeeOther",r[r.NotModified=304]="NotModified",r[r.UseProxy=305]="UseProxy",r[r.Unused=306]="Unused",r[r.TemporaryRedirect=307]="TemporaryRedirect",r[r.PermanentRedirect=308]="PermanentRedirect",r[r.BadRequest=400]="BadRequest",r[r.Unauthorized=401]="Unauthorized",r[r.PaymentRequired=402]="PaymentRequired",r[r.Forbidden=403]="Forbidden",r[r.NotFound=404]="NotFound",r[r.MethodNotAllowed=405]="MethodNotAllowed",r[r.NotAcceptable=406]="NotAcceptable",r[r.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",r[r.RequestTimeout=408]="RequestTimeout",r[r.Conflict=409]="Conflict",r[r.Gone=410]="Gone",r[r.LengthRequired=411]="LengthRequired",r[r.PreconditionFailed=412]="PreconditionFailed",r[r.PayloadTooLarge=413]="PayloadTooLarge",r[r.UriTooLong=414]="UriTooLong",r[r.UnsupportedMediaType=415]="UnsupportedMediaType",r[r.RangeNotSatisfiable=416]="RangeNotSatisfiable",r[r.ExpectationFailed=417]="ExpectationFailed",r[r.ImATeapot=418]="ImATeapot",r[r.MisdirectedRequest=421]="MisdirectedRequest",r[r.UnprocessableEntity=422]="UnprocessableEntity",r[r.Locked=423]="Locked",r[r.FailedDependency=424]="FailedDependency",r[r.TooEarly=425]="TooEarly",r[r.UpgradeRequired=426]="UpgradeRequired",r[r.PreconditionRequired=428]="PreconditionRequired",r[r.TooManyRequests=429]="TooManyRequests",r[r.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",r[r.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",r[r.InternalServerError=500]="InternalServerError",r[r.NotImplemented=501]="NotImplemented",r[r.BadGateway=502]="BadGateway",r[r.ServiceUnavailable=503]="ServiceUnavailable",r[r.GatewayTimeout=504]="GatewayTimeout",r[r.HttpVersionNotSupported=505]="HttpVersionNotSupported",r[r.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",r[r.InsufficientStorage=507]="InsufficientStorage",r[r.LoopDetected=508]="LoopDetected",r[r.NotExtended=510]="NotExtended",r[r.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",r}(Za||{});function nh(r,e){return{body:e,headers:r.headers,context:r.context,observe:r.observe,params:r.params,reportProgress:r.reportProgress,responseType:r.responseType,withCredentials:r.withCredentials,transferCache:r.transferCache}}var r0=(()=>{let e=class e{constructor(n){this.handler=n}request(n,i,s={}){let o;if(n instanceof Qs)o=n;else{let l;s.headers instanceof wr?l=s.headers:l=new wr(s.headers);let f;s.params&&(s.params instanceof Nn?f=s.params:f=new Nn({fromObject:s.params})),o=new Qs(n,i,s.body!==void 0?s.body:null,{headers:l,context:s.context,params:f,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials,transferCache:s.transferCache})}let u=K(o).pipe(Rn(l=>this.handler.handle(l)));if(n instanceof Qs||s.observe==="events")return u;let c=u.pipe(lt(l=>l instanceof Ja));switch(s.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return c.pipe(J(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return c.pipe(J(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return c.pipe(J(l=>{if(l.body!==null&&typeof l.body!="string")throw new Error("Response is not a string.");return l.body}));case"json":default:return c.pipe(J(l=>l.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(n,i={}){return this.request("DELETE",n,i)}get(n,i={}){return this.request("GET",n,i)}head(n,i={}){return this.request("HEAD",n,i)}jsonp(n,i){return this.request("JSONP",n,{params:new Nn().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,i={}){return this.request("OPTIONS",n,i)}patch(n,i,s={}){return this.request("PATCH",n,nh(s,i))}post(n,i,s={}){return this.request("POST",n,nh(s,i))}put(n,i,s={}){return this.request("PUT",n,nh(s,i))}};e.\u0275fac=function(i){return new(i||e)(j(Xs))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})();function Vy(r,e){return e(r)}function i0(r,e){return(t,n)=>e.intercept(t,{handle:i=>r(i,n)})}function s0(r,e,t){return(n,i)=>zt(t,()=>e(n,s=>r(s,i)))}var o0=new Q(""),oh=new Q(""),a0=new Q(""),u0=new Q("");function c0(){let r=null;return(e,t)=>{r===null&&(r=(H(o0,{optional:!0})??[]).reduceRight(i0,Vy));let n=H(qs),i=n.add();return r(e,t).pipe(pr(()=>n.remove(i)))}}var Dy=(()=>{let e=class e extends Xs{constructor(n,i){super(),this.backend=n,this.injector=i,this.chain=null,this.pendingTasks=H(qs);let s=H(u0,{optional:!0});this.backend=s??n}handle(n){if(this.chain===null){let s=Array.from(new Set([...this.injector.get(oh),...this.injector.get(a0,[])]));this.chain=s.reduceRight((o,u)=>s0(o,u,this.injector),Vy)}let i=this.pendingTasks.add();return this.chain(n,s=>this.backend.handle(s)).pipe(pr(()=>this.pendingTasks.remove(i)))}};e.\u0275fac=function(i){return new(i||e)(j(Xa),j(xn))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})();var l0=/^\)\]\}',?\n/;function h0(r){return"responseURL"in r&&r.responseURL?r.responseURL:/^X-Request-URL:/m.test(r.getAllResponseHeaders())?r.getResponseHeader("X-Request-URL"):null}var Py=(()=>{let e=class e{constructor(n){this.xhrFactory=n}handle(n){if(n.method==="JSONP")throw new me(-2800,!1);let i=this.xhrFactory;return(i.\u0275loadImpl?Ee(i.\u0275loadImpl()):K(null)).pipe(Me(()=>new qt(o=>{let u=i.build();if(u.open(n.method,n.urlWithParams),n.withCredentials&&(u.withCredentials=!0),n.headers.forEach((D,N)=>u.setRequestHeader(D,N.join(","))),n.headers.has("Accept")||u.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){let D=n.detectContentTypeHeader();D!==null&&u.setRequestHeader("Content-Type",D)}if(n.responseType){let D=n.responseType.toLowerCase();u.responseType=D!=="json"?D:"text"}let c=n.serializeBody(),l=null,f=()=>{if(l!==null)return l;let D=u.statusText||"OK",N=new wr(u.getAllResponseHeaders()),z=h0(u)||n.url;return l=new sh({headers:N,status:u.status,statusText:D,url:z}),l},p=()=>{let{headers:D,status:N,statusText:z,url:F}=f(),$=null;N!==Za.NoContent&&($=typeof u.response>"u"?u.responseText:u.response),N===0&&(N=$?Za.Ok:0);let X=N>=200&&N<300;if(n.responseType==="json"&&typeof $=="string"){let Y=$;$=$.replace(l0,"");try{$=$!==""?JSON.parse($):null}catch(E){$=Y,X&&(X=!1,$={error:E,text:$})}}X?(o.next(new Ja({body:$,headers:D,status:N,statusText:z,url:F||void 0})),o.complete()):o.error(new Ya({error:$,headers:D,status:N,statusText:z,url:F||void 0}))},m=D=>{let{url:N}=f(),z=new Ya({error:D,status:u.status||0,statusText:u.statusText||"Unknown Error",url:N||void 0});o.error(z)},w=!1,x=D=>{w||(o.next(f()),w=!0);let N={type:gi.DownloadProgress,loaded:D.loaded};D.lengthComputable&&(N.total=D.total),n.responseType==="text"&&u.responseText&&(N.partialText=u.responseText),o.next(N)},V=D=>{let N={type:gi.UploadProgress,loaded:D.loaded};D.lengthComputable&&(N.total=D.total),o.next(N)};return u.addEventListener("load",p),u.addEventListener("error",m),u.addEventListener("timeout",m),u.addEventListener("abort",m),n.reportProgress&&(u.addEventListener("progress",x),c!==null&&u.upload&&u.upload.addEventListener("progress",V)),u.send(c),o.next({type:gi.Sent}),()=>{u.removeEventListener("error",m),u.removeEventListener("abort",m),u.removeEventListener("load",p),u.removeEventListener("timeout",m),n.reportProgress&&(u.removeEventListener("progress",x),c!==null&&u.upload&&u.upload.removeEventListener("progress",V)),u.readyState!==u.DONE&&u.abort()}})))}};e.\u0275fac=function(i){return new(i||e)(j(Ga))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})(),My=new Q(""),d0="XSRF-TOKEN",f0=new Q("",{providedIn:"root",factory:()=>d0}),p0="X-XSRF-TOKEN",g0=new Q("",{providedIn:"root",factory:()=>p0}),eu=class{},m0=(()=>{let e=class e{constructor(n,i,s){this.doc=n,this.platform=i,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=za(n,this.cookieName),this.lastCookieString=n),this.lastToken}};e.\u0275fac=function(i){return new(i||e)(j(pt),j(st),j(f0))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})();function y0(r,e){let t=r.url.toLowerCase();if(!H(My)||r.method==="GET"||r.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(r);let n=H(eu).getToken(),i=H(g0);return n!=null&&!r.headers.has(i)&&(r=r.clone({headers:r.headers.set(i,n)})),e(r)}var ky=function(r){return r[r.Interceptors=0]="Interceptors",r[r.LegacyInterceptors=1]="LegacyInterceptors",r[r.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",r[r.NoXsrfProtection=3]="NoXsrfProtection",r[r.JsonpSupport=4]="JsonpSupport",r[r.RequestsMadeViaParent=5]="RequestsMadeViaParent",r[r.Fetch=6]="Fetch",r}(ky||{});function v0(r,e){return{\u0275kind:r,\u0275providers:e}}function _0(...r){let e=[r0,Py,Dy,{provide:Xs,useExisting:Dy},{provide:Xa,useExisting:Py},{provide:oh,useValue:y0,multi:!0},{provide:My,useValue:!0},{provide:eu,useClass:m0}];for(let t of r)e.push(...t.\u0275providers);return gr(e)}var xy=new Q("");function w0(){return v0(ky.LegacyInterceptors,[{provide:xy,useFactory:c0},{provide:oh,useExisting:xy,multi:!0}])}var JD=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=dt({type:e}),e.\u0275inj=ht({providers:[_0(w0())]});let r=e;return r})();var ch=class extends dy{constructor(){super(...arguments),this.supportsDOMEvents=!0}},lh=class r extends ch{static makeCurrent(){hy(new r)}onAndCancel(e,t,n){return e.addEventListener(t,n),()=>{e.removeEventListener(t,n)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=I0();return t==null?null:T0(t)}resetBaseElement(){Ys=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return za(document.cookie,e)}},Ys=null;function I0(){return Ys=Ys||document.querySelector("base"),Ys?Ys.getAttribute("href"):null}function T0(r){return new URL(r,document.baseURI).pathname}var A0=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})(),hh=new Q(""),Ly=(()=>{let e=class e{constructor(n,i){this._zone=i,this._eventNameToPlugin=new Map,n.forEach(s=>{s.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,i,s){return this._findPluginFor(i).addEventListener(n,i,s)}getZone(){return this._zone}_findPluginFor(n){let i=this._eventNameToPlugin.get(n);if(i)return i;if(i=this._plugins.find(o=>o.supports(n)),!i)throw new me(5101,!1);return this._eventNameToPlugin.set(n,i),i}};e.\u0275fac=function(i){return new(i||e)(j(hh),j(Se))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})(),tu=class{constructor(e){this._doc=e}},ah="ng-app-id",Uy=(()=>{let e=class e{constructor(n,i,s,o={}){this.doc=n,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=kn(o),this.resetHostNodes()}addStyles(n){for(let i of n)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(n){for(let i of n)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let n=this.styleNodesInDOM;n&&(n.forEach(i=>i.remove()),n.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(let i of this.getAllStyles())this.addStyleToHost(n,i)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(let i of this.hostNodes)this.addStyleToHost(i,n)}onStyleRemoved(n){let i=this.styleRef;i.get(n)?.elements?.forEach(s=>s.remove()),i.delete(n)}collectServerRenderedStyles(){let n=this.doc.head?.querySelectorAll(`style[${ah}="${this.appId}"]`);if(n?.length){let i=new Map;return n.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(n,i){let s=this.styleRef;if(s.has(n)){let o=s.get(n);return o.usage+=i,o.usage}return s.set(n,{usage:i,elements:[]}),i}getStyleElement(n,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===n)return s.delete(i),o.removeAttribute(ah),o;{let u=this.doc.createElement("style");return this.nonce&&u.setAttribute("nonce",this.nonce),u.textContent=i,this.platformIsServer&&u.setAttribute(ah,this.appId),n.appendChild(u),u}}addStyleToHost(n,i){let s=this.getStyleElement(n,i),o=this.styleRef,u=o.get(i)?.elements;u?u.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let n=this.hostNodes;n.clear(),n.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(j(pt),j(ql),j($l,8),j(st))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})(),uh={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},fh=/%COMP%/g,jy="%COMP%",b0=`_nghost-${jy}`,C0=`_ngcontent-${jy}`,S0=!0,R0=new Q("",{providedIn:"root",factory:()=>S0});function D0(r){return C0.replace(fh,r)}function P0(r){return b0.replace(fh,r)}function By(r,e){return e.map(t=>t.replace(fh,r))}var Ny=(()=>{let e=class e{constructor(n,i,s,o,u,c,l,f=null){this.eventManager=n,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=u,this.platformId=c,this.ngZone=l,this.nonce=f,this.rendererByCompId=new Map,this.platformIsServer=kn(c),this.defaultRenderer=new Zs(n,u,l,this.platformIsServer)}createRenderer(n,i){if(!n||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===js.ShadowDom&&(i=we(B({},i),{encapsulation:js.Emulated}));let s=this.getOrCreateRenderer(n,i);return s instanceof nu?s.applyToHost(n):s instanceof eo&&s.applyStyles(),s}getOrCreateRenderer(n,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let u=this.doc,c=this.ngZone,l=this.eventManager,f=this.sharedStylesHost,p=this.removeStylesOnCompDestroy,m=this.platformIsServer;switch(i.encapsulation){case js.Emulated:o=new nu(l,f,i,this.appId,p,u,c,m);break;case js.ShadowDom:return new dh(l,f,n,i,u,c,this.nonce,m);default:o=new eo(l,f,i,p,u,c,m);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(j(Ly),j(Uy),j(ql),j(R0),j(pt),j(st),j(Se),j($l))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})(),Zs=class{constructor(e,t,n,i){this.eventManager=e,this.doc=t,this.ngZone=n,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(uh[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(Oy(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(Oy(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n=typeof e=="string"?this.doc.querySelector(e):e;if(!n)throw new me(-5104,!1);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,i){if(i){t=i+":"+t;let s=uh[i];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){let i=uh[n];i?e.removeAttributeNS(i,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,i){i&(Bs.DashCase|Bs.Important)?e.style.setProperty(t,n,i&Bs.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&Bs.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e!=null&&(e[t]=n)}setValue(e,t){e.nodeValue=t}listen(e,t,n){if(typeof e=="string"&&(e=fi().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(n))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function Oy(r){return r.tagName==="TEMPLATE"&&r.content!==void 0}var dh=class extends Zs{constructor(e,t,n,i,s,o,u,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=By(i.id,i.styles);for(let f of l){let p=document.createElement("style");u&&p.setAttribute("nonce",u),p.textContent=f,this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},eo=class extends Zs{constructor(e,t,n,i,s,o,u,c){super(e,s,o,u),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?By(c,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},nu=class extends eo{constructor(e,t,n,i,s,o,u,c){let l=i+"-"+n.id;super(e,t,n,s,o,u,c,l),this.contentAttr=D0(l),this.hostAttr=P0(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}},x0=(()=>{let e=class e extends tu{constructor(n){super(n)}supports(n){return!0}addEventListener(n,i,s){return n.addEventListener(i,s,!1),()=>this.removeEventListener(n,i,s)}removeEventListener(n,i,s){return n.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(j(pt))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})(),Fy=["alt","control","meta","shift"],V0={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},M0={alt:r=>r.altKey,control:r=>r.ctrlKey,meta:r=>r.metaKey,shift:r=>r.shiftKey},k0=(()=>{let e=class e extends tu{constructor(n){super(n)}supports(n){return e.parseEventName(n)!=null}addEventListener(n,i,s){let o=e.parseEventName(i),u=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>fi().onAndCancel(n,o.domEventName,u))}static parseEventName(n){let i=n.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),u="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),u="code."),Fy.forEach(f=>{let p=i.indexOf(f);p>-1&&(i.splice(p,1),u+=f+".")}),u+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=s,l.fullKey=u,l}static matchEventFullKeyCode(n,i){let s=V0[n.key]||n.key,o="";return i.indexOf("code.")>-1&&(s=n.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),Fy.forEach(u=>{if(u!==s){let c=M0[u];c(n)&&(o+=u+".")}}),o+=s,o===i)}static eventCallback(n,i,s){return o=>{e.matchEventFullKeyCode(o,n)&&s.runGuarded(()=>i(o))}}static _normalizeKey(n){return n==="esc"?"escape":n}};e.\u0275fac=function(i){return new(i||e)(j(pt))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})();function vP(r,e){return cy(B({rootComponent:r},N0(e)))}function N0(r){return{appProviders:[...j0,...r?.providers??[]],platformProviders:U0}}function O0(){lh.makeCurrent()}function F0(){return new Bl}function L0(){return Km(document),document}var U0=[{provide:st,useValue:my},{provide:Wm,useValue:O0,multi:!0},{provide:pt,useFactory:L0,deps:[]}];var j0=[{provide:zm,useValue:"root"},{provide:Bl,useFactory:F0,deps:[]},{provide:hh,useClass:x0,multi:!0,deps:[pt,Se,st]},{provide:hh,useClass:k0,multi:!0,deps:[pt]},Ny,Uy,Ly,{provide:ry,useExisting:Ny},{provide:Ga,useClass:A0,deps:[]},[]];var qy=(()=>{let e=class e{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}};e.\u0275fac=function(i){return new(i||e)(j(pt))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();var B0=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:function(i){let s=null;return i?s=new(i||e):s=j(q0),s},providedIn:"root"});let r=e;return r})(),q0=(()=>{let e=class e extends B0{constructor(n){super(),this._doc=n}sanitize(n,i){if(i==null)return null;switch(n){case yr.NONE:return i;case yr.HTML:return li(i,"HTML")?ci(i):ey(this._doc,String(i)).toString();case yr.STYLE:return li(i,"Style")?ci(i):i;case yr.SCRIPT:if(li(i,"Script"))return ci(i);throw new me(5200,!1);case yr.URL:return li(i,"URL")?ci(i):Zm(String(i));case yr.RESOURCE_URL:if(li(i,"ResourceURL"))return ci(i);throw new me(5201,!1);default:throw new me(5202,!1)}}bypassSecurityTrustHtml(n){return Hm(n)}bypassSecurityTrustStyle(n){return Qm(n)}bypassSecurityTrustScript(n){return Xm(n)}bypassSecurityTrustUrl(n){return Jm(n)}bypassSecurityTrustResourceUrl(n){return Ym(n)}};e.\u0275fac=function(i){return new(i||e)(j(pt))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();var Zy=(()=>{let e=class e{constructor(n,i){this._renderer=n,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(n,i){this._renderer.setProperty(this._elementRef.nativeElement,n,i)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}};e.\u0275fac=function(i){return new(i||e)(re(vr),re(mr))},e.\u0275dir=Be({type:e});let r=e;return r})(),lu=(()=>{let e=class e extends Zy{};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=Vn(e)))(s||e)}})(),e.\u0275dir=Be({type:e,features:[Nt]});let r=e;return r})(),vi=new Q("");var z0={provide:vi,useExisting:Dn(()=>ev),multi:!0};function G0(){let r=fi()?fi().getUserAgent():"";return/android (\d+)/.test(r.toLowerCase())}var K0=new Q(""),ev=(()=>{let e=class e extends Zy{constructor(n,i,s){super(n,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!G0())}writeValue(n){let i=n??"";this.setProperty("value",i)}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}};e.\u0275fac=function(i){return new(i||e)(re(vr),re(mr),re(K0,8))},e.\u0275dir=Be({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&pe("input",function(u){return s._handleInput(u.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(u){return s._compositionEnd(u.target.value)})},features:[Mn([z0]),Nt]});let r=e;return r})();function On(r){return r==null||(typeof r=="string"||Array.isArray(r))&&r.length===0}function tv(r){return r!=null&&typeof r.length=="number"}var vh=new Q(""),_h=new Q(""),W0=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,$y=class{static min(e){return H0(e)}static max(e){return Q0(e)}static required(e){return X0(e)}static requiredTrue(e){return J0(e)}static email(e){return Y0(e)}static minLength(e){return Z0(e)}static maxLength(e){return eA(e)}static pattern(e){return tA(e)}static nullValidator(e){return nv(e)}static compose(e){return uv(e)}static composeAsync(e){return lv(e)}};function H0(r){return e=>{if(On(e.value)||On(r))return null;let t=parseFloat(e.value);return!isNaN(t)&&t<r?{min:{min:r,actual:e.value}}:null}}function Q0(r){return e=>{if(On(e.value)||On(r))return null;let t=parseFloat(e.value);return!isNaN(t)&&t>r?{max:{max:r,actual:e.value}}:null}}function X0(r){return On(r.value)?{required:!0}:null}function J0(r){return r.value===!0?null:{required:!0}}function Y0(r){return On(r.value)||W0.test(r.value)?null:{email:!0}}function Z0(r){return e=>On(e.value)||!tv(e.value)?null:e.value.length<r?{minlength:{requiredLength:r,actualLength:e.value.length}}:null}function eA(r){return e=>tv(e.value)&&e.value.length>r?{maxlength:{requiredLength:r,actualLength:e.value.length}}:null}function tA(r){if(!r)return nv;let e,t;return typeof r=="string"?(t="",r.charAt(0)!=="^"&&(t+="^"),t+=r,r.charAt(r.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=r.toString(),e=r),n=>{if(On(n.value))return null;let i=n.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}function nv(r){return null}function rv(r){return r!=null}function iv(r){return ja(r)?Ee(r):r}function sv(r){let e={};return r.forEach(t=>{e=t!=null?B(B({},e),t):e}),Object.keys(e).length===0?null:e}function ov(r,e){return e.map(t=>t(r))}function nA(r){return!r.validate}function av(r){return r.map(e=>nA(e)?e:t=>e.validate(t))}function uv(r){if(!r)return null;let e=r.filter(rv);return e.length==0?null:function(t){return sv(ov(t,e))}}function cv(r){return r!=null?uv(av(r)):null}function lv(r){if(!r)return null;let e=r.filter(rv);return e.length==0?null:function(t){let n=ov(t,e).map(iv);return Om(n).pipe(J(sv))}}function hv(r){return r!=null?lv(av(r)):null}function zy(r,e){return r===null?[e]:Array.isArray(r)?[...r,e]:[r,e]}function dv(r){return r._rawValidators}function fv(r){return r._rawAsyncValidators}function ph(r){return r?Array.isArray(r)?r:[r]:[]}function iu(r,e){return Array.isArray(r)?r.includes(e):r===e}function Gy(r,e){let t=ph(e);return ph(r).forEach(i=>{iu(t,i)||t.push(i)}),t}function Ky(r,e){return ph(e).filter(t=>!iu(r,t))}var su=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=cv(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=hv(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Er=class extends su{get formDirective(){return null}get path(){return null}},Ir=class extends su{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},ou=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},rA={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},NP=we(B({},rA),{"[class.ng-submitted]":"isSubmitted"}),OP=(()=>{let e=class e extends ou{constructor(n){super(n)}};e.\u0275fac=function(i){return new(i||e)(re(Ir,2))},e.\u0275dir=Be({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&Wl("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Nt]});let r=e;return r})(),FP=(()=>{let e=class e extends ou{constructor(n){super(n)}};e.\u0275fac=function(i){return new(i||e)(re(Er,10))},e.\u0275dir=Be({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,s){i&2&&Wl("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[Nt]});let r=e;return r})();var to="VALID",ru="INVALID",mi="PENDING",no="DISABLED";function wh(r){return(hu(r)?r.validators:r)||null}function iA(r){return Array.isArray(r)?cv(r):r||null}function Eh(r,e){return(hu(e)?e.asyncValidators:r)||null}function sA(r){return Array.isArray(r)?hv(r):r||null}function hu(r){return r!=null&&!Array.isArray(r)&&typeof r=="object"}function pv(r,e,t){let n=r.controls;if(!(e?Object.keys(n):n).length)throw new me(1e3,"");if(!n[t])throw new me(1001,"")}function gv(r,e,t){r._forEachChild((n,i)=>{if(t[i]===void 0)throw new me(1002,"")})}var yi=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===to}get invalid(){return this.status===ru}get pending(){return this.status==mi}get disabled(){return this.status===no}get enabled(){return this.status!==no}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Gy(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Gy(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Ky(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Ky(e,this._rawAsyncValidators))}hasValidator(e){return iu(this._rawValidators,e)}hasAsyncValidator(e){return iu(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=mi,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=no,this.errors=null,this._forEachChild(n=>{n.disable(we(B({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(we(B({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(n=>n(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=to,this._forEachChild(n=>{n.enable(we(B({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(we(B({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===to||this.status===mi)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?no:to}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=mi,this._hasOwnPendingAsyncValidator=!0;let t=iv(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((n,i)=>n&&n._find(i),this)}getError(e,t){let n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new kt,this.statusChanges=new kt}_calculateStatus(){return this._allControlsDisabled()?no:this.errors?ru:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(mi)?mi:this._anyControlsHaveStatus(ru)?ru:to}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){hu(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=iA(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=sA(this._rawAsyncValidators)}},au=class extends yi{constructor(e,t,n){super(wh(t),Eh(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,n={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){gv(this,!0,e),Object.keys(e).forEach(n=>{pv(this,!0,n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(n=>{let i=this.controls[n];i&&i.patchValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((n,i)=>{n.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,n)=>(e[n]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,n)=>n._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let n=this.controls[t];n&&e(n,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,n]of Object.entries(this.controls))if(this.contains(t)&&e(n))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,n,i)=>((n.enabled||this.disabled)&&(t[i]=n.value),t))}_reduceChildren(e,t){let n=e;return this._forEachChild((i,s)=>{n=t(n,i,s)}),n}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var gh=class extends au{};var du=new Q("CallSetDisabledState",{providedIn:"root",factory:()=>fu}),fu="always";function mv(r,e){return[...e.path,r]}function mh(r,e,t=fu){Ih(r,e),e.valueAccessor.writeValue(r.value),(r.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(r.disabled),aA(r,e),cA(r,e),uA(r,e),oA(r,e)}function Wy(r,e,t=!0){let n=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(n),e.valueAccessor.registerOnTouched(n)),cu(r,e),r&&(e._invokeOnDestroyCallbacks(),r._registerOnCollectionChange(()=>{}))}function uu(r,e){r.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function oA(r,e){if(e.valueAccessor.setDisabledState){let t=n=>{e.valueAccessor.setDisabledState(n)};r.registerOnDisabledChange(t),e._registerOnDestroy(()=>{r._unregisterOnDisabledChange(t)})}}function Ih(r,e){let t=dv(r);e.validator!==null?r.setValidators(zy(t,e.validator)):typeof t=="function"&&r.setValidators([t]);let n=fv(r);e.asyncValidator!==null?r.setAsyncValidators(zy(n,e.asyncValidator)):typeof n=="function"&&r.setAsyncValidators([n]);let i=()=>r.updateValueAndValidity();uu(e._rawValidators,i),uu(e._rawAsyncValidators,i)}function cu(r,e){let t=!1;if(r!==null){if(e.validator!==null){let i=dv(r);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.validator);s.length!==i.length&&(t=!0,r.setValidators(s))}}if(e.asyncValidator!==null){let i=fv(r);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.asyncValidator);s.length!==i.length&&(t=!0,r.setAsyncValidators(s))}}}let n=()=>{};return uu(e._rawValidators,n),uu(e._rawAsyncValidators,n),t}function aA(r,e){e.valueAccessor.registerOnChange(t=>{r._pendingValue=t,r._pendingChange=!0,r._pendingDirty=!0,r.updateOn==="change"&&yv(r,e)})}function uA(r,e){e.valueAccessor.registerOnTouched(()=>{r._pendingTouched=!0,r.updateOn==="blur"&&r._pendingChange&&yv(r,e),r.updateOn!=="submit"&&r.markAsTouched()})}function yv(r,e){r._pendingDirty&&r.markAsDirty(),r.setValue(r._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1}function cA(r,e){let t=(n,i)=>{e.valueAccessor.writeValue(n),i&&e.viewToModelUpdate(n)};r.registerOnChange(t),e._registerOnDestroy(()=>{r._unregisterOnChange(t)})}function lA(r,e){r==null,Ih(r,e)}function hA(r,e){return cu(r,e)}function vv(r,e){if(!r.hasOwnProperty("model"))return!1;let t=r.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function dA(r){return Object.getPrototypeOf(r.constructor)===lu}function fA(r,e){r._syncPendingControls(),e.forEach(t=>{let n=t.control;n.updateOn==="submit"&&n._pendingChange&&(t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function _v(r,e){if(!e)return null;Array.isArray(e);let t,n,i;return e.forEach(s=>{s.constructor===ev?t=s:dA(s)?n=s:i=s}),i||n||t||null}function pA(r,e){let t=r.indexOf(e);t>-1&&r.splice(t,1)}function Hy(r,e){let t=r.indexOf(e);t>-1&&r.splice(t,1)}function Qy(r){return typeof r=="object"&&r!==null&&Object.keys(r).length===2&&"value"in r&&"disabled"in r}var ro=class extends yi{constructor(e=null,t,n){super(wh(t),Eh(n,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),hu(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Qy(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(n=>n(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Hy(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Hy(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Qy(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var gA=r=>r instanceof ro;var mA={provide:Ir,useExisting:Dn(()=>yA)},Xy=Promise.resolve(),yA=(()=>{let e=class e extends Ir{constructor(n,i,s,o,u,c){super(),this._changeDetectorRef=u,this.callSetDisabledState=c,this.control=new ro,this._registered=!1,this.name="",this.update=new kt,this._parent=n,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=_v(this,o)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){let i=n.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),vv(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){mh(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(n){Xy.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){let i=n.isDisabled.currentValue,s=i!==0&&di(i);Xy.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?mv(n,this._parent):[n]}};e.\u0275fac=function(i){return new(i||e)(re(Er,9),re(vh,10),re(_h,10),re(vi,10),re(zs,8),re(du,8))},e.\u0275dir=Be({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[bt.None,"disabled","isDisabled"],model:[bt.None,"ngModel","model"],options:[bt.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Mn([mA]),Nt,ln]});let r=e;return r})(),UP=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Be({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let r=e;return r})(),vA={provide:vi,useExisting:Dn(()=>_A),multi:!0},_A=(()=>{let e=class e extends lu{writeValue(n){let i=n??"";this.setProperty("value",i)}registerOnChange(n){this.onChange=i=>{n(i==""?null:parseFloat(i))}}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=Vn(e)))(s||e)}})(),e.\u0275dir=Be({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,s){i&1&&pe("input",function(u){return s.onChange(u.target.value)})("blur",function(){return s.onTouched()})},features:[Mn([vA]),Nt]});let r=e;return r})();var wv=new Q("");var wA={provide:Er,useExisting:Dn(()=>EA)},EA=(()=>{let e=class e extends Er{constructor(n,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new kt,this._setValidators(n),this._setAsyncValidators(i)}ngOnChanges(n){this._checkFormPresent(),n.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(cu(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(n){let i=this.form.get(n.path);return mh(i,n,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(n),i}getControl(n){return this.form.get(n.path)}removeControl(n){Wy(n.control||null,n,!1),pA(this.directives,n)}addFormGroup(n){this._setUpFormContainer(n)}removeFormGroup(n){this._cleanUpFormContainer(n)}getFormGroup(n){return this.form.get(n.path)}addFormArray(n){this._setUpFormContainer(n)}removeFormArray(n){this._cleanUpFormContainer(n)}getFormArray(n){return this.form.get(n.path)}updateModel(n,i){this.form.get(n.path).setValue(i)}onSubmit(n){return this.submitted=!0,fA(this.form,this.directives),this.ngSubmit.emit(n),n?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_updateDomValue(){this.directives.forEach(n=>{let i=n.control,s=this.form.get(n.path);i!==s&&(Wy(i||null,n),gA(s)&&(mh(s,n,this.callSetDisabledState),n.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(n){let i=this.form.get(n.path);lA(i,n),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(n){if(this.form){let i=this.form.get(n.path);i&&hA(i,n)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Ih(this.form,this),this._oldForm&&cu(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(i){return new(i||e)(re(vh,10),re(_h,10),re(du,8))},e.\u0275dir=Be({type:e,selectors:[["","formGroup",""]],hostBindings:function(i,s){i&1&&pe("submit",function(u){return s.onSubmit(u)})("reset",function(){return s.onReset()})},inputs:{form:[bt.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Mn([wA]),Nt,ln]});let r=e;return r})();var IA={provide:Ir,useExisting:Dn(()=>TA)},TA=(()=>{let e=class e extends Ir{set isDisabled(n){}constructor(n,i,s,o,u){super(),this._ngModelWarningConfig=u,this._added=!1,this.name=null,this.update=new kt,this._ngModelWarningSent=!1,this._parent=n,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=_v(this,o)}ngOnChanges(n){this._added||this._setUpControl(),vv(n,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}get path(){return mv(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}};e._ngModelWarningSentOnce=!1,e.\u0275fac=function(i){return new(i||e)(re(Er,13),re(vh,10),re(_h,10),re(vi,10),re(wv,8))},e.\u0275dir=Be({type:e,selectors:[["","formControlName",""]],inputs:{name:[bt.None,"formControlName","name"],isDisabled:[bt.None,"disabled","isDisabled"],model:[bt.None,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[Mn([IA]),Nt,ln]});let r=e;return r})(),AA={provide:vi,useExisting:Dn(()=>Iv),multi:!0};function Ev(r,e){return r==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${r}: ${e}`.slice(0,50))}function bA(r){return r.split(":")[0]}var Iv=(()=>{let e=class e extends lu{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){this.value=n;let i=this._getOptionId(n),s=Ev(i,n);this.setProperty("value",s)}registerOnChange(n){this.onChange=i=>{this.value=this._getOptionValue(i),n(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(n){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),n))return i;return null}_getOptionValue(n){let i=bA(n);return this._optionMap.has(i)?this._optionMap.get(i):n}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=Vn(e)))(s||e)}})(),e.\u0275dir=Be({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,s){i&1&&pe("change",function(u){return s.onChange(u.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[Mn([AA]),Nt]});let r=e;return r})(),jP=(()=>{let e=class e{constructor(n,i,s){this._element=n,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(n){this._select!=null&&(this._select._optionMap.set(this.id,n),this._setElementValue(Ev(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._setElementValue(n),this._select&&this._select.writeValue(this._select.value)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(re(mr),re(vr),re(Iv,9))},e.\u0275dir=Be({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let r=e;return r})(),CA={provide:vi,useExisting:Dn(()=>Tv),multi:!0};function Jy(r,e){return r==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${r}: ${e}`.slice(0,50))}function SA(r){return r.split(":")[0]}var Tv=(()=>{let e=class e extends lu{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){this.value=n;let i;if(Array.isArray(n)){let s=n.map(o=>this._getOptionId(o));i=(o,u)=>{o._setSelected(s.indexOf(u.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(n){this.onChange=i=>{let s=[],o=i.selectedOptions;if(o!==void 0){let u=o;for(let c=0;c<u.length;c++){let l=u[c],f=this._getOptionValue(l.value);s.push(f)}}else{let u=i.options;for(let c=0;c<u.length;c++){let l=u[c];if(l.selected){let f=this._getOptionValue(l.value);s.push(f)}}}this.value=s,n(s)}}_registerOption(n){let i=(this._idCounter++).toString();return this._optionMap.set(i,n),i}_getOptionId(n){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,n))return i;return null}_getOptionValue(n){let i=SA(n);return this._optionMap.has(i)?this._optionMap.get(i)._value:n}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=Vn(e)))(s||e)}})(),e.\u0275dir=Be({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,s){i&1&&pe("change",function(u){return s.onChange(u.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[Mn([CA]),Nt]});let r=e;return r})(),BP=(()=>{let e=class e{constructor(n,i,s){this._element=n,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(n){this._select!=null&&(this._value=n,this._setElementValue(Jy(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._select?(this._value=n,this._setElementValue(Jy(this.id,n)),this._select.writeValue(this._select.value)):this._setElementValue(n)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}_setSelected(n){this._renderer.setProperty(this._element.nativeElement,"selected",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(re(mr),re(vr),re(Tv,9))},e.\u0275dir=Be({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let r=e;return r})();var Av=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=dt({type:e}),e.\u0275inj=ht({});let r=e;return r})(),yh=class extends yi{constructor(e,t,n){super(wh(t),Eh(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,n={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(e,t={}){let n=this._adjustIndex(e);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,n={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){gv(this,!1,e),e.forEach((n,i)=>{pv(this,!1,i),this.at(i).setValue(n,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((n,i)=>{this.at(i)&&this.at(i).patchValue(n,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((n,i)=>{n.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,n)=>n._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,n)=>{e(t,n)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function Yy(r){return!!r&&(r.asyncValidators!==void 0||r.validators!==void 0||r.updateOn!==void 0)}var qP=(()=>{let e=class e{constructor(){this.useNonNullable=!1}get nonNullable(){let n=new e;return n.useNonNullable=!0,n}group(n,i=null){let s=this._reduceControls(n),o={};return Yy(i)?o=i:i!==null&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new au(s,o)}record(n,i=null){let s=this._reduceControls(n);return new gh(s,i)}control(n,i,s){let o={};return this.useNonNullable?(Yy(i)?o=i:(o.validators=i,o.asyncValidators=s),new ro(n,we(B({},o),{nonNullable:!0}))):new ro(n,i,s)}array(n,i,s){let o=n.map(u=>this._createControl(u));return new yh(o,i,s)}_reduceControls(n){let i={};return Object.keys(n).forEach(s=>{i[s]=this._createControl(n[s])}),i}_createControl(n){if(n instanceof ro)return n;if(n instanceof yi)return n;if(Array.isArray(n)){let i=n[0],s=n.length>1?n[1]:null,o=n.length>2?n[2]:null;return this.control(i,s,o)}else return this.control(n)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();var $P=(()=>{let e=class e{static withConfig(n){return{ngModule:e,providers:[{provide:du,useValue:n.callSetDisabledState??fu}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=dt({type:e}),e.\u0275inj=ht({imports:[Av]});let r=e;return r})(),zP=(()=>{let e=class e{static withConfig(n){return{ngModule:e,providers:[{provide:wv,useValue:n.warnOnNgModelWithFormControl??"always"},{provide:du,useValue:n.callSetDisabledState??fu}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=dt({type:e}),e.\u0275inj=ht({imports:[Av]});let r=e;return r})();var ne="primary",wo=Symbol("RouteTitle"),Sh=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Ti(r){return new Sh(r)}function RA(r,e,t){let n=t.path.split("/");if(n.length>r.length||t.pathMatch==="full"&&(e.hasChildren()||n.length<r.length))return null;let i={};for(let s=0;s<n.length;s++){let o=n[s],u=r[s];if(o.startsWith(":"))i[o.substring(1)]=u;else if(o!==u.path)return null}return{consumed:r.slice(0,n.length),posParams:i}}function DA(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;++t)if(!Wt(r[t],e[t]))return!1;return!0}function Wt(r,e){let t=r?Rh(r):void 0,n=e?Rh(e):void 0;if(!t||!n||t.length!=n.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!Mv(r[i],e[i]))return!1;return!0}function Rh(r){return[...Object.keys(r),...Object.getOwnPropertySymbols(r)]}function Mv(r,e){if(Array.isArray(r)&&Array.isArray(e)){if(r.length!==e.length)return!1;let t=[...r].sort(),n=[...e].sort();return t.every((i,s)=>n[s]===i)}else return r===e}function kv(r){return r.length>0?r[r.length-1]:null}function Bn(r){return Mm(r)?r:ja(r)?Ee(Promise.resolve(r)):K(r)}var PA={exact:Ov,subset:Fv},Nv={exact:xA,subset:VA,ignored:()=>!0};function bv(r,e,t){return PA[t.paths](r.root,e.root,t.matrixParams)&&Nv[t.queryParams](r.queryParams,e.queryParams)&&!(t.fragment==="exact"&&r.fragment!==e.fragment)}function xA(r,e){return Wt(r,e)}function Ov(r,e,t){if(!Ar(r.segments,e.segments)||!mu(r.segments,e.segments,t)||r.numberOfChildren!==e.numberOfChildren)return!1;for(let n in e.children)if(!r.children[n]||!Ov(r.children[n],e.children[n],t))return!1;return!0}function VA(r,e){return Object.keys(e).length<=Object.keys(r).length&&Object.keys(e).every(t=>Mv(r[t],e[t]))}function Fv(r,e,t){return Lv(r,e,e.segments,t)}function Lv(r,e,t,n){if(r.segments.length>t.length){let i=r.segments.slice(0,t.length);return!(!Ar(i,t)||e.hasChildren()||!mu(i,t,n))}else if(r.segments.length===t.length){if(!Ar(r.segments,t)||!mu(r.segments,t,n))return!1;for(let i in e.children)if(!r.children[i]||!Fv(r.children[i],e.children[i],n))return!1;return!0}else{let i=t.slice(0,r.segments.length),s=t.slice(r.segments.length);return!Ar(r.segments,i)||!mu(r.segments,i,n)||!r.children[ne]?!1:Lv(r.children[ne],e,s,n)}}function mu(r,e,t){return e.every((n,i)=>Nv[t](r[i].parameters,n.parameters))}var Fn=class{constructor(e=new le([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap??=Ti(this.queryParams),this._queryParamMap}toString(){return NA.serialize(this)}},le=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return yu(this)}},Tr=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Ti(this.parameters),this._parameterMap}toString(){return jv(this)}};function MA(r,e){return Ar(r,e)&&r.every((t,n)=>Wt(t.parameters,e[n].parameters))}function Ar(r,e){return r.length!==e.length?!1:r.every((t,n)=>t.path===e[n].path)}function kA(r,e){let t=[];return Object.entries(r.children).forEach(([n,i])=>{n===ne&&(t=t.concat(e(i,n)))}),Object.entries(r.children).forEach(([n,i])=>{n!==ne&&(t=t.concat(e(i,n)))}),t}var Eo=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:()=>new lo,providedIn:"root"});let r=e;return r})(),lo=class{parse(e){let t=new Ph(e);return new Fn(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${io(e.root,!0)}`,n=LA(e.queryParams),i=typeof e.fragment=="string"?`#${OA(e.fragment)}`:"";return`${t}${n}${i}`}},NA=new lo;function yu(r){return r.segments.map(e=>jv(e)).join("/")}function io(r,e){if(!r.hasChildren())return yu(r);if(e){let t=r.children[ne]?io(r.children[ne],!1):"",n=[];return Object.entries(r.children).forEach(([i,s])=>{i!==ne&&n.push(`${i}:${io(s,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}else{let t=kA(r,(n,i)=>i===ne?[io(r.children[ne],!1)]:[`${i}:${io(n,!1)}`]);return Object.keys(r.children).length===1&&r.children[ne]!=null?`${yu(r)}/${t[0]}`:`${yu(r)}/(${t.join("//")})`}}function Uv(r){return encodeURIComponent(r).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function pu(r){return Uv(r).replace(/%3B/gi,";")}function OA(r){return encodeURI(r)}function Dh(r){return Uv(r).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function vu(r){return decodeURIComponent(r)}function Cv(r){return vu(r.replace(/\+/g,"%20"))}function jv(r){return`${Dh(r.path)}${FA(r.parameters)}`}function FA(r){return Object.entries(r).map(([e,t])=>`;${Dh(e)}=${Dh(t)}`).join("")}function LA(r){let e=Object.entries(r).map(([t,n])=>Array.isArray(n)?n.map(i=>`${pu(t)}=${pu(i)}`).join("&"):`${pu(t)}=${pu(n)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var UA=/^[^\/()?;#]+/;function Th(r){let e=r.match(UA);return e?e[0]:""}var jA=/^[^\/()?;=#]+/;function BA(r){let e=r.match(jA);return e?e[0]:""}var qA=/^[^=?&#]+/;function $A(r){let e=r.match(qA);return e?e[0]:""}var zA=/^[^&#]+/;function GA(r){let e=r.match(zA);return e?e[0]:""}var Ph=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new le([],{}):new le([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[ne]=new le(e,t)),n}parseSegment(){let e=Th(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new me(4009,!1);return this.capture(e),new Tr(vu(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=BA(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let i=Th(this.remaining);i&&(n=i,this.capture(n))}e[vu(t)]=vu(n)}parseQueryParam(e){let t=$A(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let o=GA(this.remaining);o&&(n=o,this.capture(n))}let i=Cv(t),s=Cv(n);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let n=Th(this.remaining),i=this.remaining[n.length];if(i!=="/"&&i!==")"&&i!==";")throw new me(4010,!1);let s;n.indexOf(":")>-1?(s=n.slice(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=ne);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[ne]:new le([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new me(4011,!1)}};function Bv(r){return r.segments.length>0?new le([],{[ne]:r}):r}function qv(r){let e={};for(let[n,i]of Object.entries(r.children)){let s=qv(i);if(n===ne&&s.segments.length===0&&s.hasChildren())for(let[o,u]of Object.entries(s.children))e[o]=u;else(s.segments.length>0||s.hasChildren())&&(e[n]=s)}let t=new le(r.segments,e);return KA(t)}function KA(r){if(r.numberOfChildren===1&&r.children[ne]){let e=r.children[ne];return new le(r.segments.concat(e.segments),e.children)}return r}function Ai(r){return r instanceof Fn}function WA(r,e,t=null,n=null){let i=$v(r);return zv(i,e,t,n)}function $v(r){let e;function t(s){let o={};for(let c of s.children){let l=t(c);o[c.outlet]=l}let u=new le(s.url,o);return s===r&&(e=u),u}let n=t(r.root),i=Bv(n);return e??i}function zv(r,e,t,n){let i=r;for(;i.parent;)i=i.parent;if(e.length===0)return Ah(i,i,i,t,n);let s=HA(e);if(s.toRoot())return Ah(i,i,new le([],{}),t,n);let o=QA(s,i,r),u=o.processChildren?ao(o.segmentGroup,o.index,s.commands):Kv(o.segmentGroup,o.index,s.commands);return Ah(i,o.segmentGroup,u,t,n)}function _u(r){return typeof r=="object"&&r!=null&&!r.outlets&&!r.segmentPath}function ho(r){return typeof r=="object"&&r!=null&&r.outlets}function Ah(r,e,t,n,i){let s={};n&&Object.entries(n).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(f=>`${f}`):`${l}`});let o;r===e?o=t:o=Gv(r,e,t);let u=Bv(qv(o));return new Fn(u,s,i)}function Gv(r,e,t){let n={};return Object.entries(r.children).forEach(([i,s])=>{s===e?n[i]=t:n[i]=Gv(s,e,t)}),new le(r.segments,n)}var wu=class{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&_u(n[0]))throw new me(4003,!1);let i=n.find(ho);if(i&&i!==kv(n))throw new me(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function HA(r){if(typeof r[0]=="string"&&r.length===1&&r[0]==="/")return new wu(!0,0,r);let e=0,t=!1,n=r.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let u={};return Object.entries(s.outlets).forEach(([c,l])=>{u[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:u}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((u,c)=>{c==0&&u==="."||(c==0&&u===""?t=!0:u===".."?e++:u!=""&&i.push(u))}),i):[...i,s]},[]);return new wu(t,e,n)}var Ei=class{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}};function QA(r,e,t){if(r.isAbsolute)return new Ei(e,!0,0);if(!t)return new Ei(e,!1,NaN);if(t.parent===null)return new Ei(t,!0,0);let n=_u(r.commands[0])?0:1,i=t.segments.length-1+n;return XA(t,i,r.numberOfDoubleDots)}function XA(r,e,t){let n=r,i=e,s=t;for(;s>i;){if(s-=i,n=n.parent,!n)throw new me(4005,!1);i=n.segments.length}return new Ei(n,!1,i-s)}function JA(r){return ho(r[0])?r[0].outlets:{[ne]:r}}function Kv(r,e,t){if(r??=new le([],{}),r.segments.length===0&&r.hasChildren())return ao(r,e,t);let n=YA(r,e,t),i=t.slice(n.commandIndex);if(n.match&&n.pathIndex<r.segments.length){let s=new le(r.segments.slice(0,n.pathIndex),{});return s.children[ne]=new le(r.segments.slice(n.pathIndex),r.children),ao(s,0,i)}else return n.match&&i.length===0?new le(r.segments,{}):n.match&&!r.hasChildren()?xh(r,e,t):n.match?ao(r,0,i):xh(r,e,t)}function ao(r,e,t){if(t.length===0)return new le(r.segments,{});{let n=JA(t),i={};if(Object.keys(n).some(s=>s!==ne)&&r.children[ne]&&r.numberOfChildren===1&&r.children[ne].segments.length===0){let s=ao(r.children[ne],e,t);return new le(r.segments,s.children)}return Object.entries(n).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=Kv(r.children[s],e,o))}),Object.entries(r.children).forEach(([s,o])=>{n[s]===void 0&&(i[s]=o)}),new le(r.segments,i)}}function YA(r,e,t){let n=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<r.segments.length;){if(n>=t.length)return s;let o=r.segments[i],u=t[n];if(ho(u))break;let c=`${u}`,l=n<t.length-1?t[n+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!Rv(c,l,o))return s;n+=2}else{if(!Rv(c,{},o))return s;n++}i++}return{match:!0,pathIndex:i,commandIndex:n}}function xh(r,e,t){let n=r.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(ho(s)){let c=ZA(s.outlets);return new le(n,c)}if(i===0&&_u(t[0])){let c=r.segments[e];n.push(new Tr(c.path,Sv(t[0]))),i++;continue}let o=ho(s)?s.outlets[ne]:`${s}`,u=i<t.length-1?t[i+1]:null;o&&u&&_u(u)?(n.push(new Tr(o,Sv(u))),i+=2):(n.push(new Tr(o,{})),i++)}return new le(n,{})}function ZA(r){let e={};return Object.entries(r).forEach(([t,n])=>{typeof n=="string"&&(n=[n]),n!==null&&(e[t]=xh(new le([],{}),0,n))}),e}function Sv(r){let e={};return Object.entries(r).forEach(([t,n])=>e[t]=`${n}`),e}function Rv(r,e,t){return r==t.path&&Wt(e,t.parameters)}var uo="imperative",Ge=function(r){return r[r.NavigationStart=0]="NavigationStart",r[r.NavigationEnd=1]="NavigationEnd",r[r.NavigationCancel=2]="NavigationCancel",r[r.NavigationError=3]="NavigationError",r[r.RoutesRecognized=4]="RoutesRecognized",r[r.ResolveStart=5]="ResolveStart",r[r.ResolveEnd=6]="ResolveEnd",r[r.GuardsCheckStart=7]="GuardsCheckStart",r[r.GuardsCheckEnd=8]="GuardsCheckEnd",r[r.RouteConfigLoadStart=9]="RouteConfigLoadStart",r[r.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",r[r.ChildActivationStart=11]="ChildActivationStart",r[r.ChildActivationEnd=12]="ChildActivationEnd",r[r.ActivationStart=13]="ActivationStart",r[r.ActivationEnd=14]="ActivationEnd",r[r.Scroll=15]="Scroll",r[r.NavigationSkipped=16]="NavigationSkipped",r}(Ge||{}),Rt=class{constructor(e,t){this.id=e,this.url=t}},bi=class extends Rt{constructor(e,t,n="imperative",i=null){super(e,t),this.type=Ge.NavigationStart,this.navigationTrigger=n,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Ht=class extends Rt{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n,this.type=Ge.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},wt=function(r){return r[r.Redirect=0]="Redirect",r[r.SupersededByNewNavigation=1]="SupersededByNewNavigation",r[r.NoDataFromResolver=2]="NoDataFromResolver",r[r.GuardRejected=3]="GuardRejected",r}(wt||{}),Eu=function(r){return r[r.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",r[r.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",r}(Eu||{}),Ln=class extends Rt{constructor(e,t,n,i){super(e,t),this.reason=n,this.code=i,this.type=Ge.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Un=class extends Rt{constructor(e,t,n,i){super(e,t),this.reason=n,this.code=i,this.type=Ge.NavigationSkipped}},fo=class extends Rt{constructor(e,t,n,i){super(e,t),this.error=n,this.target=i,this.type=Ge.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Iu=class extends Rt{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=Ge.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Vh=class extends Rt{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=Ge.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Mh=class extends Rt{constructor(e,t,n,i,s){super(e,t),this.urlAfterRedirects=n,this.state=i,this.shouldActivate=s,this.type=Ge.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},kh=class extends Rt{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=Ge.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Nh=class extends Rt{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=Ge.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Oh=class{constructor(e){this.route=e,this.type=Ge.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Fh=class{constructor(e){this.route=e,this.type=Ge.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Lh=class{constructor(e){this.snapshot=e,this.type=Ge.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Uh=class{constructor(e){this.snapshot=e,this.type=Ge.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},jh=class{constructor(e){this.snapshot=e,this.type=Ge.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Bh=class{constructor(e){this.snapshot=e,this.type=Ge.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Tu=class{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n,this.type=Ge.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},po=class{},go=class{constructor(e){this.url=e}};var qh=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Io,this.attachRef=null}},Io=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(n,i){let s=this.getOrCreateContext(n);s.outlet=i,this.contexts.set(n,s)}onChildOutletDestroyed(n){let i=this.getContext(n);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let i=this.getContext(n);return i||(i=new qh,this.contexts.set(n,i)),i}getContext(n){return this.contexts.get(n)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),Au=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=$h(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){let t=$h(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=zh(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return zh(e,this._root).map(t=>t.value)}};function $h(r,e){if(r===e.value)return e;for(let t of e.children){let n=$h(r,t);if(n)return n}return null}function zh(r,e){if(r===e.value)return[e];for(let t of e.children){let n=zh(r,t);if(n.length)return n.unshift(e),n}return[]}var _t=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function wi(r){let e={};return r&&r.children.forEach(t=>e[t.value.outlet]=t),e}var bu=class extends Au{constructor(e,t){super(e),this.snapshot=t,ed(this,e)}toString(){return this.snapshot.toString()}};function Wv(r){let e=eb(r),t=new At([new Tr("",{})]),n=new At({}),i=new At({}),s=new At({}),o=new At(""),u=new jn(t,n,s,o,i,ne,r,e.root);return u.snapshot=e.root,new bu(new _t(u,[]),e)}function eb(r){let e={},t={},n={},i="",s=new mo([],e,n,i,t,ne,r,null,{});return new Cu("",new _t(s,[]))}var jn=class{constructor(e,t,n,i,s,o,u,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=n,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=u,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(J(l=>l[wo]))??K(void 0),this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(J(e=>Ti(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(J(e=>Ti(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Zh(r,e,t="emptyOnly"){let n,{routeConfig:i}=r;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?n={params:B(B({},e.params),r.params),data:B(B({},e.data),r.data),resolve:B(B(B(B({},r.data),e.data),i?.data),r._resolvedData)}:n={params:B({},r.params),data:B({},r.data),resolve:B(B({},r.data),r._resolvedData??{})},i&&Qv(i)&&(n.resolve[wo]=i.title),n}var mo=class{get title(){return this.data?.[wo]}constructor(e,t,n,i,s,o,u,c,l){this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=s,this.outlet=o,this.component=u,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Ti(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Ti(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(n=>n.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Cu=class extends Au{constructor(e,t){super(t),this.url=e,ed(this,t)}toString(){return Hv(this._root)}};function ed(r,e){e.value._routerState=r,e.children.forEach(t=>ed(r,t))}function Hv(r){let e=r.children.length>0?` { ${r.children.map(Hv).join(", ")} } `:"";return`${r.value}${e}`}function bh(r){if(r.snapshot){let e=r.snapshot,t=r._futureSnapshot;r.snapshot=t,Wt(e.queryParams,t.queryParams)||r.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&r.fragmentSubject.next(t.fragment),Wt(e.params,t.params)||r.paramsSubject.next(t.params),DA(e.url,t.url)||r.urlSubject.next(t.url),Wt(e.data,t.data)||r.dataSubject.next(t.data)}else r.snapshot=r._futureSnapshot,r.dataSubject.next(r._futureSnapshot.data)}function Gh(r,e){let t=Wt(r.params,e.params)&&MA(r.url,e.url),n=!r.parent!=!e.parent;return t&&!n&&(!r.parent||Gh(r.parent,e.parent))}function Qv(r){return typeof r.title=="string"||r.title===null}var tb=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=ne,this.activateEvents=new kt,this.deactivateEvents=new kt,this.attachEvents=new kt,this.detachEvents=new kt,this.parentContexts=H(Io),this.location=H(iy),this.changeDetector=H(zs),this.environmentInjector=H(xn),this.inputBinder=H(Pu,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){let{firstChange:i,previousValue:s}=n.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new me(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new me(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new me(4012,!1);this.location.detach();let n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,i){this.activated=n,this._activatedRoute=i,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){let n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,i){if(this.isActivated)throw new me(4013,!1);this._activatedRoute=n;let s=this.location,u=n.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new Kh(n,c,s.injector);this.activated=s.createComponent(u,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Be({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[ln]});let r=e;return r})(),Kh=class r{__ngOutletInjector(e){return new r(this.route,this.childContexts,e)}constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===jn?this.route:e===Io?this.childContexts:this.parent.get(e,t)}},Pu=new Q(""),Dv=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){let{activatedRoute:i}=n,s=Na([i.queryParams,i.params,i.data]).pipe(Me(([o,u,c],l)=>(c=B(B(B({},o),u),c),l===0?K(c):Promise.resolve(c)))).subscribe(o=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(n);return}let u=ly(i.component);if(!u){this.unsubscribeFromRouteData(n);return}for(let{templateName:c}of u.inputs)n.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(n,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})();function nb(r,e,t){let n=yo(r,e._root,t?t._root:void 0);return new bu(n,e)}function yo(r,e,t){if(t&&r.shouldReuseRoute(e.value,t.value.snapshot)){let n=t.value;n._futureSnapshot=e.value;let i=rb(r,e,t);return new _t(n,i)}else{if(r.shouldAttach(e.value)){let s=r.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(u=>yo(r,u)),o}}let n=ib(e.value),i=e.children.map(s=>yo(r,s));return new _t(n,i)}}function rb(r,e,t){return e.children.map(n=>{for(let i of t.children)if(r.shouldReuseRoute(n.value,i.value.snapshot))return yo(r,n,i);return yo(r,n)})}function ib(r){return new jn(new At(r.url),new At(r.params),new At(r.queryParams),new At(r.fragment),new At(r.data),r.outlet,r.component,r)}var Xv="ngNavigationCancelingError";function Jv(r,e){let{redirectTo:t,navigationBehaviorOptions:n}=Ai(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=Yv(!1,wt.Redirect);return i.url=t,i.navigationBehaviorOptions=n,i}function Yv(r,e){let t=new Error(`NavigationCancelingError: ${r||""}`);return t[Xv]=!0,t.cancellationCode=e,t}function sb(r){return Zv(r)&&Ai(r.url)}function Zv(r){return!!r&&r[Xv]}var ob=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=ai({type:e,selectors:[["ng-component"]],standalone:!0,features:[hi],decls:1,vars:0,template:function(i,s){i&1&&Fa(0,"router-outlet")},dependencies:[tb],encapsulation:2});let r=e;return r})();function ab(r,e){return r.providers&&!r._injector&&(r._injector=Gl(r.providers,e,`Route: ${r.path}`)),r._injector??e}function td(r){let e=r.children&&r.children.map(td),t=e?we(B({},r),{children:e}):B({},r);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==ne&&(t.component=ob),t}function Qt(r){return r.outlet||ne}function ub(r,e){let t=r.filter(n=>Qt(n)===e);return t.push(...r.filter(n=>Qt(n)!==e)),t}function To(r){if(!r)return null;if(r.routeConfig?._injector)return r.routeConfig._injector;for(let e=r.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var cb=(r,e,t,n)=>J(i=>(new Wh(e,i.targetRouterState,i.currentRouterState,t,n).activate(r),i)),Wh=class{constructor(e,t,n,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),bh(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){let i=wi(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],n),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,t,n){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=n.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else s&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,s=wi(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(n&&n.outlet){let o=n.outlet.detach(),u=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:u})}}deactivateRouteAndOutlet(e,t){let n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,s=wi(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(e,t,n){let i=wi(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],n),this.forwardEvent(new Bh(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Uh(e.value.snapshot))}activateRoutes(e,t,n){let i=e.value,s=t?t.value:null;if(bh(i),i===s)if(i.component){let o=n.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(i.component){let o=n.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let u=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(u.contexts),o.attachRef=u.componentRef,o.route=u.route.value,o.outlet&&o.outlet.attach(u.componentRef,u.route.value),bh(u.route.value),this.activateChildRoutes(e,null,o.children)}else{let u=To(i.snapshot);o.attachRef=null,o.route=i,o.injector=u,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}},Su=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Ii=class{constructor(e,t){this.component=e,this.route=t}};function lb(r,e,t){let n=r._root,i=e?e._root:null;return so(n,i,t,[n.value])}function hb(r){let e=r.routeConfig?r.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:r,guards:e}}function Si(r,e){let t=Symbol(),n=e.get(r,t);return n===t?typeof r=="function"&&!qm(r)?r:e.get(r):n}function so(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=wi(e);return r.children.forEach(o=>{db(o,s[o.value.outlet],t,n.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,u])=>co(u,t.getContext(o),i)),i}function db(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=r.value,o=e?e.value:null,u=t?t.getContext(r.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=fb(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Su(n)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?so(r,e,u?u.children:null,n,i):so(r,e,t,n,i),c&&u&&u.outlet&&u.outlet.isActivated&&i.canDeactivateChecks.push(new Ii(u.outlet.component,o))}else o&&co(e,u,i),i.canActivateChecks.push(new Su(n)),s.component?so(r,null,u?u.children:null,n,i):so(r,null,t,n,i);return i}function fb(r,e,t){if(typeof t=="function")return t(r,e);switch(t){case"pathParamsChange":return!Ar(r.url,e.url);case"pathParamsOrQueryParamsChange":return!Ar(r.url,e.url)||!Wt(r.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Gh(r,e)||!Wt(r.queryParams,e.queryParams);case"paramsChange":default:return!Gh(r,e)}}function co(r,e,t){let n=wi(r),i=r.value;Object.entries(n).forEach(([s,o])=>{i.component?e?co(o,e.children.getContext(s),t):co(o,null,t):co(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Ii(e.outlet.component,i)):t.canDeactivateChecks.push(new Ii(null,i)):t.canDeactivateChecks.push(new Ii(null,i))}function Ao(r){return typeof r=="function"}function pb(r){return typeof r=="boolean"}function gb(r){return r&&Ao(r.canLoad)}function mb(r){return r&&Ao(r.canActivate)}function yb(r){return r&&Ao(r.canActivateChild)}function vb(r){return r&&Ao(r.canDeactivate)}function _b(r){return r&&Ao(r.canMatch)}function e_(r){return r instanceof km||r?.name==="EmptyError"}var gu=Symbol("INITIAL_VALUE");function Ci(){return Me(r=>Na(r.map(e=>e.pipe(ii(1),oi(gu)))).pipe(J(e=>{for(let t of e)if(t!==!0){if(t===gu)return gu;if(t===!1||t instanceof Fn)return t}return!0}),lt(e=>e!==gu),ii(1)))}function wb(r,e){return vt(t=>{let{targetSnapshot:n,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?K(we(B({},t),{guardsResult:!0})):Eb(o,n,i,r).pipe(vt(u=>u&&pb(u)?Ib(n,s,r,e):K(u)),J(u=>we(B({},t),{guardsResult:u})))})}function Eb(r,e,t,n){return Ee(r).pipe(vt(i=>Sb(i.component,i.route,t,e,n)),$t(i=>i!==!0,!0))}function Ib(r,e,t,n){return Ee(e).pipe(Rn(i=>Nm(Ab(i.route.parent,n),Tb(i.route,n),Cb(r,i.path,t),bb(r,i.route,t))),$t(i=>i!==!0,!0))}function Tb(r,e){return r!==null&&e&&e(new jh(r)),K(!0)}function Ab(r,e){return r!==null&&e&&e(new Lh(r)),K(!0)}function bb(r,e,t){let n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||n.length===0)return K(!0);let i=n.map(s=>Nl(()=>{let o=To(e)??t,u=Si(s,o),c=mb(u)?u.canActivate(e,r):zt(o,()=>u(e,r));return Bn(c).pipe($t())}));return K(i).pipe(Ci())}function Cb(r,e,t){let n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>hb(o)).filter(o=>o!==null).map(o=>Nl(()=>{let u=o.guards.map(c=>{let l=To(o.node)??t,f=Si(c,l),p=yb(f)?f.canActivateChild(n,r):zt(l,()=>f(n,r));return Bn(p).pipe($t())});return K(u).pipe(Ci())}));return K(s).pipe(Ci())}function Sb(r,e,t,n,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return K(!0);let o=s.map(u=>{let c=To(e)??i,l=Si(u,c),f=vb(l)?l.canDeactivate(r,e,t,n):zt(c,()=>l(r,e,t,n));return Bn(f).pipe($t())});return K(o).pipe(Ci())}function Rb(r,e,t,n){let i=e.canLoad;if(i===void 0||i.length===0)return K(!0);let s=i.map(o=>{let u=Si(o,r),c=gb(u)?u.canLoad(e,t):zt(r,()=>u(e,t));return Bn(c)});return K(s).pipe(Ci(),t_(n))}function t_(r){return xm(Ue(e=>{if(Ai(e))throw Jv(r,e)}),J(e=>e===!0))}function Db(r,e,t,n){let i=e.canMatch;if(!i||i.length===0)return K(!0);let s=i.map(o=>{let u=Si(o,r),c=_b(u)?u.canMatch(e,t):zt(r,()=>u(e,t));return Bn(c)});return K(s).pipe(Ci(),t_(n))}var vo=class{constructor(e){this.segmentGroup=e||null}},Ru=class extends Error{constructor(e){super(),this.urlTree=e}};function _i(r){return Us(new vo(r))}function Pb(r){return Us(new me(4e3,!1))}function xb(r){return Us(Yv(!1,wt.GuardRejected))}var Hh=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let n=[],i=t.root;for(;;){if(n=n.concat(i.segments),i.numberOfChildren===0)return K(n);if(i.numberOfChildren>1||!i.children[ne])return Pb(e.redirectTo);i=i.children[ne]}}applyRedirectCommands(e,t,n){let i=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,n);if(t.startsWith("/"))throw new Ru(i);return i}applyRedirectCreateUrlTree(e,t,n,i){let s=this.createSegmentGroup(e,t.root,n,i);return new Fn(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let n={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let u=s.substring(1);n[i]=t[u]}else n[i]=s}),n}createSegmentGroup(e,t,n,i){let s=this.createSegments(e,t.segments,n,i),o={};return Object.entries(t.children).forEach(([u,c])=>{o[u]=this.createSegmentGroup(e,c,n,i)}),new le(s,o)}createSegments(e,t,n,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,n))}findPosParam(e,t,n){let i=n[t.path.substring(1)];if(!i)throw new me(4001,!1);return i}findOrReturn(e,t){let n=0;for(let i of t){if(i.path===e.path)return t.splice(n),i;n++}return e}},Qh={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Vb(r,e,t,n,i){let s=nd(r,e,t);return s.matched?(n=ab(e,n),Db(n,e,t,i).pipe(J(o=>o===!0?s:B({},Qh)))):K(s)}function nd(r,e,t){if(e.path==="**")return Mb(t);if(e.path==="")return e.pathMatch==="full"&&(r.hasChildren()||t.length>0)?B({},Qh):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||RA)(t,r,e);if(!i)return B({},Qh);let s={};Object.entries(i.posParams??{}).forEach(([u,c])=>{s[u]=c.path});let o=i.consumed.length>0?B(B({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function Mb(r){return{matched:!0,parameters:r.length>0?kv(r).parameters:{},consumedSegments:r,remainingSegments:[],positionalParamSegments:{}}}function Pv(r,e,t,n){return t.length>0&&Ob(r,t,n)?{segmentGroup:new le(e,Nb(n,new le(t,r.children))),slicedSegments:[]}:t.length===0&&Fb(r,t,n)?{segmentGroup:new le(r.segments,kb(r,t,n,r.children)),slicedSegments:t}:{segmentGroup:new le(r.segments,r.children),slicedSegments:t}}function kb(r,e,t,n){let i={};for(let s of t)if(xu(r,e,s)&&!n[Qt(s)]){let o=new le([],{});i[Qt(s)]=o}return B(B({},n),i)}function Nb(r,e){let t={};t[ne]=e;for(let n of r)if(n.path===""&&Qt(n)!==ne){let i=new le([],{});t[Qt(n)]=i}return t}function Ob(r,e,t){return t.some(n=>xu(r,e,n)&&Qt(n)!==ne)}function Fb(r,e,t){return t.some(n=>xu(r,e,n))}function xu(r,e,t){return(r.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function Lb(r,e,t,n){return Qt(r)!==n&&(n===ne||!xu(e,t,r))?!1:nd(e,r,t).matched}function Ub(r,e,t){return e.length===0&&!r.children[t]}var Xh=class{};function jb(r,e,t,n,i,s,o="emptyOnly"){return new Jh(r,e,t,n,i,o,s).recognize()}var Bb=31,Jh=class{constructor(e,t,n,i,s,o,u){this.injector=e,this.configLoader=t,this.rootComponentType=n,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=u,this.applyRedirects=new Hh(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new me(4002,`'${e.segmentGroup}'`)}recognize(){let e=Pv(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(J(t=>{let n=new mo([],Object.freeze({}),Object.freeze(B({},this.urlTree.queryParams)),this.urlTree.fragment,{},ne,this.rootComponentType,null,{}),i=new _t(n,t),s=new Cu("",i),o=WA(n,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,ne).pipe(ri(n=>{if(n instanceof Ru)return this.urlTree=n.urlTree,this.match(n.urlTree.root);throw n instanceof vo?this.noMatchError(n):n}))}inheritParamsAndData(e,t){let n=e.value,i=Zh(n,t,this.paramsInheritanceStrategy);n.params=Object.freeze(i.params),n.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,n))}processSegmentGroup(e,t,n,i){return n.segments.length===0&&n.hasChildren()?this.processChildren(e,t,n):this.processSegment(e,t,n,n.segments,i,!0).pipe(J(s=>s instanceof _t?[s]:[]))}processChildren(e,t,n){let i=[];for(let s of Object.keys(n.children))s==="primary"?i.unshift(s):i.push(s);return Ee(i).pipe(Rn(s=>{let o=n.children[s],u=ub(t,s);return this.processSegmentGroup(e,u,o,s)}),si((s,o)=>(s.push(...o),s)),Ol(null),jm(),vt(s=>{if(s===null)return _i(n);let o=n_(s);return qb(o),K(o)}))}processSegment(e,t,n,i,s,o){return Ee(t).pipe(Rn(u=>this.processSegmentAgainstRoute(u._injector??e,t,u,n,i,s,o).pipe(ri(c=>{if(c instanceof vo)return K(null);throw c}))),$t(u=>!!u),ri(u=>{if(e_(u))return Ub(n,i,s)?K(new Xh):_i(n);throw u}))}processSegmentAgainstRoute(e,t,n,i,s,o,u){return Lb(n,i,s,o)?n.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,n,s,o):this.allowRedirects&&u?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,n,s,o):_i(i):_i(i)}expandSegmentAgainstRouteUsingRedirect(e,t,n,i,s,o){let{matched:u,consumedSegments:c,positionalParamSegments:l,remainingSegments:f}=nd(t,i,s);if(!u)return _i(t);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Bb&&(this.allowRedirects=!1));let p=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,p).pipe(vt(m=>this.processSegment(e,n,t,m.concat(f),o,!1)))}matchSegmentAgainstRoute(e,t,n,i,s){let o=Vb(t,n,i,e,this.urlSerializer);return n.path==="**"&&(t.children={}),o.pipe(Me(u=>u.matched?(e=n._injector??e,this.getChildConfig(e,n,i).pipe(Me(({routes:c})=>{let l=n._loadedInjector??e,{consumedSegments:f,remainingSegments:p,parameters:m}=u,w=new mo(f,m,Object.freeze(B({},this.urlTree.queryParams)),this.urlTree.fragment,zb(n),Qt(n),n.component??n._loadedComponent??null,n,Gb(n)),{segmentGroup:x,slicedSegments:V}=Pv(t,f,p,c);if(V.length===0&&x.hasChildren())return this.processChildren(l,c,x).pipe(J(N=>N===null?null:new _t(w,N)));if(c.length===0&&V.length===0)return K(new _t(w,[]));let D=Qt(n)===s;return this.processSegment(l,c,x,V,D?ne:s,!0).pipe(J(N=>new _t(w,N instanceof _t?[N]:[])))}))):_i(t)))}getChildConfig(e,t,n){return t.children?K({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?K({routes:t._loadedRoutes,injector:t._loadedInjector}):Rb(e,t,n,this.urlSerializer).pipe(vt(i=>i?this.configLoader.loadChildren(e,t).pipe(Ue(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):xb(t))):K({routes:[],injector:e})}};function qb(r){r.sort((e,t)=>e.value.outlet===ne?-1:t.value.outlet===ne?1:e.value.outlet.localeCompare(t.value.outlet))}function $b(r){let e=r.value.routeConfig;return e&&e.path===""}function n_(r){let e=[],t=new Set;for(let n of r){if(!$b(n)){e.push(n);continue}let i=e.find(s=>n.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...n.children),t.add(i)):e.push(n)}for(let n of t){let i=n_(n.children);e.push(new _t(n.value,i))}return e.filter(n=>!t.has(n))}function zb(r){return r.data||{}}function Gb(r){return r.resolve||{}}function Kb(r,e,t,n,i,s){return vt(o=>jb(r,e,t,n,o.extractedUrl,i,s).pipe(J(({state:u,tree:c})=>we(B({},o),{targetSnapshot:u,urlAfterRedirects:c}))))}function Wb(r,e){return vt(t=>{let{targetSnapshot:n,guards:{canActivateChecks:i}}=t;if(!i.length)return K(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of r_(c))o.add(l);let u=0;return Ee(o).pipe(Rn(c=>s.has(c)?Hb(c,n,r,e):(c.data=Zh(c,c.parent,r).resolve,K(void 0))),Ue(()=>u++),Fl(1),vt(c=>u===o.size?K(t):Cn))})}function r_(r){let e=r.children.map(t=>r_(t)).flat();return[r,...e]}function Hb(r,e,t,n){let i=r.routeConfig,s=r._resolve;return i?.title!==void 0&&!Qv(i)&&(s[wo]=i.title),Qb(s,r,e,n).pipe(J(o=>(r._resolvedData=o,r.data=Zh(r,r.parent,t).resolve,null)))}function Qb(r,e,t,n){let i=Rh(r);if(i.length===0)return K({});let s={};return Ee(i).pipe(vt(o=>Xb(r[o],e,t,n).pipe($t(),Ue(u=>{s[o]=u}))),Fl(1),Lm(s),ri(o=>e_(o)?Cn:Us(o)))}function Xb(r,e,t,n){let i=To(e)??n,s=Si(r,i),o=s.resolve?s.resolve(e,t):zt(i,()=>s(e,t));return Bn(o)}function Ch(r){return Me(e=>{let t=r(e);return t?Ee(t).pipe(J(()=>e)):K(e)})}var i_=(()=>{let e=class e{buildTitle(n){let i,s=n.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===ne);return i}getResolvedTitleForRoute(n){return n.data[wo]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:()=>H(Jb),providedIn:"root"});let r=e;return r})(),Jb=(()=>{let e=class e extends i_{constructor(n){super(),this.title=n}updateTitle(n){let i=this.buildTitle(n);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(j(qy))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),bo=new Q("",{providedIn:"root",factory:()=>({})}),_o=new Q(""),rd=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=H($a)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return K(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);let i=Bn(n.loadComponent()).pipe(J(s_),Ue(o=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=o}),pr(()=>{this.componentLoaders.delete(n)})),s=new Ml(i,()=>new Tt).pipe(Vl());return this.componentLoaders.set(n,s),s}loadChildren(n,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return K({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=Yb(i,this.compiler,n,this.onLoadEndListener).pipe(pr(()=>{this.childrenLoaders.delete(i)})),u=new Ml(o,()=>new Tt).pipe(Vl());return this.childrenLoaders.set(i,u),u}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();function Yb(r,e,t,n){return Bn(r.loadChildren()).pipe(J(s_),vt(i=>i instanceof oy||Array.isArray(i)?K(i):Ee(e.compileModuleAsync(i))),J(i=>{n&&n(r);let s,o,u=!1;return Array.isArray(i)?(o=i,u=!0):(s=i.create(t).injector,o=s.get(_o,[],{optional:!0,self:!0}).flat()),{routes:o.map(td),injector:s}}))}function Zb(r){return r&&typeof r=="object"&&"default"in r}function s_(r){return Zb(r)?r.default:r}var id=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:()=>H(eC),providedIn:"root"});let r=e;return r})(),eC=(()=>{let e=class e{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,i){return n}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),o_=new Q(""),a_=new Q("");function tC(r,e,t){let n=r.get(a_),i=r.get(pt);return r.get(Se).runOutsideAngular(()=>{if(!i.startViewTransition||n.skipNextTransition)return n.skipNextTransition=!1,new Promise(l=>setTimeout(l));let s,o=new Promise(l=>{s=l}),u=i.startViewTransition(()=>(s(),nC(r))),{onViewTransitionCreated:c}=n;return c&&zt(r,()=>c({transition:u,from:e,to:t})),o})}function nC(r){return new Promise(e=>{zl(e,{injector:r})})}var sd=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Tt,this.transitionAbortSubject=new Tt,this.configLoader=H(rd),this.environmentInjector=H(xn),this.urlSerializer=H(Eo),this.rootContexts=H(Io),this.location=H(Gs),this.inputBindingEnabled=H(Pu,{optional:!0})!==null,this.titleStrategy=H(i_),this.options=H(bo,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=H(id),this.createViewTransition=H(o_,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>K(void 0),this.rootComponentType=null;let n=s=>this.events.next(new Oh(s)),i=s=>this.events.next(new Fh(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=n}complete(){this.transitions?.complete()}handleNavigationRequest(n){let i=++this.navigationId;this.transitions?.next(we(B(B({},this.transitions.value),n),{id:i}))}setupNavigations(n,i,s){return this.transitions=new At({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:uo,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(lt(o=>o.id!==0),J(o=>we(B({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Me(o=>{let u=!1,c=!1;return K(o).pipe(Me(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",wt.SupersededByNewNavigation),Cn;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?we(B({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let f=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),p=l.extras.onSameUrlNavigation??n.onSameUrlNavigation;if(!f&&p!=="reload"){let m="";return this.events.next(new Un(l.id,this.urlSerializer.serialize(l.rawUrl),m,Eu.IgnoredSameUrlNavigation)),l.resolve(null),Cn}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return K(l).pipe(Me(m=>{let w=this.transitions?.getValue();return this.events.next(new bi(m.id,this.urlSerializer.serialize(m.extractedUrl),m.source,m.restoredState)),w!==this.transitions?.getValue()?Cn:Promise.resolve(m)}),Kb(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy),Ue(m=>{o.targetSnapshot=m.targetSnapshot,o.urlAfterRedirects=m.urlAfterRedirects,this.currentNavigation=we(B({},this.currentNavigation),{finalUrl:m.urlAfterRedirects});let w=new Iu(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(w)}));if(f&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:m,extractedUrl:w,source:x,restoredState:V,extras:D}=l,N=new bi(m,this.urlSerializer.serialize(w),x,V);this.events.next(N);let z=Wv(this.rootComponentType).snapshot;return this.currentTransition=o=we(B({},l),{targetSnapshot:z,urlAfterRedirects:w,extras:we(B({},D),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=w,K(o)}else{let m="";return this.events.next(new Un(l.id,this.urlSerializer.serialize(l.extractedUrl),m,Eu.IgnoredByUrlHandlingStrategy)),l.resolve(null),Cn}}),Ue(l=>{let f=new Vh(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(f)}),J(l=>(this.currentTransition=o=we(B({},l),{guards:lb(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),wb(this.environmentInjector,l=>this.events.next(l)),Ue(l=>{if(o.guardsResult=l.guardsResult,Ai(l.guardsResult))throw Jv(this.urlSerializer,l.guardsResult);let f=new Mh(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(f)}),lt(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",wt.GuardRejected),!1)),Ch(l=>{if(l.guards.canActivateChecks.length)return K(l).pipe(Ue(f=>{let p=new kh(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(p)}),Me(f=>{let p=!1;return K(f).pipe(Wb(this.paramsInheritanceStrategy,this.environmentInjector),Ue({next:()=>p=!0,complete:()=>{p||this.cancelNavigationTransition(f,"",wt.NoDataFromResolver)}}))}),Ue(f=>{let p=new Nh(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(p)}))}),Ch(l=>{let f=p=>{let m=[];p.routeConfig?.loadComponent&&!p.routeConfig._loadedComponent&&m.push(this.configLoader.loadComponent(p.routeConfig).pipe(Ue(w=>{p.component=w}),J(()=>{})));for(let w of p.children)m.push(...f(w));return m};return Na(f(l.targetSnapshot.root)).pipe(Ol(null),ii(1))}),Ch(()=>this.afterPreactivation()),Me(()=>{let{currentSnapshot:l,targetSnapshot:f}=o,p=this.createViewTransition?.(this.environmentInjector,l.root,f.root);return p?Ee(p).pipe(J(()=>o)):K(o)}),J(l=>{let f=nb(n.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=we(B({},l),{targetRouterState:f}),this.currentNavigation.targetRouterState=f,o}),Ue(()=>{this.events.next(new po)}),cb(this.rootContexts,n.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),ii(1),Ue({next:l=>{u=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Ht(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{u=!0}}),Bm(this.transitionAbortSubject.pipe(Ue(l=>{throw l}))),pr(()=>{!u&&!c&&this.cancelNavigationTransition(o,"",wt.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),ri(l=>{if(c=!0,Zv(l))this.events.next(new Ln(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),sb(l)?this.events.next(new go(l.url)):o.resolve(!1);else{this.events.next(new fo(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0));try{o.resolve(n.errorHandler(l))}catch(f){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(f)}}return Cn}))}))}cancelNavigationTransition(n,i,s){let o=new Ln(n.id,this.urlSerializer.serialize(n.extractedUrl),i,s);this.events.next(o),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();function rC(r){return r!==uo}var iC=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:()=>H(sC),providedIn:"root"});let r=e;return r})(),Yh=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},sC=(()=>{let e=class e extends Yh{};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=Vn(e)))(s||e)}})(),e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),u_=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:()=>H(oC),providedIn:"root"});let r=e;return r})(),oC=(()=>{let e=class e extends u_{constructor(){super(...arguments),this.location=H(Gs),this.urlSerializer=H(Eo),this.options=H(bo,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=H(id),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Fn,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=Wv(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(i=>{i.type==="popstate"&&n(i.url,i.state)})}handleRouterEvent(n,i){if(n instanceof bi)this.stateMemento=this.createStateMemento();else if(n instanceof Un)this.rawUrlTree=i.initialUrl;else if(n instanceof Iu){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else n instanceof po?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):n instanceof Ln&&(n.code===wt.GuardRejected||n.code===wt.NoDataFromResolver)?this.restoreHistory(i):n instanceof fo?this.restoreHistory(i,!0):n instanceof Ht&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,i){let s=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,u=B(B({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",u)}else{let o=B(B({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(n,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===n.finalUrl&&o===0&&(this.resetState(n),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,i){return this.canceledNavigationResolution==="computed"?{navigationId:n,\u0275routerPageId:i}:{navigationId:n}}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=Vn(e)))(s||e)}})(),e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),oo=function(r){return r[r.COMPLETE=0]="COMPLETE",r[r.FAILED=1]="FAILED",r[r.REDIRECTING=2]="REDIRECTING",r}(oo||{});function c_(r,e){r.events.pipe(lt(t=>t instanceof Ht||t instanceof Ln||t instanceof fo||t instanceof Un),J(t=>t instanceof Ht||t instanceof Un?oo.COMPLETE:(t instanceof Ln?t.code===wt.Redirect||t.code===wt.SupersededByNewNavigation:!1)?oo.REDIRECTING:oo.FAILED),lt(t=>t!==oo.REDIRECTING),ii(1)).subscribe(()=>{e()})}function aC(r){throw r}var uC={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},cC={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Ot=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=H(Ua),this.stateManager=H(u_),this.options=H(bo,{optional:!0})||{},this.pendingTasks=H(qs),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=H(sd),this.urlSerializer=H(Eo),this.location=H(Gs),this.urlHandlingStrategy=H(id),this._events=new Tt,this.errorHandler=this.options.errorHandler||aC,this.navigated=!1,this.routeReuseStrategy=H(iC),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=H(_o,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!H(Pu,{optional:!0}),this.eventsSubscription=new Pm,this.isNgZoneEnabled=H(Se)instanceof Se&&Se.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let n=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Ln&&i.code!==wt.Redirect&&i.code!==wt.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Ht)this.navigated=!0;else if(i instanceof go){let u=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||rC(s.source)};this.scheduleNavigation(u,uo,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}hC(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),uo,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(n,"popstate",i)},0)})}navigateToSyncWithBrowser(n,i,s){let o={replaceUrl:!0},u=s?.navigationId?s:null;if(s){let l=B({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let c=this.parseUrl(n);this.scheduleNavigation(c,i,u,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(td),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,i={}){let{relativeTo:s,queryParams:o,fragment:u,queryParamsHandling:c,preserveFragment:l}=i,f=l?this.currentUrlTree.fragment:u,p=null;switch(c){case"merge":p=B(B({},this.currentUrlTree.queryParams),o);break;case"preserve":p=this.currentUrlTree.queryParams;break;default:p=o||null}p!==null&&(p=this.removeEmptyProps(p));let m;try{let w=s?s.snapshot:this.routerState.snapshot.root;m=$v(w)}catch{(typeof n[0]!="string"||!n[0].startsWith("/"))&&(n=[]),m=this.currentUrlTree.root}return zv(m,n,p,f??null)}navigateByUrl(n,i={skipLocationChange:!1}){let s=Ai(n)?n:this.parseUrl(n),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,uo,null,i)}navigate(n,i={skipLocationChange:!1}){return lC(n),this.navigateByUrl(this.createUrlTree(n,i),i)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.urlSerializer.parse("/")}}isActive(n,i){let s;if(i===!0?s=B({},uC):i===!1?s=B({},cC):s=i,Ai(n))return bv(this.currentUrlTree,n,s);let o=this.parseUrl(n);return bv(this.currentUrlTree,o,s)}removeEmptyProps(n){return Object.entries(n).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(n,i,s,o,u){if(this.disposed)return Promise.resolve(!1);let c,l,f;u?(c=u.resolve,l=u.reject,f=u.promise):f=new Promise((m,w)=>{c=m,l=w});let p=this.pendingTasks.add();return c_(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(p))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:o,resolve:c,reject:l,promise:f,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),f.catch(m=>Promise.reject(m))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();function lC(r){for(let e=0;e<r.length;e++)if(r[e]==null)throw new me(4008,!1)}function hC(r){return!(r instanceof po)&&!(r instanceof go)}var l_=(()=>{let e=class e{constructor(n,i,s,o,u,c){this.router=n,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=u,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new Tt,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let l=u.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=n.events.subscribe(f=>{f instanceof Ht&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(n){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(n){n!=null?(this.commands=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(n,i,s,o,u){let c=this.urlTree;if(c===null||this.isAnchorElement&&(n!==0||i||s||o||u||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let n=this.urlTree;this.href=n!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(n)):null;let i=this.href===null?null:ty(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(n,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,n,i):s.removeAttribute(o,n)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(re(Ot),re(jn),Gm("tabindex"),re(vr),re(mr),re(pi))},e.\u0275dir=Be({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&pe("click",function(u){return s.onClick(u.button,u.ctrlKey,u.shiftKey,u.altKey,u.metaKey)}),i&2&&Kl("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[bt.HasDecoratorInputTransform,"preserveFragment","preserveFragment",di],skipLocationChange:[bt.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",di],replaceUrl:[bt.HasDecoratorInputTransform,"replaceUrl","replaceUrl",di],routerLink:"routerLink"},standalone:!0,features:[sy,ln]});let r=e;return r})();var Du=class{};var dC=(()=>{let e=class e{constructor(n,i,s,o,u){this.router=n,this.injector=s,this.preloadingStrategy=o,this.loader=u}setUpPreloading(){this.subscription=this.router.events.pipe(lt(n=>n instanceof Ht),Rn(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=Gl(o.providers,n,`Route: ${o.path}`));let u=o._injector??n,c=o._loadedInjector??u;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(u,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return Ee(s).pipe(kl())}preloadConfig(n,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(n,i):s=K(null);let o=s.pipe(vt(u=>u===null?K(void 0):(i._loadedRoutes=u.routes,i._loadedInjector=u.injector,this.processRoutes(u.injector??n,u.routes))));if(i.loadComponent&&!i._loadedComponent){let u=this.loader.loadComponent(i);return Ee([o,u]).pipe(kl())}else return o})}};e.\u0275fac=function(i){return new(i||e)(j(Ot),j($a),j(xn),j(Du),j(rd))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),h_=new Q(""),fC=(()=>{let e=class e{constructor(n,i,s,o,u={}){this.urlSerializer=n,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=u,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=H(xn),u.scrollPositionRestoration||="disabled",u.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof bi?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof Ht?(this.lastId=n.id,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.urlAfterRedirects).fragment)):n instanceof Un&&n.code===Eu.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof Tu&&(n.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(n.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,i){this.zone.runOutsideAngular(()=>P(this,null,function*(){yield new Promise(s=>{setTimeout(()=>{s()}),zl(()=>{s()},{injector:this.environmentInjector})}),this.zone.run(()=>{this.transitions.events.next(new Tu(n,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){ny()},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let r=e;return r})();function fx(r,...e){return gr([{provide:_o,multi:!0,useValue:r},[],{provide:jn,useFactory:d_,deps:[Ot]},{provide:Ba,multi:!0,useFactory:f_},e.map(t=>t.\u0275providers)])}function d_(r){return r.routerState.root}function Ri(r,e){return{\u0275kind:r,\u0275providers:e}}function f_(){let r=H(ui);return e=>{let t=r.get(qa);if(e!==t.components[0])return;let n=r.get(Ot),i=r.get(p_);r.get(od)===1&&n.initialNavigation(),r.get(g_,null,jl.Optional)?.setUpPreloading(),r.get(h_,null,jl.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var p_=new Q("",{factory:()=>new Tt}),od=new Q("",{providedIn:"root",factory:()=>1});function pC(){return Ri(2,[{provide:od,useValue:0},{provide:Ql,multi:!0,deps:[ui],useFactory:e=>{let t=e.get(fy,Promise.resolve());return()=>t.then(()=>new Promise(n=>{let i=e.get(Ot),s=e.get(p_);c_(i,()=>{n(!0)}),e.get(sd).afterPreactivation=()=>(n(!0),s.closed?K(void 0):s),i.initialNavigation()}))}}])}function gC(){return Ri(3,[{provide:Ql,multi:!0,useFactory:()=>{let e=H(Ot);return()=>{e.setUpLocationChangeListener()}}},{provide:od,useValue:2}])}var g_=new Q("");function mC(r){return Ri(0,[{provide:g_,useExisting:dC},{provide:Du,useExisting:r}])}function px(){return Ri(6,[{provide:pi,useClass:Jl}])}function yC(){return Ri(8,[Dv,{provide:Pu,useExisting:Dv}])}function vC(r){let e=[{provide:o_,useValue:tC},{provide:a_,useValue:B({skipNextTransition:!!r?.skipInitialTransition},r)}];return Ri(9,e)}var xv=new Q("ROUTER_FORROOT_GUARD"),_C=[Gs,{provide:Eo,useClass:lo},Ot,Io,{provide:jn,useFactory:d_,deps:[Ot]},rd,[]],gx=(()=>{let e=class e{constructor(n){}static forRoot(n,i){return{ngModule:e,providers:[_C,[],{provide:_o,multi:!0,useValue:n},{provide:xv,useFactory:TC,deps:[[Ot,new Pn,new $m]]},{provide:bo,useValue:i||{}},i?.useHash?EC():IC(),wC(),i?.preloadingStrategy?mC(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?AC(i):[],i?.bindToComponentInputs?yC().\u0275providers:[],i?.enableViewTransitions?vC().\u0275providers:[],bC()]}}static forChild(n){return{ngModule:e,providers:[{provide:_o,multi:!0,useValue:n}]}}};e.\u0275fac=function(i){return new(i||e)(j(xv,8))},e.\u0275mod=dt({type:e}),e.\u0275inj=ht({});let r=e;return r})();function wC(){return{provide:h_,useFactory:()=>{let r=H(yy),e=H(Se),t=H(bo),n=H(sd),i=H(Eo);return t.scrollOffset&&r.setOffset(t.scrollOffset),new fC(i,n,r,e,t)}}}function EC(){return{provide:pi,useClass:Jl}}function IC(){return{provide:pi,useClass:py}}function TC(r){return"guarded"}function AC(r){return[r.initialNavigation==="disabled"?gC().\u0275providers:[],r.initialNavigation==="enabledBlocking"?pC().\u0275providers:[]]}var Vv=new Q("");function bC(){return[{provide:Vv,useFactory:f_},{provide:Ba,multi:!0,useExisting:Vv}]}var SC="firebase",RC="10.12.3";St(SC,RC,"app");var hn=new $s("ANGULARFIRE2_VERSION");function bx(r,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(r).getImmediate({optional:!0})}var DC=(r,e)=>{let t=e?[e]:Ha(),n=[];return t.forEach(i=>{i.container.getProvider(r).instances.forEach(o=>{n.includes(o)||n.push(o)})}),n},Cr=class{constructor(){return DC(PC)}},PC="app-check";function Di(){}var Vu=class{zone;delegate;constructor(e,t=Vm){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,n){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,t,n)}},ad=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Di,{},Di,Di)),t.pipe(Ue({next:n,complete:n,error:n})).subscribe(e).add(n)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Pi=(()=>{class r{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Vu(Zone.current)),this.insideAngular=t.run(()=>new Vu(Zone.current,ka)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(n){return new(n||r)(j(Se))};static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function Mu(){let r=globalThis.\u0275AngularFireScheduler;if(!r)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return r}function xC(r){return Mu().ngZone.runOutsideAngular(()=>r())}function br(r){return Mu().ngZone.run(()=>r())}function ot(r){return VC(Mu())(r)}function VC(r){return function(t){return t=t.lift(new ad(r.ngZone)),t.pipe(fr(r.outsideAngular),Sn(r.insideAngular))}}var MC=(r,e)=>function(){let n=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),br(()=>r.apply(void 0,n))},m_=(r,e)=>function(){let t,n=arguments;for(let s=0;s<arguments.length;s++)typeof n[s]=="function"&&(e&&(t||=br(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Di,{},Di,Di))),n[s]=MC(n[s],t));let i=xC(()=>r.apply(this,n));if(!e)if(i instanceof qt){let s=Mu();return i.pipe(fr(s.outsideAngular),Sn(s.insideAngular))}else return br(()=>i);return i instanceof qt?i.pipe(ot):i instanceof Promise?br(()=>new Promise((s,o)=>i.then(u=>br(()=>s(u)),u=>br(()=>o(u))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:br(()=>i)};var Co=class{constructor(e){return e}},ud=class{constructor(){return Ha()}};function kC(r){return r&&r.length===1?r[0]:new Co(Hs())}var cd=new Q("angularfire2._apps"),NC={provide:Co,useFactory:kC,deps:[[new Pn,cd]]},OC={provide:ud,deps:[[new Pn,cd]]};function FC(r){return(e,t)=>{let n=t.get(st);St("angularfire",hn.full,"core"),St("angularfire",hn.full,"app"),St("angular",La.full,n.toString());let i=e.runOutsideAngular(()=>r(t));return new Co(i)}}function Nx(r,...e){return gr([NC,OC,{provide:cd,useFactory:FC(r),multi:!0,deps:[Se,ui,Pi,...e]}])}var Ox=m_(Ay,!0);var LC="firebase",UC="10.12.3";gt.registerVersion(LC,UC,"app-compat");var jC=["ngOnDestroy"],__=(r,e,t,n={})=>new Proxy(r,{get:(i,s)=>t.runOutsideAngular(()=>{if(r[s])return n?.spy?.get&&n.spy.get(s,r[s]),r[s];if(jC.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(u=>{let c=u?.[s];return typeof c=="function"?c.bind(u):c?.then?c.then(l=>t.run(()=>l)):t.run(()=>c)});return new Proxy(()=>{},{get:(u,c)=>o[c],apply:(u,c,l)=>o.then(f=>{let p=f?.(...l);return n?.spy?.apply&&n.spy.apply(s,l,p),p})})})});var ku=class{constructor(e){return e}},xi=new Q("angularfire2.app.options"),Vi=new Q("angularfire2.app.name");function So(r,e,t){let n=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||n;let o=gt.apps.filter(u=>u&&u.name===i.name)[0]||e.runOutsideAngular(()=>gt.initializeApp(r,i));try{if(JSON.stringify(r)!==JSON.stringify(o.options)){let u=!!module.hot;BC("error",`${o.name} Firebase App already initialized with different options${u?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new ku(o)}var BC=(r,...e)=>{Xl()&&typeof console<"u"&&console[r](...e)},qC={provide:ku,useFactory:So,deps:[xi,Se,[new Pn,Vi]]},Wx=(()=>{class r{static initializeApp(t,n){return{ngModule:r,providers:[{provide:xi,useValue:t},{provide:Vi,useValue:n}]}}constructor(t){gt.registerVersion("angularfire",hn.full,"core"),gt.registerVersion("angularfire",hn.full,"app-compat"),gt.registerVersion("angular",La.full,t.toString())}static \u0275fac=function(n){return new(n||r)(j(st))};static \u0275mod=dt({type:r});static \u0275inj=ht({providers:[qC]})}return r})();function Nu(r,e,t,n,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(u=>u[0]===r)||[];if(s)return $C(i,o)||(v_("error",`${e} was already initialized on the ${t} Firebase App with different settings.${zC?" You may need to reload as Firebase is not HMR aware.":""}`),v_("warn",{is:i,was:o})),s;{let u=n();return globalThis.\u0275AngularfireInstanceCache.push([r,u,i]),u}}function $C(r,e){try{return r.toString()===e.toString()}catch{return r===e}}var zC=typeof module<"u"&&!!module.hot,v_=(r,...e)=>{Xl()&&typeof console<"u"&&console[r](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var GC=new Map,KC={activated:!1,tokenObservers:[]},WC={initialized:!1,enabled:!1};function Ft(r){return GC.get(r)||Object.assign({},KC)}function A_(){return WC}var HC="https://content-firebaseappcheck.googleapis.com/v1";var QC="exchangeDebugToken",w_={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},rV=24*60*60*1e3;var hd=class{constructor(e,t,n,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return P(this,null,function*(){this.stop();try{this.pending=new Yl,this.pending.promise.catch(t=>{}),yield XC(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new Yl,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function XC(r){return new Promise(e=>{setTimeout(e,r)})}var JC={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},qn=new Iy("appCheck","AppCheck",JC);function b_(r){if(!Ft(r).activated)throw qn.create("use-before-activation",{appName:r.name})}function C_(n,i){return P(this,arguments,function*({url:r,body:e},t){let s={"Content-Type":"application/json"},o=t.getImmediate({optional:!0});if(o){let w=yield o.getHeartbeatsHeader();w&&(s["X-Firebase-Client"]=w)}let u={method:"POST",body:JSON.stringify(e),headers:s},c;try{c=yield fetch(r,u)}catch(w){throw qn.create("fetch-network-error",{originalErrorMessage:w?.message})}if(c.status!==200)throw qn.create("fetch-status-error",{httpStatus:c.status});let l;try{l=yield c.json()}catch(w){throw qn.create("fetch-parse-error",{originalErrorMessage:w?.message})}let f=l.ttl.match(/^([\d.]+)(s)$/);if(!f||!f[2]||isNaN(Number(f[1])))throw qn.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let p=Number(f[1])*1e3,m=Date.now();return{token:l.token,expireTimeMillis:m+p,issuedAtTimeMillis:m}})}function S_(r,e){let{projectId:t,appId:n,apiKey:i}=r.options;return{url:`${HC}/projects/${t}/apps/${n}:${QC}?key=${i}`,body:{debug_token:e}}}var YC="firebase-app-check-database",ZC=1,dd="firebase-app-check-store";var Ou=null;function eS(){return Ou||(Ou=new Promise((r,e)=>{try{let t=indexedDB.open(YC,ZC);t.onsuccess=n=>{r(n.target.result)},t.onerror=n=>{var i;e(qn.create("storage-open",{originalErrorMessage:(i=n.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=n=>{let i=n.target.result;switch(n.oldVersion){case 0:i.createObjectStore(dd,{keyPath:"compositeKey"})}}}catch(t){e(qn.create("storage-open",{originalErrorMessage:t?.message}))}}),Ou)}function tS(r,e){return nS(rS(r),e)}function nS(r,e){return P(this,null,function*(){let n=(yield eS()).transaction(dd,"readwrite"),s=n.objectStore(dd).put({compositeKey:r,value:e});return new Promise((o,u)=>{s.onsuccess=c=>{o()},n.onerror=c=>{var l;u(qn.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})})}function rS(r){return`${r.options.appId}-${r.name}`}var fd=new Wa("@firebase/app-check");function ld(r,e){return Ka()?tS(r,e).catch(t=>{fd.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function R_(){return A_().enabled}function D_(){return P(this,null,function*(){let r=A_();if(r.enabled&&r.token)return r.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var iS={error:"UNKNOWN_ERROR"};function sS(r){return vy.encodeString(JSON.stringify(r),!1)}function pd(r,e=!1){return P(this,null,function*(){let t=r.app;b_(t);let n=Ft(t),i=n.token,s;if(i&&!Ro(i)&&(n.token=void 0,i=void 0),!i){let c=yield n.cachedTokenPromise;c&&(Ro(c)?i=c:yield ld(t,void 0))}if(!e&&i&&Ro(i))return{token:i.token};let o=!1;if(R_()){n.exchangeTokenPromise||(n.exchangeTokenPromise=C_(S_(t,yield D_()),r.heartbeatServiceProvider).finally(()=>{n.exchangeTokenPromise=void 0}),o=!0);let c=yield n.exchangeTokenPromise;return yield ld(t,c),n.token=c,{token:c.token}}try{n.exchangeTokenPromise||(n.exchangeTokenPromise=n.provider.getToken().finally(()=>{n.exchangeTokenPromise=void 0}),o=!0),i=yield Ft(t).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?fd.warn(c.message):fd.error(c),s=c}let u;return i?s?Ro(i)?u={token:i.token,internalError:s}:u=I_(s):(u={token:i.token},n.token=i,yield ld(t,i)):u=I_(s),o&&cS(t,u),u})}function oS(r){return P(this,null,function*(){let e=r.app;b_(e);let{provider:t}=Ft(e);if(R_()){let n=yield D_(),{token:i}=yield C_(S_(e,n),r.heartbeatServiceProvider);return{token:i}}else{let{token:n}=yield t.getToken();return{token:n}}})}function aS(r,e,t,n){let{app:i}=r,s=Ft(i),o={next:t,error:n,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Ro(s.token)){let u=s.token;Promise.resolve().then(()=>{t({token:u.token}),E_(r)}).catch(()=>{})}s.cachedTokenPromise.then(()=>E_(r))}function P_(r,e){let t=Ft(r),n=t.tokenObservers.filter(i=>i.next!==e);n.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=n}function E_(r){let{app:e}=r,t=Ft(e),n=t.tokenRefresher;n||(n=uS(r),t.tokenRefresher=n),!n.isRunning()&&t.isTokenAutoRefreshEnabled&&n.start()}function uS(r){let{app:e}=r;return new hd(()=>P(this,null,function*(){let t=Ft(e),n;if(t.token?n=yield pd(r,!0):n=yield pd(r),n.error)throw n.error;if(n.internalError)throw n.internalError}),()=>!0,()=>{let t=Ft(e);if(t.token){let n=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return n=Math.min(n,i),Math.max(0,n-Date.now())}else return 0},w_.RETRIAL_MIN_WAIT,w_.RETRIAL_MAX_WAIT)}function cS(r,e){let t=Ft(r).tokenObservers;for(let n of t)try{n.type==="EXTERNAL"&&e.error!=null?n.error(e.error):n.next(e)}catch{}}function Ro(r){return r.expireTimeMillis-Date.now()>0}function I_(r){return{token:sS(iS),error:r}}var gd=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=Ft(this.app);for(let t of e)P_(this.app,t.next);return Promise.resolve()}};function lS(r,e){return new gd(r,e)}function hS(r){return{getToken:e=>pd(r,e),getLimitedUseToken:()=>oS(r),addTokenListener:e=>aS(r,"INTERNAL",e),removeTokenListener:e=>P_(r.app,e)}}var dS="@firebase/app-check",fS="0.8.5";var pS="app-check",T_="app-check-internal";function gS(){Ws(new _r(pS,r=>{let e=r.getProvider("app").getImmediate(),t=r.getProvider("heartbeat");return lS(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((r,e,t)=>{r.getProvider(T_).initialize()})),Ws(new _r(T_,r=>{let e=r.getProvider("app-check").getImmediate();return hS(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),St(dS,fS)}gS();var mS=["localhost","0.0.0.0","127.0.0.1"],gV=typeof window<"u"&&mS.includes(window.location.hostname);var md=new Q("angularfire2.auth.use-emulator"),yd=new Q("angularfire2.auth.settings"),vd=new Q("angularfire2.auth.tenant-id"),_d=new Q("angularfire2.auth.langugage-code"),wd=new Q("angularfire2.auth.use-device-language"),Ed=new Q("angularfire.auth.persistence"),Id=(r,e,t,n,i,s,o,u)=>Nu(`${r.name}.auth`,"AngularFireAuth",r.name,()=>{let c=e.runOutsideAngular(()=>r.auth());if(t&&c.useEmulator(...t),n&&(c.tenantId=n),c.languageCode=i,s&&c.useDeviceLanguage(),o)for(let[l,f]of Object.entries(o))c.settings[l]=f;return u&&c.setPersistence(u),c},[t,n,i,s,o,u]),V_=(()=>{class r{authState;idToken;user;idTokenResult;credential;constructor(t,n,i,s,o,u,c,l,f,p,m,w){let x=new Tt,V=K(void 0).pipe(Sn(o.outsideAngular),Me(()=>s.runOutsideAngular(()=>import("./chunk-N52UVFYP.js"))),J(()=>So(t,s,n)),J(D=>Id(D,s,u,l,f,p,c,m)),Ll({bufferSize:1,refCount:!1}));if(kn(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=K(null);else{V.pipe($t()).subscribe();let D=V.pipe(Me(F=>F.getRedirectResult().then($=>$,()=>null)),ot,Ll({bufferSize:1,refCount:!1})),N=V.pipe(Me(F=>new qt($=>({unsubscribe:s.runOutsideAngular(()=>F.onAuthStateChanged(X=>$.next(X),X=>$.error(X),()=>$.complete()))})))),z=V.pipe(Me(F=>new qt($=>({unsubscribe:s.runOutsideAngular(()=>F.onIdTokenChanged(X=>$.next(X),X=>$.error(X),()=>$.complete()))}))));this.authState=D.pipe(Ul(N),fr(o.outsideAngular),Sn(o.insideAngular)),this.user=D.pipe(Ul(z),fr(o.outsideAngular),Sn(o.insideAngular)),this.idToken=this.user.pipe(Me(F=>F?Ee(F.getIdToken()):K(null))),this.idTokenResult=this.user.pipe(Me(F=>F?Ee(F.getIdTokenResult()):K(null))),this.credential=Fm(D,x,this.authState.pipe(lt(F=>!F))).pipe(J(F=>F?.user?F:null),fr(o.outsideAngular),Sn(o.insideAngular))}return __(this,V,s,{spy:{apply:(D,N,z)=>{(D.startsWith("signIn")||D.startsWith("createUser"))&&z.then(F=>x.next(F))}}})}static \u0275fac=function(n){return new(n||r)(j(xi),j(Vi,8),j(st),j(Se),j(Pi),j(md,8),j(yd,8),j(vd,8),j(_d,8),j(wd,8),j(Ed,8),j(Cr,8))};static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"any"})}return r})();var M_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},k_={};var $n,Td;(function(){var r;function e(E,y){function _(){}_.prototype=y.prototype,E.D=y.prototype,E.prototype=new _,E.prototype.constructor=E,E.C=function(I,T,b){for(var v=Array(arguments.length-2),an=2;an<arguments.length;an++)v[an-2]=arguments[an];return y.prototype[T].apply(I,v)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,y,_){_||(_=0);var I=Array(16);if(typeof y=="string")for(var T=0;16>T;++T)I[T]=y.charCodeAt(_++)|y.charCodeAt(_++)<<8|y.charCodeAt(_++)<<16|y.charCodeAt(_++)<<24;else for(T=0;16>T;++T)I[T]=y[_++]|y[_++]<<8|y[_++]<<16|y[_++]<<24;y=E.g[0],_=E.g[1],T=E.g[2];var b=E.g[3],v=y+(b^_&(T^b))+I[0]+3614090360&4294967295;y=_+(v<<7&4294967295|v>>>25),v=b+(T^y&(_^T))+I[1]+3905402710&4294967295,b=y+(v<<12&4294967295|v>>>20),v=T+(_^b&(y^_))+I[2]+606105819&4294967295,T=b+(v<<17&4294967295|v>>>15),v=_+(y^T&(b^y))+I[3]+3250441966&4294967295,_=T+(v<<22&4294967295|v>>>10),v=y+(b^_&(T^b))+I[4]+4118548399&4294967295,y=_+(v<<7&4294967295|v>>>25),v=b+(T^y&(_^T))+I[5]+1200080426&4294967295,b=y+(v<<12&4294967295|v>>>20),v=T+(_^b&(y^_))+I[6]+2821735955&4294967295,T=b+(v<<17&4294967295|v>>>15),v=_+(y^T&(b^y))+I[7]+4249261313&4294967295,_=T+(v<<22&4294967295|v>>>10),v=y+(b^_&(T^b))+I[8]+1770035416&4294967295,y=_+(v<<7&4294967295|v>>>25),v=b+(T^y&(_^T))+I[9]+2336552879&4294967295,b=y+(v<<12&4294967295|v>>>20),v=T+(_^b&(y^_))+I[10]+4294925233&4294967295,T=b+(v<<17&4294967295|v>>>15),v=_+(y^T&(b^y))+I[11]+2304563134&4294967295,_=T+(v<<22&4294967295|v>>>10),v=y+(b^_&(T^b))+I[12]+1804603682&4294967295,y=_+(v<<7&4294967295|v>>>25),v=b+(T^y&(_^T))+I[13]+4254626195&4294967295,b=y+(v<<12&4294967295|v>>>20),v=T+(_^b&(y^_))+I[14]+2792965006&4294967295,T=b+(v<<17&4294967295|v>>>15),v=_+(y^T&(b^y))+I[15]+1236535329&4294967295,_=T+(v<<22&4294967295|v>>>10),v=y+(T^b&(_^T))+I[1]+4129170786&4294967295,y=_+(v<<5&4294967295|v>>>27),v=b+(_^T&(y^_))+I[6]+3225465664&4294967295,b=y+(v<<9&4294967295|v>>>23),v=T+(y^_&(b^y))+I[11]+643717713&4294967295,T=b+(v<<14&4294967295|v>>>18),v=_+(b^y&(T^b))+I[0]+3921069994&4294967295,_=T+(v<<20&4294967295|v>>>12),v=y+(T^b&(_^T))+I[5]+3593408605&4294967295,y=_+(v<<5&4294967295|v>>>27),v=b+(_^T&(y^_))+I[10]+38016083&4294967295,b=y+(v<<9&4294967295|v>>>23),v=T+(y^_&(b^y))+I[15]+3634488961&4294967295,T=b+(v<<14&4294967295|v>>>18),v=_+(b^y&(T^b))+I[4]+3889429448&4294967295,_=T+(v<<20&4294967295|v>>>12),v=y+(T^b&(_^T))+I[9]+568446438&4294967295,y=_+(v<<5&4294967295|v>>>27),v=b+(_^T&(y^_))+I[14]+3275163606&4294967295,b=y+(v<<9&4294967295|v>>>23),v=T+(y^_&(b^y))+I[3]+4107603335&4294967295,T=b+(v<<14&4294967295|v>>>18),v=_+(b^y&(T^b))+I[8]+1163531501&4294967295,_=T+(v<<20&4294967295|v>>>12),v=y+(T^b&(_^T))+I[13]+2850285829&4294967295,y=_+(v<<5&4294967295|v>>>27),v=b+(_^T&(y^_))+I[2]+4243563512&4294967295,b=y+(v<<9&4294967295|v>>>23),v=T+(y^_&(b^y))+I[7]+1735328473&4294967295,T=b+(v<<14&4294967295|v>>>18),v=_+(b^y&(T^b))+I[12]+2368359562&4294967295,_=T+(v<<20&4294967295|v>>>12),v=y+(_^T^b)+I[5]+4294588738&4294967295,y=_+(v<<4&4294967295|v>>>28),v=b+(y^_^T)+I[8]+2272392833&4294967295,b=y+(v<<11&4294967295|v>>>21),v=T+(b^y^_)+I[11]+1839030562&4294967295,T=b+(v<<16&4294967295|v>>>16),v=_+(T^b^y)+I[14]+4259657740&4294967295,_=T+(v<<23&4294967295|v>>>9),v=y+(_^T^b)+I[1]+2763975236&4294967295,y=_+(v<<4&4294967295|v>>>28),v=b+(y^_^T)+I[4]+1272893353&4294967295,b=y+(v<<11&4294967295|v>>>21),v=T+(b^y^_)+I[7]+4139469664&4294967295,T=b+(v<<16&4294967295|v>>>16),v=_+(T^b^y)+I[10]+3200236656&4294967295,_=T+(v<<23&4294967295|v>>>9),v=y+(_^T^b)+I[13]+681279174&4294967295,y=_+(v<<4&4294967295|v>>>28),v=b+(y^_^T)+I[0]+3936430074&4294967295,b=y+(v<<11&4294967295|v>>>21),v=T+(b^y^_)+I[3]+3572445317&4294967295,T=b+(v<<16&4294967295|v>>>16),v=_+(T^b^y)+I[6]+76029189&4294967295,_=T+(v<<23&4294967295|v>>>9),v=y+(_^T^b)+I[9]+3654602809&4294967295,y=_+(v<<4&4294967295|v>>>28),v=b+(y^_^T)+I[12]+3873151461&4294967295,b=y+(v<<11&4294967295|v>>>21),v=T+(b^y^_)+I[15]+530742520&4294967295,T=b+(v<<16&4294967295|v>>>16),v=_+(T^b^y)+I[2]+3299628645&4294967295,_=T+(v<<23&4294967295|v>>>9),v=y+(T^(_|~b))+I[0]+4096336452&4294967295,y=_+(v<<6&4294967295|v>>>26),v=b+(_^(y|~T))+I[7]+1126891415&4294967295,b=y+(v<<10&4294967295|v>>>22),v=T+(y^(b|~_))+I[14]+2878612391&4294967295,T=b+(v<<15&4294967295|v>>>17),v=_+(b^(T|~y))+I[5]+4237533241&4294967295,_=T+(v<<21&4294967295|v>>>11),v=y+(T^(_|~b))+I[12]+1700485571&4294967295,y=_+(v<<6&4294967295|v>>>26),v=b+(_^(y|~T))+I[3]+2399980690&4294967295,b=y+(v<<10&4294967295|v>>>22),v=T+(y^(b|~_))+I[10]+4293915773&4294967295,T=b+(v<<15&4294967295|v>>>17),v=_+(b^(T|~y))+I[1]+2240044497&4294967295,_=T+(v<<21&4294967295|v>>>11),v=y+(T^(_|~b))+I[8]+1873313359&4294967295,y=_+(v<<6&4294967295|v>>>26),v=b+(_^(y|~T))+I[15]+4264355552&4294967295,b=y+(v<<10&4294967295|v>>>22),v=T+(y^(b|~_))+I[6]+2734768916&4294967295,T=b+(v<<15&4294967295|v>>>17),v=_+(b^(T|~y))+I[13]+1309151649&4294967295,_=T+(v<<21&4294967295|v>>>11),v=y+(T^(_|~b))+I[4]+4149444226&4294967295,y=_+(v<<6&4294967295|v>>>26),v=b+(_^(y|~T))+I[11]+3174756917&4294967295,b=y+(v<<10&4294967295|v>>>22),v=T+(y^(b|~_))+I[2]+718787259&4294967295,T=b+(v<<15&4294967295|v>>>17),v=_+(b^(T|~y))+I[9]+3951481745&4294967295,E.g[0]=E.g[0]+y&4294967295,E.g[1]=E.g[1]+(T+(v<<21&4294967295|v>>>11))&4294967295,E.g[2]=E.g[2]+T&4294967295,E.g[3]=E.g[3]+b&4294967295}n.prototype.u=function(E,y){y===void 0&&(y=E.length);for(var _=y-this.blockSize,I=this.B,T=this.h,b=0;b<y;){if(T==0)for(;b<=_;)i(this,E,b),b+=this.blockSize;if(typeof E=="string"){for(;b<y;)if(I[T++]=E.charCodeAt(b++),T==this.blockSize){i(this,I),T=0;break}}else for(;b<y;)if(I[T++]=E[b++],T==this.blockSize){i(this,I),T=0;break}}this.h=T,this.o+=y},n.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var y=1;y<E.length-8;++y)E[y]=0;var _=8*this.o;for(y=E.length-8;y<E.length;++y)E[y]=_&255,_/=256;for(this.u(E),E=Array(16),y=_=0;4>y;++y)for(var I=0;32>I;I+=8)E[_++]=this.g[y]>>>I&255;return E};function s(E,y){var _=u;return Object.prototype.hasOwnProperty.call(_,E)?_[E]:_[E]=y(E)}function o(E,y){this.h=y;for(var _=[],I=!0,T=E.length-1;0<=T;T--){var b=E[T]|0;I&&b==y||(_[T]=b,I=!1)}this.g=_}var u={};function c(E){return-128<=E&&128>E?s(E,function(y){return new o([y|0],0>y?-1:0)}):new o([E|0],0>E?-1:0)}function l(E){if(isNaN(E)||!isFinite(E))return p;if(0>E)return D(l(-E));for(var y=[],_=1,I=0;E>=_;I++)y[I]=E/_|0,_*=4294967296;return new o(y,0)}function f(E,y){if(E.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(E.charAt(0)=="-")return D(f(E.substring(1),y));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=l(Math.pow(y,8)),I=p,T=0;T<E.length;T+=8){var b=Math.min(8,E.length-T),v=parseInt(E.substring(T,T+b),y);8>b?(b=l(Math.pow(y,b)),I=I.j(b).add(l(v))):(I=I.j(_),I=I.add(l(v)))}return I}var p=c(0),m=c(1),w=c(16777216);r=o.prototype,r.m=function(){if(V(this))return-D(this).m();for(var E=0,y=1,_=0;_<this.g.length;_++){var I=this.i(_);E+=(0<=I?I:4294967296+I)*y,y*=4294967296}return E},r.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(x(this))return"0";if(V(this))return"-"+D(this).toString(E);for(var y=l(Math.pow(E,6)),_=this,I="";;){var T=$(_,y).g;_=N(_,T.j(y));var b=((0<_.g.length?_.g[0]:_.h)>>>0).toString(E);if(_=T,x(_))return b+I;for(;6>b.length;)b="0"+b;I=b+I}},r.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function x(E){if(E.h!=0)return!1;for(var y=0;y<E.g.length;y++)if(E.g[y]!=0)return!1;return!0}function V(E){return E.h==-1}r.l=function(E){return E=N(this,E),V(E)?-1:x(E)?0:1};function D(E){for(var y=E.g.length,_=[],I=0;I<y;I++)_[I]=~E.g[I];return new o(_,~E.h).add(m)}r.abs=function(){return V(this)?D(this):this},r.add=function(E){for(var y=Math.max(this.g.length,E.g.length),_=[],I=0,T=0;T<=y;T++){var b=I+(this.i(T)&65535)+(E.i(T)&65535),v=(b>>>16)+(this.i(T)>>>16)+(E.i(T)>>>16);I=v>>>16,b&=65535,v&=65535,_[T]=v<<16|b}return new o(_,_[_.length-1]&-2147483648?-1:0)};function N(E,y){return E.add(D(y))}r.j=function(E){if(x(this)||x(E))return p;if(V(this))return V(E)?D(this).j(D(E)):D(D(this).j(E));if(V(E))return D(this.j(D(E)));if(0>this.l(w)&&0>E.l(w))return l(this.m()*E.m());for(var y=this.g.length+E.g.length,_=[],I=0;I<2*y;I++)_[I]=0;for(I=0;I<this.g.length;I++)for(var T=0;T<E.g.length;T++){var b=this.i(I)>>>16,v=this.i(I)&65535,an=E.i(T)>>>16,ws=E.i(T)&65535;_[2*I+2*T]+=v*ws,z(_,2*I+2*T),_[2*I+2*T+1]+=b*ws,z(_,2*I+2*T+1),_[2*I+2*T+1]+=v*an,z(_,2*I+2*T+1),_[2*I+2*T+2]+=b*an,z(_,2*I+2*T+2)}for(I=0;I<y;I++)_[I]=_[2*I+1]<<16|_[2*I];for(I=y;I<2*y;I++)_[I]=0;return new o(_,0)};function z(E,y){for(;(E[y]&65535)!=E[y];)E[y+1]+=E[y]>>>16,E[y]&=65535,y++}function F(E,y){this.g=E,this.h=y}function $(E,y){if(x(y))throw Error("division by zero");if(x(E))return new F(p,p);if(V(E))return y=$(D(E),y),new F(D(y.g),D(y.h));if(V(y))return y=$(E,D(y)),new F(D(y.g),y.h);if(30<E.g.length){if(V(E)||V(y))throw Error("slowDivide_ only works with positive integers.");for(var _=m,I=y;0>=I.l(E);)_=X(_),I=X(I);var T=Y(_,1),b=Y(I,1);for(I=Y(I,2),_=Y(_,2);!x(I);){var v=b.add(I);0>=v.l(E)&&(T=T.add(_),b=v),I=Y(I,1),_=Y(_,1)}return y=N(E,T.j(y)),new F(T,y)}for(T=p;0<=E.l(y);){for(_=Math.max(1,Math.floor(E.m()/y.m())),I=Math.ceil(Math.log(_)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),b=l(_),v=b.j(y);V(v)||0<v.l(E);)_-=I,b=l(_),v=b.j(y);x(b)&&(b=m),T=T.add(b),E=N(E,v)}return new F(T,E)}r.A=function(E){return $(this,E).h},r.and=function(E){for(var y=Math.max(this.g.length,E.g.length),_=[],I=0;I<y;I++)_[I]=this.i(I)&E.i(I);return new o(_,this.h&E.h)},r.or=function(E){for(var y=Math.max(this.g.length,E.g.length),_=[],I=0;I<y;I++)_[I]=this.i(I)|E.i(I);return new o(_,this.h|E.h)},r.xor=function(E){for(var y=Math.max(this.g.length,E.g.length),_=[],I=0;I<y;I++)_[I]=this.i(I)^E.i(I);return new o(_,this.h^E.h)};function X(E){for(var y=E.g.length+1,_=[],I=0;I<y;I++)_[I]=E.i(I)<<1|E.i(I-1)>>>31;return new o(_,E.h)}function Y(E,y){var _=y>>5;y%=32;for(var I=E.g.length-_,T=[],b=0;b<I;b++)T[b]=0<y?E.i(b+_)>>>y|E.i(b+_+1)<<32-y:E.i(b+_);return new o(T,E.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Td=k_.Md5=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=f,$n=k_.Integer=o}).apply(typeof M_<"u"?M_:typeof self<"u"?self:typeof window<"u"?window:{});var Fu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},dn={};var Ad,bd,Mi,Cd,Do,Lu,Sd,Rd,Dd;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,h,d){return a==Array.prototype||a==Object.prototype||(a[h]=d.value),a};function t(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Fu=="object"&&Fu];for(var h=0;h<a.length;++h){var d=a[h];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var n=t(this);function i(a,h){if(h)e:{var d=n;a=a.split(".");for(var g=0;g<a.length-1;g++){var A=a[g];if(!(A in d))break e;d=d[A]}a=a[a.length-1],g=d[a],h=h(g),h!=g&&h!=null&&e(d,a,{configurable:!0,writable:!0,value:h})}}function s(a,h){a instanceof String&&(a+="");var d=0,g=!1,A={next:function(){if(!g&&d<a.length){var S=d++;return{value:h(S,a[S]),done:!1}}return g=!0,{done:!0,value:void 0}}};return A[Symbol.iterator]=function(){return A},A}i("Array.prototype.values",function(a){return a||function(){return s(this,function(h,d){return d})}});var o=o||{},u=this||self;function c(a){var h=typeof a;return h=h!="object"?h:a?Array.isArray(a)?"array":h:"null",h=="array"||h=="object"&&typeof a.length=="number"}function l(a){var h=typeof a;return h=="object"&&a!=null||h=="function"}function f(a,h,d){return a.call.apply(a.bind,arguments)}function p(a,h,d){if(!a)throw Error();if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var A=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(A,g),a.apply(h,A)}}return function(){return a.apply(h,arguments)}}function m(a,h,d){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,m.apply(null,arguments)}function w(a,h){var d=Array.prototype.slice.call(arguments,1);return function(){var g=d.slice();return g.push.apply(g,arguments),a.apply(this,g)}}function x(a,h){function d(){}d.prototype=h.prototype,a.aa=h.prototype,a.prototype=new d,a.prototype.constructor=a,a.Qb=function(g,A,S){for(var O=Array(arguments.length-2),ge=2;ge<arguments.length;ge++)O[ge-2]=arguments[ge];return h.prototype[A].apply(g,O)}}function V(a){let h=a.length;if(0<h){let d=Array(h);for(let g=0;g<h;g++)d[g]=a[g];return d}return[]}function D(a,h){for(let d=1;d<arguments.length;d++){let g=arguments[d];if(c(g)){let A=a.length||0,S=g.length||0;a.length=A+S;for(let O=0;O<S;O++)a[A+O]=g[O]}else a.push(g)}}class N{constructor(h,d){this.i=h,this.j=d,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function z(a){return/^[\s\xa0]*$/.test(a)}function F(){var a=u.navigator;return a&&(a=a.userAgent)?a:""}function $(a){return $[" "](a),a}$[" "]=function(){};var X=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function Y(a,h,d){for(let g in a)h.call(d,a[g],g,a)}function E(a,h){for(let d in a)h.call(void 0,a[d],d,a)}function y(a){let h={};for(let d in a)h[d]=a[d];return h}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(a,h){let d,g;for(let A=1;A<arguments.length;A++){g=arguments[A];for(d in g)a[d]=g[d];for(let S=0;S<_.length;S++)d=_[S],Object.prototype.hasOwnProperty.call(g,d)&&(a[d]=g[d])}}function T(a){var h=1;a=a.split(":");let d=[];for(;0<h&&a.length;)d.push(a.shift()),h--;return a.length&&d.push(a.join(":")),d}function b(a){u.setTimeout(()=>{throw a},0)}function v(){var a=ol;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}class an{constructor(){this.h=this.g=null}add(h,d){let g=ws.get();g.set(h,d),this.h?this.h.next=g:this.g=g,this.h=g}}var ws=new N(()=>new pT,a=>a.reset());class pT{constructor(){this.next=this.g=this.h=null}set(h,d){this.h=h,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let Es,Is=!1,ol=new an,Dg=()=>{let a=u.Promise.resolve(void 0);Es=()=>{a.then(gT)}};var gT=()=>{for(var a;a=v();){try{a.h.call(a.g)}catch(d){b(d)}var h=ws;h.j(a),100>h.h&&(h.h++,a.next=h.g,h.g=a)}Is=!1};function In(){this.s=this.s,this.C=this.C}In.prototype.s=!1,In.prototype.ma=function(){this.s||(this.s=!0,this.N())},In.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Xe(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}Xe.prototype.h=function(){this.defaultPrevented=!0};var mT=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{let d=()=>{};u.addEventListener("test",d,h),u.removeEventListener("test",d,h)}catch{}return a}();function Ts(a,h){if(Xe.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var d=this.type=a.type,g=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=h,h=a.relatedTarget){if(X){e:{try{$(h.nodeName);var A=!0;break e}catch{}A=!1}A||(h=null)}}else d=="mouseover"?h=a.fromElement:d=="mouseout"&&(h=a.toElement);this.relatedTarget=h,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:yT[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&Ts.aa.h.call(this)}}x(Ts,Xe);var yT={2:"touch",3:"pen",4:"mouse"};Ts.prototype.h=function(){Ts.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var As="closure_listenable_"+(1e6*Math.random()|0),vT=0;function _T(a,h,d,g,A){this.listener=a,this.proxy=null,this.src=h,this.type=d,this.capture=!!g,this.ha=A,this.key=++vT,this.da=this.fa=!1}function ya(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function va(a){this.src=a,this.g={},this.h=0}va.prototype.add=function(a,h,d,g,A){var S=a.toString();a=this.g[S],a||(a=this.g[S]=[],this.h++);var O=ul(a,h,g,A);return-1<O?(h=a[O],d||(h.fa=!1)):(h=new _T(h,this.src,S,!!g,A),h.fa=d,a.push(h)),h};function al(a,h){var d=h.type;if(d in a.g){var g=a.g[d],A=Array.prototype.indexOf.call(g,h,void 0),S;(S=0<=A)&&Array.prototype.splice.call(g,A,1),S&&(ya(h),a.g[d].length==0&&(delete a.g[d],a.h--))}}function ul(a,h,d,g){for(var A=0;A<a.length;++A){var S=a[A];if(!S.da&&S.listener==h&&S.capture==!!d&&S.ha==g)return A}return-1}var cl="closure_lm_"+(1e6*Math.random()|0),ll={};function Pg(a,h,d,g,A){if(g&&g.once)return Vg(a,h,d,g,A);if(Array.isArray(h)){for(var S=0;S<h.length;S++)Pg(a,h[S],d,g,A);return null}return d=pl(d),a&&a[As]?a.K(h,d,l(g)?!!g.capture:!!g,A):xg(a,h,d,!1,g,A)}function xg(a,h,d,g,A,S){if(!h)throw Error("Invalid event type");var O=l(A)?!!A.capture:!!A,ge=dl(a);if(ge||(a[cl]=ge=new va(a)),d=ge.add(h,d,g,O,S),d.proxy)return d;if(g=wT(),d.proxy=g,g.src=a,g.listener=d,a.addEventListener)mT||(A=O),A===void 0&&(A=!1),a.addEventListener(h.toString(),g,A);else if(a.attachEvent)a.attachEvent(kg(h.toString()),g);else if(a.addListener&&a.removeListener)a.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return d}function wT(){function a(d){return h.call(a.src,a.listener,d)}let h=ET;return a}function Vg(a,h,d,g,A){if(Array.isArray(h)){for(var S=0;S<h.length;S++)Vg(a,h[S],d,g,A);return null}return d=pl(d),a&&a[As]?a.L(h,d,l(g)?!!g.capture:!!g,A):xg(a,h,d,!0,g,A)}function Mg(a,h,d,g,A){if(Array.isArray(h))for(var S=0;S<h.length;S++)Mg(a,h[S],d,g,A);else g=l(g)?!!g.capture:!!g,d=pl(d),a&&a[As]?(a=a.i,h=String(h).toString(),h in a.g&&(S=a.g[h],d=ul(S,d,g,A),-1<d&&(ya(S[d]),Array.prototype.splice.call(S,d,1),S.length==0&&(delete a.g[h],a.h--)))):a&&(a=dl(a))&&(h=a.g[h.toString()],a=-1,h&&(a=ul(h,d,g,A)),(d=-1<a?h[a]:null)&&hl(d))}function hl(a){if(typeof a!="number"&&a&&!a.da){var h=a.src;if(h&&h[As])al(h.i,a);else{var d=a.type,g=a.proxy;h.removeEventListener?h.removeEventListener(d,g,a.capture):h.detachEvent?h.detachEvent(kg(d),g):h.addListener&&h.removeListener&&h.removeListener(g),(d=dl(h))?(al(d,a),d.h==0&&(d.src=null,h[cl]=null)):ya(a)}}}function kg(a){return a in ll?ll[a]:ll[a]="on"+a}function ET(a,h){if(a.da)a=!0;else{h=new Ts(h,this);var d=a.listener,g=a.ha||a.src;a.fa&&hl(a),a=d.call(g,h)}return a}function dl(a){return a=a[cl],a instanceof va?a:null}var fl="__closure_events_fn_"+(1e9*Math.random()>>>0);function pl(a){return typeof a=="function"?a:(a[fl]||(a[fl]=function(h){return a.handleEvent(h)}),a[fl])}function Je(){In.call(this),this.i=new va(this),this.M=this,this.F=null}x(Je,In),Je.prototype[As]=!0,Je.prototype.removeEventListener=function(a,h,d,g){Mg(this,a,h,d,g)};function rt(a,h){var d,g=a.F;if(g)for(d=[];g;g=g.F)d.push(g);if(a=a.M,g=h.type||h,typeof h=="string")h=new Xe(h,a);else if(h instanceof Xe)h.target=h.target||a;else{var A=h;h=new Xe(g,a),I(h,A)}if(A=!0,d)for(var S=d.length-1;0<=S;S--){var O=h.g=d[S];A=_a(O,g,!0,h)&&A}if(O=h.g=a,A=_a(O,g,!0,h)&&A,A=_a(O,g,!1,h)&&A,d)for(S=0;S<d.length;S++)O=h.g=d[S],A=_a(O,g,!1,h)&&A}Je.prototype.N=function(){if(Je.aa.N.call(this),this.i){var a=this.i,h;for(h in a.g){for(var d=a.g[h],g=0;g<d.length;g++)ya(d[g]);delete a.g[h],a.h--}}this.F=null},Je.prototype.K=function(a,h,d,g){return this.i.add(String(a),h,!1,d,g)},Je.prototype.L=function(a,h,d,g){return this.i.add(String(a),h,!0,d,g)};function _a(a,h,d,g){if(h=a.i.g[String(h)],!h)return!0;h=h.concat();for(var A=!0,S=0;S<h.length;++S){var O=h[S];if(O&&!O.da&&O.capture==d){var ge=O.listener,He=O.ha||O.src;O.fa&&al(a.i,O),A=ge.call(He,g)!==!1&&A}}return A&&!g.defaultPrevented}function Ng(a,h,d){if(typeof a=="function")d&&(a=m(a,d));else if(a&&typeof a.handleEvent=="function")a=m(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:u.setTimeout(a,h||0)}function Og(a){a.g=Ng(()=>{a.g=null,a.i&&(a.i=!1,Og(a))},a.l);let h=a.h;a.h=null,a.m.apply(null,h)}class IT extends In{constructor(h,d){super(),this.m=h,this.l=d,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Og(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function bs(a){In.call(this),this.h=a,this.g={}}x(bs,In);var Fg=[];function Lg(a){Y(a.g,function(h,d){this.g.hasOwnProperty(d)&&hl(h)},a),a.g={}}bs.prototype.N=function(){bs.aa.N.call(this),Lg(this)},bs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var gl=u.JSON.stringify,TT=u.JSON.parse,AT=class{stringify(a){return u.JSON.stringify(a,void 0)}parse(a){return u.JSON.parse(a,void 0)}};function ml(){}ml.prototype.h=null;function Ug(a){return a.h||(a.h=a.i())}function jg(){}var Cs={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function yl(){Xe.call(this,"d")}x(yl,Xe);function vl(){Xe.call(this,"c")}x(vl,Xe);var cr={},Bg=null;function wa(){return Bg=Bg||new Je}cr.La="serverreachability";function qg(a){Xe.call(this,cr.La,a)}x(qg,Xe);function Ss(a){let h=wa();rt(h,new qg(h))}cr.STAT_EVENT="statevent";function $g(a,h){Xe.call(this,cr.STAT_EVENT,a),this.stat=h}x($g,Xe);function it(a){let h=wa();rt(h,new $g(h,a))}cr.Ma="timingevent";function zg(a,h){Xe.call(this,cr.Ma,a),this.size=h}x(zg,Xe);function Rs(a,h){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){a()},h)}function Ds(){this.g=!0}Ds.prototype.xa=function(){this.g=!1};function bT(a,h,d,g,A,S){a.info(function(){if(a.g)if(S)for(var O="",ge=S.split("&"),He=0;He<ge.length;He++){var ue=ge[He].split("=");if(1<ue.length){var Ye=ue[0];ue=ue[1];var Ze=Ye.split("_");O=2<=Ze.length&&Ze[1]=="type"?O+(Ye+"="+ue+"&"):O+(Ye+"=redacted&")}}else O=null;else O=S;return"XMLHTTP REQ ("+g+") [attempt "+A+"]: "+h+`
`+d+`
`+O})}function CT(a,h,d,g,A,S,O){a.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+A+"]: "+h+`
`+d+`
`+S+" "+O})}function Zr(a,h,d,g){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+RT(a,d)+(g?" "+g:"")})}function ST(a,h){a.info(function(){return"TIMEOUT: "+h})}Ds.prototype.info=function(){};function RT(a,h){if(!a.g)return h;if(!h)return null;try{var d=JSON.parse(h);if(d){for(a=0;a<d.length;a++)if(Array.isArray(d[a])){var g=d[a];if(!(2>g.length)){var A=g[1];if(Array.isArray(A)&&!(1>A.length)){var S=A[0];if(S!="noop"&&S!="stop"&&S!="close")for(var O=1;O<A.length;O++)A[O]=""}}}}return gl(d)}catch{return h}}var Ea={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Gg={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},_l;function Ia(){}x(Ia,ml),Ia.prototype.g=function(){return new XMLHttpRequest},Ia.prototype.i=function(){return{}},_l=new Ia;function Tn(a,h,d,g){this.j=a,this.i=h,this.l=d,this.R=g||1,this.U=new bs(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Kg}function Kg(){this.i=null,this.g="",this.h=!1}var Wg={},wl={};function El(a,h,d){a.L=1,a.v=Ca(un(h)),a.m=d,a.P=!0,Hg(a,null)}function Hg(a,h){a.F=Date.now(),Ta(a),a.A=un(a.v);var d=a.A,g=a.R;Array.isArray(g)||(g=[String(g)]),um(d.i,"t",g),a.C=0,d=a.j.J,a.h=new Kg,a.g=Cm(a.j,d?h:null,!a.m),0<a.O&&(a.M=new IT(m(a.Y,a,a.g),a.O)),h=a.U,d=a.g,g=a.ca;var A="readystatechange";Array.isArray(A)||(A&&(Fg[0]=A.toString()),A=Fg);for(var S=0;S<A.length;S++){var O=Pg(d,A[S],g||h.handleEvent,!1,h.h||h);if(!O)break;h.g[O.key]=O}h=a.H?y(a.H):{},a.m?(a.u||(a.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,h)):(a.u="GET",a.g.ea(a.A,a.u,null,h)),Ss(),bT(a.i,a.u,a.A,a.l,a.R,a.m)}Tn.prototype.ca=function(a){a=a.target;let h=this.M;h&&cn(a)==3?h.j():this.Y(a)},Tn.prototype.Y=function(a){try{if(a==this.g)e:{let Ze=cn(this.g);var h=this.g.Ba();let ni=this.g.Z();if(!(3>Ze)&&(Ze!=3||this.g&&(this.h.h||this.g.oa()||gm(this.g)))){this.J||Ze!=4||h==7||(h==8||0>=ni?Ss(3):Ss(2)),Il(this);var d=this.g.Z();this.X=d;t:if(Qg(this)){var g=gm(this.g);a="";var A=g.length,S=cn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){lr(this),Ps(this);var O="";break t}this.h.i=new u.TextDecoder}for(h=0;h<A;h++)this.h.h=!0,a+=this.h.i.decode(g[h],{stream:!(S&&h==A-1)});g.length=0,this.h.g+=a,this.C=0,O=this.h.g}else O=this.g.oa();if(this.o=d==200,CT(this.i,this.u,this.A,this.l,this.R,Ze,d),this.o){if(this.T&&!this.K){t:{if(this.g){var ge,He=this.g;if((ge=He.g?He.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(ge)){var ue=ge;break t}}ue=null}if(d=ue)Zr(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Tl(this,d);else{this.o=!1,this.s=3,it(12),lr(this),Ps(this);break e}}if(this.P){d=!0;let Mt;for(;!this.J&&this.C<O.length;)if(Mt=DT(this,O),Mt==wl){Ze==4&&(this.s=4,it(14),d=!1),Zr(this.i,this.l,null,"[Incomplete Response]");break}else if(Mt==Wg){this.s=4,it(15),Zr(this.i,this.l,O,"[Invalid Chunk]"),d=!1;break}else Zr(this.i,this.l,Mt,null),Tl(this,Mt);if(Qg(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ze!=4||O.length!=0||this.h.h||(this.s=1,it(16),d=!1),this.o=this.o&&d,!d)Zr(this.i,this.l,O,"[Invalid Chunked Response]"),lr(this),Ps(this);else if(0<O.length&&!this.W){this.W=!0;var Ye=this.j;Ye.g==this&&Ye.ba&&!Ye.M&&(Ye.j.info("Great, no buffering proxy detected. Bytes received: "+O.length),Dl(Ye),Ye.M=!0,it(11))}}else Zr(this.i,this.l,O,null),Tl(this,O);Ze==4&&lr(this),this.o&&!this.J&&(Ze==4?Im(this.j,this):(this.o=!1,Ta(this)))}else KT(this.g),d==400&&0<O.indexOf("Unknown SID")?(this.s=3,it(12)):(this.s=0,it(13)),lr(this),Ps(this)}}}catch{}finally{}};function Qg(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function DT(a,h){var d=a.C,g=h.indexOf(`
`,d);return g==-1?wl:(d=Number(h.substring(d,g)),isNaN(d)?Wg:(g+=1,g+d>h.length?wl:(h=h.slice(g,g+d),a.C=g+d,h)))}Tn.prototype.cancel=function(){this.J=!0,lr(this)};function Ta(a){a.S=Date.now()+a.I,Xg(a,a.I)}function Xg(a,h){if(a.B!=null)throw Error("WatchDog timer not null");a.B=Rs(m(a.ba,a),h)}function Il(a){a.B&&(u.clearTimeout(a.B),a.B=null)}Tn.prototype.ba=function(){this.B=null;let a=Date.now();0<=a-this.S?(ST(this.i,this.A),this.L!=2&&(Ss(),it(17)),lr(this),this.s=2,Ps(this)):Xg(this,this.S-a)};function Ps(a){a.j.G==0||a.J||Im(a.j,a)}function lr(a){Il(a);var h=a.M;h&&typeof h.ma=="function"&&h.ma(),a.M=null,Lg(a.U),a.g&&(h=a.g,a.g=null,h.abort(),h.ma())}function Tl(a,h){try{var d=a.j;if(d.G!=0&&(d.g==a||Al(d.h,a))){if(!a.K&&Al(d.h,a)&&d.G==3){try{var g=d.Da.g.parse(h)}catch{g=null}if(Array.isArray(g)&&g.length==3){var A=g;if(A[0]==0){e:if(!d.u){if(d.g)if(d.g.F+3e3<a.F)xa(d),Da(d);else break e;Rl(d),it(18)}}else d.za=A[1],0<d.za-d.T&&37500>A[2]&&d.F&&d.v==0&&!d.C&&(d.C=Rs(m(d.Za,d),6e3));if(1>=Zg(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else dr(d,11)}else if((a.K||d.g==a)&&xa(d),!z(h))for(A=d.Da.g.parse(h),h=0;h<A.length;h++){let ue=A[h];if(d.T=ue[0],ue=ue[1],d.G==2)if(ue[0]=="c"){d.K=ue[1],d.ia=ue[2];let Ye=ue[3];Ye!=null&&(d.la=Ye,d.j.info("VER="+d.la));let Ze=ue[4];Ze!=null&&(d.Aa=Ze,d.j.info("SVER="+d.Aa));let ni=ue[5];ni!=null&&typeof ni=="number"&&0<ni&&(g=1.5*ni,d.L=g,d.j.info("backChannelRequestTimeoutMs_="+g)),g=d;let Mt=a.g;if(Mt){let Ma=Mt.g?Mt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ma){var S=g.h;S.g||Ma.indexOf("spdy")==-1&&Ma.indexOf("quic")==-1&&Ma.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(bl(S,S.h),S.h=null))}if(g.D){let Pl=Mt.g?Mt.g.getResponseHeader("X-HTTP-Session-Id"):null;Pl&&(g.ya=Pl,_e(g.I,g.D,Pl))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-a.F,d.j.info("Handshake RTT: "+d.R+"ms")),g=d;var O=a;if(g.qa=bm(g,g.J?g.ia:null,g.W),O.K){em(g.h,O);var ge=O,He=g.L;He&&(ge.I=He),ge.B&&(Il(ge),Ta(ge)),g.g=O}else wm(g);0<d.i.length&&Pa(d)}else ue[0]!="stop"&&ue[0]!="close"||dr(d,7);else d.G==3&&(ue[0]=="stop"||ue[0]=="close"?ue[0]=="stop"?dr(d,7):Sl(d):ue[0]!="noop"&&d.l&&d.l.ta(ue),d.v=0)}}Ss(4)}catch{}}var PT=class{constructor(a,h){this.g=a,this.map=h}};function Jg(a){this.l=a||10,u.PerformanceNavigationTiming?(a=u.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Yg(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Zg(a){return a.h?1:a.g?a.g.size:0}function Al(a,h){return a.h?a.h==h:a.g?a.g.has(h):!1}function bl(a,h){a.g?a.g.add(h):a.h=h}function em(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}Jg.prototype.cancel=function(){if(this.i=tm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let a of this.g.values())a.cancel();this.g.clear()}};function tm(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let h=a.i;for(let d of a.g.values())h=h.concat(d.D);return h}return V(a.i)}function xT(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(c(a)){for(var h=[],d=a.length,g=0;g<d;g++)h.push(a[g]);return h}h=[],d=0;for(g in a)h[d++]=a[g];return h}function VT(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(c(a)||typeof a=="string"){var h=[];a=a.length;for(var d=0;d<a;d++)h.push(d);return h}h=[],d=0;for(let g in a)h[d++]=g;return h}}}function nm(a,h){if(a.forEach&&typeof a.forEach=="function")a.forEach(h,void 0);else if(c(a)||typeof a=="string")Array.prototype.forEach.call(a,h,void 0);else for(var d=VT(a),g=xT(a),A=g.length,S=0;S<A;S++)h.call(void 0,g[S],d&&d[S],a)}var rm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function MT(a,h){if(a){a=a.split("&");for(var d=0;d<a.length;d++){var g=a[d].indexOf("="),A=null;if(0<=g){var S=a[d].substring(0,g);A=a[d].substring(g+1)}else S=a[d];h(S,A?decodeURIComponent(A.replace(/\+/g," ")):"")}}}function hr(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof hr){this.h=a.h,Aa(this,a.j),this.o=a.o,this.g=a.g,ba(this,a.s),this.l=a.l;var h=a.i,d=new Ms;d.i=h.i,h.g&&(d.g=new Map(h.g),d.h=h.h),im(this,d),this.m=a.m}else a&&(h=String(a).match(rm))?(this.h=!1,Aa(this,h[1]||"",!0),this.o=xs(h[2]||""),this.g=xs(h[3]||"",!0),ba(this,h[4]),this.l=xs(h[5]||"",!0),im(this,h[6]||"",!0),this.m=xs(h[7]||"")):(this.h=!1,this.i=new Ms(null,this.h))}hr.prototype.toString=function(){var a=[],h=this.j;h&&a.push(Vs(h,sm,!0),":");var d=this.g;return(d||h=="file")&&(a.push("//"),(h=this.o)&&a.push(Vs(h,sm,!0),"@"),a.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&a.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&a.push("/"),a.push(Vs(d,d.charAt(0)=="/"?OT:NT,!0))),(d=this.i.toString())&&a.push("?",d),(d=this.m)&&a.push("#",Vs(d,LT)),a.join("")};function un(a){return new hr(a)}function Aa(a,h,d){a.j=d?xs(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function ba(a,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);a.s=h}else a.s=null}function im(a,h,d){h instanceof Ms?(a.i=h,UT(a.i,a.h)):(d||(h=Vs(h,FT)),a.i=new Ms(h,a.h))}function _e(a,h,d){a.i.set(h,d)}function Ca(a){return _e(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function xs(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Vs(a,h,d){return typeof a=="string"?(a=encodeURI(a).replace(h,kT),d&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function kT(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var sm=/[#\/\?@]/g,NT=/[#\?:]/g,OT=/[#\?]/g,FT=/[#\?@]/g,LT=/#/g;function Ms(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function An(a){a.g||(a.g=new Map,a.h=0,a.i&&MT(a.i,function(h,d){a.add(decodeURIComponent(h.replace(/\+/g," ")),d)}))}r=Ms.prototype,r.add=function(a,h){An(this),this.i=null,a=ei(this,a);var d=this.g.get(a);return d||this.g.set(a,d=[]),d.push(h),this.h+=1,this};function om(a,h){An(a),h=ei(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function am(a,h){return An(a),h=ei(a,h),a.g.has(h)}r.forEach=function(a,h){An(this),this.g.forEach(function(d,g){d.forEach(function(A){a.call(h,A,g,this)},this)},this)},r.na=function(){An(this);let a=Array.from(this.g.values()),h=Array.from(this.g.keys()),d=[];for(let g=0;g<h.length;g++){let A=a[g];for(let S=0;S<A.length;S++)d.push(h[g])}return d},r.V=function(a){An(this);let h=[];if(typeof a=="string")am(this,a)&&(h=h.concat(this.g.get(ei(this,a))));else{a=Array.from(this.g.values());for(let d=0;d<a.length;d++)h=h.concat(a[d])}return h},r.set=function(a,h){return An(this),this.i=null,a=ei(this,a),am(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},r.get=function(a,h){return a?(a=this.V(a),0<a.length?String(a[0]):h):h};function um(a,h,d){om(a,h),0<d.length&&(a.i=null,a.g.set(ei(a,h),V(d)),a.h+=d.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";let a=[],h=Array.from(this.g.keys());for(var d=0;d<h.length;d++){var g=h[d];let S=encodeURIComponent(String(g)),O=this.V(g);for(g=0;g<O.length;g++){var A=S;O[g]!==""&&(A+="="+encodeURIComponent(String(O[g]))),a.push(A)}}return this.i=a.join("&")};function ei(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function UT(a,h){h&&!a.j&&(An(a),a.i=null,a.g.forEach(function(d,g){var A=g.toLowerCase();g!=A&&(om(this,g),um(this,A,d))},a)),a.j=h}function jT(a,h){let d=new Ds;if(u.Image){let g=new Image;g.onload=w(bn,d,"TestLoadImage: loaded",!0,h,g),g.onerror=w(bn,d,"TestLoadImage: error",!1,h,g),g.onabort=w(bn,d,"TestLoadImage: abort",!1,h,g),g.ontimeout=w(bn,d,"TestLoadImage: timeout",!1,h,g),u.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=a}else h(!1)}function BT(a,h){let d=new Ds,g=new AbortController,A=setTimeout(()=>{g.abort(),bn(d,"TestPingServer: timeout",!1,h)},1e4);fetch(a,{signal:g.signal}).then(S=>{clearTimeout(A),S.ok?bn(d,"TestPingServer: ok",!0,h):bn(d,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(A),bn(d,"TestPingServer: error",!1,h)})}function bn(a,h,d,g,A){try{A&&(A.onload=null,A.onerror=null,A.onabort=null,A.ontimeout=null),g(d)}catch{}}function qT(){this.g=new AT}function $T(a,h,d){let g=d||"";try{nm(a,function(A,S){let O=A;l(A)&&(O=gl(A)),h.push(g+S+"="+encodeURIComponent(O))})}catch(A){throw h.push(g+"type="+encodeURIComponent("_badmap")),A}}function ks(a){this.l=a.Ub||null,this.j=a.eb||!1}x(ks,ml),ks.prototype.g=function(){return new Sa(this.l,this.j)},ks.prototype.i=function(a){return function(){return a}}({});function Sa(a,h){Je.call(this),this.D=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(Sa,Je),r=Sa.prototype,r.open=function(a,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=h,this.readyState=1,Os(this)},r.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(h.body=a),(this.D||u).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ns(this)),this.readyState=0},r.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Os(this)),this.g&&(this.readyState=3,Os(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;cm(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function cm(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}r.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?Ns(this):Os(this),this.readyState==3&&cm(this)}},r.Ra=function(a){this.g&&(this.response=this.responseText=a,Ns(this))},r.Qa=function(a){this.g&&(this.response=a,Ns(this))},r.ga=function(){this.g&&Ns(this)};function Ns(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Os(a)}r.setRequestHeader=function(a,h){this.u.append(a,h)},r.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";let a=[],h=this.h.entries();for(var d=h.next();!d.done;)d=d.value,a.push(d[0]+": "+d[1]),d=h.next();return a.join(`\r
`)};function Os(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Sa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function lm(a){let h="";return Y(a,function(d,g){h+=g,h+=":",h+=d,h+=`\r
`}),h}function Cl(a,h,d){e:{for(g in d){var g=!1;break e}g=!0}g||(d=lm(d),typeof a=="string"?d!=null&&encodeURIComponent(String(d)):_e(a,h,d))}function Ce(a){Je.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(Ce,Je);var zT=/^https?$/i,GT=["POST","PUT"];r=Ce.prototype,r.Ha=function(a){this.J=a},r.ea=function(a,h,d,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():_l.g(),this.v=this.o?Ug(this.o):Ug(_l),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(S){hm(this,S);return}if(a=d||"",d=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var A in g)d.set(A,g[A]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(let S of g.keys())d.set(S,g.get(S));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(d.keys()).find(S=>S.toLowerCase()=="content-type"),A=u.FormData&&a instanceof u.FormData,!(0<=Array.prototype.indexOf.call(GT,h,void 0))||g||A||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[S,O]of d)this.g.setRequestHeader(S,O);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{pm(this),this.u=!0,this.g.send(a),this.u=!1}catch(S){hm(this,S)}};function hm(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.m=5,dm(a),Ra(a)}function dm(a){a.A||(a.A=!0,rt(a,"complete"),rt(a,"error"))}r.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,rt(this,"complete"),rt(this,"abort"),Ra(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ra(this,!0)),Ce.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?fm(this):this.bb())},r.bb=function(){fm(this)};function fm(a){if(a.h&&typeof o<"u"&&(!a.v[1]||cn(a)!=4||a.Z()!=2)){if(a.u&&cn(a)==4)Ng(a.Ea,0,a);else if(rt(a,"readystatechange"),cn(a)==4){a.h=!1;try{let O=a.Z();e:switch(O){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var d;if(!(d=h)){var g;if(g=O===0){var A=String(a.D).match(rm)[1]||null;!A&&u.self&&u.self.location&&(A=u.self.location.protocol.slice(0,-1)),g=!zT.test(A?A.toLowerCase():"")}d=g}if(d)rt(a,"complete"),rt(a,"success");else{a.m=6;try{var S=2<cn(a)?a.g.statusText:""}catch{S=""}a.l=S+" ["+a.Z()+"]",dm(a)}}finally{Ra(a)}}}}function Ra(a,h){if(a.g){pm(a);let d=a.g,g=a.v[0]?()=>{}:null;a.g=null,a.v=null,h||rt(a,"ready");try{d.onreadystatechange=g}catch{}}}function pm(a){a.I&&(u.clearTimeout(a.I),a.I=null)}r.isActive=function(){return!!this.g};function cn(a){return a.g?a.g.readyState:0}r.Z=function(){try{return 2<cn(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(a){if(this.g){var h=this.g.responseText;return a&&h.indexOf(a)==0&&(h=h.substring(a.length)),TT(h)}};function gm(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function KT(a){let h={};a=(a.g&&2<=cn(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<a.length;g++){if(z(a[g]))continue;var d=T(a[g]);let A=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();let S=h[A]||[];h[A]=S,S.push(d)}E(h,function(g){return g.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Fs(a,h,d){return d&&d.internalChannelParams&&d.internalChannelParams[a]||h}function mm(a){this.Aa=0,this.i=[],this.j=new Ds,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Fs("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Fs("baseRetryDelayMs",5e3,a),this.cb=Fs("retryDelaySeedMs",1e4,a),this.Wa=Fs("forwardChannelMaxRetries",2,a),this.wa=Fs("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Jg(a&&a.concurrentRequestLimit),this.Da=new qT,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=mm.prototype,r.la=8,r.G=1,r.connect=function(a,h,d,g){it(0),this.W=a,this.H=h||{},d&&g!==void 0&&(this.H.OSID=d,this.H.OAID=g),this.F=this.X,this.I=bm(this,null,this.W),Pa(this)};function Sl(a){if(ym(a),a.G==3){var h=a.U++,d=un(a.I);if(_e(d,"SID",a.K),_e(d,"RID",h),_e(d,"TYPE","terminate"),Ls(a,d),h=new Tn(a,a.j,h),h.L=2,h.v=Ca(un(d)),d=!1,u.navigator&&u.navigator.sendBeacon)try{d=u.navigator.sendBeacon(h.v.toString(),"")}catch{}!d&&u.Image&&(new Image().src=h.v,d=!0),d||(h.g=Cm(h.j,null),h.g.ea(h.v)),h.F=Date.now(),Ta(h)}Am(a)}function Da(a){a.g&&(Dl(a),a.g.cancel(),a.g=null)}function ym(a){Da(a),a.u&&(u.clearTimeout(a.u),a.u=null),xa(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&u.clearTimeout(a.s),a.s=null)}function Pa(a){if(!Yg(a.h)&&!a.s){a.s=!0;var h=a.Ga;Es||Dg(),Is||(Es(),Is=!0),ol.add(h,a),a.B=0}}function WT(a,h){return Zg(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=h.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=Rs(m(a.Ga,a,h),Tm(a,a.B)),a.B++,!0)}r.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;let A=new Tn(this,this.j,a),S=this.o;if(this.S&&(S?(S=y(S),I(S,this.S)):S=this.S),this.m!==null||this.O||(A.H=S,S=null),this.P)e:{for(var h=0,d=0;d<this.i.length;d++){t:{var g=this.i[d];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(h+=g,4096<h){h=d;break e}if(h===4096||d===this.i.length-1){h=d+1;break e}}h=1e3}else h=1e3;h=_m(this,A,h),d=un(this.I),_e(d,"RID",a),_e(d,"CVER",22),this.D&&_e(d,"X-HTTP-Session-Id",this.D),Ls(this,d),S&&(this.O?h="headers="+encodeURIComponent(String(lm(S)))+"&"+h:this.m&&Cl(d,this.m,S)),bl(this.h,A),this.Ua&&_e(d,"TYPE","init"),this.P?(_e(d,"$req",h),_e(d,"SID","null"),A.T=!0,El(A,d,null)):El(A,d,h),this.G=2}}else this.G==3&&(a?vm(this,a):this.i.length==0||Yg(this.h)||vm(this))};function vm(a,h){var d;h?d=h.l:d=a.U++;let g=un(a.I);_e(g,"SID",a.K),_e(g,"RID",d),_e(g,"AID",a.T),Ls(a,g),a.m&&a.o&&Cl(g,a.m,a.o),d=new Tn(a,a.j,d,a.B+1),a.m===null&&(d.H=a.o),h&&(a.i=h.D.concat(a.i)),h=_m(a,d,1e3),d.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),bl(a.h,d),El(d,g,h)}function Ls(a,h){a.H&&Y(a.H,function(d,g){_e(h,g,d)}),a.l&&nm({},function(d,g){_e(h,g,d)})}function _m(a,h,d){d=Math.min(a.i.length,d);var g=a.l?m(a.l.Na,a.l,a):null;e:{var A=a.i;let S=-1;for(;;){let O=["count="+d];S==-1?0<d?(S=A[0].g,O.push("ofs="+S)):S=0:O.push("ofs="+S);let ge=!0;for(let He=0;He<d;He++){let ue=A[He].g,Ye=A[He].map;if(ue-=S,0>ue)S=Math.max(0,A[He].g-100),ge=!1;else try{$T(Ye,O,"req"+ue+"_")}catch{g&&g(Ye)}}if(ge){g=O.join("&");break e}}}return a=a.i.splice(0,d),h.D=a,g}function wm(a){if(!a.g&&!a.u){a.Y=1;var h=a.Fa;Es||Dg(),Is||(Es(),Is=!0),ol.add(h,a),a.v=0}}function Rl(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=Rs(m(a.Fa,a),Tm(a,a.v)),a.v++,!0)}r.Fa=function(){if(this.u=null,Em(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=Rs(m(this.ab,this),a)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,it(10),Da(this),Em(this))};function Dl(a){a.A!=null&&(u.clearTimeout(a.A),a.A=null)}function Em(a){a.g=new Tn(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var h=un(a.qa);_e(h,"RID","rpc"),_e(h,"SID",a.K),_e(h,"AID",a.T),_e(h,"CI",a.F?"0":"1"),!a.F&&a.ja&&_e(h,"TO",a.ja),_e(h,"TYPE","xmlhttp"),Ls(a,h),a.m&&a.o&&Cl(h,a.m,a.o),a.L&&(a.g.I=a.L);var d=a.g;a=a.ia,d.L=1,d.v=Ca(un(h)),d.m=null,d.P=!0,Hg(d,a)}r.Za=function(){this.C!=null&&(this.C=null,Da(this),Rl(this),it(19))};function xa(a){a.C!=null&&(u.clearTimeout(a.C),a.C=null)}function Im(a,h){var d=null;if(a.g==h){xa(a),Dl(a),a.g=null;var g=2}else if(Al(a.h,h))d=h.D,em(a.h,h),g=1;else return;if(a.G!=0){if(h.o)if(g==1){d=h.m?h.m.length:0,h=Date.now()-h.F;var A=a.B;g=wa(),rt(g,new zg(g,d)),Pa(a)}else wm(a);else if(A=h.s,A==3||A==0&&0<h.X||!(g==1&&WT(a,h)||g==2&&Rl(a)))switch(d&&0<d.length&&(h=a.h,h.i=h.i.concat(d)),A){case 1:dr(a,5);break;case 4:dr(a,10);break;case 3:dr(a,6);break;default:dr(a,2)}}}function Tm(a,h){let d=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(d*=2),d*h}function dr(a,h){if(a.j.info("Error code "+h),h==2){var d=m(a.fb,a),g=a.Xa;let A=!g;g=new hr(g||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Aa(g,"https"),Ca(g),A?jT(g.toString(),d):BT(g.toString(),d)}else it(2);a.G=0,a.l&&a.l.sa(h),Am(a),ym(a)}r.fb=function(a){a?(this.j.info("Successfully pinged google.com"),it(2)):(this.j.info("Failed to ping google.com"),it(1))};function Am(a){if(a.G=0,a.ka=[],a.l){let h=tm(a.h);(h.length!=0||a.i.length!=0)&&(D(a.ka,h),D(a.ka,a.i),a.h.i.length=0,V(a.i),a.i.length=0),a.l.ra()}}function bm(a,h,d){var g=d instanceof hr?un(d):new hr(d);if(g.g!="")h&&(g.g=h+"."+g.g),ba(g,g.s);else{var A=u.location;g=A.protocol,h=h?h+"."+A.hostname:A.hostname,A=+A.port;var S=new hr(null);g&&Aa(S,g),h&&(S.g=h),A&&ba(S,A),d&&(S.l=d),g=S}return d=a.D,h=a.ya,d&&h&&_e(g,d,h),_e(g,"VER",a.la),Ls(a,g),g}function Cm(a,h,d){if(h&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=a.Ca&&!a.pa?new Ce(new ks({eb:d})):new Ce(a.pa),h.Ha(a.J),h}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function Sm(){}r=Sm.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function Va(){}Va.prototype.g=function(a,h){return new yt(a,h)};function yt(a,h){Je.call(this),this.g=new mm(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(a?a["X-WebChannel-Client-Profile"]=h.va:a={"X-WebChannel-Client-Profile":h.va}),this.g.S=a,(a=h&&h.Sb)&&!z(a)&&(this.g.m=a),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!z(h)&&(this.g.D=h,a=this.h,a!==null&&h in a&&(a=this.h,h in a&&delete a[h])),this.j=new ti(this)}x(yt,Je),yt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},yt.prototype.close=function(){Sl(this.g)},yt.prototype.o=function(a){var h=this.g;if(typeof a=="string"){var d={};d.__data__=a,a=d}else this.u&&(d={},d.__data__=gl(a),a=d);h.i.push(new PT(h.Ya++,a)),h.G==3&&Pa(h)},yt.prototype.N=function(){this.g.l=null,delete this.j,Sl(this.g),delete this.g,yt.aa.N.call(this)};function Rm(a){yl.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){e:{for(let d in h){a=d;break e}a=void 0}(this.i=a)&&(a=this.i,h=h!==null&&a in h?h[a]:void 0),this.data=h}else this.data=a}x(Rm,yl);function Dm(){vl.call(this),this.status=1}x(Dm,vl);function ti(a){this.g=a}x(ti,Sm),ti.prototype.ua=function(){rt(this.g,"a")},ti.prototype.ta=function(a){rt(this.g,new Rm(a))},ti.prototype.sa=function(a){rt(this.g,new Dm)},ti.prototype.ra=function(){rt(this.g,"b")},Va.prototype.createWebChannel=Va.prototype.g,yt.prototype.send=yt.prototype.o,yt.prototype.open=yt.prototype.m,yt.prototype.close=yt.prototype.close,Dd=dn.createWebChannelTransport=function(){return new Va},Rd=dn.getStatEventTarget=function(){return wa()},Sd=dn.Event=cr,Lu=dn.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ea.NO_ERROR=0,Ea.TIMEOUT=8,Ea.HTTP_ERROR=6,Do=dn.ErrorCode=Ea,Gg.COMPLETE="complete",Cd=dn.EventType=Gg,jg.EventType=Cs,Cs.OPEN="a",Cs.CLOSE="b",Cs.ERROR="c",Cs.MESSAGE="d",Je.prototype.listen=Je.prototype.K,Mi=dn.WebChannel=jg,bd=dn.FetchXmlHttpFactory=ks,Ce.prototype.listenOnce=Ce.prototype.L,Ce.prototype.getLastError=Ce.prototype.Ka,Ce.prototype.getLastErrorCode=Ce.prototype.Ba,Ce.prototype.getStatus=Ce.prototype.Z,Ce.prototype.getResponseJson=Ce.prototype.Oa,Ce.prototype.getResponseText=Ce.prototype.oa,Ce.prototype.send=Ce.prototype.ea,Ce.prototype.setWithCredentials=Ce.prototype.Ha,Ad=dn.XhrIo=Ce}).apply(typeof Fu<"u"?Fu:typeof self<"u"?self:typeof window<"u"?window:{});var N_="@firebase/firestore";var Oe=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Oe.UNAUTHENTICATED=new Oe(null),Oe.GOOGLE_CREDENTIALS=new Oe("google-credentials-uid"),Oe.FIRST_PARTY=new Oe("first-party-uid"),Oe.MOCK_USER=new Oe("mock-user");var ls="10.12.3";var Xn=new Wa("@firebase/firestore");function Li(){return Xn.logLevel}function Nw(r){Xn.setLogLevel(r)}function k(r,...e){if(Xn.logLevel<=Gt.DEBUG){let t=e.map(Mp);Xn.debug(`Firestore (${ls}): ${r}`,...t)}}function Pe(r,...e){if(Xn.logLevel<=Gt.ERROR){let t=e.map(Mp);Xn.error(`Firestore (${ls}): ${r}`,...t)}}function Pt(r,...e){if(Xn.logLevel<=Gt.WARN){let t=e.map(Mp);Xn.warn(`Firestore (${ls}): ${r}`,...t)}}function Mp(r){if(typeof r=="string")return r;try{return function(t){return JSON.stringify(t)}(r)}catch{return r}}function q(r="Unexpected state"){let e=`FIRESTORE (${ls}) INTERNAL ASSERTION FAILED: `+r;throw Pe(e),new Error(e)}function G(r,e){r||q()}function Ow(r,e){r||q()}function U(r,e){return r}var R={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},M=class extends Ey{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Fe=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Qu=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},kd=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Oe.UNAUTHENTICATED))}shutdown(){}},Nd=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Od=class{constructor(e){this.t=e,this.currentUser=Oe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i,i=c=>this.i!==n?(n=this.i,t(c)):Promise.resolve(),s=new Fe;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Fe,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>P(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},u=c=>{k("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>u(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?u(c):(k("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Fe)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(k("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(G(typeof n.accessToken=="string"),new Qu(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return G(e===null||typeof e=="string"),new Oe(e)}},Fd=class{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=Oe.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Ld=class{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new Fd(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Oe.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Ud=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},jd=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let n=s=>{s.error!=null&&k("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,k("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};let i=s=>{k("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):k("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(G(typeof t.token=="string"),this.R=t.token,new Ud(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function vS(r){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}var Xu=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";for(;n.length<20;){let i=vS(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+=e.charAt(i[s]%e.length))}return n}};function Z(r,e){return r<e?-1:r>e?1:0}function Wi(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}function Fw(r){return r+"\0"}var be=class r{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new M(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new M(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new M(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new M(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return r.fromMillis(Date.now())}static fromDate(e){return r.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new r(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Z(this.nanoseconds,e.nanoseconds):Z(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var W=class r{constructor(e){this.timestamp=e}static fromTimestamp(e){return new r(e)}static min(){return new r(new be(0,0))}static max(){return new r(new be(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Ju=class r{constructor(e,t,n){t===void 0?t=0:t>e.length&&q(),n===void 0?n=e.length-t:n>e.length-t&&q(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return r.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof r?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let n=Math.min(e.length,t.length);for(let i=0;i<n;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},oe=class r extends Ju{construct(e,t,n){return new r(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let n of e){if(n.indexOf("//")>=0)throw new M(R.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new r(t)}static emptyPath(){return new r([])}},_S=/^[_a-zA-Z][_a-zA-Z0-9]*$/,xe=class r extends Ju{construct(e,t,n){return new r(e,t,n)}static isValidIdentifier(e){return _S.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),r.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new r(["__name__"])}static fromServerFormat(e){let t=[],n="",i=0,s=()=>{if(n.length===0)throw new M(R.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""},o=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new M(R.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new M(R.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else u==="`"?(o=!o,i++):u!=="."||o?(n+=u,i++):(s(),i++)}if(s(),o)throw new M(R.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new r(t)}static emptyPath(){return new r([])}};var L=class r{constructor(e){this.path=e}static fromPath(e){return new r(oe.fromString(e))}static fromName(e){return new r(oe.fromString(e).popFirst(5))}static empty(){return new r(oe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&oe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return oe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new r(new oe(e.slice()))}};var Hi=class{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}};function Bd(r){return r.fields.find(e=>e.kind===2)}function Rr(r){return r.fields.filter(e=>e.kind!==2)}Hi.UNKNOWN_ID=-1;var zi=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var Bo=class r{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new r(0,xt.min())}};function Lw(r,e){let t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=W.fromTimestamp(n===1e9?new be(t+1,0):new be(t,n));return new xt(i,L.empty(),e)}function Uw(r){return new xt(r.readTime,r.key,-1)}var xt=class r{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new r(W.min(),L.empty(),-1)}static max(){return new r(W.max(),L.empty(),-1)}};function kp(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=L.comparator(r.documentKey,e.documentKey),t!==0?t:Z(r.largestBatchId,e.largestBatchId))}var jw="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Yu=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function or(r){return P(this,null,function*(){if(r.code!==R.FAILED_PRECONDITION||r.message!==jw)throw r;k("LocalStore","Unexpectedly lost primary lease")})}var C=class r{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&q(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new r((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof r?t:r.resolve(t)}catch(t){return r.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):r.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):r.reject(t)}static resolve(e){return new r((t,n)=>{t(e)})}static reject(e){return new r((t,n)=>{n(e)})}static waitFor(e){return new r((t,n)=>{let i=0,s=0,o=!1;e.forEach(u=>{++i,u.next(()=>{++s,o&&s===i&&t()},c=>n(c))}),o=!0,s===i&&t()})}static or(e){let t=r.resolve(!1);for(let n of e)t=t.next(i=>i?r.resolve(i):n());return t}static forEach(e,t){let n=[];return e.forEach((i,s)=>{n.push(t.call(this,i,s))}),this.waitFor(n)}static mapArray(e,t){return new r((n,i)=>{let s=e.length,o=new Array(s),u=0;for(let c=0;c<s;c++){let l=c;t(e[l]).next(f=>{o[l]=f,++u,u===s&&n(o)},f=>i(f))}})}static doWhile(e,t){return new r((n,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):n()};s()})}};var Zu=class r{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Fe,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new kr(e,t.error)):this.V.resolve()},this.transaction.onerror=n=>{let i=Np(n.target.error);this.V.reject(new kr(e,i))}}static open(e,t,n,i){try{return new r(t,e.transaction(i,n))}catch(s){throw new kr(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(k("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new $d(t)}},Jn=class r{constructor(e,t,n){this.name=e,this.version=t,this.p=n,r.S(Ks())===12.2&&Pe("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return k("SimpleDb","Removing database:",e),Dr(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Ka())return!1;if(r.C())return!0;let e=Ks(),t=r.S(e),n=0<t&&t<10,i=Bw(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}M(e){return P(this,null,function*(){return this.db||(k("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,n)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{n(new kr(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?n(new M(R.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?n(new M(R.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):n(new kr(e,o))},i.onupgradeneeded=s=>{k("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{k("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,n,i){return P(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let u=Zu.open(this.db,e,s?"readonly":"readwrite",n),c=i(u).next(l=>(u.g(),l)).catch(l=>(u.abort(l),C.reject(l))).toPromise();return c.catch(()=>{}),yield u.m,c}catch(u){let c=u,l=c.name!=="FirebaseError"&&o<3;if(k("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function Bw(r){let e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var qd=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Dr(this.B.delete())}},kr=class extends M{constructor(e,t){super(R.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function ar(r){return r.name==="IndexedDbTransactionError"}var $d=class{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(k("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(k("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Dr(n)}add(e){return k("SimpleDb","ADD",this.store.name,e,e),Dr(this.store.add(e))}get(e){return Dr(this.store.get(e)).next(t=>(t===void 0&&(t=null),k("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return k("SimpleDb","DELETE",this.store.name,e),Dr(this.store.delete(e))}count(){return k("SimpleDb","COUNT",this.store.name),Dr(this.store.count())}U(e,t){let n=this.options(e,t),i=n.index?this.store.index(n.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(n.range);return new C((o,u)=>{s.onerror=c=>{u(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(n),o=[];return this.W(s,(u,c)=>{o.push(c)}).next(()=>o)}}G(e,t){let n=this.store.getAll(e,t===null?void 0:t);return new C((i,s)=>{n.onerror=o=>{s(o.target.error)},n.onsuccess=o=>{i(o.target.result)}})}j(e,t){k("SimpleDb","DELETE ALL",this.store.name);let n=this.options(e,t);n.H=!1;let i=this.cursor(n);return this.W(i,(s,o,u)=>u.delete())}J(e,t){let n;t?n=e:(n={},t=e);let i=this.cursor(n);return this.W(i,t)}Y(e){let t=this.cursor({});return new C((n,i)=>{t.onerror=s=>{let o=Np(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(u=>{u?o.continue():n()}):n()}})}W(e,t){let n=[];return new C((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let u=o.target.result;if(!u)return void i();let c=new qd(u),l=t(u.primaryKey,u.value,c);if(l instanceof C){let f=l.catch(p=>(c.done(),C.reject(p)));n.push(f)}c.isDone?i():c.K===null?u.continue():u.continue(c.K)}}).next(()=>C.waitFor(n))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function Dr(r){return new C((e,t)=>{r.onsuccess=n=>{let i=n.target.result;e(i)},r.onerror=n=>{let i=Np(n.target.error);t(i)}})}var O_=!1;function Np(r){let e=Jn.S(Ks());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(r.message.indexOf(t)>=0){let n=new M("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return O_||(O_=!0,setTimeout(()=>{throw n},0)),n}}return r}var zd=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){k("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>P(this,null,function*(){this.task=null;try{k("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){ar(t)?k("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield or(t)}yield this.X(6e4)}))}},Gd=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return P(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let n=new Set,i=t,s=!0;return C.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!n.has(o))return k("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(u=>{i-=u,n.add(o)});s=!1})).next(()=>t-i)}ne(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,n).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(u=>(k("IndexBackfiller",`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(e,t,u))).next(()=>o.size)}))}re(e,t){let n=e;return t.changes.forEach((i,s)=>{let o=Uw(s);kp(o,n)>0&&(n=o)}),new xt(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}};var Et=(()=>{class r{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.ie(i),this.se=i=>n.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return r.oe=-1,r})();function ca(r){return r==null}function qo(r){return r===0&&1/r==-1/0}function qw(r){return typeof r=="number"&&Number.isInteger(r)&&!qo(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}function at(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=F_(e)),e=wS(r.get(t),e);return F_(e)}function wS(r,e){let t=e,n=r.length;for(let i=0;i<n;i++){let s=r.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function F_(r){return r+""}function Xt(r){let e=r.length;if(G(e>=2),e===2)return G(r.charAt(0)===""&&r.charAt(1)===""),oe.emptyPath();let t=e-2,n=[],i="";for(let s=0;s<e;){let o=r.indexOf("",s);switch((o<0||o>t)&&q(),r.charAt(o+1)){case"":let u=r.substring(s,o),c;i.length===0?c=u:(i+=u,c=i,i=""),n.push(c);break;case"":i+=r.substring(s,o),i+="\0";break;case"":i+=r.substring(s,o+1);break;default:q()}s=o+2}return new oe(n)}var L_=["userId","batchId"];function $u(r,e){return[r,at(e)]}function $w(r,e,t){return[r,at(e),t]}var ES={},IS=["prefixPath","collectionGroup","readTime","documentId"],TS=["prefixPath","collectionGroup","documentId"],AS=["collectionGroup","readTime","prefixPath","documentId"],bS=["canonicalId","targetId"],CS=["targetId","path"],SS=["path","targetId"],RS=["collectionId","parent"],DS=["indexId","uid"],PS=["uid","sequenceNumber"],xS=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],VS=["indexId","uid","orderedDocumentKey"],MS=["userId","collectionPath","documentId"],kS=["userId","collectionPath","largestBatchId"],NS=["userId","collectionGroup","largestBatchId"],zw=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],OS=[...zw,"documentOverlays"],Gw=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Kw=Gw,Ww=[...Kw,"indexConfiguration","indexState","indexEntries"],FS=Ww;var $o=class extends Yu{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function We(r,e){let t=U(r);return Jn.F(t._e,e)}function U_(r){let e=0;for(let t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function Kr(r,e){for(let t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function Hw(r){for(let e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}var Ie=class r{constructor(e,t){this.comparator=e,this.root=t||Yt.EMPTY}insert(e,t){return new r(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Yt.BLACK,null,null))}remove(e){return new r(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Yt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){let i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){let e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $i(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $i(this.root,e,this.comparator,!1)}getReverseIterator(){return new $i(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $i(this.root,e,this.comparator,!0)}},$i=class{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Yt=class r{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??r.RED,this.left=i??r.EMPTY,this.right=s??r.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new r(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this,s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return r.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return r.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,r.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,r.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw q();let e=this.left.check();if(e!==this.right.check())throw q();return e+(this.isRed()?0:1)}};Yt.EMPTY=null,Yt.RED=!0,Yt.BLACK=!1;Yt.EMPTY=new class{constructor(){this.size=0}get key(){throw q()}get value(){throw q()}get color(){throw q()}get left(){throw q()}get right(){throw q()}copy(e,t,n,i,s){return this}insert(e,t,n){return new Yt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var ye=class r{constructor(e){this.comparator=e,this.data=new Ie(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){let n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){let i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ec(this.data.getIterator())}getIteratorFrom(e){return new ec(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof r)||this.size!==e.size)return!1;let t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new r(this.comparator);return t.data=e,t}},ec=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function ki(r){return r.hasNext()?r.getNext():void 0}var It=class r{constructor(e){this.fields=e,e.sort(xe.comparator)}static empty(){return new r([])}unionWith(e){let t=new ye(xe.comparator);for(let n of this.fields)t=t.add(n);for(let n of e)t=t.add(n);return new r(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Wi(this.fields,e.fields,(t,n)=>t.isEqual(n))}};var tc=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function Qw(){return typeof atob<"u"}var Ke=class r{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new tc("Invalid base64 string: "+s):s}}(e);return new r(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new r(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Z(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ke.EMPTY_BYTE_STRING=new Ke("");var LS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function gn(r){if(G(!!r),typeof r=="string"){let e=0,t=LS.exec(r);if(G(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Re(r.seconds),nanos:Re(r.nanos)}}function Re(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function Yn(r){return typeof r=="string"?Ke.fromBase64String(r):Ke.fromUint8Array(r)}function Gc(r){var e,t;return((t=(((e=r?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Op(r){let e=r.mapValue.fields.__previous_value__;return Gc(e)?Op(e):e}function zo(r){let e=gn(r.mapValue.fields.__local_write_time__.timestampValue);return new be(e.seconds,e.nanos)}var Kd=class{constructor(e,t,n,i,s,o,u,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=c,this.useFetchStreams=l}},Zn=class r{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new r("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof r&&e.projectId===this.projectId&&e.database===this.database}};var Hn={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},zu={nullValue:"NULL_VALUE"};function Nr(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?Gc(r)?4:Xw(r)?9007199254740991:10:q()}function tn(r,e){if(r===e)return!0;let t=Nr(r);if(t!==Nr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return zo(r).isEqual(zo(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=gn(i.timestampValue),u=gn(s.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(i,s){return Yn(i.bytesValue).isEqual(Yn(s.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(i,s){return Re(i.geoPointValue.latitude)===Re(s.geoPointValue.latitude)&&Re(i.geoPointValue.longitude)===Re(s.geoPointValue.longitude)}(r,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Re(i.integerValue)===Re(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Re(i.doubleValue),u=Re(s.doubleValue);return o===u?qo(o)===qo(u):isNaN(o)&&isNaN(u)}return!1}(r,e);case 9:return Wi(r.arrayValue.values||[],e.arrayValue.values||[],tn);case 10:return function(i,s){let o=i.mapValue.fields||{},u=s.mapValue.fields||{};if(U_(o)!==U_(u))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(u[c]===void 0||!tn(o[c],u[c])))return!1;return!0}(r,e);default:return q()}}function Go(r,e){return(r.values||[]).find(t=>tn(t,e))!==void 0}function er(r,e){if(r===e)return 0;let t=Nr(r),n=Nr(e);if(t!==n)return Z(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Z(r.booleanValue,e.booleanValue);case 2:return function(s,o){let u=Re(s.integerValue||s.doubleValue),c=Re(o.integerValue||o.doubleValue);return u<c?-1:u>c?1:u===c?0:isNaN(u)?isNaN(c)?0:-1:1}(r,e);case 3:return j_(r.timestampValue,e.timestampValue);case 4:return j_(zo(r),zo(e));case 5:return Z(r.stringValue,e.stringValue);case 6:return function(s,o){let u=Yn(s),c=Yn(o);return u.compareTo(c)}(r.bytesValue,e.bytesValue);case 7:return function(s,o){let u=s.split("/"),c=o.split("/");for(let l=0;l<u.length&&l<c.length;l++){let f=Z(u[l],c[l]);if(f!==0)return f}return Z(u.length,c.length)}(r.referenceValue,e.referenceValue);case 8:return function(s,o){let u=Z(Re(s.latitude),Re(o.latitude));return u!==0?u:Z(Re(s.longitude),Re(o.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return function(s,o){let u=s.values||[],c=o.values||[];for(let l=0;l<u.length&&l<c.length;++l){let f=er(u[l],c[l]);if(f)return f}return Z(u.length,c.length)}(r.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Hn.mapValue&&o===Hn.mapValue)return 0;if(s===Hn.mapValue)return 1;if(o===Hn.mapValue)return-1;let u=s.fields||{},c=Object.keys(u),l=o.fields||{},f=Object.keys(l);c.sort(),f.sort();for(let p=0;p<c.length&&p<f.length;++p){let m=Z(c[p],f[p]);if(m!==0)return m;let w=er(u[c[p]],l[f[p]]);if(w!==0)return w}return Z(c.length,f.length)}(r.mapValue,e.mapValue);default:throw q()}}function j_(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return Z(r,e);let t=gn(r),n=gn(e),i=Z(t.seconds,n.seconds);return i!==0?i:Z(t.nanos,n.nanos)}function Qi(r){return Wd(r)}function Wd(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){let n=gn(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return Yn(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return L.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",i=!0;for(let s of t.values||[])i?i=!1:n+=",",n+=Wd(s);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){let n=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of n)s?s=!1:i+=",",i+=`${o}:${Wd(t.fields[o])}`;return i+"}"}(r.mapValue):q()}function Or(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function Hd(r){return!!r&&"integerValue"in r}function Ko(r){return!!r&&"arrayValue"in r}function B_(r){return!!r&&"nullValue"in r}function q_(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function Gu(r){return!!r&&"mapValue"in r}function Oo(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){let e={mapValue:{fields:{}}};return Kr(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Oo(n)),e}if(r.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Oo(r.arrayValue.values[t]);return e}return Object.assign({},r)}function Xw(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function US(r){return"nullValue"in r?zu:"booleanValue"in r?{booleanValue:!1}:"integerValue"in r||"doubleValue"in r?{doubleValue:NaN}:"timestampValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in r?{stringValue:""}:"bytesValue"in r?{bytesValue:""}:"referenceValue"in r?Or(Zn.empty(),L.empty()):"geoPointValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in r?{arrayValue:{}}:"mapValue"in r?{mapValue:{}}:q()}function jS(r){return"nullValue"in r?{booleanValue:!1}:"booleanValue"in r?{doubleValue:NaN}:"integerValue"in r||"doubleValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in r?{stringValue:""}:"stringValue"in r?{bytesValue:""}:"bytesValue"in r?Or(Zn.empty(),L.empty()):"referenceValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in r?{arrayValue:{}}:"arrayValue"in r?{mapValue:{}}:"mapValue"in r?Hn:q()}function $_(r,e){let t=er(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?-1:!r.inclusive&&e.inclusive?1:0}function z_(r,e){let t=er(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?1:!r.inclusive&&e.inclusive?-1:0}var nt=class r{constructor(e){this.value=e}static empty(){return new r({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Gu(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Oo(t)}setAll(e){let t=xe.emptyPath(),n={},i=[];e.forEach((o,u)=>{if(!t.isImmediateParentOf(u)){let c=this.getFieldsMap(t);this.applyChanges(c,n,i),n={},i=[],t=u.popLast()}o?n[u.lastSegment()]=Oo(o):i.push(u.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){let t=this.field(e.popLast());Gu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return tn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];Gu(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){Kr(t,(i,s)=>e[i]=s);for(let i of n)delete e[i]}clone(){return new r(Oo(this.value))}};function Jw(r){let e=[];return Kr(r.fields,(t,n)=>{let i=new xe([t]);if(Gu(n)){let s=Jw(n.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new It(e)}var Le=class r{constructor(e,t,n,i,s,o,u){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=o,this.documentState=u}static newInvalidDocument(e){return new r(e,0,W.min(),W.min(),W.min(),nt.empty(),0)}static newFoundDocument(e,t,n,i){return new r(e,1,t,W.min(),n,i,0)}static newNoDocument(e,t){return new r(e,2,t,W.min(),W.min(),nt.empty(),0)}static newUnknownDocument(e,t){return new r(e,3,t,W.min(),W.min(),nt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(W.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=nt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=nt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=W.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof r&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new r(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var nn=class{constructor(e,t){this.position=e,this.inclusive=t}};function G_(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){let s=e[i],o=r.position[i];if(s.field.isKeyField()?n=L.comparator(L.fromName(o.referenceValue),t.key):n=er(o,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function K_(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!tn(r.position[t],e.position[t]))return!1;return!0}var Fr=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function BS(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}var nc=class{},ie=class r extends nc{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new Jd(e,t,n):t==="array-contains"?new ef(e,n):t==="in"?new rc(e,n):t==="not-in"?new tf(e,n):t==="array-contains-any"?new nf(e,n):new r(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new Yd(e,n):new Zd(e,n)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(er(t,this.value)):t!==null&&Nr(this.value)===Nr(t)&&this.matchesComparison(er(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return q()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},fe=class r extends nc{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new r(e,t)}matches(e){return Xi(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function Xi(r){return r.op==="and"}function Qd(r){return r.op==="or"}function Fp(r){return Yw(r)&&Xi(r)}function Yw(r){for(let e of r.filters)if(e instanceof fe)return!1;return!0}function Xd(r){if(r instanceof ie)return r.field.canonicalString()+r.op.toString()+Qi(r.value);if(Fp(r))return r.filters.map(e=>Xd(e)).join(",");{let e=r.filters.map(t=>Xd(t)).join(",");return`${r.op}(${e})`}}function Zw(r,e){return r instanceof ie?function(n,i){return i instanceof ie&&n.op===i.op&&n.field.isEqual(i.field)&&tn(n.value,i.value)}(r,e):r instanceof fe?function(n,i){return i instanceof fe&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,o,u)=>s&&Zw(o,i.filters[u]),!0):!1}(r,e):void q()}function eE(r,e){let t=r.filters.concat(e);return fe.create(t,r.op)}function tE(r){return r instanceof ie?function(t){return`${t.field.canonicalString()} ${t.op} ${Qi(t.value)}`}(r):r instanceof fe?function(t){return t.op.toString()+" {"+t.getFilters().map(tE).join(" ,")+"}"}(r):"Filter"}var Jd=class extends ie{constructor(e,t,n){super(e,t,n),this.key=L.fromName(n.referenceValue)}matches(e){let t=L.comparator(e.key,this.key);return this.matchesComparison(t)}},Yd=class extends ie{constructor(e,t){super(e,"in",t),this.keys=nE("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Zd=class extends ie{constructor(e,t){super(e,"not-in",t),this.keys=nE("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function nE(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>L.fromName(n.referenceValue))}var ef=class extends ie{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Ko(t)&&Go(t.arrayValue,this.value)}},rc=class extends ie{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Go(this.value.arrayValue,t)}},tf=class extends ie{constructor(e,t){super(e,"not-in",t)}matches(e){if(Go(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Go(this.value.arrayValue,t)}},nf=class extends ie{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Ko(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>Go(this.value.arrayValue,n))}};var rf=class{constructor(e,t=null,n=[],i=[],s=null,o=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=o,this.endAt=u,this.ue=null}};function sf(r,e=null,t=[],n=[],i=null,s=null,o=null){return new rf(r,e,t,n,i,s,o)}function Lr(r){let e=U(r);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>Xd(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),ca(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Qi(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Qi(n)).join(",")),e.ue=t}return e.ue}function la(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!BS(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!Zw(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!K_(r.startAt,e.startAt)&&K_(r.endAt,e.endAt)}function ic(r){return L.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}function sc(r,e){return r.filters.filter(t=>t instanceof ie&&t.field.isEqual(e))}function W_(r,e,t){let n=zu,i=!0;for(let s of sc(r,e)){let o=zu,u=!0;switch(s.op){case"<":case"<=":o=US(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,u=!1;break;case"!=":case"not-in":o=zu}$_({value:n,inclusive:i},{value:o,inclusive:u})<0&&(n=o,i=u)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){let o=t.position[s];$_({value:n,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(n=o,i=t.inclusive);break}}return{value:n,inclusive:i}}function H_(r,e,t){let n=Hn,i=!0;for(let s of sc(r,e)){let o=Hn,u=!0;switch(s.op){case">=":case">":o=jS(s.value),u=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,u=!1;break;case"!=":case"not-in":o=Hn}z_({value:n,inclusive:i},{value:o,inclusive:u})>0&&(n=o,i=u)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){let o=t.position[s];z_({value:n,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(n=o,i=t.inclusive);break}}return{value:n,inclusive:i}}var Lt=class{constructor(e,t=null,n=[],i=[],s=null,o="F",u=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=o,this.startAt=u,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function rE(r,e,t,n,i,s,o,u){return new Lt(r,e,t,n,i,s,o,u)}function hs(r){return new Lt(r)}function Q_(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function Lp(r){return r.collectionGroup!==null}function Gi(r){let e=U(r);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new ye(xe.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(u=u.add(l.field))})}),u})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Fr(s,n))}),t.has(xe.keyField().canonicalString())||e.ce.push(new Fr(xe.keyField(),n))}return e.ce}function ut(r){let e=U(r);return e.le||(e.le=qS(e,Gi(r))),e.le}function qS(r,e){if(r.limitType==="F")return sf(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Fr(i.field,s)});let t=r.endAt?new nn(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new nn(r.startAt.position,r.startAt.inclusive):null;return sf(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function of(r,e){let t=r.filters.concat([e]);return new Lt(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function oc(r,e,t){return new Lt(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function ha(r,e){return la(ut(r),ut(e))&&r.limitType===e.limitType}function iE(r){return`${Lr(ut(r))}|lt:${r.limitType}`}function Ui(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>tE(i)).join(", ")}]`),ca(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>Qi(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>Qi(i)).join(",")),`Target(${n})`}(ut(r))}; limitType=${r.limitType})`}function da(r,e){return e.isFoundDocument()&&function(n,i){let s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):L.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(r,e)&&function(n,i){for(let s of Gi(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(r,e)&&function(n,i){for(let s of n.filters)if(!s.matches(i))return!1;return!0}(r,e)&&function(n,i){return!(n.startAt&&!function(o,u,c){let l=G_(o,u,c);return o.inclusive?l<=0:l<0}(n.startAt,Gi(n),i)||n.endAt&&!function(o,u,c){let l=G_(o,u,c);return o.inclusive?l>=0:l>0}(n.endAt,Gi(n),i))}(r,e)}function sE(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function oE(r){return(e,t)=>{let n=!1;for(let i of Gi(r)){let s=$S(i,e,t);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function $S(r,e,t){let n=r.field.isKeyField()?L.comparator(e.key,t.key):function(s,o,u){let c=o.data.field(s),l=u.data.field(s);return c!==null&&l!==null?er(c,l):q()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return q()}}var rn=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(let[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Kr(this.inner,(t,n)=>{for(let[i,s]of n)e(i,s)})}isEmpty(){return Hw(this.inner)}size(){return this.innerSize}};var zS=new Ie(L.comparator);function mt(){return zS}var aE=new Ie(L.comparator);function ko(...r){let e=aE;for(let t of r)e=e.insert(t.key,t);return e}function uE(r){let e=aE;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Jt(){return Fo()}function cE(){return Fo()}function Fo(){return new rn(r=>r.toString(),(r,e)=>r.isEqual(e))}var GS=new Ie(L.comparator),KS=new ye(L.comparator);function te(...r){let e=KS;for(let t of r)e=e.add(t);return e}var WS=new ye(Z);function Up(){return WS}function lE(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qo(e)?"-0":e}}function hE(r){return{integerValue:""+r}}function dE(r,e){return qw(e)?hE(e):lE(r,e)}var Ji=class{constructor(){this._=void 0}};function HS(r,e,t){return r instanceof tr?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Gc(s)&&(s=Op(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):r instanceof mn?pE(r,e):r instanceof yn?gE(r,e):function(i,s){let o=fE(i,s),u=X_(o)+X_(i.Pe);return Hd(o)&&Hd(i.Pe)?hE(u):lE(i.serializer,u)}(r,e)}function QS(r,e,t){return r instanceof mn?pE(r,e):r instanceof yn?gE(r,e):t}function fE(r,e){return r instanceof nr?function(n){return Hd(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}var tr=class extends Ji{},mn=class extends Ji{constructor(e){super(),this.elements=e}};function pE(r,e){let t=mE(e);for(let n of r.elements)t.some(i=>tn(i,n))||t.push(n);return{arrayValue:{values:t}}}var yn=class extends Ji{constructor(e){super(),this.elements=e}};function gE(r,e){let t=mE(e);for(let n of r.elements)t=t.filter(i=>!tn(i,n));return{arrayValue:{values:t}}}var nr=class extends Ji{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function X_(r){return Re(r.integerValue||r.doubleValue)}function mE(r){return Ko(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}var Ur=class{constructor(e,t){this.field=e,this.transform=t}};function XS(r,e){return r.field.isEqual(e.field)&&function(n,i){return n instanceof mn&&i instanceof mn||n instanceof yn&&i instanceof yn?Wi(n.elements,i.elements,tn):n instanceof nr&&i instanceof nr?tn(n.Pe,i.Pe):n instanceof tr&&i instanceof tr}(r.transform,e.transform)}var af=class{constructor(e,t){this.version=e,this.transformResults=t}},De=class r{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new r}static exists(e){return new r(void 0,e)}static updateTime(e){return new r(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Ku(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}var Yi=class{};function yE(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new ir(r.key,De.none()):new rr(r.key,r.data,De.none());{let t=r.data,n=nt.empty(),i=new ye(xe.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?n.delete(s):n.set(s,o),i=i.add(s)}return new Ut(r.key,n,new It(i.toArray()),De.none())}}function JS(r,e,t){r instanceof rr?function(i,s,o){let u=i.value.clone(),c=Y_(i.fieldTransforms,s,o.transformResults);u.setAll(c),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(r,e,t):r instanceof Ut?function(i,s,o){if(!Ku(i.precondition,s))return void s.convertToUnknownDocument(o.version);let u=Y_(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(vE(i)),c.setAll(u),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(r,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Lo(r,e,t,n){return r instanceof rr?function(s,o,u,c){if(!Ku(s.precondition,o))return u;let l=s.value.clone(),f=Z_(s.fieldTransforms,c,o);return l.setAll(f),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(r,e,t,n):r instanceof Ut?function(s,o,u,c){if(!Ku(s.precondition,o))return u;let l=Z_(s.fieldTransforms,c,o),f=o.data;return f.setAll(vE(s)),f.setAll(l),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(r,e,t,n):function(s,o,u){return Ku(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u}(r,e,t)}function YS(r,e){let t=null;for(let n of r.fieldTransforms){let i=e.data.field(n.field),s=fE(n.transform,i||null);s!=null&&(t===null&&(t=nt.empty()),t.set(n.field,s))}return t||null}function J_(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Wi(n,i,(s,o)=>XS(s,o))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}var rr=class extends Yi{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Ut=class extends Yi{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function vE(r){let e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let n=r.data.field(t);e.set(t,n)}}),e}function Y_(r,e,t){let n=new Map;G(r.length===t.length);for(let i=0;i<t.length;i++){let s=r[i],o=s.transform,u=e.data.field(s.field);n.set(s.field,QS(o,u,t[i]))}return n}function Z_(r,e,t){let n=new Map;for(let i of r){let s=i.transform,o=t.data.field(i.field);n.set(i.field,HS(s,o,e))}return n}var ir=class extends Yi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Wo=class extends Yi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Ho=class{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){let n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&JS(s,e,n[i])}}applyToLocalView(e,t){for(let n of this.baseMutations)n.key.isEqual(e.key)&&(t=Lo(n,e,t,this.localWriteTime));for(let n of this.mutations)n.key.isEqual(e.key)&&(t=Lo(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let n=cE();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,u=this.applyToLocalView(o,s.mutatedFields);u=t.has(i.key)?null:u;let c=yE(o,u);c!==null&&n.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(W.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),te())}isEqual(e){return this.batchId===e.batchId&&Wi(this.mutations,e.mutations,(t,n)=>J_(t,n))&&Wi(this.baseMutations,e.baseMutations,(t,n)=>J_(t,n))}},uf=class r{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){G(e.mutations.length===n.length);let i=function(){return GS}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,n[o].version);return new r(e,t,n,i)}};var Qo=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var cf=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ke,se;function _E(r){switch(r){default:return q();case R.CANCELLED:case R.UNKNOWN:case R.DEADLINE_EXCEEDED:case R.RESOURCE_EXHAUSTED:case R.INTERNAL:case R.UNAVAILABLE:case R.UNAUTHENTICATED:return!1;case R.INVALID_ARGUMENT:case R.NOT_FOUND:case R.ALREADY_EXISTS:case R.PERMISSION_DENIED:case R.FAILED_PRECONDITION:case R.ABORTED:case R.OUT_OF_RANGE:case R.UNIMPLEMENTED:case R.DATA_LOSS:return!0}}function wE(r){if(r===void 0)return Pe("GRPC error has no .code"),R.UNKNOWN;switch(r){case ke.OK:return R.OK;case ke.CANCELLED:return R.CANCELLED;case ke.UNKNOWN:return R.UNKNOWN;case ke.DEADLINE_EXCEEDED:return R.DEADLINE_EXCEEDED;case ke.RESOURCE_EXHAUSTED:return R.RESOURCE_EXHAUSTED;case ke.INTERNAL:return R.INTERNAL;case ke.UNAVAILABLE:return R.UNAVAILABLE;case ke.UNAUTHENTICATED:return R.UNAUTHENTICATED;case ke.INVALID_ARGUMENT:return R.INVALID_ARGUMENT;case ke.NOT_FOUND:return R.NOT_FOUND;case ke.ALREADY_EXISTS:return R.ALREADY_EXISTS;case ke.PERMISSION_DENIED:return R.PERMISSION_DENIED;case ke.FAILED_PRECONDITION:return R.FAILED_PRECONDITION;case ke.ABORTED:return R.ABORTED;case ke.OUT_OF_RANGE:return R.OUT_OF_RANGE;case ke.UNIMPLEMENTED:return R.UNIMPLEMENTED;case ke.DATA_LOSS:return R.DATA_LOSS;default:return q()}}(se=ke||(ke={}))[se.OK=0]="OK",se[se.CANCELLED=1]="CANCELLED",se[se.UNKNOWN=2]="UNKNOWN",se[se.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",se[se.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",se[se.NOT_FOUND=5]="NOT_FOUND",se[se.ALREADY_EXISTS=6]="ALREADY_EXISTS",se[se.PERMISSION_DENIED=7]="PERMISSION_DENIED",se[se.UNAUTHENTICATED=16]="UNAUTHENTICATED",se[se.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",se[se.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",se[se.ABORTED=10]="ABORTED",se[se.OUT_OF_RANGE=11]="OUT_OF_RANGE",se[se.UNIMPLEMENTED=12]="UNIMPLEMENTED",se[se.INTERNAL=13]="INTERNAL",se[se.UNAVAILABLE=14]="UNAVAILABLE",se[se.DATA_LOSS=15]="DATA_LOSS";var ew=null;function EE(){return new TextEncoder}var ZS=new $n([4294967295,4294967295],0);function tw(r){let e=EE().encode(r),t=new Td;return t.update(e),new Uint8Array(t.digest())}function nw(r){let e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new $n([t,n],0),new $n([i,s],0)]}var lf=class r{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Mr(`Invalid padding: ${t}`);if(n<0)throw new Mr(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Mr(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Mr(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=$n.fromNumber(this.Ie)}Ee(e,t,n){let i=e.add(t.multiply($n.fromNumber(n)));return i.compare(ZS)===1&&(i=new $n([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=tw(e),[n,i]=nw(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(n,i,s);if(!this.de(o))return!1}return!0}static create(e,t,n){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new r(s,i,t);return n.forEach(u=>o.insert(u)),o}insert(e){if(this.Ie===0)return;let t=tw(e),[n,i]=nw(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(n,i,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}},Mr=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Xo=class r{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){let i=new Map;return i.set(e,Jo.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new r(W.min(),i,new Ie(Z),mt(),te())}},Jo=class r{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new r(n,t,te(),te(),te())}};var Ki=class{constructor(e,t,n,i){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=i}},ac=class{constructor(e,t){this.targetId=e,this.me=t}},uc=class{constructor(e,t,n=Ke.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}},cc=class{constructor(){this.fe=0,this.ge=iw(),this.pe=Ke.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=te(),t=te(),n=te();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:q()}}),new Jo(this.pe,this.ye,e,t,n)}ve(){this.we=!1,this.ge=iw()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,G(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},hf=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=mt(),this.qe=rw(),this.Qe=new Ie(Z)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.ve(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:q()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((n,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,n=e.me.count,i=this.Je(t);if(i){let s=i.target;if(ic(s))if(n===0){let o=new L(s.path);this.Ue(t,o,Le.newNoDocument(o,W.min()))}else G(n===1);else{let o=this.Ye(t);if(o!==n){let u=this.Ze(e),c=u?this.Xe(u,e,o):1;if(c!==0){this.je(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}ew?.et(function(f,p,m,w,x){var V,D,N,z,F,$;let X={localCacheCount:f,existenceFilterCount:p.count,databaseId:m.database,projectId:m.projectId},Y=p.unchangedNames;return Y&&(X.bloomFilter={applied:x===0,hashCount:(V=Y?.hashCount)!==null&&V!==void 0?V:0,bitmapLength:(z=(N=(D=Y?.bits)===null||D===void 0?void 0:D.bitmap)===null||N===void 0?void 0:N.length)!==null&&z!==void 0?z:0,padding:($=(F=Y?.bits)===null||F===void 0?void 0:F.padding)!==null&&$!==void 0?$:0,mightContain:E=>{var y;return(y=w?.mightContain(E))!==null&&y!==void 0&&y}}),X}(o,e.me,this.Le.tt(),u,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=t,o,u;try{o=Yn(n).toUint8Array()}catch(c){if(c instanceof tc)return Pt("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{u=new lf(o,i,s)}catch(c){return Pt(c instanceof Mr?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return u.Ie===0?null:u}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){let n=this.Le.getRemoteKeysForTarget(t),i=0;return n.forEach(s=>{let o=this.Le.tt(),u=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let u=this.Je(o);if(u){if(s.current&&ic(u.target)){let c=new L(u.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Le.newNoDocument(c,e))}s.be&&(t.set(o,s.Ce()),s.ve())}});let n=te();this.qe.forEach((s,o)=>{let u=!0;o.forEachWhile(c=>{let l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(n=n.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new Xo(e,t,this.Qe,this.ke,n);return this.ke=mt(),this.qe=rw(),this.Qe=new Ie(Z),i}$e(e,t){if(!this.ze(e))return;let n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new cc,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new ye(Z),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||k("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new cc),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function rw(){return new Ie(L.comparator)}function iw(){return new Ie(L.comparator)}var eR={asc:"ASCENDING",desc:"DESCENDING"},tR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},nR={and:"AND",or:"OR"},df=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function ff(r,e){return r.useProto3Json||ca(e)?e:{value:e}}function Zi(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function IE(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function rR(r,e){return Zi(r,e.toTimestamp())}function Ve(r){return G(!!r),W.fromTimestamp(function(t){let n=gn(t);return new be(n.seconds,n.nanos)}(r))}function jp(r,e){return pf(r,e).canonicalString()}function pf(r,e){let t=function(i){return new oe(["projects",i.projectId,"databases",i.database])}(r).child("documents");return e===void 0?t:t.child(e)}function TE(r){let e=oe.fromString(r);return G(ME(e)),e}function Yo(r,e){return jp(r.databaseId,e.path)}function Zt(r,e){let t=TE(e);if(t.get(1)!==r.databaseId.projectId)throw new M(R.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new M(R.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new L(CE(t))}function AE(r,e){return jp(r.databaseId,e)}function bE(r){let e=TE(r);return e.length===4?oe.emptyPath():CE(e)}function gf(r){return new oe(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function CE(r){return G(r.length>4&&r.get(4)==="documents"),r.popFirst(5)}function sw(r,e,t){return{name:Yo(r,e),fields:t.value.mapValue.fields}}function SE(r,e,t){let n=Zt(r,e.name),i=Ve(e.updateTime),s=e.createTime?Ve(e.createTime):W.min(),o=new nt({mapValue:{fields:e.fields}}),u=Le.newFoundDocument(n,i,s,o);return t&&u.setHasCommittedMutations(),t?u.setHasCommittedMutations():u}function iR(r,e){return"found"in e?function(n,i){G(!!i.found),i.found.name,i.found.updateTime;let s=Zt(n,i.found.name),o=Ve(i.found.updateTime),u=i.found.createTime?Ve(i.found.createTime):W.min(),c=new nt({mapValue:{fields:i.found.fields}});return Le.newFoundDocument(s,o,u,c)}(r,e):"missing"in e?function(n,i){G(!!i.missing),G(!!i.readTime);let s=Zt(n,i.missing),o=Ve(i.readTime);return Le.newNoDocument(s,o)}(r,e):q()}function sR(r,e){let t;if("targetChange"in e){e.targetChange;let n=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:q()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,f){return l.useProto3Json?(G(f===void 0||typeof f=="string"),Ke.fromBase64String(f||"")):(G(f===void 0||f instanceof Buffer||f instanceof Uint8Array),Ke.fromUint8Array(f||new Uint8Array))}(r,e.targetChange.resumeToken),o=e.targetChange.cause,u=o&&function(l){let f=l.code===void 0?R.UNKNOWN:wE(l.code);return new M(f,l.message||"")}(o);t=new uc(n,i,s,u||null)}else if("documentChange"in e){e.documentChange;let n=e.documentChange;n.document,n.document.name,n.document.updateTime;let i=Zt(r,n.document.name),s=Ve(n.document.updateTime),o=n.document.createTime?Ve(n.document.createTime):W.min(),u=new nt({mapValue:{fields:n.document.fields}}),c=Le.newFoundDocument(i,s,o,u),l=n.targetIds||[],f=n.removedTargetIds||[];t=new Ki(l,f,c.key,c)}else if("documentDelete"in e){e.documentDelete;let n=e.documentDelete;n.document;let i=Zt(r,n.document),s=n.readTime?Ve(n.readTime):W.min(),o=Le.newNoDocument(i,s),u=n.removedTargetIds||[];t=new Ki([],u,o.key,o)}else if("documentRemove"in e){e.documentRemove;let n=e.documentRemove;n.document;let i=Zt(r,n.document),s=n.removedTargetIds||[];t=new Ki([],s,i,null)}else{if(!("filter"in e))return q();{e.filter;let n=e.filter;n.targetId;let{count:i=0,unchangedNames:s}=n,o=new cf(i,s),u=n.targetId;t=new ac(u,o)}}return t}function Zo(r,e){let t;if(e instanceof rr)t={update:sw(r,e.key,e.value)};else if(e instanceof ir)t={delete:Yo(r,e.key)};else if(e instanceof Ut)t={update:sw(r,e.key,e.data),updateMask:hR(e.fieldMask)};else{if(!(e instanceof Wo))return q();t={verify:Yo(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(s,o){let u=o.transform;if(u instanceof tr)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof mn)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof yn)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof nr)return{fieldPath:o.field.canonicalString(),increment:u.Pe};throw q()}(0,n))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:rR(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:q()}(r,e.precondition)),t}function mf(r,e){let t=e.currentDocument?function(s){return s.updateTime!==void 0?De.updateTime(Ve(s.updateTime)):s.exists!==void 0?De.exists(s.exists):De.none()}(e.currentDocument):De.none(),n=e.updateTransforms?e.updateTransforms.map(i=>function(o,u){let c=null;if("setToServerValue"in u)G(u.setToServerValue==="REQUEST_TIME"),c=new tr;else if("appendMissingElements"in u){let f=u.appendMissingElements.values||[];c=new mn(f)}else if("removeAllFromArray"in u){let f=u.removeAllFromArray.values||[];c=new yn(f)}else"increment"in u?c=new nr(o,u.increment):q();let l=xe.fromServerFormat(u.fieldPath);return new Ur(l,c)}(r,i)):[];if(e.update){e.update.name;let i=Zt(r,e.update.name),s=new nt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let l=c.fieldPaths||[];return new It(l.map(f=>xe.fromServerFormat(f)))}(e.updateMask);return new Ut(i,s,o,t,n)}return new rr(i,s,t,n)}if(e.delete){let i=Zt(r,e.delete);return new ir(i,t)}if(e.verify){let i=Zt(r,e.verify);return new Wo(i,t)}return q()}function oR(r,e){return r&&r.length>0?(G(e!==void 0),r.map(t=>function(i,s){let o=i.updateTime?Ve(i.updateTime):Ve(s);return o.isEqual(W.min())&&(o=Ve(s)),new af(o,i.transformResults||[])}(t,e))):[]}function RE(r,e){return{documents:[AE(r,e.path)]}}function DE(r,e){let t={structuredQuery:{}},n=e.path,i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=AE(r,i);let s=function(l){if(l.length!==0)return VE(fe.create(l,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(l){if(l.length!==0)return l.map(f=>function(m){return{field:ji(m.field),direction:uR(m.dir)}}(f))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let u=ff(r,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function PE(r){let e=bE(r.parent),t=r.structuredQuery,n=t.from?t.from.length:0,i=null;if(n>0){G(n===1);let f=t.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=function(p){let m=xE(p);return m instanceof fe&&Fp(m)?m.getFilters():[m]}(t.where));let o=[];t.orderBy&&(o=function(p){return p.map(m=>function(x){return new Fr(Bi(x.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(m))}(t.orderBy));let u=null;t.limit&&(u=function(p){let m;return m=typeof p=="object"?p.value:p,ca(m)?null:m}(t.limit));let c=null;t.startAt&&(c=function(p){let m=!!p.before,w=p.values||[];return new nn(w,m)}(t.startAt));let l=null;return t.endAt&&(l=function(p){let m=!p.before,w=p.values||[];return new nn(w,m)}(t.endAt)),rE(e,i,o,s,u,"F",c,l)}function aR(r,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return q()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function xE(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let n=Bi(t.unaryFilter.field);return ie.create(n,"==",{doubleValue:NaN});case"IS_NULL":let i=Bi(t.unaryFilter.field);return ie.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Bi(t.unaryFilter.field);return ie.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Bi(t.unaryFilter.field);return ie.create(o,"!=",{nullValue:"NULL_VALUE"});default:return q()}}(r):r.fieldFilter!==void 0?function(t){return ie.create(Bi(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return q()}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return fe.create(t.compositeFilter.filters.map(n=>xE(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return q()}}(t.compositeFilter.op))}(r):q()}function uR(r){return eR[r]}function cR(r){return tR[r]}function lR(r){return nR[r]}function ji(r){return{fieldPath:r.canonicalString()}}function Bi(r){return xe.fromServerFormat(r.fieldPath)}function VE(r){return r instanceof ie?function(t){if(t.op==="=="){if(q_(t.value))return{unaryFilter:{field:ji(t.field),op:"IS_NAN"}};if(B_(t.value))return{unaryFilter:{field:ji(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(q_(t.value))return{unaryFilter:{field:ji(t.field),op:"IS_NOT_NAN"}};if(B_(t.value))return{unaryFilter:{field:ji(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ji(t.field),op:cR(t.op),value:t.value}}}(r):r instanceof fe?function(t){let n=t.getFilters().map(i=>VE(i));return n.length===1?n[0]:{compositeFilter:{op:lR(t.op),filters:n}}}(r):q()}function hR(r){let e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function ME(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}var es=class r{constructor(e,t,n,i,s=W.min(),o=W.min(),u=Ke.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=c}withSequenceNumber(e){return new r(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new r(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var lc=class{constructor(e){this.ct=e}};function dR(r,e){let t;if(e.document)t=SE(r.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let n=L.fromSegments(e.noDocument.path),i=Br(e.noDocument.readTime);t=Le.newNoDocument(n,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return q();{let n=L.fromSegments(e.unknownDocument.path),i=Br(e.unknownDocument.version);t=Le.newUnknownDocument(n,i)}}return e.readTime&&t.setReadTime(function(i){let s=new be(i[0],i[1]);return W.fromTimestamp(s)}(e.readTime)),t}function ow(r,e){let t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:hc(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(s,o){return{name:Yo(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Zi(s,o.version.toTimestamp()),createTime:Zi(s,o.createTime.toTimestamp())}}(r.ct,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:jr(e.version)};else{if(!e.isUnknownDocument())return q();n.unknownDocument={path:t.path.toArray(),version:jr(e.version)}}return n}function hc(r){let e=r.toTimestamp();return[e.seconds,e.nanoseconds]}function jr(r){let e=r.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Br(r){let e=new be(r.seconds,r.nanoseconds);return W.fromTimestamp(e)}function Pr(r,e){let t=(e.baseMutations||[]).map(s=>mf(r.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let u=e.mutations[s+1];o.updateTransforms=u.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let n=e.mutations.map(s=>mf(r.ct,s)),i=be.fromMillis(e.localWriteTimeMs);return new Ho(e.batchId,i,t,n)}function No(r){let e=Br(r.readTime),t=r.lastLimboFreeSnapshotVersion!==void 0?Br(r.lastLimboFreeSnapshotVersion):W.min(),n;return n=function(s){return s.documents!==void 0}(r.query)?function(s){return G(s.documents.length===1),ut(hs(bE(s.documents[0])))}(r.query):function(s){return ut(PE(s))}(r.query),new es(n,r.targetId,"TargetPurposeListen",r.lastListenSequenceNumber,e,t,Ke.fromBase64String(r.resumeToken))}function kE(r,e){let t=jr(e.snapshotVersion),n=jr(e.lastLimboFreeSnapshotVersion),i;i=ic(e.target)?RE(r.ct,e.target):DE(r.ct,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Lr(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:i}}function Bp(r){let e=PE({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?oc(e,e.limit,"L"):e}function Pd(r,e){return new Qo(e.largestBatchId,mf(r.ct,e.overlayMutation))}function aw(r,e){let t=e.path.lastSegment();return[r,at(e.path.popLast()),t]}function uw(r,e,t,n){return{indexId:r,uid:e,sequenceNumber:t,readTime:jr(n.readTime),documentKey:at(n.documentKey.path),largestBatchId:n.largestBatchId}}var yf=class{getBundleMetadata(e,t){return cw(e).get(t).next(n=>{if(n)return function(s){return{id:s.bundleId,createTime:Br(s.createTime),version:s.version}}(n)})}saveBundleMetadata(e,t){return cw(e).put(function(i){return{bundleId:i.id,createTime:jr(Ve(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return lw(e).get(t).next(n=>{if(n)return function(s){return{name:s.name,query:Bp(s.bundledQuery),readTime:Br(s.readTime)}}(n)})}saveNamedQuery(e,t){return lw(e).put(function(i){return{name:i.name,readTime:jr(Ve(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function cw(r){return We(r,"bundles")}function lw(r){return We(r,"namedQueries")}var dc=class r{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let n=t.uid||"";return new r(e,n)}getOverlay(e,t){return Po(e).get(aw(this.userId,t)).next(n=>n?Pd(this.serializer,n):null)}getOverlays(e,t){let n=Jt();return C.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){let i=[];return n.forEach((s,o)=>{let u=new Qo(t,o);i.push(this.ht(e,u))}),C.waitFor(i)}removeOverlaysForBatchId(e,t,n){let i=new Set;t.forEach(o=>i.add(at(o.getCollectionPath())));let s=[];return i.forEach(o=>{let u=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,n+1],!1,!0);s.push(Po(e).j("collectionPathOverlayIndex",u))}),C.waitFor(s)}getOverlaysForCollection(e,t,n){let i=Jt(),s=at(t),o=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Po(e).U("collectionPathOverlayIndex",o).next(u=>{for(let c of u){let l=Pd(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,n,i){let s=Jt(),o,u=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Po(e).J({index:"collectionGroupOverlayIndex",range:u},(c,l,f)=>{let p=Pd(this.serializer,l);s.size()<i||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):f.done()}).next(()=>s)}ht(e,t){return Po(e).put(function(i,s,o){let[u,c,l]=aw(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Zo(i.ct,o.mutation)}}(this.serializer,this.userId,t))}};function Po(r){return We(r,"documentOverlays")}var fn=class{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(Re(e.integerValue));else if("doubleValue"in e){let n=Re(e.doubleValue);isNaN(n)?this.Et(t,13):(this.Et(t,15),qo(n)?t.dt(0):t.dt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Et(t,20),typeof n=="string"&&(n=gn(n)),t.At(`${n.seconds||""}`),t.dt(n.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(Yn(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){let n=e.geoPointValue;this.Et(t,45),t.dt(n.latitude||0),t.dt(n.longitude||0)}else"mapValue"in e?Xw(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):q()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){let n=e.fields||{};this.Et(t,55);for(let i of Object.keys(n))this.Rt(i,t),this.It(n[i],t)}wt(e,t){let n=e.values||[];this.Et(t,50);for(let i of n)this.It(i,t)}gt(e,t){this.Et(t,37),L.fromName(e).path.forEach(n=>{this.Et(t,60),this.St(n,t)})}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}};fn.bt=new fn;function fR(r){if(r===0)return 8;let e=0;return!(r>>4)&&(e+=4,r<<=4),!(r>>6)&&(e+=2,r<<=2),!(r>>7)&&(e+=1),e}function hw(r){let e=64-function(n){let i=0;for(let s=0;s<8;++s){let o=fR(255&n[s]);if(i+=o,o!==8)break}return i}(r);return Math.ceil(e/8)}var vf=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let t=e[Symbol.iterator](),n=t.next();for(;!n.done;)this.Ct(n.value),n=t.next();this.vt()}Ft(e){let t=e[Symbol.iterator](),n=t.next();for(;!n.done;)this.Mt(n.value),n=t.next();this.xt()}Ot(e){for(let t of e){let n=t.charCodeAt(0);if(n<128)this.Ct(n);else if(n<2048)this.Ct(960|n>>>6),this.Ct(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Ct(480|n>>>12),this.Ct(128|63&n>>>6),this.Ct(128|63&n);else{let i=t.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let t of e){let n=t.charCodeAt(0);if(n<128)this.Mt(n);else if(n<2048)this.Mt(960|n>>>6),this.Mt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Mt(480|n>>>12),this.Mt(128|63&n>>>6),this.Mt(128|63&n);else{let i=t.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Lt(e){let t=this.Bt(e),n=hw(t);this.kt(1+n),this.buffer[this.position++]=255&n;for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=255&t[i]}qt(e){let t=this.Bt(e),n=hw(t);this.kt(1+n),this.buffer[this.position++]=~(255&n);for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){let t=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),n=(128&t[0])!=0;t[0]^=n?255:128;for(let i=1;i<t.length;++i)t[i]^=n?255:0;return t}Ct(e){let t=255&e;t===0?(this.Kt(0),this.Kt(255)):t===255?(this.Kt(255),this.Kt(0)):this.Kt(t)}Mt(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);let i=new Uint8Array(n);i.set(this.buffer),this.buffer=i}},_f=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}},wf=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},xr=class{constructor(){this.Gt=new vf,this.zt=new _f(this.Gt),this.jt=new wf(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var Vr=class r{constructor(e,t,n,i){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=i}Jt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new r(this.indexId,this.documentKey,this.arrayValue,n)}};function zn(r,e){let t=r.indexId-e.indexId;return t!==0?t:(t=dw(r.arrayValue,e.arrayValue),t!==0?t:(t=dw(r.directionalValue,e.directionalValue),t!==0?t:L.comparator(r.documentKey,e.documentKey)))}function dw(r,e){for(let t=0;t<r.length&&t<e.length;++t){let n=r[t]-e[t];if(n!==0)return n}return r.length-e.length}var fc=class{constructor(e){this.Yt=new ye((t,n)=>xe.comparator(t.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let t of e.filters){let n=t;n.isInequality()?this.Yt=this.Yt.add(n):this.Xt.push(n)}}get en(){return this.Yt.size>1}tn(e){if(G(e.collectionGroup===this.collectionId),this.en)return!1;let t=Bd(e);if(t!==void 0&&!this.nn(t))return!1;let n=Rr(e),i=new Set,s=0,o=0;for(;s<n.length&&this.nn(n[s]);++s)i=i.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.Yt.size>0){let u=this.Yt.getIterator().getNext();if(!i.has(u.field.canonicalString())){let c=n[s];if(!this.rn(u,c)||!this.sn(this.Zt[o++],c))return!1}++s}for(;s<n.length;++s){let u=n[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],u))return!1}return!0}on(){if(this.en)return null;let e=new ye(xe.comparator),t=[];for(let n of this.Xt)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new zi(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new zi(n.field,0))}for(let n of this.Zt)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new zi(n.field,n.dir==="asc"?0:1)));return new Hi(Hi.UNKNOWN_ID,this.collectionId,t,Bo.empty())}nn(e){for(let t of this.Xt)if(this.rn(t,e))return!0;return!1}rn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function NE(r){var e,t;if(G(r instanceof ie||r instanceof fe),r instanceof ie){if(r instanceof rc){let i=((t=(e=r.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>ie.create(r.field,"==",s)))||[];return fe.create(i,"or")}return r}let n=r.filters.map(i=>NE(i));return fe.create(n,r.op)}function pR(r){if(r.getFilters().length===0)return[];let e=Tf(NE(r));return G(OE(e)),Ef(e)||If(e)?[e]:e.getFilters()}function Ef(r){return r instanceof ie}function If(r){return r instanceof fe&&Fp(r)}function OE(r){return Ef(r)||If(r)||function(t){if(t instanceof fe&&Qd(t)){for(let n of t.getFilters())if(!Ef(n)&&!If(n))return!1;return!0}return!1}(r)}function Tf(r){if(G(r instanceof ie||r instanceof fe),r instanceof ie)return r;if(r.filters.length===1)return Tf(r.filters[0]);let e=r.filters.map(n=>Tf(n)),t=fe.create(e,r.op);return t=pc(t),OE(t)?t:(G(t instanceof fe),G(Xi(t)),G(t.filters.length>1),t.filters.reduce((n,i)=>qp(n,i)))}function qp(r,e){let t;return G(r instanceof ie||r instanceof fe),G(e instanceof ie||e instanceof fe),t=r instanceof ie?e instanceof ie?function(i,s){return fe.create([i,s],"and")}(r,e):fw(r,e):e instanceof ie?fw(e,r):function(i,s){if(G(i.filters.length>0&&s.filters.length>0),Xi(i)&&Xi(s))return eE(i,s.getFilters());let o=Qd(i)?i:s,u=Qd(i)?s:i,c=o.filters.map(l=>qp(l,u));return fe.create(c,"or")}(r,e),pc(t)}function fw(r,e){if(Xi(e))return eE(e,r.getFilters());{let t=e.filters.map(n=>qp(r,n));return fe.create(t,"or")}}function pc(r){if(G(r instanceof ie||r instanceof fe),r instanceof ie)return r;let e=r.getFilters();if(e.length===1)return pc(e[0]);if(Yw(r))return r;let t=e.map(i=>pc(i)),n=[];return t.forEach(i=>{i instanceof ie?n.push(i):i instanceof fe&&(i.op===r.op?n.push(...i.filters):n.push(i))}),n.length===1?n[0]:fe.create(n,r.op)}var Af=class{constructor(){this._n=new ea}addToCollectionParentIndex(e,t){return this._n.add(t),C.resolve()}getCollectionParents(e,t){return C.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return C.resolve()}deleteFieldIndex(e,t){return C.resolve()}deleteAllFieldIndexes(e){return C.resolve()}createTargetIndexes(e,t){return C.resolve()}getDocumentsMatchingTarget(e,t){return C.resolve(null)}getIndexType(e,t){return C.resolve(0)}getFieldIndexes(e,t){return C.resolve([])}getNextCollectionGroupToUpdate(e){return C.resolve(null)}getMinOffset(e,t){return C.resolve(xt.min())}getMinOffsetFromCollectionGroup(e,t){return C.resolve(xt.min())}updateCollectionGroup(e,t,n){return C.resolve()}updateIndexEntries(e,t){return C.resolve()}},ea=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new ye(oe.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){let t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new ye(oe.comparator)).toArray()}};var Uu=new Uint8Array(0),bf=class{constructor(e,t){this.databaseId=t,this.an=new ea,this.un=new rn(n=>Lr(n),(n,i)=>la(n,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.an.has(t)){let n=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.an.add(t)});let s={collectionId:n,parent:at(i)};return pw(e).put(s)}return C.resolve()}getCollectionParents(e,t){let n=[],i=IDBKeyRange.bound([t,""],[Fw(t),""],!1,!0);return pw(e).U(i).next(s=>{for(let o of s){if(o.collectionId!==t)break;n.push(Xt(o.parent))}return n})}addFieldIndex(e,t){let n=xo(e),i=function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;let s=n.add(i);if(t.indexState){let o=Oi(e);return s.next(u=>{o.put(uw(u,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let n=xo(e),i=Oi(e),s=Ni(e);return n.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=xo(e),n=Ni(e),i=Oi(e);return t.j().next(()=>n.j()).next(()=>i.j())}createTargetIndexes(e,t){return C.forEach(this.cn(t),n=>this.getIndexType(e,n).next(i=>{if(i===0||i===1){let s=new fc(n).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let n=Ni(e),i=!0,s=new Map;return C.forEach(this.cn(t),o=>this.ln(e,o).next(u=>{i&&(i=!!u),s.set(o,u)})).next(()=>{if(i){let o=te(),u=[];return C.forEach(s,(c,l)=>{k("IndexedDbIndexManager",`Using index ${function(F){return`id=${F.indexId}|cg=${F.collectionGroup}|f=${F.fields.map($=>`${$.fieldPath}:${$.kind}`).join(",")}`}(c)} to execute ${Lr(t)}`);let f=function(F,$){let X=Bd($);if(X===void 0)return null;for(let Y of sc(F,X.fieldPath))switch(Y.op){case"array-contains-any":return Y.value.arrayValue.values||[];case"array-contains":return[Y.value]}return null}(l,c),p=function(F,$){let X=new Map;for(let Y of Rr($))for(let E of sc(F,Y.fieldPath))switch(E.op){case"==":case"in":X.set(Y.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return X.set(Y.fieldPath.canonicalString(),E.value),Array.from(X.values())}return null}(l,c),m=function(F,$){let X=[],Y=!0;for(let E of Rr($)){let y=E.kind===0?W_(F,E.fieldPath,F.startAt):H_(F,E.fieldPath,F.startAt);X.push(y.value),Y&&(Y=y.inclusive)}return new nn(X,Y)}(l,c),w=function(F,$){let X=[],Y=!0;for(let E of Rr($)){let y=E.kind===0?H_(F,E.fieldPath,F.endAt):W_(F,E.fieldPath,F.endAt);X.push(y.value),Y&&(Y=y.inclusive)}return new nn(X,Y)}(l,c),x=this.hn(c,l,m),V=this.hn(c,l,w),D=this.Pn(c,l,p),N=this.In(c.indexId,f,x,m.inclusive,V,w.inclusive,D);return C.forEach(N,z=>n.G(z,t.limit).next(F=>{F.forEach($=>{let X=L.fromSegments($.documentKey);o.has(X)||(o=o.add(X),u.push(X))})}))}).next(()=>u)}return C.resolve(null)})}cn(e){let t=this.un.get(e);return t||(e.filters.length===0?t=[e]:t=pR(fe.create(e.filters,"and")).map(n=>sf(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}In(e,t,n,i,s,o,u){let c=(t!=null?t.length:1)*Math.max(n.length,s.length),l=c/(t!=null?t.length:1),f=[];for(let p=0;p<c;++p){let m=t?this.Tn(t[p/l]):Uu,w=this.En(e,m,n[p%l],i),x=this.dn(e,m,s[p%l],o),V=u.map(D=>this.En(e,m,D,!0));f.push(...this.createRange(w,x,V))}return f}En(e,t,n,i){let s=new Vr(e,L.empty(),t,n);return i?s:s.Jt()}dn(e,t,n,i){let s=new Vr(e,L.empty(),t,n);return i?s.Jt():s}ln(e,t){let n=new fc(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let u of s)n.tn(u)&&(!o||u.fields.length>o.fields.length)&&(o=u);return o})}getIndexType(e,t){let n=2,i=this.cn(t);return C.forEach(i,s=>this.ln(e,s).next(o=>{o?n!==0&&o.fields.length<function(c){let l=new ye(xe.comparator),f=!1;for(let p of c.filters)for(let m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?f=!0:l=l.add(m.field));for(let p of c.orderBy)p.field.isKeyField()||(l=l.add(p.field));return l.size+(f?1:0)}(s)&&(n=1):n=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&n===2?1:n)}An(e,t){let n=new xr;for(let i of Rr(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=n.Ht(i.kind);fn.bt.Pt(s,o)}return n.Wt()}Tn(e){let t=new xr;return fn.bt.Pt(e,t.Ht(0)),t.Wt()}Rn(e,t){let n=new xr;return fn.bt.Pt(Or(this.databaseId,t),n.Ht(function(s){let o=Rr(s);return o.length===0?0:o[o.length-1].kind}(e))),n.Wt()}Pn(e,t,n){if(n===null)return[];let i=[];i.push(new xr);let s=0;for(let o of Rr(e)){let u=n[s++];for(let c of i)if(this.Vn(t,o.fieldPath)&&Ko(u))i=this.mn(i,o,u);else{let l=c.Ht(o.kind);fn.bt.Pt(u,l)}}return this.fn(i)}hn(e,t,n){return this.Pn(e,t,n.position)}fn(e){let t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Wt();return t}mn(e,t,n){let i=[...e],s=[];for(let o of n.arrayValue.values||[])for(let u of i){let c=new xr;c.seed(u.Wt()),fn.bt.Pt(o,c.Ht(t.kind)),s.push(c)}return s}Vn(e,t){return!!e.filters.find(n=>n instanceof ie&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,t){let n=xo(e),i=Oi(e);return(t?n.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.U()).next(s=>{let o=[];return C.forEach(s,u=>i.get([u.indexId,this.uid]).next(c=>{o.push(function(f,p){let m=p?new Bo(p.sequenceNumber,new xt(Br(p.readTime),new L(Xt(p.documentKey)),p.largestBatchId)):Bo.empty(),w=f.fields.map(([x,V])=>new zi(xe.fromServerFormat(x),V));return new Hi(f.indexId,f.collectionGroup,w,m)}(u,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((n,i)=>{let s=n.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Z(n.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,n){let i=xo(e),s=Oi(e);return this.gn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(u=>C.forEach(u,c=>s.put(uw(c.indexId,this.uid,o,n)))))}updateIndexEntries(e,t){let n=new Map;return C.forEach(t,(i,s)=>{let o=n.get(i.collectionGroup);return(o?C.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(u=>(n.set(i.collectionGroup,u),C.forEach(u,c=>this.pn(e,i,c).next(l=>{let f=this.yn(s,c);return l.isEqual(f)?C.resolve():this.wn(e,s,c,l,f)}))))})}Sn(e,t,n,i){return Ni(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(n,t.key),documentKey:t.key.path.toArray()})}bn(e,t,n,i){return Ni(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(n,t.key),t.key.path.toArray()])}pn(e,t,n){let i=Ni(e),s=new ye(zn);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.Rn(n,t)])},(o,u)=>{s=s.add(new Vr(n.indexId,t,u.arrayValue,u.directionalValue))}).next(()=>s)}yn(e,t){let n=new ye(zn),i=this.An(t,e);if(i==null)return n;let s=Bd(t);if(s!=null){let o=e.data.field(s.fieldPath);if(Ko(o))for(let u of o.arrayValue.values||[])n=n.add(new Vr(t.indexId,e.key,this.Tn(u),i))}else n=n.add(new Vr(t.indexId,e.key,Uu,i));return n}wn(e,t,n,i,s){k("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let o=[];return function(c,l,f,p,m){let w=c.getIterator(),x=l.getIterator(),V=ki(w),D=ki(x);for(;V||D;){let N=!1,z=!1;if(V&&D){let F=f(V,D);F<0?z=!0:F>0&&(N=!0)}else V!=null?z=!0:N=!0;N?(p(D),D=ki(x)):z?(m(V),V=ki(w)):(V=ki(w),D=ki(x))}}(i,s,zn,u=>{o.push(this.Sn(e,t,n,u))},u=>{o.push(this.bn(e,t,n,u))}),C.waitFor(o)}gn(e){let t=1;return Oi(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((o,u)=>zn(o,u)).filter((o,u,c)=>!u||zn(o,c[u-1])!==0);let i=[];i.push(e);for(let o of n){let u=zn(o,e),c=zn(o,t);if(u===0)i[0]=e.Jt();else if(u>0&&c<0)i.push(o),i.push(o.Jt());else if(c>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let u=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Uu,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Uu,[]];s.push(IDBKeyRange.bound(u,c))}return s}Dn(e,t){return zn(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(gw)}getMinOffset(e,t){return C.mapArray(this.cn(t),n=>this.ln(e,n).next(i=>i||q())).next(gw)}};function pw(r){return We(r,"collectionParents")}function Ni(r){return We(r,"indexEntries")}function xo(r){return We(r,"indexConfiguration")}function Oi(r){return We(r,"indexState")}function gw(r){G(r.length!==0);let e=r[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<r.length;n++){let i=r[n].indexState.offset;kp(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new xt(e.readTime,e.documentKey,t)}var mw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Dt=class r{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new r(e,r.DEFAULT_COLLECTION_PERCENTILE,r.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function FE(r,e,t){let n=r.store("mutations"),i=r.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId),u=0,c=n.J({range:o},(f,p,m)=>(u++,m.delete()));s.push(c.next(()=>{G(u===1)}));let l=[];for(let f of t.mutations){let p=$w(e,f.key.path,t.batchId);s.push(i.delete(p)),l.push(f.key)}return C.waitFor(s).next(()=>l)}function gc(r){if(!r)return 0;let e;if(r.document)e=r.document;else if(r.unknownDocument)e=r.unknownDocument;else{if(!r.noDocument)throw q();e=r.noDocument}return JSON.stringify(e).length}Dt.DEFAULT_COLLECTION_PERCENTILE=10,Dt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Dt.DEFAULT=new Dt(41943040,Dt.DEFAULT_COLLECTION_PERCENTILE,Dt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Dt.DISABLED=new Dt(-1,0,0);var mc=class r{constructor(e,t,n,i){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=i,this.Cn={}}static lt(e,t,n,i){G(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new r(s,t,n,i)}checkEmpty(e){let t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Gn(e).J({index:"userMutationsIndex",range:n},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,n,i){let s=qi(e),o=Gn(e);return o.add({}).next(u=>{G(typeof u=="number");let c=new Ho(u,t,n,i),l=function(w,x,V){let D=V.baseMutations.map(z=>Zo(w.ct,z)),N=V.mutations.map(z=>Zo(w.ct,z));return{userId:x,batchId:V.batchId,localWriteTimeMs:V.localWriteTime.toMillis(),baseMutations:D,mutations:N}}(this.serializer,this.userId,c),f=[],p=new ye((m,w)=>Z(m.canonicalString(),w.canonicalString()));for(let m of i){let w=$w(this.userId,m.key.path,u);p=p.add(m.key.path.popLast()),f.push(o.put(l)),f.push(s.put(w,ES))}return p.forEach(m=>{f.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Cn[u]=c.keys()}),C.waitFor(f).next(()=>c)})}lookupMutationBatch(e,t){return Gn(e).get(t).next(n=>n?(G(n.userId===this.userId),Pr(this.serializer,n)):null)}vn(e,t){return this.Cn[t]?C.resolve(this.Cn[t]):this.lookupMutationBatch(e,t).next(n=>{if(n){let i=n.keys();return this.Cn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let n=t+1,i=IDBKeyRange.lowerBound([this.userId,n]),s=null;return Gn(e).J({index:"userMutationsIndex",range:i},(o,u,c)=>{u.userId===this.userId&&(G(u.batchId>=n),s=Pr(this.serializer,u)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Gn(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{n=s.batchId,o.done()}).next(()=>n)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Gn(e).U("userMutationsIndex",t).next(n=>n.map(i=>Pr(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let n=$u(this.userId,t.path),i=IDBKeyRange.lowerBound(n),s=[];return qi(e).J({range:i},(o,u,c)=>{let[l,f,p]=o,m=Xt(f);if(l===this.userId&&t.path.isEqual(m))return Gn(e).get(p).next(w=>{if(!w)throw q();G(w.userId===this.userId),s.push(Pr(this.serializer,w))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new ye(Z),i=[];return t.forEach(s=>{let o=$u(this.userId,s.path),u=IDBKeyRange.lowerBound(o),c=qi(e).J({range:u},(l,f,p)=>{let[m,w,x]=l,V=Xt(w);m===this.userId&&s.path.isEqual(V)?n=n.add(x):p.done()});i.push(c)}),C.waitFor(i).next(()=>this.Fn(e,n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,i=n.length+1,s=$u(this.userId,n),o=IDBKeyRange.lowerBound(s),u=new ye(Z);return qi(e).J({range:o},(c,l,f)=>{let[p,m,w]=c,x=Xt(m);p===this.userId&&n.isPrefixOf(x)?x.length===i&&(u=u.add(w)):f.done()}).next(()=>this.Fn(e,u))}Fn(e,t){let n=[],i=[];return t.forEach(s=>{i.push(Gn(e).get(s).next(o=>{if(o===null)throw q();G(o.userId===this.userId),n.push(Pr(this.serializer,o))}))}),C.waitFor(i).next(()=>n)}removeMutationBatch(e,t){return FE(e._e,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.Mn(t.batchId)}),C.forEach(n,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return C.resolve();let n=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return qi(e).J({range:n},(s,o,u)=>{if(s[0]===this.userId){let c=Xt(s[1]);i.push(c)}else u.done()}).next(()=>{G(i.length===0)})})}containsKey(e,t){return LE(e,this.userId,t)}xn(e){return UE(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function LE(r,e,t){let n=$u(e,t.path),i=n[1],s=IDBKeyRange.lowerBound(n),o=!1;return qi(r).J({range:s,H:!0},(u,c,l)=>{let[f,p,m]=u;f===e&&p===i&&(o=!0),l.done()}).next(()=>o)}function Gn(r){return We(r,"mutations")}function qi(r){return We(r,"documentMutations")}function UE(r){return We(r,"mutationQueues")}var ts=class r{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new r(0)}static Ln(){return new r(-1)}};var Cf=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{let n=new ts(t.highestTargetId);return t.highestTargetId=n.next(),this.kn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>W.fromTimestamp(new be(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.kn(e,i)))}addTargetData(e,t){return this.qn(e,t).next(()=>this.Bn(e).next(n=>(n.targetCount+=1,this.Qn(t,n),this.kn(e,n))))}updateTargetData(e,t){return this.qn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Fi(e).delete(t.targetId)).next(()=>this.Bn(e)).next(n=>(G(n.targetCount>0),n.targetCount-=1,this.kn(e,n)))}removeTargets(e,t,n){let i=0,s=[];return Fi(e).J((o,u)=>{let c=No(u);c.sequenceNumber<=t&&n.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>C.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Fi(e).J((n,i)=>{let s=No(i);t(s)})}Bn(e){return yw(e).get("targetGlobalKey").next(t=>(G(t!==null),t))}kn(e,t){return yw(e).put("targetGlobalKey",t)}qn(e,t){return Fi(e).put(kE(this.serializer,t))}Qn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){let n=Lr(t),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),s=null;return Fi(e).J({range:i,index:"queryTargetsIndex"},(o,u,c)=>{let l=No(u);la(t,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,t,n){let i=[],s=Kn(e);return t.forEach(o=>{let u=at(o.path);i.push(s.put({targetId:n,path:u})),i.push(this.referenceDelegate.addReference(e,n,o))}),C.waitFor(i)}removeMatchingKeys(e,t,n){let i=Kn(e);return C.forEach(t,s=>{let o=at(s.path);return C.waitFor([i.delete([n,o]),this.referenceDelegate.removeReference(e,n,s)])})}removeMatchingKeysForTargetId(e,t){let n=Kn(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(i)}getMatchingKeysForTargetId(e,t){let n=IDBKeyRange.bound([t],[t+1],!1,!0),i=Kn(e),s=te();return i.J({range:n,H:!0},(o,u,c)=>{let l=Xt(o[1]),f=new L(l);s=s.add(f)}).next(()=>s)}containsKey(e,t){let n=at(t.path),i=IDBKeyRange.bound([n],[Fw(n)],!1,!0),s=0;return Kn(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,u],c,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}ot(e,t){return Fi(e).get(t).next(n=>n?No(n):null)}};function Fi(r){return We(r,"targets")}function yw(r){return We(r,"targetGlobal")}function Kn(r){return We(r,"targetDocuments")}function vw([r,e],[t,n]){let i=Z(r,t);return i===0?Z(e,n):i}var Sf=class{constructor(e){this.Kn=e,this.buffer=new ye(vw),this.$n=0}Un(){return++this.$n}Wn(e){let t=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(t);else{let n=this.buffer.last();vw(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}},Rf=class{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){k("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>P(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){ar(t)?k("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield or(t)}yield this.zn(3e5)}))}},Df=class{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.Hn(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return C.resolve(Et.oe);let n=new Sf(t);return this.jn.forEachTarget(e,i=>n.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>n.Wn(i))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.jn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(k("LruGarbageCollector","Garbage collection skipped; disabled"),C.resolve(mw)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(k("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),mw):this.Yn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,t){let n,i,s,o,u,c,l,f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(k("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(n=p,u=Date.now(),this.removeTargets(e,n,t))).next(p=>(s=p,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(p=>(l=Date.now(),Li()<=Gt.DEBUG&&k("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${i} in `+(u-o)+`ms
	Removed ${s} targets in `+(c-u)+`ms
	Removed ${p} documents in `+(l-c)+`ms
Total Duration: ${l-f}ms`),C.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}};function gR(r,e){return new Df(r,e)}var Pf=class{constructor(e,t){this.db=e,this.garbageCollector=gR(this,t)}Hn(e){let t=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}Zn(e){let t=0;return this.Jn(e,n=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Jn(e,t){return this.Xn(e,(n,i)=>t(i))}addReference(e,t,n){return ju(e,n)}removeReference(e,t,n){return ju(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return ju(e,t)}er(e,t){return function(i,s){let o=!1;return UE(i).Y(u=>LE(i,u,s).next(c=>(c&&(o=!0),C.resolve(!c)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){let n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,u)=>{if(u<=t){let c=this.er(e,o).next(l=>{if(!l)return s++,n.getEntry(e,o).next(()=>(n.removeEntry(o,W.min()),Kn(e).delete(function(p){return[0,at(p.path)]}(o))))});i.push(c)}}).next(()=>C.waitFor(i)).next(()=>n.apply(e)).next(()=>s)}removeTarget(e,t){let n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return ju(e,t)}Xn(e,t){let n=Kn(e),i,s=Et.oe;return n.J({index:"documentTargetsIndex"},([o,u],{path:c,sequenceNumber:l})=>{o===0?(s!==Et.oe&&t(new L(Xt(i)),s),s=l,i=c):s=Et.oe}).next(()=>{s!==Et.oe&&t(new L(Xt(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function ju(r,e){return Kn(r).put(function(n,i){return{targetId:0,path:at(n.path),sequenceNumber:i}}(e,r.currentSequenceNumber))}var yc=class{constructor(){this.changes=new rn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Le.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let n=this.changes.get(t);return n!==void 0?C.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var xf=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Sr(e).put(n)}removeEntry(e,t,n){return Sr(e).delete(function(s,o){let u=s.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],hc(o),u[u.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.tr(e,n)))}getEntry(e,t){let n=Le.newInvalidDocument(t);return Sr(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Vo(t))},(i,s)=>{n=this.nr(t,s)}).next(()=>n)}rr(e,t){let n={size:0,document:Le.newInvalidDocument(t)};return Sr(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Vo(t))},(i,s)=>{n={document:this.nr(t,s),size:gc(s)}}).next(()=>n)}getEntries(e,t){let n=mt();return this.ir(e,t,(i,s)=>{let o=this.nr(i,s);n=n.insert(i,o)}).next(()=>n)}sr(e,t){let n=mt(),i=new Ie(L.comparator);return this.ir(e,t,(s,o)=>{let u=this.nr(s,o);n=n.insert(s,u),i=i.insert(s,gc(o))}).next(()=>({documents:n,_r:i}))}ir(e,t,n){if(t.isEmpty())return C.resolve();let i=new ye(Ew);t.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(Vo(i.first()),Vo(i.last())),o=i.getIterator(),u=o.getNext();return Sr(e).J({index:"documentKeyIndex",range:s},(c,l,f)=>{let p=L.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;u&&Ew(u,p)<0;)n(u,null),u=o.getNext();u&&u.isEqual(p)&&(n(u,l),u=o.hasNext()?o.getNext():null),u?f.$(Vo(u)):f.done()}).next(()=>{for(;u;)n(u,null),u=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,n,i,s){let o=t.path,u=[o.popLast().toArray(),o.lastSegment(),hc(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Sr(e).U(IDBKeyRange.bound(u,c,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let f=mt();for(let p of l){let m=this.nr(L.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(da(t,m)||i.has(m.key))&&(f=f.insert(m.key,m))}return f})}getAllFromCollectionGroup(e,t,n,i){let s=mt(),o=ww(t,n),u=ww(t,xt.max());return Sr(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,u,!0)},(c,l,f)=>{let p=this.nr(L.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(p.key,p),s.size===i&&f.done()}).next(()=>s)}newChangeBuffer(e){return new Vf(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return _w(e).get("remoteDocumentGlobalKey").next(t=>(G(!!t),t))}tr(e,t){return _w(e).put("remoteDocumentGlobalKey",t)}nr(e,t){if(t){let n=dR(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(W.min())))return n}return Le.newInvalidDocument(e)}};function jE(r){return new xf(r)}var Vf=class extends yc{constructor(e,t){super(),this.ar=e,this.trackRemovals=t,this.ur=new rn(n=>n.toString(),(n,i)=>n.isEqual(i))}applyChanges(e){let t=[],n=0,i=new ye((s,o)=>Z(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let u=this.ur.get(s);if(t.push(this.ar.removeEntry(e,s,u.readTime)),o.isValidDocument()){let c=ow(this.ar.serializer,o);i=i.add(s.path.popLast());let l=gc(c);n+=l-u.size,t.push(this.ar.addEntry(e,s,c))}else if(n-=u.size,this.trackRemovals){let c=ow(this.ar.serializer,o.convertToNoDocument(W.min()));t.push(this.ar.addEntry(e,s,c))}}),i.forEach(s=>{t.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.ar.updateMetadata(e,n)),C.waitFor(t)}getFromCache(e,t){return this.ar.rr(e,t).next(n=>(this.ur.set(t,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,t){return this.ar.sr(e,t).next(({documents:n,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:n.get(s).readTime})}),n))}};function _w(r){return We(r,"remoteDocumentGlobal")}function Sr(r){return We(r,"remoteDocumentsV14")}function Vo(r){let e=r.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function ww(r,e){let t=e.documentKey.path.toArray();return[r,hc(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Ew(r,e){let t=r.path.toArray(),n=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<n.length-2;++s)if(i=Z(t[s],n[s]),i)return i;return i=Z(t.length,n.length),i||(i=Z(t[t.length-2],n[n.length-2]),i||Z(t[t.length-1],n[n.length-1]))}var Mf=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var vc=class{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(n!==null&&Lo(n.mutation,i,It.empty(),be.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,te()).next(()=>n))}getLocalViewOfDocuments(e,t,n=te()){let i=Jt();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(s=>{let o=ko();return s.forEach((u,c)=>{o=o.insert(u,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let n=Jt();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,te()))}populateOverlays(e,t,n){let i=[];return n.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,u)=>{t.set(o,u)})})}computeViews(e,t,n,i){let s=mt(),o=Fo(),u=function(){return Fo()}();return t.forEach((c,l)=>{let f=n.get(l.key);i.has(l.key)&&(f===void 0||f.mutation instanceof Ut)?s=s.insert(l.key,l):f!==void 0?(o.set(l.key,f.mutation.getFieldMask()),Lo(f.mutation,l,f.mutation.getFieldMask(),be.now())):o.set(l.key,It.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,f)=>o.set(l,f)),t.forEach((l,f)=>{var p;return u.set(l,new Mf(f,(p=o.get(l))!==null&&p!==void 0?p:null))}),u))}recalculateAndSaveOverlays(e,t){let n=Fo(),i=new Ie((o,u)=>o-u),s=te();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let u of o)u.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let f=n.get(c)||It.empty();f=u.applyToLocalView(l,f),n.set(c,f);let p=(i.get(u.batchId)||te()).add(c);i=i.insert(u.batchId,p)})}).next(()=>{let o=[],u=i.getReverseIterator();for(;u.hasNext();){let c=u.getNext(),l=c.key,f=c.value,p=cE();f.forEach(m=>{if(!s.has(m)){let w=yE(t.get(m),n.get(m));w!==null&&p.set(m,w),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,p))}return C.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return function(o){return L.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Lp(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):C.resolve(Jt()),u=-1,c=s;return o.next(l=>C.forEach(l,(f,p)=>(u<p.largestBatchId&&(u=p.largestBatchId),s.get(f)?C.resolve():this.remoteDocumentCache.getEntry(e,f).next(m=>{c=c.insert(f,m)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,te())).next(f=>({batchId:u,changes:uE(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new L(t)).next(n=>{let i=ko();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){let s=t.collectionGroup,o=ko();return this.indexManager.getCollectionParents(e,s).next(u=>C.forEach(u,c=>{let l=function(p,m){return new Lt(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,n,i).next(f=>{f.forEach((p,m)=>{o=o.insert(p,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,i))).next(o=>{s.forEach((c,l)=>{let f=l.getKey();o.get(f)===null&&(o=o.insert(f,Le.newInvalidDocument(f)))});let u=ko();return o.forEach((c,l)=>{let f=s.get(c);f!==void 0&&Lo(f.mutation,l,It.empty(),be.now()),da(t,l)&&(u=u.insert(c,l))}),u})}};var kf=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return C.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Ve(i.createTime)}}(t)),C.resolve()}getNamedQuery(e,t){return C.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(i){return{name:i.name,query:Bp(i.bundledQuery),readTime:Ve(i.readTime)}}(t)),C.resolve()}};var Nf=class{constructor(){this.overlays=new Ie(L.comparator),this.hr=new Map}getOverlay(e,t){return C.resolve(this.overlays.get(t))}getOverlays(e,t){let n=Jt();return C.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,s)=>{this.ht(e,t,s)}),C.resolve()}removeOverlaysForBatchId(e,t,n){let i=this.hr.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(n)),C.resolve()}getOverlaysForCollection(e,t,n){let i=Jt(),s=t.length+1,o=new L(t.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){let c=u.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>n&&i.set(c.getKey(),c)}return C.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new Ie((l,f)=>l-f),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>n){let f=s.get(l.largestBatchId);f===null&&(f=Jt(),s=s.insert(l.largestBatchId,f)),f.set(l.getKey(),l)}}let u=Jt(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,f)=>u.set(l,f)),!(u.size()>=i)););return C.resolve(u)}ht(e,t,n){let i=this.overlays.get(n.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(n.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new Qo(t,n));let s=this.hr.get(t);s===void 0&&(s=te(),this.hr.set(t,s)),this.hr.set(t,s.add(n.key))}};var ta=class{constructor(){this.Pr=new ye(Ne.Ir),this.Tr=new ye(Ne.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){let n=new Ne(e,t);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.Ar(new Ne(e,t))}Rr(e,t){e.forEach(n=>this.removeReference(n,t))}Vr(e){let t=new L(new oe([])),n=new Ne(t,e),i=new Ne(t,e+1),s=[];return this.Tr.forEachInRange([n,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let t=new L(new oe([])),n=new Ne(t,e),i=new Ne(t,e+1),s=te();return this.Tr.forEachInRange([n,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Ne(e,0),n=this.Pr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}},Ne=class{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return L.comparator(e.key,t.key)||Z(e.pr,t.pr)}static Er(e,t){return Z(e.pr,t.pr)||L.comparator(e.key,t.key)}};var Of=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new ye(Ne.Ir)}checkEmpty(e){return C.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Ho(s,t,n,i);this.mutationQueue.push(o);for(let u of i)this.wr=this.wr.add(new Ne(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return C.resolve(o)}lookupMutationBatch(e,t){return C.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){let n=t+1,i=this.br(n),s=i<0?0:i;return C.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return C.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return C.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let n=new Ne(t,0),i=new Ne(t,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([n,i],o=>{let u=this.Sr(o.pr);s.push(u)}),C.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new ye(Z);return t.forEach(i=>{let s=new Ne(i,0),o=new Ne(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],u=>{n=n.add(u.pr)})}),C.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,i=n.length+1,s=n;L.isDocumentKey(s)||(s=s.child(""));let o=new Ne(new L(s),0),u=new ye(Z);return this.wr.forEachWhile(c=>{let l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===i&&(u=u.add(c.pr)),!0)},o),C.resolve(this.Dr(u))}Dr(e){let t=[];return e.forEach(n=>{let i=this.Sr(n);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){G(this.Cr(t.batchId,"removed")===0),this.mutationQueue.shift();let n=this.wr;return C.forEach(t.mutations,i=>{let s=new Ne(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=n})}Mn(e){}containsKey(e,t){let n=new Ne(t,0),i=this.wr.firstAfterOrEqual(n);return C.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,C.resolve()}Cr(e,t){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Ff=class{constructor(e){this.vr=e,this.docs=function(){return new Ie(L.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let n=t.key,i=this.docs.get(n),s=i?i.size:0,o=this.vr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let n=this.docs.get(t);return C.resolve(n?n.document.mutableCopy():Le.newInvalidDocument(t))}getEntries(e,t){let n=mt();return t.forEach(i=>{let s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Le.newInvalidDocument(i))}),C.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=mt(),o=t.path,u=new L(o.child("")),c=this.docs.getIteratorFrom(u);for(;c.hasNext();){let{key:l,value:{document:f}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||kp(Uw(f),n)<=0||(i.has(f.key)||da(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return C.resolve(s)}getAllFromCollectionGroup(e,t,n,i){q()}Fr(e,t){return C.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new Lf(this)}getSize(e){return C.resolve(this.size)}},Lf=class extends yc{constructor(e){super(),this.ar=e}applyChanges(e){let t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.ar.addEntry(e,i)):this.ar.removeEntry(n)}),C.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}};var Uf=class{constructor(e){this.persistence=e,this.Mr=new rn(t=>Lr(t),la),this.lastRemoteSnapshotVersion=W.min(),this.highestTargetId=0,this.Or=0,this.Nr=new ta,this.targetCount=0,this.Lr=ts.Nn()}forEachTarget(e,t){return this.Mr.forEach((n,i)=>t(i)),C.resolve()}getLastRemoteSnapshotVersion(e){return C.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return C.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),C.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Or&&(this.Or=t),C.resolve()}qn(e){this.Mr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Lr=new ts(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,C.resolve()}updateTargetData(e,t){return this.qn(t),C.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,C.resolve()}removeTargets(e,t,n){let i=0,s=[];return this.Mr.forEach((o,u)=>{u.sequenceNumber<=t&&n.get(u.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),C.waitFor(s).next(()=>i)}getTargetCount(e){return C.resolve(this.targetCount)}getTargetData(e,t){let n=this.Mr.get(t)||null;return C.resolve(n)}addMatchingKeys(e,t,n){return this.Nr.dr(t,n),C.resolve()}removeMatchingKeys(e,t,n){this.Nr.Rr(t,n);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),C.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),C.resolve()}getMatchingKeysForTargetId(e,t){let n=this.Nr.gr(t);return C.resolve(n)}containsKey(e,t){return C.resolve(this.Nr.containsKey(t))}};var _c=class{constructor(e,t){this.Br={},this.overlays={},this.kr=new Et(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new Uf(this),this.indexManager=new Af,this.remoteDocumentCache=function(i){return new Ff(i)}(n=>this.referenceDelegate.Kr(n)),this.serializer=new lc(t),this.$r=new kf(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Nf,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Br[e.toKey()];return n||(n=new Of(t,this.referenceDelegate),this.Br[e.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,n){k("MemoryPersistence","Starting transaction:",e);let i=new jf(this.kr.next());return this.referenceDelegate.Ur(),n(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,t){return C.or(Object.values(this.Br).map(n=>()=>n.containsKey(e,t)))}},jf=class extends Yu{constructor(e){super(),this.currentSequenceNumber=e}},wc=class r{constructor(e){this.persistence=e,this.zr=new ta,this.jr=null}static Hr(e){return new r(e)}get Jr(){if(this.jr)return this.jr;throw q()}addReference(e,t,n){return this.zr.addReference(n,t),this.Jr.delete(n.toString()),C.resolve()}removeReference(e,t,n){return this.zr.removeReference(n,t),this.Jr.add(n.toString()),C.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),C.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach(i=>this.Jr.add(i.toString()));let n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}Ur(){this.jr=new Set}Wr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return C.forEach(this.Jr,n=>{let i=L.fromPath(n);return this.Yr(e,i).next(s=>{s||t.removeEntry(i,W.min())})}).next(()=>(this.jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Yr(e,t).next(n=>{n?this.Jr.delete(t.toString()):this.Jr.add(t.toString())})}Kr(e){return 0}Yr(e,t){return C.or([()=>C.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}};var Bf=class{constructor(e){this.serializer=e}O(e,t,n,i){let s=new Zu("createOrUpgrade",t);n<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",L_,{unique:!0}),c.createObjectStore("documentMutations")}(e),Iw(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=C.resolve();return n<3&&i>=3&&(n!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),Iw(e)),o=o.next(()=>function(c){let l=c.store("targetGlobal"),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:W.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",f)}(s))),n<4&&i>=4&&(n!==0&&(o=o.next(()=>function(c,l){return l.store("mutations").U().next(f=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",L_,{unique:!0});let p=l.store("mutations"),m=f.map(w=>p.put(w));return C.waitFor(m)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),n<5&&i>=5&&(o=o.next(()=>this.Xr(s))),n<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),n<7&&i>=7&&(o=o.next(()=>this.ti(s))),n<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),n<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&i>=10&&(o=o.next(()=>this.ri(s))),n<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&i>=12&&(o=o.next(()=>{(function(c){let l=c.createObjectStore("documentOverlays",{keyPath:MS});l.createIndex("collectionPathOverlayIndex",kS,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",NS,{unique:!1})})(e)})),n<13&&i>=13&&(o=o.next(()=>function(c){let l=c.createObjectStore("remoteDocumentsV14",{keyPath:IS});l.createIndex("documentKeyIndex",TS),l.createIndex("collectionGroupIndex",AS)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&i>=14&&(o=o.next(()=>this.si(e,s))),n<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:DS}).createIndex("sequenceNumberIndex",PS,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:xS}).createIndex("documentKeyIndex",VS,{unique:!1})}(e))),n<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),o}ei(e){let t=0;return e.store("remoteDocuments").J((n,i)=>{t+=gc(i)}).next(()=>{let n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}Xr(e){let t=e.store("mutationQueues"),n=e.store("mutations");return t.U().next(i=>C.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",o).next(u=>C.forEach(u,c=>{G(c.userId===s.userId);let l=Pr(this.serializer,c);return FE(e,s.userId,l).next(()=>{})}))}))}ti(e){let t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return n.J((o,u)=>{let c=new oe(o),l=function(p){return[0,at(p)]}(c);s.push(t.get(l).next(f=>f?C.resolve():(p=>t.put({targetId:0,path:at(p),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>C.waitFor(s))})}ni(e,t){e.createObjectStore("collectionParents",{keyPath:RS});let n=t.store("collectionParents"),i=new ea,s=o=>{if(i.add(o)){let u=o.lastSegment(),c=o.popLast();return n.put({collectionId:u,parent:at(c)})}};return t.store("remoteDocuments").J({H:!0},(o,u)=>{let c=new oe(o);return s(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,u,c],l)=>{let f=Xt(u);return s(f.popLast())}))}ri(e){let t=e.store("targets");return t.J((n,i)=>{let s=No(i),o=kE(this.serializer,s);return t.put(o)})}ii(e,t){let n=t.store("remoteDocuments"),i=[];return n.J((s,o)=>{let u=t.store("remoteDocumentsV14"),c=function(p){return p.document?new L(oe.fromString(p.document.name).popFirst(5)):p.noDocument?L.fromSegments(p.noDocument.path):p.unknownDocument?L.fromSegments(p.unknownDocument.path):q()}(o).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(u.put(l))}).next(()=>C.waitFor(i))}si(e,t){let n=t.store("mutations"),i=jE(this.serializer),s=new _c(wc.Hr,this.serializer.ct);return n.U().next(o=>{let u=new Map;return o.forEach(c=>{var l;let f=(l=u.get(c.userId))!==null&&l!==void 0?l:te();Pr(this.serializer,c).keys().forEach(p=>f=f.add(p)),u.set(c.userId,f)}),C.forEach(u,(c,l)=>{let f=new Oe(l),p=dc.lt(this.serializer,f),m=s.getIndexManager(f),w=mc.lt(f,this.serializer,m,s.referenceDelegate);return new vc(i,w,p,m).recalculateAndSaveOverlaysForDocumentKeys(new $o(t,Et.oe),c).next()})})}};function Iw(r){r.createObjectStore("targetDocuments",{keyPath:CS}).createIndex("documentTargetsIndex",SS,{unique:!0}),r.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",bS,{unique:!0}),r.createObjectStore("targetGlobal")}var xd="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",qf=class r{constructor(e,t,n,i,s,o,u,c,l,f,p=16){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.oi=s,this.window=o,this.document=u,this._i=l,this.ai=f,this.ui=p,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=m=>Promise.resolve(),!r.D())throw new M(R.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Pf(this,i),this.Ti=t+"main",this.serializer=new lc(c),this.Ei=new Jn(this.Ti,this.ui,new Bf(this.serializer)),this.Qr=new Cf(this.referenceDelegate,this.serializer),this.remoteDocumentCache=jE(this.serializer),this.$r=new yf,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,f===!1&&Pe("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new M(R.FAILED_PRECONDITION,xd);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new Et(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=t=>P(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(t=>P(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>P(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Bu(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(t=>{t||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(t=>this.isPrimary&&!t?this.yi(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(ar(e))return k("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return k("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return Mo(e).get("owner").next(t=>C.resolve(this.Si(t)))}bi(e){return Bu(e).delete(this.clientId)}Di(){return P(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let n=We(t,"clientMetadata");return n.U().next(i=>{let s=this.vi(i,18e5),o=i.filter(u=>s.indexOf(u)===-1);return C.forEach(o,u=>n.delete(u.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let t of e)this.di.removeItem(this.Fi(t.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?C.resolve(!0):Mo(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)){if(this.Si(t)&&this.networkEnabled)return!0;if(!this.Si(t)){if(!t.allowTabSynchronization)throw new M(R.FAILED_PRECONDITION,xd);return!1}}return!(!this.networkEnabled||!this.inForeground)||Bu(e).U().next(n=>this.vi(n,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,u=this.networkEnabled===i.networkEnabled;if(s||o&&u)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&k("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return P(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new $o(e,Et.oe);return this.yi(t).next(()=>this.bi(t))}),this.Ei.close(),this.Li()})}vi(e,t){return e.filter(n=>this.Ci(n.updateTimeMs,t)&&!this.Mi(n.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>Bu(e).U().next(t=>this.vi(t,18e5).map(n=>n.clientId)))}get started(){return this.qr}getMutationQueue(e,t){return mc.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new bf(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return dc.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,t,n){k("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=function(c){return c===16?FS:c===15?Ww:c===14?Kw:c===13?Gw:c===12?OS:c===11?zw:void q()}(this.ui),o;return this.Ei.runTransaction(e,i,s,u=>(o=new $o(u,this.kr?this.kr.next():Et.oe),t==="readwrite-primary"?this.gi(o).next(c=>!!c||this.pi(o)).next(c=>{if(!c)throw Pe(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new M(R.FAILED_PRECONDITION,jw);return n(o)}).next(c=>this.wi(o).next(()=>c)):this.ki(o).next(()=>n(o)))).then(u=>(o.raiseOnCommittedEvent(),u))}ki(e){return Mo(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)&&!this.Si(t)&&!(this.ai||this.allowTabSynchronization&&t.allowTabSynchronization))throw new M(R.FAILED_PRECONDITION,xd)})}wi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Mo(e).put("owner",t)}static D(){return Jn.D()}yi(e){let t=Mo(e);return t.get("owner").next(n=>this.Si(n)?(k("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):C.resolve())}Ci(e,t){let n=Date.now();return!(e<n-t)&&(!(e>n)||(Pe(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let t=/(?:Version|Mobile)\/1[456]/;Zl()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var t;try{let n=((t=this.di)===null||t===void 0?void 0:t.getItem(this.Fi(e)))!==null;return k("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Pe("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){Pe("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Mo(r){return We(r,"owner")}function Bu(r){return We(r,"clientMetadata")}function $p(r,e){let t=r.projectId;return r.isDefaultDatabase||(t+="."+r.database),"firestore/"+e+"/"+t+"/"}var $f=class r{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.qi=n,this.Qi=i}static Ki(e,t){let n=te(),i=te();for(let s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new r(e,t.fromCache,n,i)}};var zf=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Ec=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return Zl()?8:Bw(Ks())>0?6:4}()}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,n,i){let s={result:null};return this.ji(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,t,i,n).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new zf;return this.Ji(e,t,o).next(u=>{if(s.result=u,this.Ui)return this.Yi(e,t,o,u.size)})}).next(()=>s.result)}Yi(e,t,n,i){return n.documentReadCount<this.Wi?(Li()<=Gt.DEBUG&&k("QueryEngine","SDK will not create cache indexes for query:",Ui(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),C.resolve()):(Li()<=Gt.DEBUG&&k("QueryEngine","Query:",Ui(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Gi*i?(Li()<=Gt.DEBUG&&k("QueryEngine","The SDK decides to create cache indexes for query:",Ui(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ut(t))):C.resolve())}ji(e,t){if(Q_(t))return C.resolve(null);let n=ut(t);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=oc(t,null,"F"),n=ut(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{let o=te(...s);return this.zi.getDocuments(e,o).next(u=>this.indexManager.getMinOffset(e,n).next(c=>{let l=this.Zi(t,u);return this.Xi(t,l,o,c.readTime)?this.ji(e,oc(t,null,"F")):this.es(e,l,t,c)}))})))}Hi(e,t,n,i){return Q_(t)||i.isEqual(W.min())?C.resolve(null):this.zi.getDocuments(e,n).next(s=>{let o=this.Zi(t,s);return this.Xi(t,o,n,i)?C.resolve(null):(Li()<=Gt.DEBUG&&k("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ui(t)),this.es(e,o,t,Lw(i,-1)).next(u=>u))})}Zi(e,t){let n=new ye(oE(e));return t.forEach((i,s)=>{da(e,s)&&(n=n.add(s))}),n}Xi(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,t,n){return Li()<=Gt.DEBUG&&k("QueryEngine","Using full collection scan to execute query:",Ui(t)),this.zi.getDocumentsMatchingQuery(e,t,xt.min(),n)}es(e,t,n,i){return this.zi.getDocumentsMatchingQuery(e,n,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Gf=class{constructor(e,t,n,i){this.persistence=e,this.ts=t,this.serializer=i,this.ns=new Ie(Z),this.rs=new rn(s=>Lr(s),la),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(n)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new vc(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ns))}};function BE(r,e,t,n){return new Gf(r,e,t,n)}function qE(r,e){return P(this,null,function*(){let t=U(r);return yield t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,t._s(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{let o=[],u=[],c=te();for(let l of i){o.push(l.batchId);for(let f of l.mutations)c=c.add(f.key)}for(let l of s){u.push(l.batchId);for(let f of l.mutations)c=c.add(f.key)}return t.localDocuments.getDocuments(n,c).next(l=>({us:l,removedBatchIds:o,addedBatchIds:u}))})})})}function mR(r,e){let t=U(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{let i=e.batch.keys(),s=t.os.newChangeBuffer({trackRemovals:!0});return function(u,c,l,f){let p=l.batch,m=p.keys(),w=C.resolve();return m.forEach(x=>{w=w.next(()=>f.getEntry(c,x)).next(V=>{let D=l.docVersions.get(x);G(D!==null),V.version.compareTo(D)<0&&(p.applyToRemoteDocument(V,l),V.isValidDocument()&&(V.setReadTime(l.commitVersion),f.addEntry(V)))})}),w.next(()=>u.mutationQueue.removeMutationBatch(c,p))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(u){let c=te();for(let l=0;l<u.mutationResults.length;++l)u.mutationResults[l].transformResults.length>0&&(c=c.add(u.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}function $E(r){let e=U(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Qr.getLastRemoteSnapshotVersion(t))}function yR(r,e){let t=U(r),n=e.snapshotVersion,i=t.ns;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.os.newChangeBuffer({trackRemovals:!0});i=t.ns;let u=[];e.targetChanges.forEach((f,p)=>{let m=i.get(p);if(!m)return;u.push(t.Qr.removeMatchingKeys(s,f.removedDocuments,p).next(()=>t.Qr.addMatchingKeys(s,f.addedDocuments,p)));let w=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?w=w.withResumeToken(Ke.EMPTY_BYTE_STRING,W.min()).withLastLimboFreeSnapshotVersion(W.min()):f.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(f.resumeToken,n)),i=i.insert(p,w),function(V,D,N){return V.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-V.snapshotVersion.toMicroseconds()>=3e8?!0:N.addedDocuments.size+N.modifiedDocuments.size+N.removedDocuments.size>0}(m,w,f)&&u.push(t.Qr.updateTargetData(s,w))});let c=mt(),l=te();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(s,f))}),u.push(zE(s,o,e.documentUpdates).next(f=>{c=f.cs,l=f.ls})),!n.isEqual(W.min())){let f=t.Qr.getLastRemoteSnapshotVersion(s).next(p=>t.Qr.setTargetsMetadata(s,s.currentSequenceNumber,n));u.push(f)}return C.waitFor(u).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.ns=i,s))}function zE(r,e,t){let n=te(),i=te();return t.forEach(s=>n=n.add(s)),e.getEntries(r,n).next(s=>{let o=mt();return t.forEach((u,c)=>{let l=s.get(u);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(u)),c.isNoDocument()&&c.version.isEqual(W.min())?(e.removeEntry(u,c.readTime),o=o.insert(u,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(u,c)):k("LocalStore","Ignoring outdated watch update for ",u,". Current version:",l.version," Watch version:",c.version)}),{cs:o,ls:i}})}function vR(r,e){let t=U(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function ns(r,e){let t=U(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Qr.getTargetData(n,e).next(s=>s?(i=s,C.resolve(i)):t.Qr.allocateTargetId(n).next(o=>(i=new es(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Qr.addTargetData(n,i).next(()=>i))))}).then(n=>{let i=t.ns.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ns=t.ns.insert(n.targetId,n),t.rs.set(e,n.targetId)),n})}function rs(r,e,t){return P(this,null,function*(){let n=U(r),i=n.ns.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!ar(o))throw o;k("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.ns=n.ns.remove(e),n.rs.delete(i.target)})}function Ic(r,e,t){let n=U(r),i=W.min(),s=te();return n.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,f){let p=U(c),m=p.rs.get(f);return m!==void 0?C.resolve(p.ns.get(m)):p.Qr.getTargetData(l,f)}(n,o,ut(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,n.Qr.getMatchingKeysForTargetId(o,u.targetId).next(c=>{s=c})}).next(()=>n.ts.getDocumentsMatchingQuery(o,e,t?i:W.min(),t?s:te())).next(u=>(WE(n,sE(e),u),{documents:u,hs:s})))}function GE(r,e){let t=U(r),n=U(t.Qr),i=t.ns.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>n.ot(s,e).next(o=>o?o.target:null))}function KE(r,e){let t=U(r),n=t.ss.get(e)||W.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.os.getAllFromCollectionGroup(i,e,Lw(n,-1),Number.MAX_SAFE_INTEGER)).then(i=>(WE(t,e,i),i))}function WE(r,e,t){let n=r.ss.get(e)||W.min();t.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),r.ss.set(e,n)}function _R(r,e,t,n){return P(this,null,function*(){let i=U(r),s=te(),o=mt();for(let l of t){let f=e.Ps(l.metadata.name);l.document&&(s=s.add(f));let p=e.Is(l);p.setReadTime(e.Ts(l.metadata.readTime)),o=o.insert(f,p)}let u=i.os.newChangeBuffer({trackRemovals:!0}),c=yield ns(i,function(f){return ut(hs(oe.fromString(`__bundle__/docs/${f}`)))}(n));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>zE(l,u,o).next(f=>(u.apply(l),f)).next(f=>i.Qr.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.Qr.addMatchingKeys(l,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,f.cs,f.ls)).next(()=>f.cs)))})}function wR(n,i){return P(this,arguments,function*(r,e,t=te()){let s=yield ns(r,ut(Bp(e.bundledQuery))),o=U(r);return o.persistence.runTransaction("Save named query","readwrite",u=>{let c=Ve(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.$r.saveNamedQuery(u,e);let l=s.withResumeToken(Ke.EMPTY_BYTE_STRING,c);return o.ns=o.ns.insert(l.targetId,l),o.Qr.updateTargetData(u,l).next(()=>o.Qr.removeMatchingKeysForTargetId(u,s.targetId)).next(()=>o.Qr.addMatchingKeys(u,t,s.targetId)).next(()=>o.$r.saveNamedQuery(u,e))})})}function Tw(r,e){return`firestore_clients_${r}_${e}`}function Aw(r,e,t){let n=`firestore_mutations_${r}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}function Vd(r,e){return`firestore_targets_${r}_${e}`}var Tc=class r{constructor(e,t,n,i){this.user=e,this.batchId=t,this.state=n,this.error=i}static Es(e,t,n){let i=JSON.parse(n),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new M(i.error.code,i.error.message))),o?new r(e,t,i.state,s):(Pe("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Uo=class r{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Es(e,t){let n=JSON.parse(t),i,s=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object");return s&&n.error&&(s=typeof n.error.message=="string"&&typeof n.error.code=="string",s&&(i=new M(n.error.code,n.error.message))),s?new r(e,n.state,i):(Pe("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Ac=class r{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Es(e,t){let n=JSON.parse(t),i=typeof n=="object"&&n.activeTargetIds instanceof Array,s=Up();for(let o=0;i&&o<n.activeTargetIds.length;++o)i=qw(n.activeTargetIds[o]),s=s.add(n.activeTargetIds[o]);return i?new r(e,s):(Pe("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},Kf=class r{constructor(e,t){this.clientId=e,this.onlineState=t}static Es(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new r(t.clientId,t.onlineState):(Pe("SharedClientState",`Failed to parse online state: ${e}`),null)}},na=class{constructor(){this.activeTargetIds=Up()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},jo=class{constructor(e,t,n,i,s){this.window=e,this.oi=t,this.persistenceKey=n,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new Ie(Z),this.started=!1,this.ys=[];let o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=Tw(this.persistenceKey,this.Vs),this.Ss=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new na),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Fs=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return P(this,null,function*(){let e=yield this.syncEngine.Bi();for(let n of e){if(n===this.Vs)continue;let i=this.getItem(Tw(this.persistenceKey,n));if(i){let s=Ac.Es(n,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let t=this.storage.getItem(this.vs);if(t){let n=this.xs(t);n&&this.Os(n)}for(let n of this.ys)this.gs(n);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let t=!1;return this.ps.forEach((n,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,t,n){this.Ls(e,t,n),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){let n=this.storage.getItem(Vd(this.persistenceKey,e));if(n){let i=Uo.Es(e,n);i&&(t=i.state)}}return this.ks.As(e),this.Ms(),t}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Vd(this.persistenceKey,e))}updateQueryState(e,t,n){this.qs(e,t,n)}handleUserChange(e,t,n){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,n.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return k("SharedClientState","READ",e,t),t}setItem(e,t){k("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){k("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let t=e;if(t.storageArea===this.storage){if(k("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ws)return void Pe("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>P(this,null,function*(){if(this.started){if(t.key!==null){if(this.bs.test(t.key)){if(t.newValue==null){let n=this.$s(t.key);return this.Us(n,null)}{let n=this.Ws(t.key,t.newValue);if(n)return this.Us(n.clientId,n)}}else if(this.Ds.test(t.key)){if(t.newValue!==null){let n=this.Gs(t.key,t.newValue);if(n)return this.zs(n)}}else if(this.Cs.test(t.key)){if(t.newValue!==null){let n=this.js(t.key,t.newValue);if(n)return this.Hs(n)}}else if(t.key===this.vs){if(t.newValue!==null){let n=this.xs(t.newValue);if(n)return this.Os(n)}}else if(t.key===this.Ss){let n=function(s){let o=Et.oe;if(s!=null)try{let u=JSON.parse(s);G(typeof u=="number"),o=u}catch(u){Pe("SharedClientState","Failed to read sequence number from WebStorage",u)}return o}(t.newValue);n!==Et.oe&&this.sequenceNumberHandler(n)}else if(t.key===this.Fs){let n=this.Js(t.newValue);yield Promise.all(n.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(t)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,t,n){let i=new Tc(this.currentUser,e,t,n),s=Aw(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Bs(e){let t=Aw(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Qs(e){let t={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(t))}qs(e,t,n){let i=Vd(this.persistenceKey,e),s=new Uo(e,t,n);this.setItem(i,s.ds())}Ks(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Fs,t)}$s(e){let t=this.bs.exec(e);return t?t[1]:null}Ws(e,t){let n=this.$s(e);return Ac.Es(n,t)}Gs(e,t){let n=this.Ds.exec(e),i=Number(n[1]),s=n[2]!==void 0?n[2]:null;return Tc.Es(new Oe(s),i,t)}js(e,t){let n=this.Cs.exec(e),i=Number(n[1]);return Uo.Es(i,t)}xs(e){return Kf.Es(e)}Js(e){return JSON.parse(e)}zs(e){return P(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);k("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,t){let n=t?this.ps.insert(e,t):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(n),o=[],u=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||u.push(c)}),this.syncEngine.eo(o,u).then(()=>{this.ps=n})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let t=Up();return e.forEach((n,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},bc=class{constructor(){this.no=new na,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,n){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new na,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Wf=class{io(e){}shutdown(){}};var Cc=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){k("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){k("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var qu=null;function Md(){return qu===null?qu=function(){return 268435456+Math.round(2147483648*Math.random())}():qu++,"0x"+qu.toString(16)}var ER={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Hf=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}};var tt="WebChannelConnection",Qf=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let n=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.wo=n+"://"+t.host,this.So=`projects/${i}/databases/${s}`,this.bo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Do(){return!1}Co(t,n,i,s,o){let u=Md(),c=this.vo(t,n.toUriEncodedString());k("RestConnection",`Sending RPC '${t}' ${u}:`,c,i);let l={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(l,s,o),this.Mo(t,c,l,i).then(f=>(k("RestConnection",`Received RPC '${t}' ${u}: `,f),f),f=>{throw Pt("RestConnection",`RPC '${t}' ${u} failed with error: `,f,"url: ",c,"request:",i),f})}xo(t,n,i,s,o,u){return this.Co(t,n,i,s,o)}Fo(t,n,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ls}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}vo(t,n){let i=ER[t];return`${this.wo}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,t,n,i){let s=Md();return new Promise((o,u)=>{let c=new Ad;c.setWithCredentials(!0),c.listenOnce(Cd.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Do.NO_ERROR:let f=c.getResponseJson();k(tt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),o(f);break;case Do.TIMEOUT:k(tt,`RPC '${e}' ${s} timed out`),u(new M(R.DEADLINE_EXCEEDED,"Request time out"));break;case Do.HTTP_ERROR:let p=c.getStatus();if(k(tt,`RPC '${e}' ${s} failed with status:`,p,"response text:",c.getResponseText()),p>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);let w=m?.error;if(w&&w.status&&w.message){let x=function(D){let N=D.toLowerCase().replace(/_/g,"-");return Object.values(R).indexOf(N)>=0?N:R.UNKNOWN}(w.status);u(new M(x,w.message))}else u(new M(R.UNKNOWN,"Server responded with status "+c.getStatus()))}else u(new M(R.UNAVAILABLE,"Connection failed."));break;default:q()}}finally{k(tt,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);k(tt,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",l,n,15)})}Oo(e,t,n){let i=Md(),s=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Dd(),u=Rd(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new bd({})),this.Fo(c.initMessageHeaders,t,n),c.encodeInitMessageHeaders=!0;let f=s.join("");k(tt,`Creating RPC '${e}' stream ${i}: ${f}`,c);let p=o.createWebChannel(f,c),m=!1,w=!1,x=new Hf({lo:D=>{w?k(tt,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(m||(k(tt,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),k(tt,`RPC '${e}' stream ${i} sending:`,D),p.send(D))},ho:()=>p.close()}),V=(D,N,z)=>{D.listen(N,F=>{try{z(F)}catch($){setTimeout(()=>{throw $},0)}})};return V(p,Mi.EventType.OPEN,()=>{w||(k(tt,`RPC '${e}' stream ${i} transport opened.`),x.mo())}),V(p,Mi.EventType.CLOSE,()=>{w||(w=!0,k(tt,`RPC '${e}' stream ${i} transport closed`),x.po())}),V(p,Mi.EventType.ERROR,D=>{w||(w=!0,Pt(tt,`RPC '${e}' stream ${i} transport errored:`,D),x.po(new M(R.UNAVAILABLE,"The operation could not be completed")))}),V(p,Mi.EventType.MESSAGE,D=>{var N;if(!w){let z=D.data[0];G(!!z);let F=z,$=F.error||((N=F[0])===null||N===void 0?void 0:N.error);if($){k(tt,`RPC '${e}' stream ${i} received error:`,$);let X=$.status,Y=function(_){let I=ke[_];if(I!==void 0)return wE(I)}(X),E=$.message;Y===void 0&&(Y=R.INTERNAL,E="Unknown error status: "+X+" with message "+$.message),w=!0,x.po(new M(Y,E)),p.close()}else k(tt,`RPC '${e}' stream ${i} received:`,z),x.yo(z)}}),V(u,Sd.STAT_EVENT,D=>{D.stat===Lu.PROXY?k(tt,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===Lu.NOPROXY&&k(tt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{x.fo()},0),x}};function HE(){return typeof window<"u"?window:null}function Wu(){return typeof document<"u"?document:null}function fa(r){return new df(r,!0)}var ra=class{constructor(e,t,n=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=t,this.No=n,this.Lo=i,this.Bo=s,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();let t=Math.floor(this.ko+this.Uo()),n=Math.max(0,Date.now()-this.Qo),i=Math.max(0,t-n);i>0&&k("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.ko} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}};var Sc=class{constructor(e,t,n,i,s,o,u,c){this.oi=e,this.Go=n,this.zo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=c,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new ra(e,t)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}stop(){return P(this,null,function*(){this.Zo()&&(yield this.close(0))})}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}r_(){return P(this,null,function*(){if(this.Xo())return this.close(0)})}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}close(e,t){return P(this,null,function*(){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():t&&t.code===R.RESOURCE_EXHAUSTED?(Pe(t.toString()),Pe("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):t&&t.code===R.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Ao(t)})}__(){}auth(){this.state=1;let e=this.a_(this.jo),t=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.jo===t&&this.u_(n,i)},n=>{e(()=>{let i=new M(R.UNKNOWN,"Fetching auth token failed: "+n.message);return this.c_(i)})})}u_(e,t){let n=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po(()=>{n(()=>this.listener.Po())}),this.stream.To(()=>{n(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(i=>{n(()=>this.c_(i))}),this.stream.onMessage(i=>{n(()=>this.onMessage(i))})}e_(){this.state=5,this.Yo.$o(()=>P(this,null,function*(){this.state=0,this.start()}))}c_(e){return k("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return t=>{this.oi.enqueueAndForget(()=>this.jo===e?t():(k("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Xf=class extends Sc{constructor(e,t,n,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s}l_(e,t){return this.connection.Oo("Listen",e,t)}onMessage(e){this.Yo.reset();let t=sR(this.serializer,e),n=function(s){if(!("targetChange"in s))return W.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?W.min():o.readTime?Ve(o.readTime):W.min()}(e);return this.listener.h_(t,n)}P_(e){let t={};t.database=gf(this.serializer),t.addTarget=function(s,o){let u,c=o.target;if(u=ic(c)?{documents:RE(s,c)}:{query:DE(s,c)._t},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=IE(s,o.resumeToken);let l=ff(s,o.expectedCount);l!==null&&(u.expectedCount=l)}else if(o.snapshotVersion.compareTo(W.min())>0){u.readTime=Zi(s,o.snapshotVersion.toTimestamp());let l=ff(s,o.expectedCount);l!==null&&(u.expectedCount=l)}return u}(this.serializer,e);let n=aR(this.serializer,e);n&&(t.labels=n),this.i_(t)}I_(e){let t={};t.database=gf(this.serializer),t.removeTarget=e,this.i_(t)}},Jf=class extends Sc{constructor(e,t,n,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,t){return this.connection.Oo("Write",e,t)}onMessage(e){if(G(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();let t=oR(e.writeResults,e.commitTime),n=Ve(e.commitTime);return this.listener.A_(n,t)}return G(!e.writeResults||e.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){let e={};e.database=gf(this.serializer),this.i_(e)}d_(e){let t={streamToken:this.lastStreamToken,writes:e.map(n=>Zo(this.serializer,n))};this.i_(t)}};var Yf=class extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.m_=!1}f_(){if(this.m_)throw new M(R.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,t,n,i){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,pf(t,n),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new M(R.UNKNOWN,s.toString())})}xo(e,t,n,i,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.xo(e,pf(t,n),i,o,u,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new M(R.UNKNOWN,o.toString())})}terminate(){this.m_=!0,this.connection.terminate()}},Zf=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(Pe(t),this.y_=!1):k("OnlineStateTracker",t)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}};var ep=class{constructor(e,t,n,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.io(o=>{n.enqueueAndForget(()=>P(this,null,function*(){ur(this)&&(k("RemoteStore","Restarting streams for network reachability change."),yield function(c){return P(this,null,function*(){let l=U(c);l.M_.add(4),yield ds(l),l.N_.set("Unknown"),l.M_.delete(4),yield pa(l)})}(this))}))}),this.N_=new Zf(n,i)}};function pa(r){return P(this,null,function*(){if(ur(r))for(let e of r.x_)yield e(!0)})}function ds(r){return P(this,null,function*(){for(let e of r.x_)yield e(!1)})}function Kc(r,e){let t=U(r);t.F_.has(e.targetId)||(t.F_.set(e.targetId,e),Kp(t)?Gp(t):ps(t).Xo()&&zp(t,e))}function is(r,e){let t=U(r),n=ps(t);t.F_.delete(e),n.Xo()&&QE(t,e),t.F_.size===0&&(n.Xo()?n.n_():ur(t)&&t.N_.set("Unknown"))}function zp(r,e){if(r.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(W.min())>0){let t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ps(r).P_(e)}function QE(r,e){r.L_.xe(e),ps(r).I_(e)}function Gp(r){r.L_=new hf({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>r.F_.get(e)||null,tt:()=>r.datastore.serializer.databaseId}),ps(r).start(),r.N_.w_()}function Kp(r){return ur(r)&&!ps(r).Zo()&&r.F_.size>0}function ur(r){return U(r).M_.size===0}function XE(r){r.L_=void 0}function IR(r){return P(this,null,function*(){r.N_.set("Online")})}function TR(r){return P(this,null,function*(){r.F_.forEach((e,t)=>{zp(r,e)})})}function AR(r,e){return P(this,null,function*(){XE(r),Kp(r)?(r.N_.D_(e),Gp(r)):r.N_.set("Unknown")})}function bR(r,e,t){return P(this,null,function*(){if(r.N_.set("Online"),e instanceof uc&&e.state===2&&e.cause)try{yield function(i,s){return P(this,null,function*(){let o=s.cause;for(let u of s.targetIds)i.F_.has(u)&&(yield i.remoteSyncer.rejectListen(u,o),i.F_.delete(u),i.L_.removeTarget(u))})}(r,e)}catch(n){k("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),yield Rc(r,n)}else if(e instanceof Ki?r.L_.Ke(e):e instanceof ac?r.L_.He(e):r.L_.We(e),!t.isEqual(W.min()))try{let n=yield $E(r.localStore);t.compareTo(n)>=0&&(yield function(s,o){let u=s.L_.rt(o);return u.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let f=s.F_.get(l);f&&s.F_.set(l,f.withResumeToken(c.resumeToken,o))}}),u.targetMismatches.forEach((c,l)=>{let f=s.F_.get(c);if(!f)return;s.F_.set(c,f.withResumeToken(Ke.EMPTY_BYTE_STRING,f.snapshotVersion)),QE(s,c);let p=new es(f.target,c,l,f.sequenceNumber);zp(s,p)}),s.remoteSyncer.applyRemoteEvent(u)}(r,t))}catch(n){k("RemoteStore","Failed to raise snapshot:",n),yield Rc(r,n)}})}function Rc(r,e,t){return P(this,null,function*(){if(!ar(e))throw e;r.M_.add(1),yield ds(r),r.N_.set("Offline"),t||(t=()=>$E(r.localStore)),r.asyncQueue.enqueueRetryable(()=>P(this,null,function*(){k("RemoteStore","Retrying IndexedDB access"),yield t(),r.M_.delete(1),yield pa(r)}))})}function JE(r,e){return e().catch(t=>Rc(r,t,e))}function fs(r){return P(this,null,function*(){let e=U(r),t=sr(e),n=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;CR(e);)try{let i=yield vR(e.localStore,n);if(i===null){e.v_.length===0&&t.n_();break}n=i.batchId,SR(e,i)}catch(i){yield Rc(e,i)}YE(e)&&ZE(e)})}function CR(r){return ur(r)&&r.v_.length<10}function SR(r,e){r.v_.push(e);let t=sr(r);t.Xo()&&t.E_&&t.d_(e.mutations)}function YE(r){return ur(r)&&!sr(r).Zo()&&r.v_.length>0}function ZE(r){sr(r).start()}function RR(r){return P(this,null,function*(){sr(r).V_()})}function DR(r){return P(this,null,function*(){let e=sr(r);for(let t of r.v_)e.d_(t.mutations)})}function PR(r,e,t){return P(this,null,function*(){let n=r.v_.shift(),i=uf.from(n,e,t);yield JE(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),yield fs(r)})}function xR(r,e){return P(this,null,function*(){e&&sr(r).E_&&(yield function(n,i){return P(this,null,function*(){if(function(o){return _E(o)&&o!==R.ABORTED}(i.code)){let s=n.v_.shift();sr(n).t_(),yield JE(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield fs(n)}})}(r,e)),YE(r)&&ZE(r)})}function bw(r,e){return P(this,null,function*(){let t=U(r);t.asyncQueue.verifyOperationInProgress(),k("RemoteStore","RemoteStore received new credentials");let n=ur(t);t.M_.add(3),yield ds(t),n&&t.N_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.M_.delete(3),yield pa(t)})}function tp(r,e){return P(this,null,function*(){let t=U(r);e?(t.M_.delete(2),yield pa(t)):e||(t.M_.add(2),yield ds(t),t.N_.set("Unknown"))})}function ps(r){return r.B_||(r.B_=function(t,n,i){let s=U(t);return s.f_(),new Xf(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{Po:IR.bind(null,r),To:TR.bind(null,r),Ao:AR.bind(null,r),h_:bR.bind(null,r)}),r.x_.push(e=>P(this,null,function*(){e?(r.B_.t_(),Kp(r)?Gp(r):r.N_.set("Unknown")):(yield r.B_.stop(),XE(r))}))),r.B_}function sr(r){return r.k_||(r.k_=function(t,n,i){let s=U(t);return s.f_(),new Jf(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{Po:()=>Promise.resolve(),To:RR.bind(null,r),Ao:xR.bind(null,r),R_:DR.bind(null,r),A_:PR.bind(null,r)}),r.x_.push(e=>P(this,null,function*(){e?(r.k_.t_(),yield fs(r)):(yield r.k_.stop(),r.v_.length>0&&(k("RemoteStore",`Stopping write stream with ${r.v_.length} pending writes`),r.v_=[]))}))),r.k_}var np=class r{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Fe,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,s){let o=Date.now()+n,u=new r(e,t,o,i,s);return u.start(n),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new M(R.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function gs(r,e){if(Pe("AsyncQueue",`${e}: ${r}`),ar(r))return new M(R.UNAVAILABLE,`${e}: ${r}`);throw r}var Dc=class r{constructor(e){this.comparator=e?(t,n)=>e(t,n)||L.comparator(t.key,n.key):(t,n)=>L.comparator(t.key,n.key),this.keyedMap=ko(),this.sortedSet=new Ie(this.comparator)}static emptySet(e){return new r(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof r)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let n=new r;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}};var Pc=class{constructor(){this.q_=new Ie(L.comparator)}track(e){let t=e.doc.key,n=this.q_.get(t);n?e.type!==0&&n.type===3?this.q_=this.q_.insert(t,e):e.type===3&&n.type!==1?this.q_=this.q_.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.q_=this.q_.remove(t):e.type===1&&n.type===2?this.q_=this.q_.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):q():this.q_=this.q_.insert(t,e)}Q_(){let e=[];return this.q_.inorderTraversal((t,n)=>{e.push(n)}),e}},ss=class r{constructor(e,t,n,i,s,o,u,c,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,i,s){let o=[];return t.forEach(u=>{o.push({type:0,doc:u})}),new r(e,t,Dc.emptySet(t),o,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ha(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}};var rp=class{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}},ip=class{constructor(){this.queries=new rn(e=>iE(e),ha),this.onlineState="Unknown",this.z_=new Set}};function Wp(r,e){return P(this,null,function*(){let t=U(r),n=3,i=e.query,s=t.queries.get(i);s?!s.W_()&&e.G_()&&(n=2):(s=new rp,n=e.G_()?0:1);try{switch(n){case 0:s.K_=yield t.onListen(i,!0);break;case 1:s.K_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let u=gs(o,`Initialization of query '${Ui(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,s),s.U_.push(e),e.j_(t.onlineState),s.K_&&e.H_(s.K_)&&Qp(t)})}function Hp(r,e){return P(this,null,function*(){let t=U(r),n=e.query,i=3,s=t.queries.get(n);if(s){let o=s.U_.indexOf(e);o>=0&&(s.U_.splice(o,1),s.U_.length===0?i=e.G_()?0:1:!s.W_()&&e.G_()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}})}function VR(r,e){let t=U(r),n=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let u of o.U_)u.H_(i)&&(n=!0);o.K_=i}}n&&Qp(t)}function MR(r,e,t){let n=U(r),i=n.queries.get(e);if(i)for(let s of i.U_)s.onError(t);n.queries.delete(e)}function Qp(r){r.z_.forEach(e=>{e.next()})}var sp,Cw;(Cw=sp||(sp={})).J_="default",Cw.Cache="cache";var ia=class{constructor(e,t,n){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=n||{}}H_(e){if(!this.options.includeMetadataChanges){let n=[];for(let i of e.docChanges)i.type!==3&&n.push(i);e=new ss(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){if(!e.fromCache||!this.G_())return!0;let n=t!=="Offline";return(!this.options.ra||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ea(e){if(e.docChanges.length>0)return!0;let t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}na(e){e=ss.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==sp.Cache}};var op=class{constructor(e,t){this.ia=e,this.byteLength=t}sa(){return"metadata"in this.ia}};var xc=class{constructor(e){this.serializer=e}Ps(e){return Zt(this.serializer,e)}Is(e){return e.metadata.exists?SE(this.serializer,e.document,!1):Le.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return Ve(e)}},ap=class{constructor(e,t,n){this.oa=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=eI(e)}_a(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++t;let n=oe.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}aa(e){let t=new Map,n=new xc(this.serializer);for(let i of e)if(i.metadata.queries){let s=n.Ps(i.metadata.name);for(let o of i.metadata.queries){let u=(t.get(o)||te()).add(s);t.set(o,u)}}return t}complete(){return P(this,null,function*(){let e=yield _R(this.localStore,new xc(this.serializer),this.documents,this.oa.id),t=this.aa(this.documents);for(let n of this.queries)yield wR(this.localStore,n,t.get(n.name));return this.progress.taskState="Success",{progress:this.progress,ua:this.collectionGroups,ca:e}})}};function eI(r){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:r.totalDocuments,totalBytes:r.totalBytes}}var Vc=class{constructor(e){this.key=e}},Mc=class{constructor(e){this.key=e}},kc=class{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=te(),this.mutatedKeys=te(),this.Ia=oE(e),this.Ta=new Dc(this.Ia)}get Ea(){return this.la}da(e,t){let n=t?t.Aa:new Pc,i=t?t.Ta:this.Ta,s=t?t.mutatedKeys:this.mutatedKeys,o=i,u=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,p)=>{let m=i.get(f),w=da(this.query,p)?p:null,x=!!m&&this.mutatedKeys.has(m.key),V=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations),D=!1;m&&w?m.data.isEqual(w.data)?x!==V&&(n.track({type:3,doc:w}),D=!0):this.Ra(m,w)||(n.track({type:2,doc:w}),D=!0,(c&&this.Ia(w,c)>0||l&&this.Ia(w,l)<0)&&(u=!0)):!m&&w?(n.track({type:0,doc:w}),D=!0):m&&!w&&(n.track({type:1,doc:m}),D=!0,(c||l)&&(u=!0)),D&&(w?(o=o.add(w),s=V?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{Ta:o,Aa:n,Xi:u,mutatedKeys:s}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){let s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;let o=e.Aa.Q_();o.sort((f,p)=>function(w,x){let V=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return q()}};return V(w)-V(x)}(f.type,p.type)||this.Ia(f.doc,p.doc)),this.Va(n),i=i!=null&&i;let u=t&&!i?this.ma():[],c=this.Pa.size===0&&this.current&&!i?1:0,l=c!==this.ha;return this.ha=c,o.length!==0||l?{snapshot:new ss(this.query,e.Ta,s,o,e.mutatedKeys,c===0,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),fa:u}:{fa:u}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new Pc,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(t=>this.la=this.la.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.la=this.la.delete(t)),this.current=e.current)}ma(){if(!this.current)return[];let e=this.Pa;this.Pa=te(),this.Ta.forEach(n=>{this.ga(n.key)&&(this.Pa=this.Pa.add(n.key))});let t=[];return e.forEach(n=>{this.Pa.has(n)||t.push(new Mc(n))}),this.Pa.forEach(n=>{e.has(n)||t.push(new Vc(n))}),t}pa(e){this.la=e.hs,this.Pa=te();let t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return ss.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}},up=class{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}},cp=class{constructor(e){this.key=e,this.wa=!1}},lp=class{constructor(e,t,n,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new rn(u=>iE(u),ha),this.Da=new Map,this.Ca=new Set,this.va=new Ie(L.comparator),this.Fa=new Map,this.Ma=new ta,this.xa={},this.Oa=new Map,this.Na=ts.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}};function kR(r,e,t=!0){return P(this,null,function*(){let n=Wc(r),i,s=n.ba.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ya()):i=yield tI(n,e,t,!0),i})}function NR(r,e){return P(this,null,function*(){let t=Wc(r);yield tI(t,e,!0,!1)})}function tI(r,e,t,n){return P(this,null,function*(){let i=yield ns(r.localStore,ut(e)),s=i.targetId,o=t?r.sharedClientState.addLocalQueryTarget(s):"not-current",u;return n&&(u=yield Xp(r,e,s,o==="current",i.resumeToken)),r.isPrimaryClient&&t&&Kc(r.remoteStore,i),u})}function Xp(r,e,t,n,i){return P(this,null,function*(){r.Ba=(p,m,w)=>function(V,D,N,z){return P(this,null,function*(){let F=D.view.da(N);F.Xi&&(F=yield Ic(V.localStore,D.query,!1).then(({documents:E})=>D.view.da(E,F)));let $=z&&z.targetChanges.get(D.targetId),X=z&&z.targetMismatches.get(D.targetId)!=null,Y=D.view.applyChanges(F,V.isPrimaryClient,$,X);return hp(V,D.targetId,Y.fa),Y.snapshot})}(r,p,m,w);let s=yield Ic(r.localStore,e,!0),o=new kc(e,s.hs),u=o.da(s.documents),c=Jo.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),l=o.applyChanges(u,r.isPrimaryClient,c);hp(r,t,l.fa);let f=new up(e,t,o);return r.ba.set(e,f),r.Da.has(t)?r.Da.get(t).push(e):r.Da.set(t,[e]),l.snapshot})}function OR(r,e,t){return P(this,null,function*(){let n=U(r),i=n.ba.get(e),s=n.Da.get(i.targetId);if(s.length>1)return n.Da.set(i.targetId,s.filter(o=>!ha(o,e))),void n.ba.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||(yield rs(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),t&&is(n.remoteStore,i.targetId),os(n,i.targetId)}).catch(or))):(os(n,i.targetId),yield rs(n.localStore,i.targetId,!0))})}function FR(r,e){return P(this,null,function*(){let t=U(r),n=t.ba.get(e),i=t.Da.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),is(t.remoteStore,n.targetId))})}function LR(r,e,t){return P(this,null,function*(){let n=eg(r);try{let i=yield function(o,u){let c=U(o),l=be.now(),f=u.reduce((w,x)=>w.add(x.key),te()),p,m;return c.persistence.runTransaction("Locally write mutations","readwrite",w=>{let x=mt(),V=te();return c.os.getEntries(w,f).next(D=>{x=D,x.forEach((N,z)=>{z.isValidDocument()||(V=V.add(N))})}).next(()=>c.localDocuments.getOverlayedDocuments(w,x)).next(D=>{p=D;let N=[];for(let z of u){let F=YS(z,p.get(z.key).overlayedDocument);F!=null&&N.push(new Ut(z.key,F,Jw(F.value.mapValue),De.exists(!0)))}return c.mutationQueue.addMutationBatch(w,l,N,u)}).next(D=>{m=D;let N=D.applyToLocalDocumentSet(p,V);return c.documentOverlayCache.saveOverlays(w,D.batchId,N)})}).then(()=>({batchId:m.batchId,changes:uE(p)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(o,u,c){let l=o.xa[o.currentUser.toKey()];l||(l=new Ie(Z)),l=l.insert(u,c),o.xa[o.currentUser.toKey()]=l}(n,i.batchId,t),yield wn(n,i.changes),yield fs(n.remoteStore)}catch(i){let s=gs(i,"Failed to persist write");t.reject(s)}})}function nI(r,e){return P(this,null,function*(){let t=U(r);try{let n=yield yR(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Fa.get(s);o&&(G(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.wa=!0:i.modifiedDocuments.size>0?G(o.wa):i.removedDocuments.size>0&&(G(o.wa),o.wa=!1))}),yield wn(t,n,e)}catch(n){yield or(n)}})}function Sw(r,e,t){let n=U(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){let i=[];n.ba.forEach((s,o)=>{let u=o.view.j_(e);u.snapshot&&i.push(u.snapshot)}),function(o,u){let c=U(o);c.onlineState=u;let l=!1;c.queries.forEach((f,p)=>{for(let m of p.U_)m.j_(u)&&(l=!0)}),l&&Qp(c)}(n.eventManager,e),i.length&&n.Sa.h_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function UR(r,e,t){return P(this,null,function*(){let n=U(r);n.sharedClientState.updateQueryState(e,"rejected",t);let i=n.Fa.get(e),s=i&&i.key;if(s){let o=new Ie(L.comparator);o=o.insert(s,Le.newNoDocument(s,W.min()));let u=te().add(s),c=new Xo(W.min(),new Map,new Ie(Z),o,u);yield nI(n,c),n.va=n.va.remove(s),n.Fa.delete(e),Zp(n)}else yield rs(n.localStore,e,!1).then(()=>os(n,e,t)).catch(or)})}function jR(r,e){return P(this,null,function*(){let t=U(r),n=e.batch.batchId;try{let i=yield mR(t.localStore,e);Yp(t,n,null),Jp(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),yield wn(t,i)}catch(i){yield or(i)}})}function BR(r,e,t){return P(this,null,function*(){let n=U(r);try{let i=yield function(o,u){let c=U(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let f;return c.mutationQueue.lookupMutationBatch(l,u).next(p=>(G(p!==null),f=p.keys(),c.mutationQueue.removeMutationBatch(l,p))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,f,u)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,f)).next(()=>c.localDocuments.getDocuments(l,f))})}(n.localStore,e);Yp(n,e,t),Jp(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),yield wn(n,i)}catch(i){yield or(i)}})}function qR(r,e){return P(this,null,function*(){let t=U(r);ur(t.remoteStore)||k("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let n=yield function(o){let u=U(o);return u.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>u.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(n===-1)return void e.resolve();let i=t.Oa.get(n)||[];i.push(e),t.Oa.set(n,i)}catch(n){let i=gs(n,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function Jp(r,e){(r.Oa.get(e)||[]).forEach(t=>{t.resolve()}),r.Oa.delete(e)}function Yp(r,e,t){let n=U(r),i=n.xa[n.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.xa[n.currentUser.toKey()]=i}}function os(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(let n of r.Da.get(e))r.ba.delete(n),t&&r.Sa.ka(n,t);r.Da.delete(e),r.isPrimaryClient&&r.Ma.Vr(e).forEach(n=>{r.Ma.containsKey(n)||rI(r,n)})}function rI(r,e){r.Ca.delete(e.path.canonicalString());let t=r.va.get(e);t!==null&&(is(r.remoteStore,t),r.va=r.va.remove(e),r.Fa.delete(t),Zp(r))}function hp(r,e,t){for(let n of t)n instanceof Vc?(r.Ma.addReference(n.key,e),$R(r,n)):n instanceof Mc?(k("SyncEngine","Document no longer in limbo: "+n.key),r.Ma.removeReference(n.key,e),r.Ma.containsKey(n.key)||rI(r,n.key)):q()}function $R(r,e){let t=e.key,n=t.path.canonicalString();r.va.get(t)||r.Ca.has(n)||(k("SyncEngine","New document in limbo: "+t),r.Ca.add(n),Zp(r))}function Zp(r){for(;r.Ca.size>0&&r.va.size<r.maxConcurrentLimboResolutions;){let e=r.Ca.values().next().value;r.Ca.delete(e);let t=new L(oe.fromString(e)),n=r.Na.next();r.Fa.set(n,new cp(t)),r.va=r.va.insert(t,n),Kc(r.remoteStore,new es(ut(hs(t.path)),n,"TargetPurposeLimboResolution",Et.oe))}}function wn(r,e,t){return P(this,null,function*(){let n=U(r),i=[],s=[],o=[];n.ba.isEmpty()||(n.ba.forEach((u,c)=>{o.push(n.Ba(c,e,t).then(l=>{var f;if((l||t)&&n.isPrimaryClient){let p=l?!l.fromCache:(f=t?.targetChanges.get(c.targetId))===null||f===void 0?void 0:f.current;n.sharedClientState.updateQueryState(c.targetId,p?"current":"not-current")}if(l){i.push(l);let p=$f.Ki(c.targetId,l);s.push(p)}}))}),yield Promise.all(o),n.Sa.h_(i),yield function(c,l){return P(this,null,function*(){let f=U(c);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>C.forEach(l,m=>C.forEach(m.qi,w=>f.persistence.referenceDelegate.addReference(p,m.targetId,w)).next(()=>C.forEach(m.Qi,w=>f.persistence.referenceDelegate.removeReference(p,m.targetId,w)))))}catch(p){if(!ar(p))throw p;k("LocalStore","Failed to update sequence numbers: "+p)}for(let p of l){let m=p.targetId;if(!p.fromCache){let w=f.ns.get(m),x=w.snapshotVersion,V=w.withLastLimboFreeSnapshotVersion(x);f.ns=f.ns.insert(m,V)}}})}(n.localStore,s))})}function zR(r,e){return P(this,null,function*(){let t=U(r);if(!t.currentUser.isEqual(e)){k("SyncEngine","User change. New user:",e.toKey());let n=yield qE(t.localStore,e);t.currentUser=e,function(s,o){s.Oa.forEach(u=>{u.forEach(c=>{c.reject(new M(R.CANCELLED,o))})}),s.Oa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),yield wn(t,n.us)}})}function GR(r,e){let t=U(r),n=t.Fa.get(e);if(n&&n.wa)return te().add(n.key);{let i=te(),s=t.Da.get(e);if(!s)return i;for(let o of s){let u=t.ba.get(o);i=i.unionWith(u.view.Ea)}return i}}function KR(r,e){return P(this,null,function*(){let t=U(r),n=yield Ic(t.localStore,e.query,!0),i=e.view.pa(n);return t.isPrimaryClient&&hp(t,e.targetId,i.fa),i})}function WR(r,e){return P(this,null,function*(){let t=U(r);return KE(t.localStore,e).then(n=>wn(t,n))})}function HR(r,e,t,n){return P(this,null,function*(){let i=U(r),s=yield function(u,c){let l=U(u),f=U(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",p=>f.vn(p,c).next(m=>m?l.localDocuments.getDocuments(p,m):C.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?yield fs(i.remoteStore):t==="acknowledged"||t==="rejected"?(Yp(i,e,n||null),Jp(i,e),function(u,c){U(U(u).mutationQueue).Mn(c)}(i.localStore,e)):q(),yield wn(i,s)):k("SyncEngine","Cannot apply mutation batch with id: "+e)})}function QR(r,e){return P(this,null,function*(){let t=U(r);if(Wc(t),eg(t),e===!0&&t.La!==!0){let n=t.sharedClientState.getAllActiveQueryTargets(),i=yield Rw(t,n.toArray());t.La=!0,yield tp(t.remoteStore,!0);for(let s of i)Kc(t.remoteStore,s)}else if(e===!1&&t.La!==!1){let n=[],i=Promise.resolve();t.Da.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?n.push(o):i=i.then(()=>(os(t,o),rs(t.localStore,o,!0))),is(t.remoteStore,o)}),yield i,yield Rw(t,n),function(o){let u=U(o);u.Fa.forEach((c,l)=>{is(u.remoteStore,l)}),u.Ma.mr(),u.Fa=new Map,u.va=new Ie(L.comparator)}(t),t.La=!1,yield tp(t.remoteStore,!1)}})}function Rw(r,e,t){return P(this,null,function*(){let n=U(r),i=[],s=[];for(let o of e){let u,c=n.Da.get(o);if(c&&c.length!==0){u=yield ns(n.localStore,ut(c[0]));for(let l of c){let f=n.ba.get(l),p=yield KR(n,f);p.snapshot&&s.push(p.snapshot)}}else{let l=yield GE(n.localStore,o);u=yield ns(n.localStore,l),yield Xp(n,iI(l),o,!1,u.resumeToken)}i.push(u)}return n.Sa.h_(s),i})}function iI(r){return rE(r.path,r.collectionGroup,r.orderBy,r.filters,r.limit,"F",r.startAt,r.endAt)}function XR(r){return function(t){return U(U(t).persistence).Bi()}(U(r).localStore)}function JR(r,e,t,n){return P(this,null,function*(){let i=U(r);if(i.La)return void k("SyncEngine","Ignoring unexpected query state notification.");let s=i.Da.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield KE(i.localStore,sE(s[0])),u=Xo.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Ke.EMPTY_BYTE_STRING);yield wn(i,o,u);break}case"rejected":yield rs(i.localStore,e,!0),os(i,e,n);break;default:q()}})}function YR(r,e,t){return P(this,null,function*(){let n=Wc(r);if(n.La){for(let i of e){if(n.Da.has(i)&&n.sharedClientState.isActiveQueryTarget(i)){k("SyncEngine","Adding an already active target "+i);continue}let s=yield GE(n.localStore,i),o=yield ns(n.localStore,s);yield Xp(n,iI(s),o.targetId,!1,o.resumeToken),Kc(n.remoteStore,o)}for(let i of t)n.Da.has(i)&&(yield rs(n.localStore,i,!1).then(()=>{is(n.remoteStore,i),os(n,i)}).catch(or))}})}function Wc(r){let e=U(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=nI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=GR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=UR.bind(null,e),e.Sa.h_=VR.bind(null,e.eventManager),e.Sa.ka=MR.bind(null,e.eventManager),e}function eg(r){let e=U(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=jR.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=BR.bind(null,e),e}function ZR(r,e,t){let n=U(r);(function(s,o,u){return P(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(w,x){let V=U(w),D=Ve(x.createTime);return V.persistence.runTransaction("hasNewerBundle","readonly",N=>V.$r.getBundleMetadata(N,x.id)).then(N=>!!N&&N.createTime.compareTo(D)>=0)}(s.localStore,c))return yield o.close(),u._completeWith(function(w){return{taskState:"Success",documentsLoaded:w.totalDocuments,bytesLoaded:w.totalBytes,totalDocuments:w.totalDocuments,totalBytes:w.totalBytes}}(c)),Promise.resolve(new Set);u._updateProgress(eI(c));let l=new ap(c,s.localStore,o.serializer),f=yield o.qa();for(;f;){let m=yield l._a(f);m&&u._updateProgress(m),f=yield o.qa()}let p=yield l.complete();return yield wn(s,p.ca,void 0),yield function(w,x){let V=U(w);return V.persistence.runTransaction("Save bundle","readwrite",D=>V.$r.saveBundleMetadata(D,x))}(s.localStore,c),u._completeWith(p.progress),Promise.resolve(p.ua)}catch(c){return Pt("SyncEngine",`Loading bundle failed with ${c}`),u._failWith(c),Promise.resolve(new Set)}})})(n,e,t).then(i=>{n.sharedClientState.notifyBundleLoaded(i)})}var sa=class{constructor(){this.synchronizeTabs=!1}initialize(e){return P(this,null,function*(){this.serializer=fa(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return BE(this.persistence,new Ec,e.initialUser,this.serializer)}createPersistence(e){return new _c(wc.Hr,this.serializer)}createSharedClientState(e){return new bc}terminate(){return P(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Nc=class r extends sa{constructor(e,t,n){super(),this.Qa=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}initialize(e){return P(this,null,function*(){yield xl(r.prototype,this,"initialize").call(this,e),yield this.Qa.initialize(this,e),yield eg(this.Qa.syncEngine),yield fs(this.Qa.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return BE(this.persistence,new Ec,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let n=this.persistence.referenceDelegate.garbageCollector;return new Rf(n,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let n=new Gd(t,this.persistence);return new zd(e.asyncQueue,n)}createPersistence(e){let t=$p(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Dt.withCacheSize(this.cacheSizeBytes):Dt.DEFAULT;return new qf(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,HE(),Wu(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new bc}},dp=class r extends Nc{constructor(e,t){super(e,t,!1),this.Qa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return P(this,null,function*(){yield xl(r.prototype,this,"initialize").call(this,e);let t=this.Qa.syncEngine;this.sharedClientState instanceof jo&&(this.sharedClientState.syncEngine={Zs:HR.bind(null,t),Xs:JR.bind(null,t),eo:YR.bind(null,t),Bi:XR.bind(null,t),Ys:WR.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.fi(n=>P(this,null,function*(){yield QR(this.Qa.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let t=HE();if(!jo.D(t))throw new M(R.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let n=$p(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new jo(t,e.asyncQueue,n,e.clientId,e.initialUser)}},oa=class{initialize(e,t){return P(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Sw(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=zR.bind(null,this.syncEngine),yield tp(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new ip}()}createDatastore(e){let t=fa(e.databaseInfo.databaseId),n=function(s){return new Qf(s)}(e.databaseInfo);return function(s,o,u,c){return new Yf(s,o,u,c)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,i,s,o,u){return new ep(n,i,s,o,u)}(this.localStore,this.datastore,e.asyncQueue,t=>Sw(this.syncEngine,t,0),function(){return Cc.D()?new Cc:new Wf}())}createSyncEngine(e,t){return function(i,s,o,u,c,l,f){let p=new lp(i,s,o,u,c,l);return f&&(p.La=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return P(this,null,function*(){var e;yield function(n){return P(this,null,function*(){let i=U(n);k("RemoteStore","RemoteStore shutting down."),i.M_.add(5),yield ds(i),i.O_.shutdown(),i.N_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function Dw(r,e=10240){let t=0;return{read(){return P(this,null,function*(){if(t<r.byteLength){let i={value:r.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return P(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var as=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):Pe("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var fp=class{constructor(e,t){this.Ua=e,this.serializer=t,this.metadata=new Fe,this.buffer=new Uint8Array,this.Wa=function(){return new TextDecoder("utf-8")}(),this.Ga().then(n=>{n&&n.sa()?this.metadata.resolve(n.ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(n?.ia)}`))},n=>this.metadata.reject(n))}close(){return this.Ua.cancel()}getMetadata(){return P(this,null,function*(){return this.metadata.promise})}qa(){return P(this,null,function*(){return yield this.getMetadata(),this.Ga()})}Ga(){return P(this,null,function*(){let e=yield this.za();if(e===null)return null;let t=this.Wa.decode(e),n=Number(t);isNaN(n)&&this.ja(`length string (${t}) is not valid number`);let i=yield this.Ha(n);return new op(JSON.parse(i),e.length+n)})}Ja(){return this.buffer.findIndex(e=>e===123)}za(){return P(this,null,function*(){for(;this.Ja()<0&&!(yield this.Ya()););if(this.buffer.length===0)return null;let e=this.Ja();e<0&&this.ja("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}Ha(e){return P(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ya())&&this.ja("Reached the end of bundle when more is expected.");let t=this.Wa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}ja(e){throw this.Ua.cancel(),new Error(`Invalid bundle format: ${e}`)}Ya(){return P(this,null,function*(){let e=yield this.Ua.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var pp=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return P(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new M(R.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,s){return P(this,null,function*(){let o=U(i),u={documents:s.map(p=>Yo(o.serializer,p))},c=yield o.xo("BatchGetDocuments",o.serializer.databaseId,oe.emptyPath(),u,s.length),l=new Map;c.forEach(p=>{let m=iR(o.serializer,p);l.set(m.key.toString(),m)});let f=[];return s.forEach(p=>{let m=l.get(p.toString());G(!!m),f.push(m)}),f})}(this.datastore,e);return t.forEach(n=>this.recordVersion(n)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new ir(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return P(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,n)=>{let i=L.fromPath(n);this.mutations.push(new Wo(i,this.precondition(i)))}),yield function(n,i){return P(this,null,function*(){let s=U(n),o={writes:i.map(u=>Zo(s.serializer,u))};yield s.Co("Commit",s.serializer.databaseId,oe.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw q();t=W.min()}let n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new M(R.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(W.min())?De.exists(!1):De.updateTime(t):De.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(W.min()))throw new M(R.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return De.updateTime(t)}return De.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var gp=class{constructor(e,t,n,i,s){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=i,this.deferred=s,this.Za=n.maxAttempts,this.Yo=new ra(this.asyncQueue,"transaction_retry")}Xa(){this.Za-=1,this.eu()}eu(){this.Yo.$o(()=>P(this,null,function*(){let e=new pp(this.datastore),t=this.tu(e);t&&t.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(i=>{this.nu(i)}))}).catch(n=>{this.nu(n)})}))}tu(e){try{let t=this.updateFunction(e);return!ca(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}nu(e){this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget(()=>(this.eu(),Promise.resolve()))):this.deferred.reject(e)}ru(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!_E(t)}return!1}};var mp=class{constructor(e,t,n,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=Oe.UNAUTHENTICATED,this.clientId=Xu.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,s=>P(this,null,function*(){k("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(n,s=>(k("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new M(R.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Fe;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>P(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let n=gs(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}};function Hu(r,e){return P(this,null,function*(){r.asyncQueue.verifyOperationInProgress(),k("FirestoreClient","Initializing OfflineComponentProvider");let t=r.configuration;yield e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(i=>P(this,null,function*(){n.isEqual(i)||(yield qE(e.localStore,i),n=i)})),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e})}function yp(r,e){return P(this,null,function*(){r.asyncQueue.verifyOperationInProgress();let t=yield tg(r);k("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>bw(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,i)=>bw(e.remoteStore,i)),r._onlineComponents=e})}function sI(r){return r.name==="FirebaseError"?r.code===R.FAILED_PRECONDITION||r.code===R.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}function tg(r){return P(this,null,function*(){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){k("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Hu(r,r._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!sI(t))throw t;Pt("Error using user provided cache. Falling back to memory cache: "+t),yield Hu(r,new sa)}}else k("FirestoreClient","Using default OfflineComponentProvider"),yield Hu(r,new sa);return r._offlineComponents})}function Hc(r){return P(this,null,function*(){return r._onlineComponents||(r._uninitializedComponentsProvider?(k("FirestoreClient","Using user provided OnlineComponentProvider"),yield yp(r,r._uninitializedComponentsProvider._online)):(k("FirestoreClient","Using default OnlineComponentProvider"),yield yp(r,new oa))),r._onlineComponents})}function oI(r){return tg(r).then(e=>e.persistence)}function ng(r){return tg(r).then(e=>e.localStore)}function aI(r){return Hc(r).then(e=>e.remoteStore)}function rg(r){return Hc(r).then(e=>e.syncEngine)}function eD(r){return Hc(r).then(e=>e.datastore)}function us(r){return P(this,null,function*(){let e=yield Hc(r),t=e.eventManager;return t.onListen=kR.bind(null,e.syncEngine),t.onUnlisten=OR.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=NR.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=FR.bind(null,e.syncEngine),t})}function tD(r){return r.asyncQueue.enqueue(()=>P(this,null,function*(){let e=yield oI(r),t=yield aI(r);return e.setNetworkEnabled(!0),function(i){let s=U(i);return s.M_.delete(0),pa(s)}(t)}))}function nD(r){return r.asyncQueue.enqueue(()=>P(this,null,function*(){let e=yield oI(r),t=yield aI(r);return e.setNetworkEnabled(!1),function(i){return P(this,null,function*(){let s=U(i);s.M_.add(0),yield ds(s),s.N_.set("Offline")})}(t)}))}function rD(r,e){let t=new Fe;return r.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(i,s,o){return P(this,null,function*(){try{let u=yield function(l,f){let p=U(l);return p.persistence.runTransaction("read document","readonly",m=>p.localDocuments.getDocument(m,f))}(i,s);u.isFoundDocument()?o.resolve(u):u.isNoDocument()?o.resolve(null):o.reject(new M(R.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(u){let c=gs(u,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield ng(r),e,t)})),t.promise}function uI(r,e,t={}){let n=new Fe;return r.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(s,o,u,c,l){let f=new as({next:m=>{o.enqueueAndForget(()=>Hp(s,p));let w=m.docs.has(u);!w&&m.fromCache?l.reject(new M(R.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&m.fromCache&&c&&c.source==="server"?l.reject(new M(R.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new ia(hs(u.path),f,{includeMetadataChanges:!0,ra:!0});return Wp(s,p)}(yield us(r),r.asyncQueue,e,t,n)})),n.promise}function iD(r,e){let t=new Fe;return r.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(i,s,o){return P(this,null,function*(){try{let u=yield Ic(i,s,!0),c=new kc(s,u.hs),l=c.da(u.documents),f=c.applyChanges(l,!1);o.resolve(f.snapshot)}catch(u){let c=gs(u,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield ng(r),e,t)})),t.promise}function cI(r,e,t={}){let n=new Fe;return r.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(s,o,u,c,l){let f=new as({next:m=>{o.enqueueAndForget(()=>Hp(s,p)),m.fromCache&&c.source==="server"?l.reject(new M(R.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new ia(u,f,{includeMetadataChanges:!0,ra:!0});return Wp(s,p)}(yield us(r),r.asyncQueue,e,t,n)})),n.promise}function sD(r,e){let t=new as(e);return r.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(i,s){U(i).z_.add(s),s.next()}(yield us(r),t)})),()=>{t.$a(),r.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(i,s){U(i).z_.delete(s)}(yield us(r),t)}))}}function oD(r,e,t,n){let i=function(o,u){let c;return c=typeof o=="string"?EE().encode(o):o,function(f,p){return new fp(f,p)}(function(f,p){if(f instanceof Uint8Array)return Dw(f,p);if(f instanceof ArrayBuffer)return Dw(new Uint8Array(f),p);if(f instanceof ReadableStream)return f.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),u)}(t,fa(e));r.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){ZR(yield rg(r),i,n)}))}function aD(r,e){return r.asyncQueue.enqueue(()=>P(this,null,function*(){return function(n,i){let s=U(n);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield ng(r),e)}))}function lI(r){let e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}var Pw=new Map;function ig(r,e,t){if(!t)throw new M(R.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function sg(r,e,t,n){if(e===!0&&n===!0)throw new M(R.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function xw(r){if(!L.isDocumentKey(r))throw new M(R.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function Vw(r){if(L.isDocumentKey(r))throw new M(R.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function Qc(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{let e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":q()}function ae(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new M(R.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Qc(r);throw new M(R.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}function hI(r,e){if(e<=0)throw new M(R.INVALID_ARGUMENT,`Function ${r}() requires a positive number, but it was: ${e}.`)}var Oc=class{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new M(R.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new M(R.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}sg("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=lI((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new M(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new M(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new M(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},qr=class{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Oc({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new M(R.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new M(R.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Oc(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new kd;switch(n.type){case"firstParty":return new Ld(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new M(R.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let n=Pw.get(t);n&&(k("ComponentProvider","Removing Datastore"),Pw.delete(t),n.terminate())}(this),Promise.resolve()}};function og(r,e,t,n={}){var i;let s=(r=ae(r,qr))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Pt("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),r._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),n.mockUserToken){let u,c;if(typeof n.mockUserToken=="string")u=n.mockUserToken,c=Oe.MOCK_USER;else{u=wy(n.mockUserToken,(i=r._app)===null||i===void 0?void 0:i.options.projectId);let l=n.mockUserToken.sub||n.mockUserToken.user_id;if(!l)throw new M(R.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Oe(l)}r._authCredentials=new Nd(new Qu(u,c))}}var Qe=class r{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new r(this.firestore,e,this._query)}},ve=class r{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new en(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new r(this.firestore,e,this._key)}},en=class r extends Qe{constructor(e,t,n){super(e,t,hs(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new ve(this.firestore,null,new L(e))}withConverter(e){return new r(this.firestore,e,this._path)}};function ag(r,e,...t){if(r=Ae(r),ig("collection","path",e),r instanceof qr){let n=oe.fromString(e,...t);return Vw(n),new en(r,null,n)}{if(!(r instanceof ve||r instanceof en))throw new M(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=r._path.child(oe.fromString(e,...t));return Vw(n),new en(r.firestore,null,n)}}function dI(r,e){if(r=ae(r,qr),ig("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new M(R.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Qe(r,null,function(n){return new Lt(oe.emptyPath(),n)}(e))}function ga(r,e,...t){if(r=Ae(r),arguments.length===1&&(e=Xu.newId()),ig("doc","path",e),r instanceof qr){let n=oe.fromString(e,...t);return xw(n),new ve(r,null,new L(n))}{if(!(r instanceof ve||r instanceof en))throw new M(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=r._path.child(oe.fromString(e,...t));return xw(n),new ve(r.firestore,r instanceof en?r.converter:null,new L(n))}}function ug(r,e){return r=Ae(r),e=Ae(e),(r instanceof ve||r instanceof en)&&(e instanceof ve||e instanceof en)&&r.firestore===e.firestore&&r.path===e.path&&r.converter===e.converter}function cg(r,e){return r=Ae(r),e=Ae(e),r instanceof Qe&&e instanceof Qe&&r.firestore===e.firestore&&ha(r._query,e._query)&&r.converter===e.converter}var vp=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new ra(this,"async_queue_retry"),this.hu=()=>{let t=Wu();t&&k("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Yo.Wo()};let e=Wu();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let t=Wu();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let t=new Fe;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return P(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!ar(e))throw e;k("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}})}Iu(e){let t=this.iu.then(()=>(this.uu=!0,e().catch(n=>{this.au=n,this.uu=!1;let i=function(o){let u=o.message||"";return o.stack&&(u=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),u}(n);throw Pe("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.uu=!1,n))));return this.iu=t,t}enqueueAfterDelay(e,t,n){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);let i=np.createAndSchedule(this,e,t,n,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&q()}verifyOperationInProgress(){}du(){return P(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(let t of this._u)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let t=this._u.indexOf(e);this._u.splice(t,1)}};function _p(r){return function(t,n){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(r,["next","error","complete"])}var wp=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Fe,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var fI=-1,Te=class extends qr{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=function(){return new vp}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||pI(this),this._firestoreClient.terminate()}};function GV(r,e){let t=typeof r=="object"?r:Hs(),n=typeof r=="string"?r:e||"(default)",i=th(t,"firestore").getImmediate({identifier:n});if(!i._initialized){let s=_y("firestore");s&&og(i,...s)}return i}function je(r){return r._firestoreClient||pI(r),r._firestoreClient.verifyNotTerminated(),r._firestoreClient}function pI(r){var e,t,n;let i=r._freezeSettings(),s=function(u,c,l,f){return new Kd(u,c,l,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,lI(f.experimentalLongPollingOptions),f.useFetchStreams)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,i);r._firestoreClient=new mp(r._authCredentials,r._appCheckCredentials,r._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(r._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function gI(r,e){AI(r=ae(r,Te));let t=je(r);if(t._uninitializedComponentsProvider)throw new M(R.FAILED_PRECONDITION,"SDK cache is already specified.");Pt("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=r._freezeSettings(),i=new oa;return yI(t,i,new Nc(i,n.cacheSizeBytes,e?.forceOwnership))}function mI(r){AI(r=ae(r,Te));let e=je(r);if(e._uninitializedComponentsProvider)throw new M(R.FAILED_PRECONDITION,"SDK cache is already specified.");Pt("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=r._freezeSettings(),n=new oa;return yI(e,n,new dp(n,t.cacheSizeBytes))}function yI(r,e,t){let n=new Fe;return r.asyncQueue.enqueue(()=>P(this,null,function*(){try{yield Hu(r,t),yield yp(r,e),n.resolve()}catch(i){let s=i;if(!sI(s))throw s;Pt("Error enabling indexeddb cache. Falling back to memory cache: "+s),n.reject(s)}})).then(()=>n.promise)}function vI(r){if(r._initialized&&!r._terminated)throw new M(R.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Fe;return r._queue.enqueueAndForgetEvenWhileRestricted(()=>P(this,null,function*(){try{yield function(n){return P(this,null,function*(){if(!Jn.D())return Promise.resolve();let i=n+"main";yield Jn.delete(i)})}($p(r._databaseId,r._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function _I(r){return function(t){let n=new Fe;return t.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return qR(yield rg(t),n)})),n.promise}(je(r=ae(r,Te)))}function wI(r){return tD(je(r=ae(r,Te)))}function EI(r){return nD(je(r=ae(r,Te)))}function II(r,e){let t=je(r=ae(r,Te)),n=new wp;return oD(t,r._databaseId,e,n),n}function TI(r,e){return aD(je(r=ae(r,Te)),e).then(t=>t?new Qe(r,null,t.query):null)}function AI(r){if(r._initialized||r._terminated)throw new M(R.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var sn=class r{constructor(e){this._byteString=e}static fromBase64String(e){try{return new r(Ke.fromBase64String(e))}catch(t){throw new M(R.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new r(Ke.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var jt=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new M(R.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var vn=class{constructor(e){this._methodName=e}};var $r=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new M(R.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new M(R.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Z(this._lat,e._lat)||Z(this._long,e._long)}};var uD=/^__.*__$/,Ep=class{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Ut(e,this.data,this.fieldMask,t,this.fieldTransforms):new rr(e,this.data,t,this.fieldTransforms)}},Fc=class{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Ut(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function bI(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw q()}}var Lc=class r{constructor(e,t,n,i,s,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new r(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;let n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:n,yu:!1});return i.wu(e),i}Su(e){var t;let n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:n,yu:!1});return i.mu(),i}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return Uc(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(bI(this.fu)&&uD.test(e))throw this.Du('Document fields cannot begin and end with "__"')}},Ip=class{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||fa(e)}Fu(e,t,n,i=!1){return new Lc({fu:e,methodName:t,vu:n,path:xe.emptyPath(),yu:!1,Cu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Wr(r){let e=r._freezeSettings(),t=fa(r._databaseId);return new Ip(r._databaseId,!!e.ignoreUndefinedProperties,t)}function Xc(r,e,t,n,i,s={}){let o=r.Fu(s.merge||s.mergeFields?2:0,e,t,i);dg("Data must be an object, but it was:",o,n);let u=RI(n,o),c,l;if(s.merge)c=new It(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let f=[];for(let p of s.mergeFields){let m=Sp(e,p,t);if(!o.contains(m))throw new M(R.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);PI(f,m)||f.push(m)}c=new It(f),l=o.fieldTransforms.filter(p=>c.covers(p.field))}else c=null,l=o.fieldTransforms;return new Ep(new nt(u),c,l)}var aa=class r extends vn{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof r}};function CI(r,e,t){return new Lc({fu:3,vu:e.settings.vu,methodName:r._methodName,yu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var Tp=class r extends vn{_toFieldTransform(e){return new Ur(e.path,new tr)}isEqual(e){return e instanceof r}},Ap=class r extends vn{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=CI(this,e,!0),n=this.Mu.map(s=>Hr(s,t)),i=new mn(n);return new Ur(e.path,i)}isEqual(e){return e instanceof r&&eh(this.Mu,e.Mu)}},bp=class r extends vn{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=CI(this,e,!0),n=this.Mu.map(s=>Hr(s,t)),i=new yn(n);return new Ur(e.path,i)}isEqual(e){return e instanceof r&&eh(this.Mu,e.Mu)}},Cp=class r extends vn{constructor(e,t){super(e),this.xu=t}_toFieldTransform(e){let t=new nr(e.serializer,dE(e.serializer,this.xu));return new Ur(e.path,t)}isEqual(e){return e instanceof r&&this.xu===e.xu}};function lg(r,e,t,n){let i=r.Fu(1,e,t);dg("Data must be an object, but it was:",i,n);let s=[],o=nt.empty();Kr(n,(c,l)=>{let f=fg(e,c,t);l=Ae(l);let p=i.Su(f);if(l instanceof aa)s.push(f);else{let m=Hr(l,p);m!=null&&(s.push(f),o.set(f,m))}});let u=new It(s);return new Fc(o,u,i.fieldTransforms)}function hg(r,e,t,n,i,s){let o=r.Fu(1,e,t),u=[Sp(e,n,t)],c=[i];if(s.length%2!=0)throw new M(R.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)u.push(Sp(e,s[m])),c.push(s[m+1]);let l=[],f=nt.empty();for(let m=u.length-1;m>=0;--m)if(!PI(l,u[m])){let w=u[m],x=c[m];x=Ae(x);let V=o.Su(w);if(x instanceof aa)l.push(w);else{let D=Hr(x,V);D!=null&&(l.push(w),f.set(w,D))}}let p=new It(l);return new Fc(f,p,o.fieldTransforms)}function SI(r,e,t,n=!1){return Hr(t,r.Fu(n?4:3,e))}function Hr(r,e){if(DI(r=Ae(r)))return dg("Unsupported field value:",e,r),RI(r,e);if(r instanceof vn)return function(n,i){if(!bI(i.fu))throw i.Du(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Du(`${n._methodName}() is not currently supported inside arrays`);let s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(n,i){let s=[],o=0;for(let u of n){let c=Hr(u,i.bu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(r,e)}return function(n,i){if((n=Ae(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return dE(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){let s=be.fromDate(n);return{timestampValue:Zi(i.serializer,s)}}if(n instanceof be){let s=new be(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Zi(i.serializer,s)}}if(n instanceof $r)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof sn)return{bytesValue:IE(i.serializer,n._byteString)};if(n instanceof ve){let s=i.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw i.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:jp(n.firestore._databaseId||i.databaseId,n._key.path)}}throw i.Du(`Unsupported field value: ${Qc(n)}`)}(r,e)}function RI(r,e){let t={};return Hw(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Kr(r,(n,i)=>{let s=Hr(i,e.pu(n));s!=null&&(t[n]=s)}),{mapValue:{fields:t}}}function DI(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof be||r instanceof $r||r instanceof sn||r instanceof ve||r instanceof vn)}function dg(r,e,t){if(!DI(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let n=Qc(t);throw n==="an object"?e.Du(r+" a custom object"):e.Du(r+" "+n)}}function Sp(r,e,t){if((e=Ae(e))instanceof jt)return e._internalPath;if(typeof e=="string")return fg(r,e);throw Uc("Field path arguments must be of type string or ",r,!1,void 0,t)}var cD=new RegExp("[~\\*/\\[\\]]");function fg(r,e,t){if(e.search(cD)>=0)throw Uc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new jt(...e.split("."))._internalPath}catch{throw Uc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function Uc(r,e,t,n,i){let s=n&&!n.isEmpty(),o=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${n}`),o&&(c+=` in document ${i}`),c+=")"),new M(R.INVALID_ARGUMENT,u+r+c)}function PI(r,e){return r.some(t=>t.isEqual(e))}var zr=class{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ve(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Rp(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Jc("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Rp=class extends zr{data(){return super.data()}};function Jc(r,e){return typeof e=="string"?fg(r,e):e instanceof jt?e._internalPath:e._delegate._internalPath}function xI(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new M(R.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ua=class{},Gr=class extends ua{};function En(r,e,...t){let n=[];e instanceof ua&&n.push(e),n=n.concat(t),function(s){let o=s.filter(c=>c instanceof Dp).length,u=s.filter(c=>c instanceof jc).length;if(o>1||o>0&&u>0)throw new M(R.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(let i of n)r=i._apply(r);return r}var jc=class r extends Gr{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new r(e,t,n)}_apply(e){let t=this._parse(e);return BI(e._query,t),new Qe(e.firestore,e.converter,of(e._query,t))}_parse(e){let t=Wr(e.firestore);return function(s,o,u,c,l,f,p){let m;if(l.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new M(R.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){kw(p,f);let w=[];for(let x of p)w.push(Mw(c,s,x));m={arrayValue:{values:w}}}else m=Mw(c,s,p)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||kw(p,f),m=SI(u,o,p,f==="in"||f==="not-in");return ie.create(l,f,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function VI(r,e,t){let n=e,i=Jc("where",r);return jc._create(i,n,t)}var Dp=class r extends ua{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new r(e,t)}_parse(e){let t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:fe.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,u=s.getFlattenedFilters();for(let c of u)BI(o,c),o=of(o,c)}(e._query,t),new Qe(e.firestore,e.converter,of(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Pp=class r extends Gr{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new r(e,t)}_apply(e){let t=function(i,s,o){if(i.startAt!==null)throw new M(R.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new M(R.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Fr(s,o)}(e._query,this._field,this._direction);return new Qe(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new Lt(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function MI(r,e="asc"){let t=e,n=Jc("orderBy",r);return Pp._create(n,t)}var Bc=class r extends Gr{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new r(e,t,n)}_apply(e){return new Qe(e.firestore,e.converter,oc(e._query,this._limit,this._limitType))}};function kI(r){return hI("limit",r),Bc._create("limit",r,"F")}function NI(r){return hI("limitToLast",r),Bc._create("limitToLast",r,"L")}var qc=class r extends Gr{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new r(e,t,n)}_apply(e){let t=jI(e,this.type,this._docOrFields,this._inclusive);return new Qe(e.firestore,e.converter,function(i,s){return new Lt(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}};function OI(...r){return qc._create("startAt",r,!0)}function FI(...r){return qc._create("startAfter",r,!1)}var $c=class r extends Gr{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new r(e,t,n)}_apply(e){let t=jI(e,this.type,this._docOrFields,this._inclusive);return new Qe(e.firestore,e.converter,function(i,s){return new Lt(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}};function LI(...r){return $c._create("endBefore",r,!1)}function UI(...r){return $c._create("endAt",r,!0)}function jI(r,e,t,n){if(t[0]=Ae(t[0]),t[0]instanceof zr)return function(s,o,u,c,l){if(!c)throw new M(R.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${u}().`);let f=[];for(let p of Gi(s))if(p.field.isKeyField())f.push(Or(o,c.key));else{let m=c.data.field(p.field);if(Gc(m))throw new M(R.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){let w=p.field.canonicalString();throw new M(R.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${w}' (used as the orderBy) does not exist.`)}f.push(m)}return new nn(f,l)}(r._query,r.firestore._databaseId,e,t[0]._document,n);{let i=Wr(r.firestore);return function(o,u,c,l,f,p){let m=o.explicitOrderBy;if(f.length>m.length)throw new M(R.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let w=[];for(let x=0;x<f.length;x++){let V=f[x];if(m[x].field.isKeyField()){if(typeof V!="string")throw new M(R.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof V}`);if(!Lp(o)&&V.indexOf("/")!==-1)throw new M(R.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${V}' contains a slash.`);let D=o.path.child(oe.fromString(V));if(!L.isDocumentKey(D))throw new M(R.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${D}' is not because it contains an odd number of segments.`);let N=new L(D);w.push(Or(u,N))}else{let D=SI(c,l,V);w.push(D)}}return new nn(w,p)}(r._query,r.firestore._databaseId,i,e,t,n)}}function Mw(r,e,t){if(typeof(t=Ae(t))=="string"){if(t==="")throw new M(R.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Lp(e)&&t.indexOf("/")!==-1)throw new M(R.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let n=e.path.child(oe.fromString(t));if(!L.isDocumentKey(n))throw new M(R.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Or(r,new L(n))}if(t instanceof ve)return Or(r,t._key);throw new M(R.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Qc(t)}.`)}function kw(r,e){if(!Array.isArray(r)||r.length===0)throw new M(R.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function BI(r,e){let t=function(i,s){for(let o of i)for(let u of o.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(r.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new M(R.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new M(R.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var cs=class{convertValue(e,t="none"){switch(Nr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Re(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Yn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw q()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let n={};return Kr(e,(i,s)=>{n[i]=this.convertValue(s,t)}),n}convertGeoPoint(e){return new $r(Re(e.latitude),Re(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":let n=Op(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(zo(e));default:return null}}convertTimestamp(e){let t=gn(e);return new be(t.seconds,t.nanos)}convertDocumentKey(e,t){let n=oe.fromString(e);G(ME(n));let i=new Zn(n.get(1),n.get(3)),s=new L(n.popFirst(5));return i.isEqual(t)||Pe(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function Yc(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}var xp=class extends cs{constructor(e){super(),this.firestore=e}convertBytes(e){return new sn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new ve(this.firestore,null,t)}};var pn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Vt=class extends zr{constructor(e,t,n,i,s,o){super(e,t,n,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Qn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let n=this._document.data.field(Jc("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}},Qn=class extends Vt{data(e={}){return super.data(e)}},Bt=class{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new pn(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Qn(this._firestore,this._userDataWriter,n.key,n,new pn(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new M(R.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(u=>{let c=new Qn(i._firestore,i._userDataWriter,u.doc.key,u.doc,new pn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{let c=new Qn(i._firestore,i._userDataWriter,u.doc.key,u.doc,new pn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,f=-1;return u.type!==0&&(l=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),f=o.indexOf(u.doc.key)),{type:lD(u.type),doc:c,oldIndex:l,newIndex:f}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function lD(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return q()}}function pg(r,e){return r instanceof Vt&&e instanceof Vt?r._firestore===e._firestore&&r._key.isEqual(e._key)&&(r._document===null?e._document===null:r._document.isEqual(e._document))&&r._converter===e._converter:r instanceof Bt&&e instanceof Bt&&r._firestore===e._firestore&&cg(r.query,e.query)&&r.metadata.isEqual(e.metadata)&&r._snapshot.isEqual(e._snapshot)}function qI(r){r=ae(r,ve);let e=ae(r.firestore,Te);return uI(je(e),r._key).then(t=>vg(e,r,t))}var _n=class extends cs{constructor(e){super(),this.firestore=e}convertBytes(e){return new sn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new ve(this.firestore,null,t)}};function $I(r){r=ae(r,ve);let e=ae(r.firestore,Te),t=je(e),n=new _n(e);return rD(t,r._key).then(i=>new Vt(e,n,r._key,i,new pn(i!==null&&i.hasLocalMutations,!0),r.converter))}function zI(r){r=ae(r,ve);let e=ae(r.firestore,Te);return uI(je(e),r._key,{source:"server"}).then(t=>vg(e,r,t))}function GI(r){r=ae(r,Qe);let e=ae(r.firestore,Te),t=je(e),n=new _n(e);return xI(r._query),cI(t,r._query).then(i=>new Bt(e,n,r,i))}function KI(r){r=ae(r,Qe);let e=ae(r.firestore,Te),t=je(e),n=new _n(e);return iD(t,r._query).then(i=>new Bt(e,n,r,i))}function WI(r){r=ae(r,Qe);let e=ae(r.firestore,Te),t=je(e),n=new _n(e);return cI(t,r._query,{source:"server"}).then(i=>new Bt(e,n,r,i))}function gg(r,e,t){r=ae(r,ve);let n=ae(r.firestore,Te),i=Yc(r.converter,e,t);return ms(n,[Xc(Wr(n),"setDoc",r._key,i,r.converter!==null,t).toMutation(r._key,De.none())])}function mg(r,e,t,...n){r=ae(r,ve);let i=ae(r.firestore,Te),s=Wr(i),o;return o=typeof(e=Ae(e))=="string"||e instanceof jt?hg(s,"updateDoc",r._key,e,t,n):lg(s,"updateDoc",r._key,e),ms(i,[o.toMutation(r._key,De.exists(!0))])}function HI(r){return ms(ae(r.firestore,Te),[new ir(r._key,De.none())])}function QI(r,e){let t=ae(r.firestore,Te),n=ga(r),i=Yc(r.converter,e);return ms(t,[Xc(Wr(r.firestore),"addDoc",n._key,i,r.converter!==null,{}).toMutation(n._key,De.exists(!1))]).then(()=>n)}function yg(r,...e){var t,n,i;r=Ae(r);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||_p(e[o])||(s=e[o],o++);let u={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(_p(e[o])){let p=e[o];e[o]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[o+1]=(n=p.error)===null||n===void 0?void 0:n.bind(p),e[o+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let c,l,f;if(r instanceof ve)l=ae(r.firestore,Te),f=hs(r._key.path),c={next:p=>{e[o]&&e[o](vg(l,r,p))},error:e[o+1],complete:e[o+2]};else{let p=ae(r,Qe);l=ae(p.firestore,Te),f=p._query;let m=new _n(l);c={next:w=>{e[o]&&e[o](new Bt(l,m,p,w))},error:e[o+1],complete:e[o+2]},xI(r._query)}return function(m,w,x,V){let D=new as(V),N=new ia(w,D,x);return m.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return Wp(yield us(m),N)})),()=>{D.$a(),m.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return Hp(yield us(m),N)}))}}(je(l),f,u,c)}function XI(r,e){return sD(je(r=ae(r,Te)),_p(e)?e:{next:e})}function ms(r,e){return function(n,i){let s=new Fe;return n.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return LR(yield rg(n),i,s)})),s.promise}(je(r),e)}function vg(r,e,t){let n=t.docs.get(e._key),i=new _n(r);return new Vt(r,i,e._key,n,new pn(t.hasPendingWrites,t.fromCache),e.converter)}var hD={maxAttempts:5};var zc=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Wr(e)}set(e,t,n){this._verifyNotCommitted();let i=Wn(e,this._firestore),s=Yc(i.converter,t,n),o=Xc(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,n);return this._mutations.push(o.toMutation(i._key,De.none())),this}update(e,t,n,...i){this._verifyNotCommitted();let s=Wn(e,this._firestore),o;return o=typeof(t=Ae(t))=="string"||t instanceof jt?hg(this._dataReader,"WriteBatch.update",s._key,t,n,i):lg(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,De.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Wn(e,this._firestore);return this._mutations=this._mutations.concat(new ir(t._key,De.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new M(R.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Wn(r,e){if((r=Ae(r)).firestore!==e)throw new M(R.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}var Vp=class extends class{constructor(t,n){this._firestore=t,this._transaction=n,this._dataReader=Wr(t)}get(t){let n=Wn(t,this._firestore),i=new xp(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return q();let o=s[0];if(o.isFoundDocument())return new zr(this._firestore,i,o.key,o,n.converter);if(o.isNoDocument())return new zr(this._firestore,i,n._key,null,n.converter);throw q()})}set(t,n,i){let s=Wn(t,this._firestore),o=Yc(s.converter,n,i),u=Xc(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,u),this}update(t,n,i,...s){let o=Wn(t,this._firestore),u;return u=typeof(n=Ae(n))=="string"||n instanceof jt?hg(this._dataReader,"Transaction.update",o._key,n,i,s):lg(this._dataReader,"Transaction.update",o._key,n),this._transaction.update(o._key,u),this}delete(t){let n=Wn(t,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Wn(e,this._firestore),n=new _n(this._firestore);return super.get(e).then(i=>new Vt(this._firestore,n,t._key,i._document,new pn(!1,!1),t.converter))}};function JI(r,e,t){r=ae(r,Te);let n=Object.assign(Object.assign({},hD),t);return function(s){if(s.maxAttempts<1)throw new M(R.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(s,o,u){let c=new Fe;return s.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){let l=yield eD(s);new gp(s.asyncQueue,l,u,o,c).Xa()})),c.promise}(je(r),i=>e(new Vp(r,i)),n)}function YI(){return new aa("deleteField")}function ZI(){return new Tp("serverTimestamp")}function eT(...r){return new Ap("arrayUnion",r)}function tT(...r){return new bp("arrayRemove",r)}function nT(r){return new Cp("increment",r)}(function(e,t=!0){(function(i){ls=i})(Ty),Ws(new _r("firestore",(n,{instanceIdentifier:i,options:s})=>{let o=n.getProvider("app").getImmediate(),u=new Te(new Od(n.getProvider("auth-internal")),new jd(n.getProvider("app-check-internal")),function(l,f){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new M(R.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zn(l.options.projectId,f)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),St(N_,"4.6.4",e),St(N_,"4.6.4","esm2017")})();var dD="@firebase/firestore-compat",fD="0.3.33";function Ag(r,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new M("invalid-argument",`Invalid options passed to function ${r}(): You cannot specify both "merge" and "mergeFields".`);return e}function rT(){if(typeof Uint8Array>"u")throw new M("unimplemented","Uint8Arrays are not available in this environment.")}function iT(){if(!Qw())throw new M("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Zc=class r{constructor(e){this._delegate=e}static fromBase64String(e){return iT(),new r(sn.fromBase64String(e))}static fromUint8Array(e){return rT(),new r(sn.fromUint8Array(e))}toBase64(){return iT(),this._delegate.toBase64()}toUint8Array(){return rT(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function _g(r){return pD(r,["next","error","complete"])}function pD(r,e){if(typeof r!="object"||r===null)return!1;let t=r;for(let n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}var wg=class{enableIndexedDbPersistence(e,t){return gI(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return mI(e._delegate)}clearIndexedDbPersistence(e){return vI(e._delegate)}},el=class{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof Zn||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Pt("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,n={}){og(this._delegate,e,t,n)}enableNetwork(){return wI(this._delegate)}disableNetwork(){return EI(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,sg("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return _I(this._delegate)}onSnapshotsInSync(e){return XI(this._delegate,e)}get app(){if(!this._appCompat)throw new M("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new _s(this,ag(this._delegate,e))}catch(t){throw ct(t,"collection()","Firestore.collection()")}}doc(e){try{return new on(this,ga(this._delegate,e))}catch(t){throw ct(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Yr(this,dI(this._delegate,e))}catch(t){throw ct(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return JI(this._delegate,t=>e(new tl(this,t)))}batch(){return je(this._delegate),new nl(new zc(this._delegate,e=>ms(this._delegate,e)))}loadBundle(e){return II(this._delegate,e)}namedQuery(e){return TI(this._delegate,e).then(t=>t?new Yr(this,t):null)}},ys=class extends cs{constructor(e){super(),this.firestore=e}convertBytes(e){return new Zc(new sn(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return on.forKey(t,this.firestore,null)}};function gD(r){Nw(r)}var tl=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new ys(e)}get(e){let t=Qr(e);return this._delegate.get(t).then(n=>new Xr(this._firestore,new Vt(this._firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,t.converter)))}set(e,t,n){let i=Qr(e);return n?(Ag("Transaction.set",n),this._delegate.set(i,t,n)):this._delegate.set(i,t),this}update(e,t,n,...i){let s=Qr(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,n,...i),this}delete(e){let t=Qr(e);return this._delegate.delete(t),this}},nl=class{constructor(e){this._delegate=e}set(e,t,n){let i=Qr(e);return n?(Ag("WriteBatch.set",n),this._delegate.set(i,t,n)):this._delegate.set(i,t),this}update(e,t,n,...i){let s=Qr(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,n,...i),this}delete(e){let t=Qr(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},vs=class r{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){let n=new Qn(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Jr(this._firestore,n),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let n=r.INSTANCES,i=n.get(e);i||(i=new WeakMap,n.set(e,i));let s=i.get(t);return s||(s=new r(e,new ys(e),t),i.set(t,s)),s}};vs.INSTANCES=new WeakMap;var on=class r{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ys(e)}static forPath(e,t,n){if(e.length%2!==0)throw new M("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new r(t,new ve(t._delegate,n,new L(e)))}static forKey(e,t,n){return new r(t,new ve(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new _s(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new _s(this.firestore,ag(this._delegate,e))}catch(t){throw ct(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Ae(e),e instanceof ve?ug(this._delegate,e):!1}set(e,t){t=Ag("DocumentReference.set",t);try{return t?gg(this._delegate,e,t):gg(this._delegate,e)}catch(n){throw ct(n,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{return arguments.length===1?mg(this._delegate,e):mg(this._delegate,e,t,...n)}catch(i){throw ct(i,"updateDoc()","DocumentReference.update()")}}delete(){return HI(this._delegate)}onSnapshot(...e){let t=sT(e),n=oT(e,i=>new Xr(this.firestore,new Vt(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return yg(this._delegate,t,n)}get(e){let t;return e?.source==="cache"?t=$I(this._delegate):e?.source==="server"?t=zI(this._delegate):t=qI(this._delegate),t.then(n=>new Xr(this.firestore,new Vt(this.firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,this._delegate.converter)))}withConverter(e){return new r(this.firestore,e?this._delegate.withConverter(vs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function ct(r,e,t){return r.message=r.message.replace(e,t),r}function sT(r){for(let e of r)if(typeof e=="object"&&!_g(e))return e;return{}}function oT(r,e){var t,n;let i;return _g(r[0])?i=r[0]:_g(r[1])?i=r[1]:typeof r[0]=="function"?i={next:r[0],error:r[1],complete:r[2]}:i={next:r[1],error:r[2],complete:r[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(n=i.complete)===null||n===void 0?void 0:n.bind(i)}}var Xr=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new on(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return pg(this._delegate,e._delegate)}},Jr=class extends Xr{data(e){let t=this._delegate.data(e);return this._delegate._converter||Ow(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},Yr=class r{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ys(e)}where(e,t,n){try{return new r(this.firestore,En(this._delegate,VI(e,t,n)))}catch(i){throw ct(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new r(this.firestore,En(this._delegate,MI(e,t)))}catch(n){throw ct(n,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new r(this.firestore,En(this._delegate,kI(e)))}catch(t){throw ct(t,"limit()","Query.limit()")}}limitToLast(e){try{return new r(this.firestore,En(this._delegate,NI(e)))}catch(t){throw ct(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new r(this.firestore,En(this._delegate,OI(...e)))}catch(t){throw ct(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new r(this.firestore,En(this._delegate,FI(...e)))}catch(t){throw ct(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new r(this.firestore,En(this._delegate,LI(...e)))}catch(t){throw ct(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new r(this.firestore,En(this._delegate,UI(...e)))}catch(t){throw ct(t,"endAt()","Query.endAt()")}}isEqual(e){return cg(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=KI(this._delegate):e?.source==="server"?t=WI(this._delegate):t=GI(this._delegate),t.then(n=>new ma(this.firestore,new Bt(this.firestore._delegate,this._userDataWriter,this._delegate,n._snapshot)))}onSnapshot(...e){let t=sT(e),n=oT(e,i=>new ma(this.firestore,new Bt(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return yg(this._delegate,t,n)}withConverter(e){return new r(this.firestore,e?this._delegate.withConverter(vs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},Eg=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Jr(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},ma=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Yr(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Jr(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Eg(this._firestore,t))}forEach(e,t){this._delegate.forEach(n=>{e.call(t,new Jr(this._firestore,n))})}isEqual(e){return pg(this._delegate,e._delegate)}},_s=class r extends Yr{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new on(this.firestore,e):null}doc(e){try{return e===void 0?new on(this.firestore,ga(this._delegate)):new on(this.firestore,ga(this._delegate,e))}catch(t){throw ct(t,"doc()","CollectionReference.doc()")}}add(e){return QI(this._delegate,e).then(t=>new on(this.firestore,t))}isEqual(e){return ug(this._delegate,e._delegate)}withConverter(e){return new r(this.firestore,e?this._delegate.withConverter(vs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Qr(r){return ae(r,ve)}var Ig=class r{constructor(...e){this._delegate=new jt(...e)}static documentId(){return new r(xe.keyField().canonicalString())}isEqual(e){return e=Ae(e),e instanceof jt?this._delegate._internalPath.isEqual(e._internalPath):!1}};var Tg=class r{constructor(e){this._delegate=e}static serverTimestamp(){let e=ZI();return e._methodName="FieldValue.serverTimestamp",new r(e)}static delete(){let e=YI();return e._methodName="FieldValue.delete",new r(e)}static arrayUnion(...e){let t=eT(...e);return t._methodName="FieldValue.arrayUnion",new r(t)}static arrayRemove(...e){let t=tT(...e);return t._methodName="FieldValue.arrayRemove",new r(t)}static increment(e){let t=nT(e);return t._methodName="FieldValue.increment",new r(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var mD={Firestore:el,GeoPoint:$r,Timestamp:be,Blob:Zc,Transaction:tl,WriteBatch:nl,DocumentReference:on,DocumentSnapshot:Xr,Query:Yr,QueryDocumentSnapshot:Jr,QuerySnapshot:ma,CollectionReference:_s,FieldPath:Ig,FieldValue:Tg,setLogLevel:gD,CACHE_SIZE_UNLIMITED:fI};function yD(r,e){r.INTERNAL.registerComponent(new _r("firestore-compat",t=>{let n=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(n,i)},"PUBLIC").setServiceProps(Object.assign({},mD)))}function vD(r){yD(r,(e,t)=>new el(e,t,new wg)),r.registerVersion(dD,fD)}vD(gt);function _D(r,e=ka){return new qt(t=>{let n;return e!=null?e.schedule(()=>{n=r.onSnapshot({includeMetadataChanges:!0},t)}):n=r.onSnapshot({includeMetadataChanges:!0},t),()=>{n?.()}})}function aT(r,e){return _D(r,e)}function wD(r,e){return aT(r,e).pipe(oi(void 0),Oa(),J(t=>{let[n,i]=t;return i.exists?n?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function Sg(r,e){return aT(r,e).pipe(J(t=>({payload:t,type:"query"})))}var rl=class{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let n=this.ref.collection(e),{ref:i,query:s}=dT(n,t);return new sl(i,s,this.afs)}snapshotChanges(){return wD(this.ref,this.afs.schedulers.outsideAngular).pipe(ot)}valueChanges(e={}){return this.snapshotChanges().pipe(J(({payload:t})=>e.idField?we(B({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return Ee(this.ref.get(e)).pipe(ot)}};function il(r,e){return Sg(r,e).pipe(oi(void 0),Oa(),J(t=>{let[n,i]=t,s=i.payload.docChanges(),o=s.map(u=>({type:u.type,payload:u}));return n&&JSON.stringify(n.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((u,c)=>{let l=s.find(p=>p.doc.ref.isEqual(u.ref)),f=n?.payload.docs.find(p=>p.ref.isEqual(u.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(u.metadata)||!l&&f&&JSON.stringify(f.metadata)===JSON.stringify(u.metadata)||o.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:u}})}),o}))}function uT(r,e,t){return il(r,t).pipe(si((n,i)=>ED(n,i.map(s=>s.payload),e),[]),Um(),J(n=>n.map(i=>({type:i.type,payload:i}))))}function ED(r,e,t){return e.forEach(n=>{t.indexOf(n.type)>-1&&(r=ID(r,n))}),r}function bg(r,e,t,...n){let i=r.slice();return i.splice(e,t,...n),i}function ID(r,e){switch(e.type){case"added":if(!(r[e.newIndex]&&r[e.newIndex].doc.ref.isEqual(e.doc.ref)))return bg(r,e.newIndex,0,e);break;case"modified":if(r[e.oldIndex]==null||r[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=r.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return bg(r,e.newIndex,1,e);break;case"removed":if(r[e.oldIndex]&&r[e.oldIndex].doc.ref.isEqual(e.doc.ref))return bg(r,e.oldIndex,1);break}return r}function cT(r){return(!r||r.length===0)&&(r=["added","removed","modified"]),r}var sl=class{ref;query;afs;constructor(e,t,n){this.ref=e,this.query=t,this.afs=n}stateChanges(e){let t=il(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(J(n=>n.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(oi(void 0),Oa(),lt(([n,i])=>i.length>0||!n),J(([,n])=>n),ot)}auditTrail(e){return this.stateChanges(e).pipe(si((t,n)=>[...t,...n],[]))}snapshotChanges(e){let t=cT(e);return uT(this.query,t,this.afs.schedulers.outsideAngular).pipe(ot)}valueChanges(e={}){return Sg(this.query,this.afs.schedulers.outsideAngular).pipe(J(t=>t.payload.docs.map(n=>e.idField?we(B({},n.data()),{[e.idField]:n.id}):n.data())),ot)}get(e){return Ee(this.query.get(e)).pipe(ot)}add(e){return this.ref.add(e)}doc(e){return new rl(this.ref.doc(e),this.afs)}},Cg=class{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?il(this.query,this.afs.schedulers.outsideAngular).pipe(ot):il(this.query,this.afs.schedulers.outsideAngular).pipe(J(t=>t.filter(n=>e.indexOf(n.type)>-1)),lt(t=>t.length>0),ot)}auditTrail(e){return this.stateChanges(e).pipe(si((t,n)=>[...t,...n],[]))}snapshotChanges(e){let t=cT(e);return uT(this.query,t,this.afs.schedulers.outsideAngular).pipe(ot)}valueChanges(e={}){return Sg(this.query,this.afs.schedulers.outsideAngular).pipe(J(n=>n.payload.docs.map(i=>e.idField?B({[e.idField]:i.id},i.data()):i.data())),ot)}get(e){return Ee(this.query.get(e)).pipe(ot)}},lT=new Q("angularfire2.enableFirestorePersistence"),hT=new Q("angularfire2.firestore.persistenceSettings"),TD=new Q("angularfire2.firestore.settings"),AD=new Q("angularfire2.firestore.use-emulator");function dT(r,e=t=>t){return{query:e(r),ref:r}}var Rg=(()=>{class r{schedulers;firestore;persistenceEnabled$;constructor(t,n,i,s,o,u,c,l,f,p,m,w,x,V,D,N,z){this.schedulers=c;let F=So(t,u,n),$=f;p&&Id(F,u,m,x,V,D,w,N),[this.firestore,this.persistenceEnabled$]=Nu(`${F.name}.firestore`,"AngularFirestore",F.name,()=>{let X=u.runOutsideAngular(()=>F.firestore());if(s&&X.settings(s),$&&X.useEmulator(...$),i&&!kn(o)){let Y=()=>{try{return Ee(X.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(E){return typeof console<"u"&&console.warn(E),K(!1)}};return[X,u.runOutsideAngular(Y)]}else return[X,K(!1)]},[s,$,i])}collection(t,n){let i;typeof t=="string"?i=this.firestore.collection(t):i=t;let{ref:s,query:o}=dT(i,n),u=this.schedulers.ngZone.run(()=>s);return new sl(u,o,this)}collectionGroup(t,n){let i=n||(o=>o),s=this.firestore.collectionGroup(t);return new Cg(i(s),this)}doc(t){let n;typeof t=="string"?n=this.firestore.doc(t):n=t;let i=this.schedulers.ngZone.run(()=>n);return new rl(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(n){return new(n||r)(j(xi),j(Vi,8),j(lT,8),j(TD,8),j(st),j(Se),j(Pi),j(hT,8),j(AD,8),j(V_,8),j(md,8),j(yd,8),j(vd,8),j(_d,8),j(wd,8),j(Ed,8),j(Cr,8))};static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"any"})}return r})(),gM=(()=>{class r{constructor(){gt.registerVersion("angularfire",hn.full,"fst-compat")}static enablePersistence(t){return{ngModule:r,providers:[{provide:lT,useValue:!0},{provide:hT,useValue:t}]}}static \u0275fac=function(n){return new(n||r)};static \u0275mod=dt({type:r});static \u0275inj=ht({providers:[Rg]})}return r})();var fT=(()=>{let e=class e{constructor(n){this._firestore=n,this._refresh$=new Tt}get refresh$(){return this._refresh$}crearUsuario(n){return this._firestore.collection("usuarios").add(n)}getListadoUsuario(){return this._firestore.collection("usuarios").stateChanges()}getPerfilUsuario(n){return this._firestore.collection("usuarios",i=>i.where("email","==",n)).snapshotChanges()}getEspecialistaAutorizado(n){return this._firestore.collection("usuarios",i=>i.where("email","==",n).where("aprobadoPorAdmin","==",!0)).snapshotChanges()}eliminarUsuario(n){return this._firestore.collection("usuarios").doc(n).delete()}modificarUsuario(n,i){return this._firestore.collection("usuarios").doc(n).update(i)}getUsuario(n){return this._firestore.collection("usuarios").doc(n).snapshotChanges()}habilitarCuenta(n){return console.log("servicio habilitarCuenta"),this._firestore.collection("usuarios").doc(n).update({aprobadoPorAdmin:"SI"})}deshabilitarCuenta(n){return this._firestore.collection("usuarios").doc(n).update({aprobadoPorAdmin:"NO"})}crearTurno(n){return this._firestore.collection("turnos").add(n)}getEspecialidades(){return this._firestore.collection("turnos").stateChanges()}getListaEspecialistas(){return this._firestore.collection("turnos").stateChanges()}getTurnosDrYEspecialidad(n,i){return this._firestore.collection("turnos",s=>s.where("email","==",i).where("especialidad","==",n)).snapshotChanges()}getTurnosDr(n){return this._firestore.collection("turnos",i=>i.where("email","==",n)).snapshotChanges()}eleminarHorarioLaboralTurno(n){return this._firestore.collection("turnos").doc(n).delete()}crearTurnoPacientes(n){return this._firestore.collection("turnopaciente").add(n)}getTurnoPacientes(n){return this._firestore.collection("turnopaciente",i=>i.where("emailPaciente","==",n)).snapshotChanges()}getTurnosPacienteFiltradoDrYEspecialidad(n,i){return this._firestore.collection("turnopaciente",s=>s.where("emailEspecialista","==",i).where("especialidad","==",n)).snapshotChanges()}cancelarTurnoPaciente(n,i,s){return this._firestore.collection("turnopaciente").doc(n).update({estado:i,canceladoComentario:s})}calificacionTurnoPaciente(n,i){return this._firestore.collection("turnopaciente").doc(n).update({atencion:i})}encuestaTurnoPaciente(n,i){return this._firestore.collection("turnopaciente").doc(n).update({encuesta:i})}getTurnoEspecialista(n){return this._firestore.collection("turnopaciente",i=>i.where("emailEspecialista","==",n)).snapshotChanges()}getHistoriaClinicaPaciente(n){return this._firestore.collection("turnopaciente",i=>i.where("emailPaciente","==",n)).snapshotChanges()}getVerResaniaPaciente(n){return this._firestore.collection("turnopaciente",i=>i.where("id","==",n)).snapshotChanges()}aceptarTurnoEspecialista(n,i){return this._firestore.collection("turnopaciente").doc(n).update({estado:i})}finalizadaAtencion(n,i,s,o){return this._firestore.collection("turnopaciente").doc(n).update({estado:i,resena:s,diagnostico:o})}guardarHistoriaClinicaServicio(n,i,s,o,u,c,l,f,p,m,w){return this._firestore.collection("turnopaciente").doc(n).update({altura:i,peso:s,temperatura:o,presion:u,clave1:c,valor1:l,clave2:f,valor2:p,clave3:m,valor3:w})}getHistoriaClinicaEspecialistaAlmenosUno(n){return this._firestore.collection("turnopaciente",i=>i.where("emailEspecialista","==",n).where("estado","==","FINALIZADO")).snapshotChanges()}getPerfil(n){return this._firestore.collection("usuarios",i=>i.where("email","==",n)).snapshotChanges()}};e.\u0275fac=function(i){return new(i||e)(j(Rg))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();function SD(r,e){if(r&1){let t=Ct();he(0,"li",3)(1,"a",9),pe("click",function(){qe(t);let i=ze();return $e(i.misTurnos())}),ce(2,"- Mis Turnos - "),de()()}}function RD(r,e){if(r&1){let t=Ct();he(0,"li",3)(1,"a",9),pe("click",function(){qe(t);let i=ze();return $e(i.solicitarTurno())}),ce(2,"Solicitar Turno - "),de()()}}function DD(r,e){if(r&1){let t=Ct();he(0,"li",3)(1,"a",9),pe("click",function(){qe(t);let i=ze();return $e(i.perfilPaciente())}),ce(2,"Mi Perfil"),de()()}}function PD(r,e){if(r&1){let t=Ct();he(0,"li",3)(1,"a",9),pe("click",function(){qe(t);let i=ze();return $e(i.misTurnoEspecialista())}),ce(2,"- Mis Turnos -"),de()()}}function xD(r,e){if(r&1){let t=Ct();he(0,"li",3)(1,"a",9),pe("click",function(){qe(t);let i=ze();return $e(i.misPacientes())}),ce(2,"Pacientes -"),de()()}}function VD(r,e){if(r&1){let t=Ct();he(0,"li",3)(1,"a",9),pe("click",function(){qe(t);let i=ze();return $e(i.perfilEspecialista())}),ce(2,"Mi Perfil"),de()()}}function MD(r,e){if(r&1){let t=Ct();he(0,"li",3)(1,"a",9),pe("click",function(){qe(t);let i=ze();return $e(i.turnosclinica())}),ce(2,"- Turnos -"),de()()}}function kD(r,e){if(r&1){let t=Ct();he(0,"li",3)(1,"a",10),pe("click",function(){qe(t);let i=ze();return $e(i.solicitarTurnoAdmin())}),ce(2,"Solicitar Turno -"),de()()}}function ND(r,e){if(r&1){let t=Ct();he(0,"li",3)(1,"a",9),pe("click",function(){qe(t);let i=ze();return $e(i.Perfil())}),ce(2,"Mi Perfil -"),de()()}}function OD(r,e){if(r&1){let t=Ct();he(0,"li",11)(1,"a",12),ce(2,"Usuarios"),de(),he(3,"ul",13)(4,"li")(5,"a",14),pe("click",function(){qe(t);let i=ze();return $e(i.habilitarInhabilitar())}),ce(6,"Habilitar/Inhabilitar Especialista"),de()(),he(7,"li")(8,"a",14),pe("click",function(){qe(t);let i=ze();return $e(i.usuarioAdmin())}),ce(9,"Datos de los Usuarios"),de()(),he(10,"li")(11,"a",14),pe("click",function(){qe(t);let i=ze();return $e(i.genUsuarioAdmin())}),ce(12,"Generar usuario"),de()()()()}}function FD(r,e){if(r&1){let t=Ct();he(0,"li",11)(1,"a",12),ce(2,"- Informes"),de(),he(3,"ul",15)(4,"li")(5,"a",14),pe("click",function(){qe(t);let i=ze();return $e(i.ingresos())}),ce(6,"Log de Ingresos"),de()(),he(7,"li")(8,"a",14),pe("click",function(){qe(t);let i=ze();return $e(i.turnosdia())}),ce(9,"Cantidad Turnos por D\xEDa"),de()(),he(10,"li")(11,"a",14),pe("click",function(){qe(t);let i=ze();return $e(i.turnosfinalizados())}),ce(12,"Cantidad Turnos Finalizados"),de()(),he(13,"li")(14,"a",14),pe("click",function(){qe(t);let i=ze();return $e(i.turnospendientes())}),ce(15,"Cantidad Turnos Pendientes"),de()(),he(16,"li")(17,"a",14),pe("click",function(){qe(t);let i=ze();return $e(i.turnosespecialidad())}),ce(18,"Cantidad Turnos por Especialidad"),de()()()()}}var _M=(()=>{let e=class e{constructor(n,i){this.rutas=n,this.unUsuario=i,this.listPerfil=[]}ngOnInit(){this.obtener_localstorage()}inicio(){this.rutas.navigate(["bienvenido"]),window.location.reload()}ngOnChanges(n){}desloguearse(){localStorage.removeItem("user"),localStorage.removeItem("userPerfil"),localStorage.removeItem("autorizadoPerfil"),localStorage.removeItem("perfil"),this.email="",this.id="",this.perfil="",this.gralPerfil="",this.rutas.navigate(["bienvenidoLogin"])}obtener_localstorage(){let n=JSON.parse(localStorage.getItem("user"));this.email=n.email,this.id=n.uid,this.getPerfil(this.email)}misTurnos(){this.rutas.navigate(["paciente/misTurnos"])}solicitarTurno(){this.rutas.navigate(["paciente/solicitarTurno"])}cancelarTurnos(){this.rutas.navigate(["paciente/cancelarTurno"])}perfilPaciente(){this.rutas.navigate(["paciente/perfilPaciente"])}misTurnoEspecialista(){this.rutas.navigate(["especialista/misTurnoEsp"])}solicitarTurnoEspecialista(){this.rutas.navigate(["especialista/misTurnosAdm"])}rechazarTurnoEspecialista(){this.rutas.navigate(["especialista/rechazarTurnos"])}finalizarTurnoEspecialista(){this.rutas.navigate(["especialista/finalizarTurno"])}crearTurnoEspecialista(){this.rutas.navigate(["especialista/crearTurnos"])}resEspecialista(){this.rutas.navigate(["especialista/resEsp"])}perfilEspecialista(){this.rutas.navigate(["especialista/perfilEsp"])}misPacientes(){this.rutas.navigate(["especialista/misPacientes"])}genUsuarioAdmin(){this.rutas.navigate(["admin/genUsAdmin"])}solicitarTurnoAdmin(){this.rutas.navigate(["admin/misTurnosAdm"])}usuarioAdmin(){this.rutas.navigate(["admin/usuariosAdmin"])}habilitarInhabilitar(){this.rutas.navigate(["admin/habEsp"])}Perfil(){this.rutas.navigate(["admin/perfilAdm"])}turnosclinica(){this.rutas.navigate(["admin/turnosclinica"])}logreporte(){this.rutas.navigate(["admin/logReporte"])}ingresos(){this.rutas.navigate(["admin/ingresos"])}turnosdia(){this.rutas.navigate(["admin/turnosdia"])}turnosfinalizados(){this.rutas.navigate(["admin/turnosfinalizados"])}turnospendientes(){this.rutas.navigate(["admin/turnospendientes"])}turnosespecialidad(){this.rutas.navigate(["admin/turnosespecialidad"])}getPerfil(n){console.log("correo :",n),this.unUsuario.getPerfilUsuario(n).subscribe(i=>{i.forEach(o=>{this.listPerfil.push(B({id:o.payload.doc.id},o.payload.doc.data()))});let s={perfil:this.listPerfil[0].perfil,apellido:this.listPerfil[0].apellido,nombre:this.listPerfil[0].nombre,dni:this.listPerfil[0].dni,email:this.listPerfil[0].email,aprobadoPorAdmin:this.listPerfil[0].aprobadoPorAdmin,especialidad:this.listPerfil[0].especialidad,otraEspecialidad:this.listPerfil[0].otraEspecialidad,fotoPerfilUno:this.listPerfil[0].fotoPerfilUno,fotoPerfilDos:this.listPerfil[0].fotoPerfilDos};this.gralPerfil=s.perfil})}};e.\u0275fac=function(i){return new(i||e)(re(Ot),re(fT))},e.\u0275cmp=ai({type:e,selectors:[["app-menu-gral"]],standalone:!0,features:[ln,hi],decls:30,vars:13,consts:[[1,"navbar","navbar-expand-md","navbar-dark","fixed-top","bg-dark"],["id","navbarsExampleDefault",1,"collapse","navbar-collapse"],[1,"navbar-nav","mr-auto"],[1,"nav-item","active"],[1,"nav-link",3,"click"],[1,"sr-only"],[1,"nav-link"],["class","nav-item active",4,"ngIf"],["class","nav-item active dropdown-submenu",4,"ngIf"],[1,"nav-link","button",3,"click"],["onclick","this.blur();",1,"nav-link","button",3,"click"],[1,"nav-item","active","dropdown-submenu"],["data-toggle","dropdown",1,"nav-link","button"],[1,"dropdown-menu"],[1,"dropdown-item","button",3,"click"],[1,"dropdown-menu","button"]],template:function(i,s){i&1&&(he(0,"nav",0)(1,"div",1)(2,"ul",2)(3,"li",3)(4,"a",4),pe("click",function(){return s.inicio()}),ce(5,"Bienvenido "),he(6,"span",5),ce(7,"(current)"),de()()(),he(8,"li",3)(9,"a",6)(10,"b"),ce(11,"Perfil:"),de(),ce(12),he(13,"b"),ce(14,"Usuario:"),de(),ce(15),de()(),ay(16,SD,3,0,"li",7)(17,RD,3,0,"li",7)(18,DD,3,0,"li",7)(19,PD,3,0,"li",7)(20,xD,3,0,"li",7)(21,VD,3,0,"li",7)(22,MD,3,0,"li",7)(23,kD,3,0,"li",7)(24,ND,3,0,"li",7)(25,OD,13,0,"li",8)(26,FD,19,0,"li",8),he(27,"li",3)(28,"a",9),pe("click",function(){return s.desloguearse()}),ce(29," - Desloguearse"),de()()()()()),i&2&&(et(12),Hl(" ",s.gralPerfil," - "),et(3),Hl(" ",s.email,""),et(),ft("ngIf",s.gralPerfil=="Paciente"),et(),ft("ngIf",s.gralPerfil=="Paciente"),et(),ft("ngIf",s.gralPerfil=="Paciente"),et(),ft("ngIf",s.gralPerfil=="Especialista"),et(),ft("ngIf",s.gralPerfil=="Especialista"),et(),ft("ngIf",s.gralPerfil=="Especialista"),et(),ft("ngIf",s.gralPerfil=="Administrador"),et(),ft("ngIf",s.gralPerfil=="Administrador"),et(),ft("ngIf",s.gralPerfil=="Administrador"),et(),ft("ngIf",s.gralPerfil=="Administrador"),et(),ft("ngIf",s.gralPerfil=="Administrador"))},dependencies:[gy],styles:['.dropdown-submenu[_ngcontent-%COMP%]{position:relative}.dropdown-submenu[_ngcontent-%COMP%] > .dropdown-menu[_ngcontent-%COMP%]{top:0;left:100%;margin-top:-6px;margin-left:-1px;-webkit-border-radius:0 6px 6px 6px;-moz-border-radius:0 6px 6px;border-radius:0 6px 6px}.dropdown-submenu[_ngcontent-%COMP%]:hover > .dropdown-menu[_ngcontent-%COMP%]{display:block}.dropdown-submenu[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:after{display:block;content:" ";float:right;width:0;height:0;border-color:transparent;border-style:solid;border-width:5px 0 5px 5px;border-left-color:#ccc;margin-top:5px;margin-right:-10px}.dropdown-submenu[_ngcontent-%COMP%]:hover > a[_ngcontent-%COMP%]:after{border-left-color:#fff}footer[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{padding-top:80px}.texto-blanco[_ngcontent-%COMP%]{color:#fff}.button[_ngcontent-%COMP%]{cursor:pointer}']});let r=e;return r})();var LD=()=>["/auth"],AM=(()=>{let e=class e{constructor(){}ngOnInit(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=ai({type:e,selectors:[["app-menu-inicio"]],standalone:!0,features:[hi],decls:10,vars:2,consts:[[1,"navbar","navbar-expand-lg","navbar-dark","bg-dark"],["href","#",1,"navbar-brand"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarColor02","aria-controls","navbarColor02","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarColor02",1,"collapse","navbar-collapse"],[1,"navbar-nav","me-auto"],[1,"nav-item"],[1,"nav-link",3,"routerLink"]],template:function(i,s){i&1&&(he(0,"nav",0)(1,"a",1),ce(2,"Bienvenidos"),de(),he(3,"button",2),Fa(4,"span",3),de(),he(5,"div",4)(6,"ul",5)(7,"li",6)(8,"a",7),ce(9,"Ingresar"),de()()()()()),i&2&&(et(8),ft("routerLink",uy(1,LD)))},dependencies:[l_]});let r=e;return r})();export{JD as a,Ny as b,vP as c,B0 as d,tb as e,Ot as f,fx as g,px as h,vC as i,gx as j,hn as k,bx as l,DC as m,Cr as n,Pi as o,m_ as p,Co as q,ud as r,Nx as s,Ox as t,Wx as u,V_ as v,GV as w,Rg as x,gM as y,fT as z,_M as A,AM as B,ev as C,$y as D,OP as E,FP as F,yA as G,UP as H,_A as I,EA as J,TA as K,jP as L,BP as M,qP as N,$P as O,zP as P};
